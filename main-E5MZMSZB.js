var Ave=Object.create;var Yb=Object.defineProperty,Ove=Object.defineProperties,Mve=Object.getOwnPropertyDescriptor,Rve=Object.getOwnPropertyDescriptors,Pve=Object.getOwnPropertyNames,i_=Object.getOwnPropertySymbols,Fve=Object.getPrototypeOf,DA=Object.prototype.hasOwnProperty,JV=Object.prototype.propertyIsEnumerable;var NA=(n,t)=>(t=Symbol[n])?t:Symbol.for("Symbol."+n),$ve=n=>{throw TypeError(n)};var ZV=(n,t,e)=>t in n?Yb(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,Fe=(n,t)=>{for(var e in t||={})DA.call(t,e)&&ZV(n,e,t[e]);if(i_)for(var e of i_(t))JV.call(t,e)&&ZV(n,e,t[e]);return n},vt=(n,t)=>Ove(n,Rve(t));var Zb=(n,t)=>{var e={};for(var r in n)DA.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&i_)for(var r of i_(n))t.indexOf(r)<0&&JV.call(n,r)&&(e[r]=n[r]);return e};var b=(n,t)=>()=>(n&&(t=n(n=0)),t);var Pn=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),xn=(n,t)=>{for(var e in t)Yb(n,e,{get:t[e],enumerable:!0})},eq=(n,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Pve(t))!DA.call(n,o)&&o!==e&&Yb(n,o,{get:()=>t[o],enumerable:!(r=Mve(t,o))||r.enumerable});return n};var Jb=(n,t,e)=>(e=n!=null?Ave(Fve(n)):{},eq(t||!n||!n.__esModule?Yb(e,"default",{value:n,enumerable:!0}):e,n)),a_=n=>eq(Yb({},"__esModule",{value:!0}),n);var Y=(n,t,e)=>new Promise((r,o)=>{var s=c=>{try{a(e.next(c))}catch(l){o(l)}},i=c=>{try{a(e.throw(c))}catch(l){o(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,i);a((e=e.apply(n,t)).next())}),Lve=function(n,t){this[0]=n,this[1]=t};var Ja=n=>{var t=n[NA("asyncIterator")],e=!1,r,o={};return t==null?(t=n[NA("iterator")](),r=s=>o[s]=i=>t[s](i)):(t=t.call(n),r=s=>o[s]=i=>{if(e){if(e=!1,s==="throw")throw i;return i}return e=!0,{done:!1,value:new Lve(new Promise(a=>{var c=t[s](i);c instanceof Object||$ve("Object expected"),a(c)}),1)}}),o[NA("iterator")]=()=>o,r("next"),"throw"in t?r("throw"):o.throw=s=>{throw s},"return"in t&&r("return"),o};function Le(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}var ef,eu,iR=b(()=>{"use strict";ef=class{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}},eu=class{decComplexRef(t){}time(t){return Le("time")}read(t){return Le("read")}readSync(t){return Le("readSync")}numDataIds(){return Le("numDataIds")}disposeData(t){return Le("disposeData")}write(t,e,r){return Le("write")}move(t,e,r,o){return Le("move")}memory(){return Le("memory")}floatPrecision(){return Le("floatPrecision")}epsilon(){return this.floatPrecision()===32?1e-7:1e-4}batchMatMul(t,e,r,o){return Le("batchMatMul")}fusedBatchMatMul({a:t,b:e,transposeA:r,transposeB:o,bias:s,activation:i,preluActivationWeights:a}){return Le("fusedBatchMatMul")}slice(t,e,r){return Le("slice")}stridedSlice(t,e,r,o){return Le("stridedSlice")}unstack(t,e){return Le("unstack")}reverse(t,e){return Le("reverse")}concat(t,e){return Le("concat")}neg(t){return Le("neg")}add(t,e){return Le("add")}addN(t){return Le("addN")}subtract(t,e){return Le("subtract")}multiply(t,e){return Le("multiply")}realDivide(t,e){return Le("realDivide")}floorDiv(t,e){return Le("floorDiv")}sum(t,e){return Le("sum")}prod(t,e){return Le("prod")}unsortedSegmentSum(t,e,r){return Le("unsortedSegmentSum")}argMin(t,e){return Le("argMin")}argMax(t,e){return Le("argMax")}equal(t,e){return Le("equal")}notEqual(t,e){return Le("notEqual")}less(t,e){return Le("less")}lessEqual(t,e){return Le("lessEqual")}greater(t,e){return Le("greater")}greaterEqual(t,e){return Le("greaterEqual")}logicalNot(t){return Le("logicalNot")}logicalAnd(t,e){return Le("logicalAnd")}logicalOr(t,e){return Le("logicalOr")}where(t){return Le("where")}select(t,e,r){return Le("select")}topk(t,e,r){return Le("topk")}min(t,e){return Le("min")}minimum(t,e){return Le("minimum")}mod(t,e){return Le("mod")}max(t,e){return Le("max")}maximum(t,e){return Le("maximum")}all(t,e){return Le("all")}any(t,e){return Le("any")}squaredDifference(t,e){return Le("squaredDifference")}ceil(t){return Le("ceil")}floor(t){return Le("floor")}round(t){return Le("round")}sign(t){return Le("sign")}isNaN(t){return Le("isNaN")}isInf(t){return Le("isInf")}isFinite(t){return Le("isFinite")}pow(t,e){return Le("pow")}exp(t){return Le("exp")}expm1(t){return Le("expm1")}softmax(t,e){return Le("softmax")}log(t){return Le("log")}log1p(t){return Le("log1p")}sqrt(t){return Le("sqrt")}rsqrt(t){return Le("rsqrt")}square(t){return Le("square")}reciprocal(t){return Le("reciprocal")}relu(t){return Le("relu")}relu6(t){return Le("relu6")}prelu(t,e){return Le("prelu")}elu(t){return Le("elu")}eluDer(t,e){return Le("eluDer")}selu(t){return Le("selu")}int(t){return Le("int")}clip(t,e,r){return Le("clip")}abs(t){return Le("abs")}complexAbs(t){return Le("complexAbs")}sigmoid(t){return Le("sigmoid")}softplus(t){return Le("softplus")}sin(t){return Le("sin")}cos(t){return Le("cos")}tan(t){return Le("tan")}asin(t){return Le("asin")}acos(t){return Le("acos")}atan(t){return Le("atan")}atan2(t,e){return Le("atan2")}sinh(t){return Le("sinh")}cosh(t){return Le("cosh")}tanh(t){return Le("tanh")}asinh(t){return Le("asinh")}acosh(t){return Le("acosh")}atanh(t){return Le("atanh")}erf(t){return Le("erf")}step(t,e){return Le("step")}fusedConv2d({input:t,filter:e,convInfo:r,bias:o,activation:s,preluActivationWeights:i}){return Le("fusedConv2d")}conv2d(t,e,r){return Le("conv2d")}conv2dDerInput(t,e,r){return Le("conv2dDerInput")}conv2dDerFilter(t,e,r){return Le("conv2dDerFilter")}fusedDepthwiseConv2D({input:t,filter:e,convInfo:r,bias:o,activation:s,preluActivationWeights:i}){return Le("fusedDepthwiseConv2D")}depthwiseConv2D(t,e,r){return Le("depthwiseConv2D")}depthwiseConv2DDerInput(t,e,r){return Le("depthwiseConv2DDerInput")}depthwiseConv2DDerFilter(t,e,r){return Le("depthwiseConv2DDerFilter")}conv3d(t,e,r){return Le("conv3d")}conv3dDerInput(t,e,r){return Le("conv3dDerInput")}conv3dDerFilter(t,e,r){return Le("conv3dDerFilter")}maxPool(t,e){return Le("maxPool")}maxPoolBackprop(t,e,r,o){return Le("maxPoolBackprop")}avgPool(t,e){return Le("avgPool")}avgPoolBackprop(t,e,r){return Le("avgPoolBackprop")}avgPool3d(t,e){return Le("avgPool3d")}avgPool3dBackprop(t,e,r){return Le("avgPool3dBackprop")}maxPool3d(t,e){return Le("maxPool3d")}maxPool3dBackprop(t,e,r,o){return Le("maxPool3dBackprop")}reshape(t,e){return Le("reshape")}cast(t,e){return Le("cast")}tile(t,e){return Le("tile")}pad(t,e,r){return Le("pad")}transpose(t,e){return Le("transpose")}gather(t,e,r,o=0){return Le("gather")}gatherND(t,e){return Le("gatherND")}scatterND(t,e,r){return Le("scatterND")}batchToSpaceND(t,e,r){return Le("batchToSpaceND")}spaceToBatchND(t,e,r){return Le("spaceToBatchND")}resizeBilinear(t,e,r,o,s){return Le("resizeBilinear")}resizeBilinearBackprop(t,e,r){return Le("resizeBilinearBackprop")}resizeNearestNeighbor(t,e,r,o,s){return Le("resizeNearestNeighbor")}resizeNearestNeighborBackprop(t,e,r){return Le("resizeNearestNeighborBackprop")}batchNorm(t,e,r,o,s,i){return Le("batchNorm")}localResponseNormalization4D(t,e,r,o,s){return Le("localResponseNormalization4D")}LRNGrad(t,e,r,o,s,i,a){return Le("LRNGrad")}multinomial(t,e,r,o){return Le("multinomial")}oneHot(t,e,r,o){return Le("oneHot")}cumsum(t,e,r,o){return Le("cumsum")}nonMaxSuppression(t,e,r,o,s){return Le("nonMaxSuppression")}fft(t){return Le("fft")}ifft(t){return Le("ifft")}complex(t,e){return Le("complex")}real(t){return Le("real")}imag(t){return Le("imag")}cropAndResize(t,e,r,o,s,i){return Le("cropAndResize")}depthToSpace(t,e,r){return Le("depthToSpace")}split(t,e,r){return Le("split")}sparseToDense(t,e,r,o){return Le("sparseToDense")}diag(t){return Le("diag")}fill(t,e,r){return Le("fill")}onesLike(t){return Le("onesLike")}zerosLike(t){return Le("zerosLike")}linspace(t,e,r){return Le("linspace")}dispose(){return Le("dispose")}}});function cW(n){let t=n.length,e=0,r=0;for(;t>0;)r=Math.random()*t|0,t--,e=n[t],n[t]=n[r],n[r]=e}function mx(n,t,e){return Math.max(n,Math.min(t,e))}function BTe(n){return n%2===0?n:n+1}function VTe(n){let t=0;for(let e=0;e<n.length;e++)t+=n[e];return t}function qTe(n,t){let e=Math.random();return t*e+(1-e)*n}function UTe(n,t){let e=0;for(let r=0;r<n.length;r++){let o=Number(n[r])-Number(t[r]);e+=o*o}return e}function q(n,t){if(!n)throw new Error(typeof t=="string"?t:t())}function rn(n,t,e=""){q(As(n,t),()=>e+` Shapes ${n} and ${t} must match`)}function zi(n){q(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function cc(n,t=[],e=!1){if(t==null&&(t=[]),Array.isArray(n)||xo(n)&&!e)for(let r=0;r<n.length;++r)cc(n[r],t,e);else t.push(n);return t}function Vn(n){if(n.length===0)return 1;let t=n[0];for(let e=1;e<n.length;e++)t*=n[e];return t}function jTe(n){return n.length===0}function As(n,t){if(n===t)return!0;if(n==null||t==null||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function Nn(n){return n%1===0}function GTe(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;{let t=Math.exp(2*n);return(t-1)/(t+1)}}function WTe(n){let t=Math.ceil(Math.sqrt(n));return[t,Math.ceil(n/t)]}function HTe(n){let t=new Uint32Array(n);for(let e=0;e<n;++e)t[e]=e;return cW(t),t}function Xd(n,t){return t<=n.length?n:n+" ".repeat(t-n.length)}function KTe(n,t=r=>0,e){return new Promise((r,o)=>{let s=0,i=()=>{if(n()){r();return}s++;let a=t(s);if(e!=null&&s>=e){o();return}setTimeout(i,a)};i()})}function XTe(n,t){let e=1,r=-1;for(let s=0;s<n.length;++s)if(n[s]>=0)e*=n[s];else if(n[s]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${s}`);r=s}else if(n[s]<0)throw Error(`Shapes can not be < 0. Found ${n[s]} at dim ${s}`);if(r===-1){if(t>0&&t!==e)throw Error(`Size(${t}) must match the product of shape ${n}`);return n}if(e===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(t%e!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${e}`);let o=n.slice();return o[r]=t/e,o}function no(n,t){let e=t.length;return n=n==null?t.map((r,o)=>o):[].concat(n),q(n.every(r=>r>=-e&&r<e),()=>`All values in axis param must be in range [-${e}, ${e}) but got axis ${n}`),q(n.every(r=>Nn(r)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(r=>r<0?e+r:r)}function aR(n,t){let e=[],r=[],o=t!=null&&Array.isArray(t)&&t.length===0,s=t==null||o?null:no(t,n).sort(),i=0;for(let a=0;a<n.length;++a){if(s!=null){if(s[i]===a&&n[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${n[a]}' is not 1`);(s[i]==null||s[i]>a)&&n[a]===1&&(e.push(n[a]),r.push(a)),s[i]<=a&&i++}n[a]!==1&&(e.push(n[a]),r.push(a))}return{newShape:e,keptDims:r}}function cR(n,t){let e=null;if(n==null||n==="float32")e=new Float32Array(t);else if(n==="int32")e=new Int32Array(t);else if(n==="bool")e=new Uint8Array(t);else throw new Error(`Unknown data type ${n}`);return e}function uR(n,t){let e=null;if(n==null||n==="float32")e=new Float32Array(t);else if(n==="int32")e=new Int32Array(t);else if(n==="bool")e=new Uint8Array(t);else if(n==="string")e=new Array(t);else throw new Error(`Unknown data type ${n}`);return e}function lR(n,t){for(let e=0;e<n.length;e++){let r=n[e];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function pR(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function hR(n,t){return!(t==="complex64"||t==="float32"&&n!=="complex64"||t==="int32"&&n!=="float32"&&n!=="complex64"||t==="bool"&&n==="bool")}function xo(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array}function fR(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function dR(n){if(n==null)return 0;let t=0;return n.forEach(e=>t+=e.length),t}function uc(n){return typeof n=="string"||n instanceof String}function uW(n){return typeof n=="boolean"}function lW(n){return typeof n=="number"}function gx(n){return Array.isArray(n)?gx(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array?"int32":lW(n)?"float32":uc(n)?"string":uW(n)?"bool":"float32"}function tu(n){return!!(n&&n.constructor&&n.call&&n.apply)}function yx(n,t){for(let e=t;e<n;++e)if(n%e===0)return e;return n}function nu(n){let t=n.length;if(t<2)return[];let e=new Array(t-1);e[t-2]=n[t-1];for(let r=t-3;r>=0;--r)e[r]=e[r+1]*n[r+1];return e}function pW(n,t,e){let r=new Array;if(t.length===1){let o=t[0];for(let s=0;s<o;s++)r[s]=e[n+s]}else{let o=t[0],s=t.slice(1),i=s.reduce((a,c)=>a*c);for(let a=0;a<o;a++)r[a]=pW(n+a*i,s,e)}return r}function Kd(n,t){if(n.length===0)return t[0];let e=n.reduce((r,o)=>r*o);if(e===0)return[];if(e!==t.length)throw new Error(`[${n}] does not match the input size ${t.length}.`);return pW(0,n,t)}function Zw(n,t){let e=xx(n,t);for(let r=0;r<e.length;r++)e[r]=1;return e}function xx(n,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(n);if(t==="int32")return new Int32Array(n);if(t==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${t}`)}function QTe(n,t){let e=n.reduce((r,o)=>r*o,1);if(t==null||t==="float32")return Kd(n,new Float32Array(e));if(t==="int32")return Kd(n,new Int32Array(e));if(t==="bool")return Kd(n,new Uint8Array(e));throw new Error(`Unknown data type ${t}`)}function Jw(n){n.forEach(t=>{q(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function YTe(n,t,e){if(t===0)return 0;if(t===1)return n[0];let r=n[n.length-1];for(let o=0;o<n.length-1;++o)r+=e[o]*n[o];return r}function ZTe(n,t,e){if(t===0)return[];if(t===1)return[n];let r=new Array(t);for(let o=0;o<r.length-1;++o)r[o]=Math.floor(n/e[o]),n-=r[o]*e[o];return r[r.length-1]=n,r}function e0(n){return n&&n.then&&typeof n.then=="function"}var pI=b(()=>{"use strict";});function eIe(n){let t={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(e,...r)=>(tIe(t,r[0],r[1]),r.join("="))),t}function tIe(n,t,e){n[decodeURIComponent(t)]=decodeURIComponent(e||"")}function nIe(n,t){if(t=t.toLowerCase(),t==="true"||t==="false")return t==="true";if(`${+t}`===t)return+t;throw new Error(`Could not parse value flag value ${t} for flag ${n}.`)}function Te(){return hI}function fW(n){hI=n}var hW,vx,hI,gs=b(()=>{"use strict";pI();hW="tfjsflags",vx=class{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}setPlatform(t,e){this.platform!=null&&console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`),this.platformName=t,this.platform=e}registerFlag(t,e,r){if(this.flagRegistry[t]={evaluationFn:e,setHook:r},this.urlFlags[t]!=null){let o=this.urlFlags[t];console.warn(`Setting feature override from URL ${t}: ${o}.`),this.set(t,o)}}getAsync(t){return Y(this,null,function*(){return t in this.flags?this.flags[t]:(this.flags[t]=yield this.evaluateFlag(t),this.flags[t])})}get(t){if(t in this.flags)return this.flags[t];let e=this.evaluateFlag(t);if(e0(e))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;let t=eIe(this.global.location.search);hW in t&&t[hW].split(",").forEach(r=>{let[o,s]=r.split(":");this.urlFlags[o]=nIe(o,s)})}};hI=null});function gR(){if(mR==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");mR=n}return mR}function rIe(){let n=gR();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function yR(n,t){let e=rIe();if(e.has(n))return e.get(n);{let r=t();return e.set(n,r),e.get(n)}}var mR,xR=b(()=>{"use strict";});var np,ru,ou,ma,rp,Qd,Yd,op,sp,su,iu,au,cu,uu,ip,Zd,ap,Jd,cp,up,em,vR,lc,lu,pu,tm,lp,pp,hp,nm,fp,dp,rm,om,hu,fu,mp,sm,im,am,gp,cm,um,lm,yp,bx,wx,du,mu,pm,gu,tf,yu,xp,xu,hm,fm,dm,vu,bu,vp,bp,mm,nf,wu,wp,gm,ym,Su,Cu,_u,Sp,rf,of,xm,Tu,Iu,sf,af,cf,bR,Cp,vm,_p,Eu,Tp,bm,Ip,wm,Sm,Ep,Np,Nu,Dp,Du,Cm,ku,kp,uf,_m,Tm,Im,Ap,Op,Mp,Rp,oIe,Au,Pp,Em,Nm,Dm,Ou,Mu,Fp,$p,km,Lp,Am,Ru,zp,Pu,Fu,Om,Bp,$u,Vp,Lu,zu,Bu,Vu,qu,Uu,qp,Up,jp,Gp,ju,Mm,Gu,Rm,Pm,Wu,Hu,pc,Fm,Wp,$m,Hp,Kp,Xp,Ku,Sx,Lm,lf,pf,hf,ae=b(()=>{"use strict";np="Abs",ru="Acos",ou="Acosh",ma="Add",rp="AddN",Qd="All",Yd="Any",op="ArgMax",sp="ArgMin",su="Asin",iu="Asinh",au="Atan",cu="Atanh",uu="Atan2",ip="AvgPool",Zd="AvgPoolGrad",ap="AvgPool3D",Jd="AvgPool3DGrad",cp="BatchMatMul",up="BatchToSpaceND",em="Bincount",vR="BroadcastTo",lc="Cast",lu="Ceil",pu="ClipByValue",tm="Complex",lp="ComplexAbs",pp="Concat",hp="Conv2D",nm="Conv2DBackpropFilter",fp="Conv2DBackpropInput",dp="Conv3D",rm="Conv3DBackpropFilterV2",om="Conv3DBackpropInputV2",hu="Cos",fu="Cosh",mp="Cumsum",sm="CropAndResize",im="DenseBincount",am="DepthToSpace",gp="DepthwiseConv2dNative",cm="DepthwiseConv2dNativeBackpropFilter",um="DepthwiseConv2dNativeBackpropInput",lm="Diag",yp="Dilation2D",bx="Dilation2DBackpropInput",wx="Dilation2DBackpropFilter",du="RealDiv",mu="Elu",pm="EluGrad",gu="Erf",tf="Equal",yu="Exp",xp="ExpandDims",xu="Expm1",hm="FFT",fm="Fill",dm="FlipLeftRight",vu="Floor",bu="FloorDiv",vp="FusedBatchNorm",bp="GatherV2",mm="GatherNd",nf="Greater",wu="GreaterEqual",wp="Identity",gm="IFFT",ym="Imag",Su="IsFinite",Cu="IsInf",_u="IsNan",Sp="LeakyRelu",rf="Less",of="LessEqual",xm="LinSpace",Tu="Log",Iu="Log1p",sf="LogicalAnd",af="LogicalNot",cf="LogicalOr",bR="LogSoftmax",Cp="LRN",vm="LRNGrad",_p="Max",Eu="Maximum",Tp="MaxPool",bm="MaxPoolGrad",Ip="MaxPool3D",wm="MaxPool3DGrad",Sm="MaxPoolWithArgmax",Ep="Mean",Np="Min",Nu="Minimum",Dp="MirrorPad",Du="Mod",Cm="Multinomial",ku="Multiply",kp="Neg",uf="NotEqual",_m="NonMaxSuppressionV3",Tm="NonMaxSuppressionV4",Im="NonMaxSuppressionV5",Ap="OnesLike",Op="OneHot",Mp="Pack",Rp="PadV2",oIe="Pool",Au="Pow",Pp="Prelu",Em="Prod",Nm="Range",Dm="Real",Ou="Reciprocal",Mu="Relu",Fp="Reshape",$p="ResizeNearestNeighbor",km="ResizeNearestNeighborGrad",Lp="ResizeBilinear",Am="ResizeBilinearGrad",Ru="Relu6",zp="Reverse",Pu="Round",Fu="Rsqrt",Om="ScatterNd",Bp="Select",$u="Selu",Vp="Slice",Lu="Sin",zu="Sinh",Bu="Sign",Vu="Sigmoid",qu="Softplus",Uu="Sqrt",qp="Sum",Up="SpaceToBatchND",jp="SplitV",Gp="Softmax",ju="SquaredDifference",Mm="Square",Gu="Sub",Rm="SparseToDense",Pm="StridedSlice",Wu="Tan",Hu="Tanh",pc="Tile",Fm="TopK",Wp="Transpose",$m="Unique",Hp="Unpack",Kp="UnsortedSegmentSum",Xp="ZerosLike",Ku="Step",Sx="FromPixels",Lm="RotateWithOffset",lf="_FusedMatMul",pf="FusedConv2D",hf="FusedDepthwiseConv2D"});function n0(n,t){let e=SR(n,t);return Cx.get(e)}function fI(n){return t0.get(n)}function r0(n){let t=Cx.entries(),e=[];for(;;){let{done:r,value:o}=t.next();if(r)break;let[s,i]=o,[a]=s.split("_");a===n&&e.push(i)}return e}function _x(n){let{kernelName:t,backendName:e}=n,r=SR(t,e);Cx.has(r)&&console.warn(`The kernel '${t}' for backend '${e}' is already registered`),Cx.set(r,n)}function wR(n){let{kernelName:t}=n;t0.has(t)&&Te().getBool("DEBUG")&&console.warn(`Overriding the gradient for '${t}'`),t0.set(t,n)}function sIe(n,t){let e=SR(n,t);if(!Cx.has(e))throw new Error(`The kernel '${n}' for backend '${t}' is not registered`);Cx.delete(e)}function iIe(n){if(!t0.has(n))throw new Error(`The gradient '${n}' for backend is not registered`);t0.delete(n)}function aIe(n,t){r0(n).forEach(r=>{let o=Object.assign({},r,{backendName:t});_x(o)})}function SR(n,t){return`${t}_${n}`}var Cx,t0,o0=b(()=>{"use strict";gs();xR();Cx=yR("kernelRegistry",()=>new Map),t0=yR("gradRegistry",()=>new Map)});var N={};xn(N,{arraysEqual:()=>As,assert:()=>q,assertNonNegativeIntegerDimensions:()=>Jw,assertNonNull:()=>zi,assertShapesMatch:()=>rn,bytesFromStringArray:()=>dR,bytesPerElement:()=>fR,checkConversionForErrors:()=>lR,clamp:()=>mx,computeStrides:()=>nu,createScalarValue:()=>cIe,createShuffledIndices:()=>HTe,decodeString:()=>Ix,distSquared:()=>UTe,encodeString:()=>ff,fetch:()=>lIe,flatten:()=>cc,getArrayFromDType:()=>uR,getTypedArrayFromDType:()=>cR,hasEncodingLoss:()=>hR,indexToLoc:()=>ZTe,inferDtype:()=>gx,inferFromImplicitShape:()=>XTe,isBoolean:()=>uW,isFunction:()=>tu,isInt:()=>Nn,isNumber:()=>lW,isPromise:()=>e0,isScalarShape:()=>jTe,isString:()=>uc,isTypedArray:()=>xo,isValidDtype:()=>pR,locToIndex:()=>YTe,makeOnesTypedArray:()=>Zw,makeZerosNestedTypedArray:()=>QTe,makeZerosTypedArray:()=>xx,nearestDivisor:()=>yx,nearestLargerEven:()=>BTe,now:()=>dI,parseAxisParam:()=>no,randUniform:()=>qTe,repeatedTry:()=>KTe,rightPad:()=>Xd,shuffle:()=>cW,sizeFromShape:()=>Vn,sizeToSquarishShape:()=>WTe,squeezeShape:()=>aR,sum:()=>VTe,tanh:()=>GTe,toNestedArray:()=>Kd,toTypedArray:()=>Tx});function cIe(n,t){return t==="string"?ff(n):Tx([n],t)}function uIe(n,t){return n instanceof Float32Array&&t==="float32"||n instanceof Int32Array&&t==="int32"||n instanceof Uint8Array&&t==="bool"}function Tx(n,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=cc(n)),Te().getBool("DEBUG")&&lR(n,t),uIe(n,t))return n;if(t==null||t==="float32"||t==="complex64")return new Float32Array(n);if(t==="int32")return new Int32Array(n);if(t==="bool"){let e=new Uint8Array(n.length);for(let r=0;r<e.length;++r)Math.round(n[r])!==0&&(e[r]=1);return e}else throw new Error(`Unknown data type ${t}`)}function dI(){return Te().platform.now()}function lIe(n,t){return Te().platform.fetch(n,t)}function ff(n,t="utf-8"){return t=t||"utf-8",Te().platform.encode(n,t)}function Ix(n,t="utf-8"){return t=t||"utf-8",Te().platform.decode(n,t)}var ze=b(()=>{"use strict";gs();pI();pI();});function pIe(n,t,e){if(t!=="float32")return!1;for(let r=0;r<n.length;r++){let o=n[r];if(isNaN(o)||!isFinite(o))return console.warn(`Found ${o} in the result of '${e}'`),!0}return!1}var mI,CR,dW=b(()=>{"use strict";gs();ze();mI=class{constructor(t,e){this.backendTimer=t,this.logger=e,e==null&&(this.logger=new CR)}profileKernel(t,e,r){let o,s=()=>{o=r()},i=this.backendTimer.time(s);if(Te().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<o.length;c++){let l=o[c];l.data().then(p=>{pIe(p,l.dtype,t)})}return{kernelName:t,outputs:o,inputs:e,timeMs:i.then(c=>c.kernelMs),extraInfo:i.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(t){let{kernelName:e,outputs:r,timeMs:o,inputs:s,extraInfo:i}=t;r.forEach(a=>{Promise.all([a.data(),o,i]).then(c=>{this.logger.logKernelProfile(e,a,c[0],c[1],s,c[2])})})}};CR=class{logKernelProfile(t,e,r,o,s,i){let a=typeof o=="number"?Xd(`${o}ms`,9):o.error,c=Xd(t,25),l=e.rank,p=e.size,f=Xd(e.shape.toString(),14),y="";for(let d in s){let h=s[d];if(h!=null){let m=h.shape||e.shape,x=m.length;y+=`${d}: ${x}D ${x>0?m:""} `}}console.log(`%c${c}	%c${a}	%c${l}D ${f}	%c${p}	%c${y}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}});function mW(n,t,e){let r={},o={};for(let c=0;c<t.length;c++)r[t[c].id]=!0;for(let c=0;c<n.length;c++){let l=n[c],p=l.inputs;for(let f in p){let y=p[f],d=!1;for(let h=0;h<t.length;h++)if(r[y.id]){l.outputs.forEach(m=>r[m.id]=!0),d=!0,o[l.id]=!0;break}if(d)break}}let s={};s[e.id]=!0;let i={};for(let c=n.length-1;c>=0;c--){let l=n[c],p=l.inputs;for(let f=0;f<l.outputs.length;f++)if(s[l.outputs[f].id]){for(let y in p)s[p[y].id]=!0,i[l.id]=!0;break}}let a=[];for(let c=0;c<n.length;c++){let l=n[c];if(o[l.id]&&i[l.id]){let p={};for(let y in l.inputs){let d=l.inputs[y];r[d.id]&&(p[y]=d)}let f=Object.assign({},l);f.inputs=p,f.outputs=l.outputs,a.push(f)}}return a}function gW(n,t,e,r){for(let o=t.length-1;o>=0;o--){let s=t[o],i=[];if(s.outputs.forEach(c=>{let l=n[c.id];l!=null?i.push(l):i.push(null)}),s.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);let a=s.gradient(i);for(let c in s.inputs){if(!(c in a))throw new Error(`Cannot backprop through input ${c}. Available gradients found: ${Object.keys(a)}.`);let l=e(()=>a[c]());if(l.dtype!=="float32")throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${c} must have 'float32' dtype, but has '${l.dtype}'`);let p=s.inputs[c];if(!As(l.shape,p.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${c}' has shape '${l.shape}', which does not match the shape of the input '${p.shape}'`);if(n[p.id]==null)n[p.id]=l;else{let f=n[p.id];n[p.id]=r(f,l),f.dispose()}}}}var yW=b(()=>{"use strict";ze();});function vW(n,t,e,r){let o=nu(t),s=hIe(n,t,e,o),i=t.length,a=gI(n,t,e,o,s),c=["Tensor"];return r&&(c.push(`  dtype: ${e}`),c.push(`  rank: ${i}`),c.push(`  shape: [${t}]`),c.push("  values:")),c.push(a.map(l=>"    "+l).join(`
`)),c.join(`
`)}function hIe(n,t,e,r){let o=Vn(t),s=r[r.length-1],i=new Array(s).fill(0),a=t.length,c=e==="complex64"?a0(n):n;if(a>1)for(let l=0;l<o/s;l++){let p=l*s;for(let f=0;f<s;f++)i[f]=Math.max(i[f],i0(c[p+f],0,e).length)}return i}function i0(n,t,e){let r;return Array.isArray(n)?r=`${parseFloat(n[0].toFixed(_R))} + ${parseFloat(n[1].toFixed(_R))}j`:uc(n)?r=`'${n}'`:e==="bool"?r=bW(n):r=parseFloat(n.toFixed(_R)).toString(),Xd(r,t)}function bW(n){return n===0?"false":"true"}function gI(n,t,e,r,o,s=!0){let i=e==="complex64"?2:1,a=t[0],c=t.length;if(c===0){if(e==="complex64"){let m=a0(n);return[i0(m[0],0,e)]}return e==="bool"?[bW(n[0])]:[n[0].toString()]}if(c===1){if(a>xW){let x=s0*i,w=Array.from(n.slice(0,x)),_=Array.from(n.slice((a-s0)*i,a*i));return e==="complex64"&&(w=a0(w),_=a0(_)),["["+w.map((I,T)=>i0(I,o[T],e)).join(", ")+", ..., "+_.map((I,T)=>i0(I,o[a-s0+T],e)).join(", ")+"]"]}return["["+(e==="complex64"?a0(n):Array.from(n)).map((x,w)=>i0(x,o[w],e)).join(", ")+"]"]}let l=t.slice(1),p=r.slice(1),f=r[0]*i,y=[];if(a>xW){for(let m=0;m<s0;m++){let x=m*f,w=x+f;y.push(...gI(n.slice(x,w),l,e,p,o,!1))}y.push("...");for(let m=a-s0;m<a;m++){let x=m*f,w=x+f;y.push(...gI(n.slice(x,w),l,e,p,o,m===a-1))}}else for(let m=0;m<a;m++){let x=m*f,w=x+f;y.push(...gI(n.slice(x,w),l,e,p,o,m===a-1))}let d=c===2?",":"";y[0]="["+y[0]+d;for(let m=1;m<y.length-1;m++)y[m]=" "+y[m]+d;let h=`,
`;for(let m=2;m<c;m++)h+=`
`;return y[y.length-1]=" "+y[y.length-1]+"]"+(s?"":h),y}function a0(n){let t=[];for(let e=0;e<n.length;e+=2)t.push([n[e],n[e+1]]);return t}var xW,s0,_R,wW=b(()=>{"use strict";ze();xW=20,s0=3,_R=7});function SW(n){Xu=n}function CW(n){Ex=n}function _W(n){fIe=n}var Dn,Xu,Ex,fIe,K,Qu,Ae=b(()=>{"use strict";wW();ze();ze();Dn=class{constructor(t,e,r){if(this.dtype=e,this.shape=t.slice(),this.size=Vn(t),r!=null){let o=r.length;q(o===this.size,()=>`Length of values '${o}' does not match the size inferred by the shape '${this.size}'.`)}if(e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||uR(e,this.size),this.strides=nu(t)}set(t,...e){e.length===0&&(e=[0]),q(e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`);let r=this.locToIndex(e);this.values[r]=t}get(...t){t.length===0&&(t=[0]);let e=0;for(let o of t){if(o<0||o>=this.shape[e]){let s=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(s)}e++}let r=t[t.length-1];for(let o=0;o<t.length-1;++o)r+=this.strides[o]*t[o];return this.values[r]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let e=t[t.length-1];for(let r=0;r<t.length-1;++r)e+=this.strides[r]*t[r];return e}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];let e=new Array(this.shape.length);for(let r=0;r<e.length-1;++r)e[r]=Math.floor(t/this.strides[r]),t-=e[r]*this.strides[r];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return Xu().makeTensor(this.values,this.shape,this.dtype)}},Xu=null,Ex=null,fIe=null;K=class{constructor(t,e,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=Vn(t),this.strides=nu(t),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}buffer(){return Y(this,null,function*(){let t=yield this.data();return Ex.buffer(this.shape,this.dtype,t)})}bufferSync(){return Ex.buffer(this.shape,this.dtype,this.dataSync())}array(){return Y(this,null,function*(){let t=yield this.data();return Kd(this.shape,t)})}arraySync(){return Kd(this.shape,this.dataSync())}data(){return Y(this,null,function*(){this.throwIfDisposed();let t=Xu().read(this.dataId);if(this.dtype==="string"){let e=yield t;try{return e.map(r=>Ix(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t})}dataSync(){this.throwIfDisposed();let t=Xu().readSync(this.dataId);if(this.dtype==="string")try{return t.map(e=>Ix(e))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}bytes(){return Y(this,null,function*(){this.throwIfDisposed();let t=yield Xu().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)})}dispose(){this.isDisposed||(Xu().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return Ex.print(this,t)}clone(){return this.throwIfDisposed(),Ex.clone(this)}toString(t=!1){let e=this.dataSync();return vW(e,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),Ex.cast(this,t)}variable(t=!0,e,r){return this.throwIfDisposed(),Xu().makeVariable(this,t,e,r)}};Object.defineProperty(K,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});Qu=class extends K{constructor(t,e,r,o){super(t.shape,t.dtype,t.dataId,o),this.trainable=e,this.name=r}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!As(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);Xu().disposeTensor(this),this.dataId=t.dataId,Xu().incRef(this,null)}dispose(){Xu().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(Qu,Symbol.hasInstance,{value:n=>n instanceof K&&n.assign!=null&&n.assign instanceof Function})});function ro(n,t){if(n==="string"||t==="string"){if(n==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${n} with ${t}`)}return dIe[n][t]}function df(n){return ro(n,"int32")}var TR,TW,IW,EW,NW,dIe,yI=b(()=>{"use strict";TR=function(n){return n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6",n}(TR||{}),TW=function(n){return n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64",n}(TW||{}),IW=function(n){return n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64",n}(IW||{}),EW=function(n){return n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64",n}(EW||{}),NW=function(n){return n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64",n}(NW||{}),dIe={float32:EW,int32:TW,bool:IW,complex64:NW}});var Bi={};xn(Bi,{assertTypesMatch:()=>IR,getTensorsInContainer:()=>c0,isTensorInList:()=>mIe,makeTypesMatch:()=>sn});function sn(n,t){if(n.dtype===t.dtype)return[n,t];let e=ro(n.dtype,t.dtype);return[n.cast(e),t.cast(e)]}function IR(n,t){q(n.dtype===t.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${t.dtype}) input must match`)}function mIe(n,t){return t.some(e=>e.id===n.id)}function c0(n){let t=[];return DW(n,t,new Set),t}function DW(n,t,e){if(n==null)return;if(n instanceof K){t.push(n);return}if(!gIe(n))return;let r=n;for(let o in r){let s=r[o];e.has(s)||(e.add(s),DW(s,t,e))}}function gIe(n){return Array.isArray(n)||typeof n=="object"}var br=b(()=>{"use strict";Ae();yI();ze();});function xIe(n){let t=Zw(Vn(n),"float32");return U.makeTensor(t,n,"float32")}function ER(){let n=gR();if(n._tfengine==null){let t=new vx(n);n._tfengine=new yIe(t)}return fW(n._tfengine.ENV),SW(()=>n._tfengine),n._tfengine}function vIe(n,t){let e={a:n,b:t};return U.runKernel(ma,e)}var xI,yIe,U,Ee=b(()=>{"use strict";iR();gs();xR();ae();o0();dW();yW();Ae();br();ze();ze();xI=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(let t in this.registeredVariables)this.registeredVariables[t].dispose()}},yIe=(()=>{class n{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new xI}ready(){return Y(this,null,function*(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;let e=this.getSortedBackends();for(let r=0;r<e.length;r++){let o=e[r];if(yield this.initializeBackend(o).success){yield this.setBackend(o);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")})}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){let{name:e,asyncInit:r}=this.initializeBackendsAndReturnBest();if(r)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){let{asyncInit:r}=this.initializeBackend(e);if(r)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,r,o=1){return e in this.registryFactory?(console.warn(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:r,priority:o},!0)}setBackend(e){return Y(this,null,function*(){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;let{success:r,asyncInit:o}=this.initializeBackend(e);if(!(o?yield r:r))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new mI(this.backendInstance),!0})}setupRegisteredKernels(){r0(this.backendName).forEach(r=>{r.setupFunc!=null&&r.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){r0(e).forEach(o=>{o.disposeFunc!=null&&o.disposeFunc(this.registry[e])})}initializeBackend(e){let r=this.registryFactory[e];if(r==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{let o=r.factory();if(o&&!(o instanceof eu)&&typeof o.then=="function"){let s=++this.pendingBackendInitId,i=o.then(a=>s<this.pendingBackendInitId?!1:(this.registry[e]=a,this.pendingBackendInit=null,!0)).catch(a=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,console.warn(`Initialization of backend ${e} failed`),console.warn(a.stack||a.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=o,{success:!0,asyncInit:!1}}catch(o){return console.warn(`Initialization of backend ${e} failed`),console.warn(o.stack||o.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,r)=>this.registryFactory[r].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){let e=this.getSortedBackends();for(let r=0;r<e.length;r++){let o=e[r],{success:s,asyncInit:i}=this.initializeBackend(o);if(i||s)return{name:o,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,r){let o=this.state.tensorInfo.get(r),s=o.backend,i=this.readSync(r);s.disposeData(r),o.backend=e,e.move(r,i,o.shape,o.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,r){let o=null;if(r==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");r=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof r!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=e}let s;return this.scopedRun(()=>this.startScope(o),()=>this.endScope(s),()=>(s=r(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,r,o){e();try{let s=o();return r(),s}catch(s){throw r(),s}}nextTensorId(){return n.nextTensorId++}nextVariableId(){return n.nextVariableId++}clone(e){let r=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),o={x:e},s=a=>({x:()=>{let c="float32",l={x:a},p={dtype:c};return U.runKernelFunc(f=>f.cast(a,c),l,null,lc,p)}}),i=[];return this.addTapeNode(this.state.activeScope.name,o,[r],s,i,{}),r}runKernel(e,r,o,s,i){return this.runKernelFunc(null,r,null,e,o,s,i)}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,r,o){let s=this.backend.numDataIds(),i=0;o.forEach(l=>{i+=l.dtype==="complex64"?3:1});let a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],c=s-r-i-a;if(c>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${c} data ids) after running '${e}'`)}runKernelFunc(e,r,o,s,i,a,c){let l,p=[],f=this.isTapeOn();s==null&&(s=this.state.activeScope!=null?this.state.activeScope.name:"");let y=this.state.numBytes,d=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let h;this.backendName==null&&this.backend;let m=n0(s,this.backendName),x;if(m!=null)h=()=>{let _=this.backend.numDataIds();x=m.kernelFunc({inputs:r,attrs:i,backend:this.backend});let I=Array.isArray(x)?x:[x];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(s,_,I);let T=I.map(D=>{if(D.rank!=null)return D;let{dataId:O,shape:R,dtype:P}=D;return this.makeTensorFromDataId(O,R,P)});if(f){let D=this.getTensorsForGradient(s,r,T);if(D==null){c==null&&(c=[]);let O=T.filter((R,P)=>c[P]);D=(a||[]).slice().concat(O)}p=this.saveTensorsForBackwardMode(D)}return T};else{if(e==null)throw new Error(`Error running ${s}: Neither modular kernel nor forward func passed`);let _=I=>{f&&(p=I.map(T=>this.keep(this.clone(T))))};h=()=>{let I=this.backend.numDataIds();x=this.tidy(()=>e(this.backend,_));let T=Array.isArray(x)?x:[x];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(s,I,T),T}}let w;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?l=h():(w=this.profiler.profileKernel(s,r,()=>h()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(w),l=w.outputs)}),f&&this.addTapeNode(s,r,l,o,p,i),this.state.profiling&&this.state.activeProfile.kernels.push({name:s,bytesAdded:this.state.numBytes-y,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-d,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(r).map(_=>r[_]!=null?r[_].shape:null),outputShapes:l.map(_=>_.shape),kernelTimeMs:w.timeMs,extraInfo:w.extraInfo}),Array.isArray(x)?l:l[0]}saveTensorsForBackwardMode(e){return e.map(o=>this.keep(this.clone(o)))}getTensorsForGradient(e,r,o){let s=fI(e);if(s!=null){let i=s.inputsToSave||[],a=s.outputsToSave||[],c;s.saveAllInputs?(q(Array.isArray(r),()=>"saveAllInputs is true, expected inputs to be an array."),c=Object.keys(r).map(p=>r[p])):c=i.map(p=>r[p]);let l=o.filter((p,f)=>a[f]);return c.concat(l)}return null}makeTensor(e,r,o,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");o=o||"float32",s=s||this.backend;let i=e;o==="string"&&uc(e[0])&&(i=e.map(l=>ff(l)));let a=s.write(i,r,o),c=new K(r,o,a,this.nextTensorId());if(this.incRef(c,s),o==="string"){let l=this.state.tensorInfo.get(a),p=dR(i);this.state.numBytes+=p-l.bytes,l.bytes=p}return c}makeTensorFromDataId(e,r,o,s){o=o||"float32";let i=new K(r,o,e,this.nextTensorId());return this.incRef(i,s),i}makeVariable(e,r=!0,o,s){o=o||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));let i=new Qu(e,r,o,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}incRef(e,r){let o=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++,o===0){this.state.numDataBuffers++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*fR(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:r||this.backend,dtype:e.dtype,shape:e.shape,bytes:s,refCount:0}),this.state.numBytes+=s}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof Qu||this.track(e)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;this.state.numTensors--,e.dtype==="string"&&this.state.numStringTensors--;let r=this.state.tensorInfo.get(e.dataId);r.refCount<=1?(e.dtype!=="complex64"&&(this.state.numBytes-=r.bytes),this.state.numDataBuffers--,r.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):(r.backend.decComplexRef(e.dataId),this.state.tensorInfo.get(e.dataId).refCount--)}disposeVariables(){for(let e in this.state.registeredVariables){let r=this.state.registeredVariables[e];this.disposeVariable(r)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){let e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}profile(e){return Y(this,null,function*(){this.state.profiling=!0;let r=this.state.numBytes,o=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=yield e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-r,this.state.activeProfile.newTensors=this.state.numTensors-o;for(let s of this.state.activeProfile.kernels)s.kernelTimeMs=yield s.kernelTimeMs,s.extraInfo=yield s.extraInfo;return this.state.activeProfile})}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,r,o,s,i,a){let c={id:this.state.nextTapeNodeId++,kernelName:e,inputs:r,outputs:o,saved:i},l=fI(e);l!=null&&(s=l.gradFunc),s!=null&&(c.gradient=p=>(p=p.map((f,y)=>{if(f==null){let d=o[y],h=xx(d.size,d.dtype);return this.makeTensor(h,d.shape,d.dtype)}return f}),s(p.length>1?p:p[0],i,a))),this.state.activeTape.push(c)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){let r={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(r.name=e),this.state.scopeStack.push(r),this.state.activeScope=r}endScope(e){let r=c0(e),o=new Set(r.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){let a=this.state.activeScope.track[i];!a.kept&&!o.has(a.id)&&a.dispose()}let s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(i=>{!i.kept&&i.scopeId===s.id&&this.track(i)})}gradients(e,r,o,s=!1){if(q(r.length>0,()=>"gradients() received an empty list of xs."),o!=null&&o.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${o.dtype}'`);let i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));q(i instanceof K,()=>"The result y returned by f() must be a tensor.");let a=mW(this.state.activeTape,r,i);if(!s&&a.length===0&&r.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let c={};c[i.id]=o??xIe(i.shape),gW(c,a,p=>this.tidy(p),vIe);let l=r.map(p=>c[p.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(p=>{for(let f of p.saved)f.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return q(tu(e),()=>"The f passed in customGrad(f) must be a function."),(...r)=>{q(r.every(i=>i instanceof K),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let o,s={};return r.forEach((i,a)=>{s[a]=i}),this.runKernelFunc((i,a)=>(o=e(...r,a),q(o.value instanceof K,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),q(tu(o.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),o.value),s,(i,a)=>{let c=o.gradFunc(i,a),l=Array.isArray(c)?c:[c];q(l.length===r.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),q(l.every(f=>f instanceof K),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let p={};return l.forEach((f,y)=>{p[y]=()=>f}),p})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}time(e){return Y(this,null,function*(){let r=dI(),o=yield this.backend.time(e);return o.wallMs=dI()-r,o})}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new xI;for(let e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}return n.nextTensorId=0,n.nextVariableId=0,n})();U=ER()});var mf={};xn(mf,{isBrowser:()=>NR,isMobile:()=>wIe});function bIe(){return typeof navigator<"u"&&navigator!=null}function wIe(){if(bIe()){let n=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))}return!1}function NR(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var DR=b(()=>{"use strict";});var Yu,Nx=b(()=>{"use strict";Ee();DR();gs();Yu=Te();Yu.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Yu.registerFlag("IS_BROWSER",()=>NR());Yu.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Yu.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Yu.registerFlag("PROD",()=>!1);Yu.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Yu.getBool("DEBUG"));Yu.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Yu.registerFlag("IS_TEST",()=>!1);Yu.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0)});function Xo(n,t){let e=n;if(xo(n))return t==="string"?[]:[n.length];if(!Array.isArray(n))return[];let r=[];for(;Array.isArray(e)||xo(e)&&t!=="string";)r.push(e.length),e=e[0];return Array.isArray(n)&&Te().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&AW(n,r,[]),r}function AW(n,t,e){if(e=e||[],!Array.isArray(n)&&!xo(n)){q(t.length===0,()=>`Element arr[${e.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}q(t.length>0,()=>`Element arr[${e.join("][")}] should be a primitive, but is an array of ${n.length} elements`),q(n.length===t[0],()=>`Element arr[${e.join("][")}] should have ${t[0]} elements, but has ${n.length} elements`);let r=t.slice(1);for(let o=0;o<n.length;++o)AW(n[o],r,e.concat(o))}function kW(n,t,e,r){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==t||n==="numeric"&&t==="string")throw new Error(`Argument '${e}' passed to '${r}' must be ${n} tensor, but got ${t} tensor`)}}function A(n,t,e,r="numeric"){if(n instanceof K)return kW(r,n.dtype,t,e),n;let o=gx(n);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),kW(r,o,t,e),n==null||!xo(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){let c=n==null?"null":n.constructor.name;throw new Error(`Argument '${t}' passed to '${e}' must be a Tensor or TensorLike, but got '${c}'`)}let s=Xo(n,o);!xo(n)&&!Array.isArray(n)&&(n=[n]);let a=o!=="string"?Tx(n,o):cc(n,[],!0);return U.makeTensor(a,s,o)}function Qp(n,t,e,r="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${t} passed to ${e} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((s,i)=>A(s,`${t}[${i}]`,e,r))}var Se=b(()=>{"use strict";Ee();gs();Ae();ze();});function z(n){let t=Object.keys(n);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let e=t[0],r=n[e];e.endsWith("_")&&(e=e.substring(0,e.length-1)),e=e+kR;let o=(...s)=>{U.startScope(e);try{let i=r(...s);return e0(i)&&console.error("Cannot return a Promise inside of tidy."),U.endScope(i),i}catch(i){throw U.endScope(null),i}};return Object.defineProperty(o,"name",{value:e,configurable:!0}),o}var kR,ye=b(()=>{"use strict";Ee();ze();kR="__op"});function SIe(n,t){let e=A(n,"real","complex"),r=A(t,"imag","complex");rn(e.shape,r.shape,`real and imag shapes, ${e.shape} and ${r.shape}, must match in call to tf.complex().`);let o={real:e,imag:r};return U.runKernel(tm,o)}var Xs,zm=b(()=>{"use strict";Ee();ae();Se();ze();ye();Xs=z({complex_:SIe})});function Os(n,t,e,r){if(r==null&&(r=gx(n)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!xo(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){Jw(t);let o=Vn(t),s=Vn(e);q(o===s,()=>`Based on the provided shape, [${t}], the tensor should have ${o} values but has ${s}`);for(let i=0;i<e.length;++i){let a=e[i],c=i===e.length-1?a!==Vn(t.slice(i)):!0;q(e[i]===t[i]||!c,()=>`Error creating a new Tensor. Inferred shape (${e}) does not match the provided shape (${t}). `)}}return!xo(n)&&!Array.isArray(n)&&(n=[n]),t=t||e,n=r!=="string"?Tx(n,r):cc(n,[],!0),U.makeTensor(n,t,r)}var Yp=b(()=>{"use strict";Ee();ze();});function Qo(n,t,e){let r=Xo(n,e);return Os(n,t,r,e)}var vI=b(()=>{"use strict";Se();Yp();});var u0,AR=b(()=>{"use strict";u0={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}});function MW(n,t){return Y(this,null,function*(){let e=[],r=[],o=Array.isArray(n)?n.map(i=>i.name):Object.keys(n);for(let i=0;i<o.length;++i){let a=o[i],c=Array.isArray(n)?n[i].tensor:n[a];if(c.dtype!=="float32"&&c.dtype!=="int32"&&c.dtype!=="bool"&&c.dtype!=="string"&&c.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${c.dtype}`);let l={name:a,shape:c.shape,dtype:c.dtype};if(c.dtype==="string"){let p=new Promise(f=>Y(null,null,function*(){let y=yield c.bytes(),d=y.reduce((x,w)=>x+w.length,0)+bI*y.length,h=new Uint8Array(d),m=0;for(let x=0;x<y.length;x++){let w=y[x],_=new Uint8Array(new Uint32Array([w.length]).buffer);h.set(_,m),m+=bI,h.set(w,m),m+=w.length}f(h)}));r.push(p)}else r.push(c.data());t!=null&&(l.group=t),e.push(l)}let s=yield Promise.all(r);return{data:CIe(s),specs:e}})}function wI(n,t){let e={},r,o=0;for(let s of t){let i=s.name,a=s.dtype,c=s.shape,l=Vn(c),p;if("quantization"in s){let f=s.quantization;if(f.dtype==="uint8"||f.dtype==="uint16"){if(!("min"in f&&"scale"in f))throw new Error(`Weight ${s.name} with quantization ${f.dtype} doesn't have corresponding metadata min and scale.`)}else if(f.dtype==="float16"){if(a!=="float32")throw new Error(`Weight ${s.name} is quantized with ${f.dtype} which only supports weights of type float32 not ${a}.`)}else throw new Error(`Weight ${s.name} has unknown quantization dtype ${f.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);let y=u0[f.dtype],d=n.slice(o,o+l*y),h=f.dtype==="uint8"?new Uint8Array(d):new Uint16Array(d);if(a==="float32")if(f.dtype==="uint8"||f.dtype==="uint16"){p=new Float32Array(h.length);for(let m=0;m<h.length;m++){let x=h[m];p[m]=x*f.scale+f.min}}else if(f.dtype==="float16")r===void 0&&(r=EIe()),p=r(h);else throw new Error(`Unsupported quantization type ${f.dtype} for weight type float32.`);else if(a==="int32"){if(f.dtype!=="uint8"&&f.dtype!=="uint16")throw new Error(`Unsupported quantization type ${f.dtype} for weight type int32.`);p=new Int32Array(h.length);for(let m=0;m<h.length;m++){let x=h[m];p[m]=Math.round(x*f.scale+f.min)}}else throw new Error(`Unsupported dtype in weight '${i}': ${a}`);o+=l*y}else if(a==="string"){let f=Vn(s.shape);p=[];for(let y=0;y<f;y++){let d=new Uint32Array(n.slice(o,o+bI))[0];o+=bI;let h=new Uint8Array(n.slice(o,o+d));p.push(h),o+=d}}else{let f=u0[a],y=n.slice(o,o+l*f);if(a==="float32")p=new Float32Array(y);else if(a==="int32")p=new Int32Array(y);else if(a==="bool")p=new Uint8Array(y);else if(a==="complex64"){p=new Float32Array(y);let d=new Float32Array(p.length/2),h=new Float32Array(p.length/2);for(let w=0;w<d.length;w++)d[w]=p[w*2],h[w]=p[w*2+1];let m=Qo(d,c,"float32"),x=Qo(h,c,"float32");e[i]=Xs(m,x),m.dispose(),x.dispose()}else throw new Error(`Unsupported dtype in weight '${i}': ${a}`);o+=l*f}a!=="complex64"&&(e[i]=Qo(p,c,a))}return e}function CIe(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let t=0,e=[];n.forEach(s=>{if(t+=s.byteLength,e.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${s.constructor.name}`)});let r=new Uint8Array(t),o=0;return e.forEach(s=>{r.set(new Uint8Array(s.buffer),o),o+=s.byteLength}),r.buffer}function OW(n){return OR?Buffer.byteLength(n):new Blob([n]).size}function RW(n){if(OR)return Buffer.from(n).toString("base64");let t=new Uint8Array(n),e="";for(let r=0,o=t.length;r<o;r++)e+=String.fromCharCode(t[r]);return btoa(e)}function PW(n){if(OR){let r=Buffer.from(n,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}let t=atob(n),e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e.set([t.charCodeAt(r)],r);return e.buffer}function Dx(n){if(n.length===1)return n[0];let t=0;n.forEach(o=>{t+=o.byteLength});let e=new Uint8Array(t),r=0;return n.forEach(o=>{e.set(new Uint8Array(o),r),r+=o.byteLength}),e.buffer}function MR(n){let t="/";for(n=n.trim();n.endsWith(t);)n=n.slice(0,n.length-1);let e=n.split(t);return e[e.length-1]}function Zu(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:OW(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:OW(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:n.weightData.byteLength}}function _Ie(){let n=e=>{let r=e<<13,o=0;for(;(r&8388608)===0;)o-=8388608,r<<=1;return r&=-8388609,o+=947912704,r|o},t=new Uint32Array(2048);t[0]=0;for(let e=1;e<1024;e++)t[e]=n(e);for(let e=1024;e<2048;e++)t[e]=939524096+(e-1024<<13);return t}function TIe(){let n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let t=1;t<31;t++)n[t]=t<<23;for(let t=33;t<63;t++)n[t]=2147483648+(t-32<<23);return n}function IIe(){let n=new Uint32Array(64);for(let t=0;t<64;t++)n[t]=1024;return n[0]=n[32]=0,n}function EIe(){let n=_Ie(),t=TIe(),e=IIe();return r=>{let o=new ArrayBuffer(4*r.length),s=new Uint32Array(o);for(let i=0;i<r.length;i++){let a=r[i],c=n[e[a>>10]+(a&1023)]+t[a>>10];s[i]=c}return new Float32Array(o)}}var bI,OR,Bm=b(()=>{"use strict";zm();vI();ze();AR();bI=4;OR=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u")});var To,FW,$W,LW,zW,Vm=b(()=>{"use strict";To=class n{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return n.instance==null&&(n.instance=new n),n.instance}static registerSaveRouter(t){n.getInstance().saveRouters.push(t)}static registerLoadRouter(t){n.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return n.getHandlers(t,"save")}static getLoadHandlers(t,e){return n.getHandlers(t,"load",e)}static getHandlers(t,e,r){let o=[];return(e==="load"?n.getInstance().loadRouters:n.getInstance().saveRouters).forEach(i=>{let a=i(t,r);a!==null&&o.push(a)}),o}},FW=n=>To.registerSaveRouter(n),$W=n=>To.registerLoadRouter(n),LW=n=>To.getSaveHandlers(n),zW=(n,t)=>To.getLoadHandlers(n,t)});function BW(){if(!Te().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let n=typeof window>"u"?self:window,t=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function FR(n){let t=n.result;t.createObjectStore(qm,{keyPath:"modelPath"}),t.createObjectStore(gf,{keyPath:"modelPath"})}function NIe(n){return new Um(n)}function DIe(n){return n.startsWith(Um.URL_SCHEME)?n.slice(Um.URL_SCHEME.length):n}var RR,PR,qm,gf,Um,VW,SI,$R=b(()=>{"use strict";Nx();gs();Bm();Vm();RR="tensorflowjs",PR=1,qm="models_store",gf="model_info_store";Um=(()=>{class n{constructor(e){if(this.indexedDB=BW(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}save(e){return Y(this,null,function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)})}load(){return Y(this,null,function*(){return this.databaseAction(this.modelPath)})}databaseAction(e,r){return new Promise((o,s)=>{let i=this.indexedDB.open(RR,PR);i.onupgradeneeded=()=>FR(i),i.onsuccess=()=>{let a=i.result;if(r==null){let c=a.transaction(qm,"readonly"),p=c.objectStore(qm).get(this.modelPath);p.onsuccess=()=>{if(p.result==null)return a.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));o(p.result.modelArtifacts)},p.onerror=f=>(a.close(),s(p.error)),c.oncomplete=()=>a.close()}else{let c=Zu(r),l=a.transaction(gf,"readwrite"),p=l.objectStore(gf),f=p.put({modelPath:this.modelPath,modelArtifactsInfo:c}),y;f.onsuccess=()=>{y=a.transaction(qm,"readwrite");let h=y.objectStore(qm).put({modelPath:this.modelPath,modelArtifacts:r,modelArtifactsInfo:c});h.onsuccess=()=>o({modelArtifactsInfo:c}),h.onerror=m=>{p=l.objectStore(gf);let x=p.delete(this.modelPath);x.onsuccess=()=>(a.close(),s(h.error)),x.onerror=w=>(a.close(),s(h.error))}},f.onerror=d=>(a.close(),s(f.error)),l.oncomplete=()=>{y==null?a.close():y.oncomplete=()=>a.close()}}},i.onerror=a=>s(i.error)})}}return n.URL_SCHEME="indexeddb://",n})(),VW=n=>Te().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Um.URL_SCHEME)?NIe(n.slice(Um.URL_SCHEME.length)):null;To.registerSaveRouter(VW);To.registerLoadRouter(VW);SI=class{constructor(){this.indexedDB=BW()}listModels(){return Y(this,null,function*(){return new Promise((t,e)=>{let r=this.indexedDB.open(RR,PR);r.onupgradeneeded=()=>FR(r),r.onsuccess=()=>{let o=r.result,s=o.transaction(gf,"readonly"),a=s.objectStore(gf).getAll();a.onsuccess=()=>{let c={};for(let l of a.result)c[l.modelPath]=l.modelArtifactsInfo;t(c)},a.onerror=c=>(o.close(),e(a.error)),s.oncomplete=()=>o.close()},r.onerror=o=>e(r.error)})})}removeModel(t){return Y(this,null,function*(){return t=DIe(t),new Promise((e,r)=>{let o=this.indexedDB.open(RR,PR);o.onupgradeneeded=()=>FR(o),o.onsuccess=()=>{let s=o.result,i=s.transaction(gf,"readwrite"),a=i.objectStore(gf),c=a.get(t),l;c.onsuccess=()=>{if(c.result==null)return s.close(),r(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{let p=a.delete(t),f=()=>{l=s.transaction(qm,"readwrite");let d=l.objectStore(qm).delete(t);d.onsuccess=()=>e(c.result.modelArtifactsInfo),d.onerror=h=>r(c.error)};p.onsuccess=f,p.onerror=y=>(f(),s.close(),r(c.error))}},c.onerror=p=>(s.close(),r(c.error)),i.oncomplete=()=>{l==null?s.close():l.oncomplete=()=>s.close()}},o.onerror=s=>r(o.error)})})}}});function UW(n){return{info:[kx,n,qW].join(Zp),topology:[kx,n,kIe].join(Zp),weightSpecs:[kx,n,AIe].join(Zp),weightData:[kx,n,OIe].join(Zp),modelMetadata:[kx,n,MIe].join(Zp)}}function RIe(n){let t=n.split(Zp);if(t.length<3)throw new Error(`Invalid key format: ${n}`);return t.slice(1,t.length-1).join(Zp)}function PIe(n){return n.startsWith(jm.URL_SCHEME)?n.slice(jm.URL_SCHEME.length):n}function FIe(n){return new jm(n)}var Zp,kx,qW,kIe,AIe,OIe,MIe,jm,jW,CI,LR=b(()=>{"use strict";Nx();gs();ze();Bm();Vm();Zp="/",kx="tensorflowjs_models",qW="info",kIe="model_topology",AIe="weight_specs",OIe="weight_data",MIe="model_metadata";jm=(()=>{class n{constructor(e){if(!Te().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=UW(this.modelPath)}save(e){return Y(this,null,function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let r=JSON.stringify(e.modelTopology),o=JSON.stringify(e.weightSpecs),s=Zu(e);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,r),this.LS.setItem(this.keys.weightSpecs,o),this.LS.setItem(this.keys.weightData,RW(e.weightData));let i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};return e.signature!=null&&(i.signature=e.signature),e.userDefinedMetadata!=null&&(i.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(i.modelInitializer=e.modelInitializer),this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:s}}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}})}load(){return Y(this,null,function*(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let r={},o=JSON.parse(this.LS.getItem(this.keys.topology));if(o==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);r.modelTopology=o;let s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);r.weightSpecs=s;let i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){let c=JSON.parse(i);r.format=c.format,r.generatedBy=c.generatedBy,r.convertedBy=c.convertedBy,c.signature!=null&&(r.signature=c.signature),c.userDefinedMetadata!=null&&(r.userDefinedMetadata=c.userDefinedMetadata),c.modelInitializer!=null&&(r.modelInitializer=c.modelInitializer)}let a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return r.weightData=PW(a),r})}}return n.URL_SCHEME="localstorage://",n})(),jW=n=>Te().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(jm.URL_SCHEME)?FIe(n.slice(jm.URL_SCHEME.length)):null;To.registerSaveRouter(jW);To.registerLoadRouter(jW);CI=class{constructor(){q(Te().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),q(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}listModels(){return Y(this,null,function*(){let t={},e=kx+Zp,r=Zp+qW;for(let o=0;o<this.LS.length;++o){let s=this.LS.key(o);if(s.startsWith(e)&&s.endsWith(r)){let i=RIe(s);t[i]=JSON.parse(this.LS.getItem(s))}}return t})}removeModel(t){return Y(this,null,function*(){t=PIe(t);let e=UW(t);if(this.LS.getItem(e.info)==null)throw new Error(`Cannot find model at path '${t}'`);let r=JSON.parse(this.LS.getItem(e.info));return this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),r})}}});function _I(n){if(n.indexOf(Ax)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${hc.getSchemes().join(",")}`);return{scheme:n.split(Ax)[0],path:n.split(Ax)[1]}}function GW(n,t,e=!1){return Y(this,null,function*(){q(n!==t,()=>`Old path and new path are the same: '${n}'`);let r=To.getLoadHandlers(n);q(r.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),q(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${n}.`);let o=r[0],s=To.getSaveHandlers(t);q(s.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),q(s.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`);let i=s[0],a=_I(n).scheme,c=_I(n).path,l=a===_I(n).scheme,p=yield o.load();e&&l&&(yield hc.getManager(a).removeModel(c));let f=yield i.save(p);return e&&!l&&(yield hc.getManager(a).removeModel(c)),f.modelArtifactsInfo})}function WW(){return Y(this,null,function*(){let n=hc.getSchemes(),t={};for(let e of n){let r=yield hc.getManager(e).listModels();for(let o in r){let s=e+Ax+o;t[s]=r[o]}}return t})}function HW(n){return Y(this,null,function*(){let t=_I(n);return hc.getManager(t.scheme).removeModel(t.path)})}function KW(n,t){return Y(this,null,function*(){return GW(n,t,!1)})}function XW(n,t){return Y(this,null,function*(){return GW(n,t,!0)})}var Ax,hc,zR=b(()=>{"use strict";ze();Vm();Ax="://",hc=class n{constructor(){this.managers={}}static getInstance(){return n.instance==null&&(n.instance=new n),n.instance}static registerManager(t,e){q(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(Ax)&&(t=t.slice(0,t.indexOf(Ax))),q(t.length>0,()=>"scheme must not be an empty string.");let r=n.getInstance();q(r.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),r.managers[t]=e}static getManager(t){let e=this.getInstance().managers[t];if(e==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return e}static getSchemes(){return Object.keys(this.getInstance().managers)}}});var BR,QW=b(()=>{"use strict";Nx();gs();$R();LR();zR();BR=class{fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${e}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}};if(Te().get("IS_BROWSER")){Te().setPlatform("browser",new BR);try{hc.registerManager(jm.URL_SCHEME,new CI)}catch{}try{hc.registerManager(Um.URL_SCHEME,new SI)}catch{}}});var ZW=Pn((Ox,YW)=>{"use strict";var $Ie=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Gm=$Ie();YW.exports=Ox=Gm.fetch;Gm.fetch&&(Ox.default=Gm.fetch.bind(Gm));Ox.Headers=Gm.Headers;Ox.Request=Gm.Request;Ox.Response=Gm.Response});var JW=Pn(()=>{"use strict"});var LIe,VR,qR,eH=b(()=>{"use strict";gs();LIe={importFetch:()=>ZW()},qR=class{constructor(){this.util=JW(),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return Te().global.fetch!=null?Te().global.fetch(t,e):(VR==null&&(VR=LIe.importFetch()),VR(t,e))}now(){let t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${e}`);return this.textEncoder.encode(t)}decode(t,e){return t.length===0?"":new this.util.TextDecoder(e).decode(t)}};Te().get("IS_NODE")&&Te().setPlatform("node",new qR)});function It(n,t="float32",e){return t=t||"float32",Jw(n),new Dn(n,t,e)}var Jp=b(()=>{"use strict";Ae();ze();});function zIe(n,t){let e=A(n,"x","cast");if(!pR(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&e.dtype!=="string"||t!=="string"&&e.dtype==="string")throw new Error("Only strings can be casted to strings");let r={x:e},o={dtype:t};return U.runKernel(lc,r,o)}var Ye,fn=b(()=>{"use strict";Ee();ae();Se();ze();ye();Ye=z({cast_:zIe})});function BIe(n){let e={x:A(n,"x","clone","string_or_numeric")};return U.runKernel(wp,e)}var bi,Mx=b(()=>{"use strict";Ee();ae();Se();ye();bi=z({clone_:BIe})});function TI(n,t=!1){console.log(n.toString(t))}var UR=b(()=>{"use strict";});var VIe,tH=b(()=>{"use strict";Ee();Nx();QW();eH();Jp();fn();Mx();UR();Ae();ER();VIe={buffer:It,cast:Ye,clone:bi,print:TI};CW(VIe)});function nH(n){return new Promise(t=>setTimeout(t)).then(n)}function WIe(n="model"){return new jR(n)}function rH(n){return new GR(n)}var qIe,UIe,jIe,jR,GR,GIe,oH=b(()=>{"use strict";Nx();gs();Bm();Vm();qIe="model",UIe=".json",jIe=".weights.bin";jR=(()=>{class n{constructor(e){if(!Te().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(n.URL_SCHEME)&&(e=e.slice(n.URL_SCHEME.length)),(e==null||e.length===0)&&(e=qIe),this.modelTopologyFileName=e+UIe,this.weightDataFileName=e+jIe}save(e){return Y(this,null,function*(){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");let r=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let o=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],s={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:o};e.signature!=null&&(s.signature=e.signature),e.userDefinedMetadata!=null&&(s.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(s.modelInitializer=e.modelInitializer);let i=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),a=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor;if(a.download=this.modelTopologyFileName,a.href=i,yield nH(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){let c=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;c.download=this.weightDataFileName,c.href=r,yield nH(()=>c.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Zu(e)}}})}}return n.URL_SCHEME="downloads://",n})(),GR=class{constructor(t){if(t==null||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.files=t}load(){return Y(this,null,function*(){let t=this.files[0],e=this.files.slice(1);return new Promise((r,o)=>{let s=new FileReader;s.onload=i=>{let a=JSON.parse(i.target.result),c=a.modelTopology;if(c==null){o(new Error(`modelTopology field is missing from file ${t.name}`));return}e.length===0&&r({modelTopology:c});let l=a.weightsManifest;if(l==null){o(new Error(`weightManifest field is missing from file ${t.name}`));return}let p;try{p=this.checkManifestAndWeightFiles(l,e)}catch(h){o(h);return}let f=[],y=[],d=[];l.forEach(h=>{h.paths.forEach(m=>{y.push(m),d.push(null)}),f.push(...h.weights)}),l.forEach(h=>{h.paths.forEach(m=>{let x=new FileReader;x.onload=w=>{let _=w.target.result,I=y.indexOf(m);if(d[I]=_,d.indexOf(null)===-1){let T={modelTopology:c,weightSpecs:f,weightData:Dx(d),format:a.format,generatedBy:a.generatedBy,convertedBy:a.convertedBy};a.signature!=null&&(T.signature=a.signature),a.userDefinedMetadata!=null&&(T.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(T.modelInitializer=a.modelInitializer),r(T)}},x.onerror=w=>o(`Failed to weights data from file of path '${m}'.`),x.readAsArrayBuffer(p[m])})})},s.onerror=i=>o(`Failed to read model topology and weights manifest JSON from file '${t.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(t)})})}checkManifestAndWeightFiles(t,e){let r=[],o=e.map(i=>MR(i.name)),s={};for(let i of t)i.paths.forEach(a=>{let c=MR(a);if(r.indexOf(c)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${c}'`);if(r.push(c),o.indexOf(c)===-1)throw new Error(`Weight file with basename '${c}' is not provided.`);s[a]=e[o.indexOf(c)]});if(r.length!==e.length)throw new Error(`Mismatch in the number of files in weights manifest (${r.length}) and the number of weight files provided (${e.length}).`);return s}},GIe=n=>Te().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(jR.URL_SCHEME)?WIe(n.slice(jR.URL_SCHEME.length)):null;To.registerSaveRouter(GIe)});function WR(n,t,e,r){i(n),e=e??0,r=r??1,a(e,r);let o=0,s=c=>(c.then(l=>{let p=e+ ++o/n.length*(r-e);return t(p),l}),c);function i(c){q(c!=null&&Array.isArray(c)&&c.length>0,()=>"promises must be a none empty array")}function a(c,l){q(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${c}`),q(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${l}`),q(l>=c,()=>`startFraction must be no more than endFraction, but got startFraction ${c} and endFraction ${l}`)}return Promise.all(n.map(s))}var sH=b(()=>{"use strict";ze();});function HR(n,t){return Y(this,null,function*(){t==null&&(t={});let e=t.fetchFunc==null?Te().platform.fetch:t.fetchFunc,r=n.map(f=>e(f,t.requestInit,{isBinary:!0})),a=(t.onProgress==null?yield Promise.all(r):yield WR(r,t.onProgress,0,.5)).map(f=>f.arrayBuffer());return t.onProgress==null?yield Promise.all(a):yield WR(a,t.onProgress,.5,1)})}function iH(n,t="",e,r){return Y(this,null,function*(){return KR(i=>HR(i,{requestInit:r}))(n,t,e)})}function KR(n){return(t,e="",r)=>Y(null,null,function*(){let o=t.map(()=>!1),s={},i=r!=null?r.map(()=>!1):[],a=[];if(t.forEach((d,h)=>{let m=0;d.weights.forEach(x=>{let w="quantization"in x?x.quantization.dtype:x.dtype,_=u0[w]*Vn(x.shape),I=()=>{o[h]=!0,s[h]==null&&(s[h]=[]),s[h].push({manifestEntry:x,groupOffset:m,sizeBytes:_})};r!=null?r.forEach((T,D)=>{T===x.name&&(I(),i[D]=!0)}):I(),a.push(x.name),m+=_})}),!i.every(d=>d)){let d=r.filter((h,m)=>!i[m]);throw new Error(`Could not find weights in manifest with names: ${d.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}let c=o.reduce((d,h,m)=>(h&&d.push(m),d),[]),l=[];c.forEach(d=>{t[d].paths.forEach(h=>{let m=e+(e.endsWith("/")?"":"/")+h;l.push(m)})});let p=yield n(l),f={},y=0;return c.forEach(d=>{let h=t[d].paths.length,m=0;for(let T=0;T<h;T++)m+=p[y+T].byteLength;let x=new ArrayBuffer(m),w=new Uint8Array(x),_=0;for(let T=0;T<h;T++){let D=new Uint8Array(p[y+T]);w.set(D,_),_+=D.byteLength}s[d].forEach(T=>{let D=x.slice(T.groupOffset,T.groupOffset+T.sizeBytes),O=wI(D,[T.manifestEntry]);for(let R in O)f[R]=O[R]}),y+=h}),f})}var XR=b(()=>{"use strict";gs();ze();Bm();sH();AR();});function XIe(n){let t=n.lastIndexOf("/"),e=n.lastIndexOf("?"),r=n.substring(0,t),o=e>t?n.substring(e):"";return[r+"/",o]}function II(n){return n.match(aH.URL_SCHEME_REGEX)!=null}function EI(n,t){return new aH(n,t)}function uH(n,t){return EI(n,t)}var HIe,KIe,aH,cH,lH=b(()=>{"use strict";gs();ze();Bm();Vm();XR();HIe="application/octet-stream",KIe="application/json",aH=(()=>{class n{constructor(e,r){if(this.DEFAULT_METHOD="POST",r==null&&(r={}),this.weightPathPrefix=r.weightPathPrefix,this.onProgress=r.onProgress,this.weightUrlConverter=r.weightUrlConverter,r.fetchFunc!=null?(q(typeof r.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=r.fetchFunc):this.fetch=Te().platform.fetch,q(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&q(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,r.requestInit!=null&&r.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=r.requestInit||{}}save(e){return Y(this,null,function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let r=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);r.body=new FormData;let o=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:o};e.signature!=null&&(s.signature=e.signature),e.userDefinedMetadata!=null&&(s.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(s.modelInitializer=e.modelInitializer),r.body.append("model.json",new Blob([JSON.stringify(s)],{type:KIe}),"model.json"),e.weightData!=null&&r.body.append("model.weights.bin",new Blob([e.weightData],{type:HIe}),"model.weights.bin");let i=yield this.fetch(this.path,r);if(i.ok)return{modelArtifactsInfo:Zu(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)})}load(){return Y(this,null,function*(){let e=yield this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let r;try{r=yield e.json()}catch{let x=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?x+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":x+=" Please make sure the server is serving valid JSON for this request.",new Error(x)}let o=r.modelTopology,s=r.weightsManifest,i=r.generatedBy,a=r.convertedBy,c=r.format,l=r.signature,p=r.userDefinedMetadata;if(o==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);let f,y;s!=null&&([f,y]=yield this.loadWeights(s));let d={modelTopology:o,weightSpecs:f,weightData:y,generatedBy:i,convertedBy:a,format:c};l!=null&&(d.signature=l),p!=null&&(d.userDefinedMetadata=p);let h=r.modelInitializer;return h&&(d.modelInitializer=h),d})}loadWeights(e){return Y(this,null,function*(){let r=Array.isArray(this.path)?this.path[1]:this.path,[o,s]=XIe(r),i=this.weightPathPrefix||o,a=[];for(let f of e)a.push(...f.weights);let c=[],l=[];for(let f of e)for(let y of f.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(y)):c.push(i+y+s);this.weightUrlConverter&&c.push(...yield Promise.all(l));let p=yield HR(c,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[a,Dx(p)]})}}return n.URL_SCHEME_REGEX=/^https?:\/\//,n})();cH=(n,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let e=!0;if(Array.isArray(n)?e=n.every(r=>II(r)):e=II(n),e)return EI(n,t)}return null};To.registerSaveRouter(cH);To.registerLoadRouter(cH)});function pH(n,t,e,r){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new l0(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new l0({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new l0({modelTopology:n,weightSpecs:t,weightData:e,trainingConfig:r}))}function hH(n){return new QR(n)}var l0,QR,fH=b(()=>{"use strict";l0=class{constructor(t){this.modelArtifacts=t}load(){return Y(this,null,function*(){return this.modelArtifacts})}},QR=class{constructor(t){this.saveHandler=t}save(t){return Y(this,null,function*(){return this.saveHandler(t)})}}});var Po={};xn(Po,{browserFiles:()=>rH,browserHTTPRequest:()=>uH,concatenateArrayBuffers:()=>Dx,copyModel:()=>KW,decodeWeights:()=>wI,encodeWeights:()=>MW,fromMemory:()=>pH,getLoadHandlers:()=>zW,getModelArtifactsInfoForJSON:()=>Zu,getSaveHandlers:()=>LW,http:()=>EI,isHTTPScheme:()=>II,listModels:()=>WW,loadWeights:()=>iH,moveModel:()=>XW,registerLoadRouter:()=>$W,registerSaveRouter:()=>FW,removeModel:()=>HW,weightsLoaderFactory:()=>KR,withSaveHandler:()=>hH});var dH=b(()=>{"use strict";$R();LR();oH();lH();Bm();fH();Vm();XR();zR();});function QIe(n,t,e=!1,r=!1){let o=A(n,"a","matMul"),s=A(t,"b","matMul");[o,s]=sn(o,s);let i={a:o,b:s},a={transposeA:e,transposeB:r};return U.runKernel(cp,i,a)}var an,Ju=b(()=>{"use strict";Ee();ae();br();Se();ye();an=z({matMul_:QIe})});function YIe(n,t,e=1,r=0){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);let s={indices:A(n,"indices","oneHot","int32")},i={depth:t,onValue:e,offValue:r};return U.runKernel(Op,s,i)}var ga,NI=b(()=>{"use strict";Ee();ae();Se();ye();ga=z({oneHot_:YIe})});function ZIe(n,t){let e=A(n,"x","transpose");if(t==null&&(t=e.shape.map((s,i)=>i).reverse()),q(e.rank===t.length,()=>`Error in transpose: rank of input ${e.rank} must match length of perm ${t}.`),t.forEach(s=>{q(s>=0&&s<e.rank,()=>`All entries in 'perm' must be between 0 and ${e.rank-1} but got ${t}`)}),e.rank<=1)return e.clone();let r={x:e},o={perm:t};return U.runKernel(Wp,r,o)}var pn,yf=b(()=>{"use strict";Ee();ae();Se();ze();ye();pn=z({transpose_:ZIe})});function JIe(n,t,e){let r=A(n,"labels","confusionMatrix"),o=A(t,"predictions","confusionMatrix");q(e==null||e>0&&Number.isInteger(e),()=>`If provided, numClasses must be a positive integer, but got ${e}`),q(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),q(o.rank===1,()=>`Expected the rank of predictions to be 1, but got ${o.rank}`),q(r.shape[0]===o.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${o.shape[0]}. Labels and predictions should have the same number of elements.`),q(e>0&&Number.isInteger(e),()=>`numClasses is required to be a positive integer, but got ${e}`);let s=ga(Ye(r,"int32"),e),i=ga(Ye(o,"int32"),e),a=pn(s),c=an(a,i);return Ye(c,"int32")}var mH,gH=b(()=>{"use strict";Se();ze();fn();Ju();NI();ye();yf();mH=z({confusionMatrix_:JIe})});var YR={};xn(YR,{confusionMatrix:()=>mH});var yH=b(()=>{"use strict";gH();});function DI(n,t,e){if(zi(n),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");let r=Xo(n,e);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Os(n,t,r,e)}var ZR=b(()=>{"use strict";Se();ze();Yp();});var p0={};xn(p0,{fromPixels:()=>n1e,toPixels:()=>t1e});function e1e(n,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let e=!1,r=!1,o=!1,s=!1,i=!1,a=!1;if(n.data instanceof Uint8Array)e=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)s=!0;else if(n.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&n instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);if(o&&o&&n.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(n0(Sx,U.backendName)!=null){let h={pixels:n},m={numChannels:t};return U.runKernel(Sx,h,m)}let[l,p]=o?[n.videoWidth,n.videoHeight]:[n.width,n.height],f;i?f=n.getContext("2d").getImageData(0,0,l,p).data:r||e?f=n.data:(s||o||a)&&(Rx==null&&(Rx=document.createElement("canvas").getContext("2d")),Rx.canvas.width=l,Rx.canvas.height=p,Rx.drawImage(n,0,0,l,p),f=Rx.getImageData(0,0,l,p).data);let y;if(t===4)y=new Int32Array(f);else{let h=l*p;y=new Int32Array(h*t);for(let m=0;m<h;m++)for(let x=0;x<t;++x)y[m*t+x]=f[m*4+x]}return DI(y,[p,l,t],"int32")}function t1e(n,t){return Y(this,null,function*(){let e=A(n,"img","toPixels");if(!(n instanceof K)){let l=e;e=Ye(l,"int32"),l.dispose()}if(e.rank!==2&&e.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);let[r,o]=e.shape.slice(0,2),s=e.rank===2?1:e.shape[2];if(s>4||s===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${s}`);if(e.dtype!=="float32"&&e.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`);let i=yield e.data(),a=e.dtype==="float32"?255:1,c=new Uint8ClampedArray(o*r*4);for(let l=0;l<r*o;++l){let p=[0,0,0,255];for(let y=0;y<s;y++){let d=i[l*s+y];if(e.dtype==="float32"){if(d<0||d>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${d}.`)}else if(e.dtype==="int32"&&(d<0||d>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${d}.`);s===1?(p[0]=d*a,p[1]=d*a,p[2]=d*a):p[y]=d*a}let f=l*4;c[f+0]=Math.round(p[0]),c[f+1]=Math.round(p[1]),c[f+2]=Math.round(p[2]),c[f+3]=Math.round(p[3])}if(t!=null){t.width=o,t.height=r;let l=t.getContext("2d"),p=new ImageData(c,o,r);l.putImageData(p,0,0)}return e!==n&&e.dispose(),c})}var Rx,n1e,xH=b(()=>{"use strict";Ee();ae();o0();Ae();Se();fn();ye();ZR();n1e=z({fromPixels_:e1e})});var JR={};xn(JR,{prepareAndValidate:()=>vH});function vH(n,t){let e=n.shape.length,r=t.shape.length;if(e<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${e}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>e)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${e}`);if(Vn(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);let o=t.shape,s=o[o.length-1],i=1;for(let f=0;f<o.length-1;++f)i*=o[f];let a=n.shape,c=o.slice();c.pop();let l=1;for(let f=s;f<e;++f)l*=a[f],c.push(a[f]);let p=[...nu(n.shape).map(f=>f/l),1].slice(0,s);return[c,i,l,p]}var e2=b(()=>{"use strict";ze()});var AI={};xn(AI,{calculateShapes:()=>bH,validateInput:()=>kI,validateUpdateShape:()=>t2});function t2(n,t,e){let r=t.rank>1?t.shape[t.rank-1]:1,o=t.rank>1?t.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${e.shape}, indices.shape: ${t.shape}, shape: ${n}, sliceDim: ${r}, and batchDim: ${o}.`;if(e.rank<o)throw new Error(s+` update.rank < ${o}. `);if(n.length<r+(e.rank-o))throw new Error(s+` Output shape length < ${r+(e.rank-o)}`);if(e.rank!==o+n.length-r)throw new Error(s+` update.rank != ${o+n.length-r}`);for(let i=0;i<o;++i)if(e.shape[i]!==t.shape[i])throw new Error(s+` updates.shape[${i}] (${e.shape[i]}) != indices.shape[${i}] (${t.shape[i]}).`);for(let i=0;i<e.rank-o;++i)if(e.shape[i+o]!==n[i+r])throw new Error(s+` updates.shape[${i+o}] (${e.shape[i+o]}) != shape[${i+o}] (${n[i+o]})`)}function kI(n,t,e){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(e.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${e}`);if(e.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}t2(e,t,n)}function bH(n,t,e){let r=t.shape.length,o=r>1?t.shape[r-1]:1,s=e.length,i=1;for(let f=o;f<s;++f)i*=e[f];let a=o<1?1:o,c=Vn(t.shape)/a,l=[...nu(e.slice(0,o)),1],p=Vn(e);return{sliceRank:o,numUpdates:c,sliceSize:i,strides:l,outputSize:p}}var OI=b(()=>{"use strict";ze()});var Fo={};xn(Fo,{assertParamsValid:()=>r1e,computeFlatOffset:()=>s1e,computeOutShape:()=>wH,getNormalizedAxes:()=>TH,isSliceContinous:()=>o1e,maskToAxes:()=>MI,parseSliceParams:()=>n2,sliceInfo:()=>i1e,startForAxis:()=>DH,startIndicesWithElidedDims:()=>IH,stopForAxis:()=>kH,stopIndicesWithElidedDims:()=>EH,stridesForAxis:()=>NH,stridesWithElidedDims:()=>SH});function r1e(n,t,e){let r=n.shape.length;q(r===t.length,()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`),q(r===e.length,()=>`Error in slice${r}D: Length of size ${e} must match the rank of the array (${r}).`);for(let o=0;o<r;++o)q(t[o]+e[o]<=n.shape[o],()=>`Error in slice${r}D: begin[${o}] + size[${o}] (${t[o]+e[o]}) would overflow input.shape[${o}] (${n.shape[o]})`)}function MI(n){let t=[],e=0;for(;n>0;)n&1&&t.push(e),n/=2,e++;return t}function wH(n,t,e){let r=[];for(let o=0;o<n.length;o++)r[o]=Math.ceil((t[o]-n[o])/e[o]);return r}function SH(n,t,e,r){let o=[...n];for(let s=o.length;s<r.length;s++)o.push(1);for(let s=0;s<e;s++)s===0?o[t]=1:(o.splice(t,0,1),o.pop());return o}function CH(n,t,e){return e<=n?e:e-(t-1)}function _H(n,t){let e=[];for(let r=0;r<n;r++)e.push(t+r);return e}function TH(n,t,e,r,o,s,i,a,c){let l=n.length,p=new Array(l),f=new Array(l),y=new Array(l);if(t.length&&e>0){let d=t[0],h=e+1;p=IH(i,d,h,r,n),f=EH(a,d,h,o,n),y=SH(s,d,h,n)}else for(let d=0;d<l;d++)p[d]=DH(i,r,s,n,d,c),f[d]=kH(a,o,s,n,d,c),y[d]=NH(s,d,c);return{begin:p,end:f,strides:y}}function IH(n,t,e,r,o){let s=[...o],i=_H(e,t);for(let a=0;a<s.length;a++)if(i.indexOf(a)>-1)s[a]=0;else{let c=CH(t,e,a),l=r[c];n&1<<c&&(l=0),s[a]=l}return s}function EH(n,t,e,r,o){let s=[...o],i=_H(e,t);for(let a=0;a<s.length;a++)if(i.indexOf(a)>-1)s[a]=Number.MAX_SAFE_INTEGER;else{let c=CH(t,e,a),l=r[c];n&1<<c&&(l=Number.MAX_SAFE_INTEGER),s[a]=l}for(let a=0;a<s.length;a++){let c=o[a];s[a]<0&&(s[a]+=c),s[a]=mx(0,s[a],o[a])}return s}function NH(n,t,e){let r=n[t];return(e&1<<t||r==null)&&(r=1),r}function DH(n,t,e,r,o,s){let i=t[o],a=e[o]||1;(n&1<<o||s&1<<o||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);let c=r[o];return i<0&&(i+=c),i=mx(0,i,c-1),i}function kH(n,t,e,r,o,s){let i=t[o],a=e[o]||1;(n&1<<o||s&1<<o||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);let c=r[o];return i<0&&(i+=c),a>0?i=mx(0,i,c):i=mx(-1,i,c-1),i}function o1e(n,t,e){let r=e.length;for(let o=0;o<e.length;o++)if(e[o]>1){r=o;break}for(let o=r+1;o<e.length;o++)if(t[o]>0||e[o]!==n[o])return!1;return!0}function s1e(n,t){let e=n.length>0?n[n.length-1]:1;for(let r=0;r<n.length-1;r++)e+=n[r]*t[r];return e}function n2(n,t,e){let r,o=n.shape.length;typeof t=="number"?r=[t,...new Array(o-1).fill(0)]:t.length<o?r=t.concat(new Array(o-t.length).fill(0)):r=t.slice(),r.forEach(i=>{q(i!==-1,()=>"slice() does not support negative begin indexing.")});let s;return e==null?s=new Array(o).fill(-1):typeof e=="number"?s=[e,...new Array(o-1).fill(-1)]:e.length<o?s=e.concat(new Array(o-e.length).fill(-1)):s=e,s=s.map((i,a)=>i>=0?i:(q(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),n.shape[a]-r[a])),[r,s]}function i1e(n,t,e,r,o,s,i,a,c){let l=t.slice(),p=e.slice(),f=r;r==null&&(f=new Array(l.length));let y=MI(i);if(y.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(i!==0&&a!==0)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(i!==0&&c!==0)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");let d=n.length-l.length,h=MI(a),m=n.slice();h.forEach(R=>{l[R]=0,p[R]=1,m.splice(R,0,1)});let{begin:x,end:w,strides:_}=TH(m,y,d,l,p,f,o,s,i);l=x,p=w,f=_;let I=MI(c);I.forEach(R=>{p[R]=l[R]+1,f[R]=1});let T=wH(l,p,f),D=T.filter((R,P)=>I.indexOf(P)===-1);return{nonStrided:f.every(R=>R===1),$begin:l,$end:p,$strides:f,size:T,newShape:m,outShape:D}}var RI=b(()=>{"use strict";ze();});var He={};xn(He,{Serializable:()=>h0,SerializationMap:()=>PI,registerClass:()=>Qs});function Qs(n){q(n.className!=null,()=>"Class being registered does not have the static className property defined."),q(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),q(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),PI.register(n)}var h0,PI,el=b(()=>{"use strict";ze();h0=class{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}},PI=class n{constructor(){this.classNameMap={}}static getMap(){return n.instance==null&&(n.instance=new n),n.instance}static register(t){n.getMap().classNameMap[t.className]=[t,t.fromConfig]}}});var i2={};xn(i2,{TEST_EPSILON_FLOAT16:()=>AH,encodeStrings:()=>OH,expectArrayBuffersEqual:()=>f1e,expectArraysClose:()=>c1e,expectArraysEqual:()=>l1e,expectNumbersClose:()=>p1e,expectPromiseToFail:()=>u1e,expectValuesInRange:()=>h1e,testEpsilon:()=>o2});function c1e(n,t,e){return e==null&&(e=o2()),r2(n,t,(r,o)=>s2(r,o,e))}function o2(){return U.backend.floatPrecision()===32?a1e:AH}function r2(n,t,e){let r=!0;if((xo(n)||xo(t))&&(r=!1),xo(n)&&xo(t)&&(r=!0),r){let i=n.constructor.name,a=t.constructor.name;if(i!==a)throw new Error(`Arrays are of different type. Actual: ${i}. Expected: ${a}`)}if(Array.isArray(n)&&Array.isArray(t)){let i=Xo(n),a=Xo(t);if(!As(i,a))throw new Error(`Arrays have different shapes. Actual: [${i}]. Expected: [${a}]`)}let o=xo(n)?n:cc(n),s=xo(t)?t:cc(t);if(o.length!==s.length)throw new Error(`Arrays have different lengths actual: ${o.length} vs expected: ${s.length}.
Actual:   ${o}.
Expected: ${s}.`);for(let i=0;i<s.length;++i){let a=o[i],c=s[i];if(!e(a,c))throw new Error(`Arrays differ: actual[${i}] = ${a}, expected[${i}] = ${c}.
Actual:   ${o}.
Expected: ${s}.`)}}function u1e(n,t){n().then(()=>t.fail(),()=>t())}function l1e(n,t){let e=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return uc(n)||uc(n[0])||uc(t)||uc(t[0])?r2(n,e,(r,o)=>r==o):r2(n,t,(r,o)=>s2(r,o,0))}function p1e(n,t,e){if(e==null&&(e=o2()),!s2(n,t,e))throw new Error(`Numbers differ: actual === ${n}, expected === ${t}`)}function s2(n,t,e){return!isFinite(n)&&!isFinite(t)?!0:!(isNaN(n)||isNaN(t)||Math.abs(n-t)>e)}function h1e(n,t,e){for(let r=0;r<n.length;r++)if(n[r]<t||n[r]>e)throw new Error(`Value out of range:${n[r]} low: ${t}, high: ${e}`)}function f1e(n,t){expect(new Float32Array(n)).toEqual(new Float32Array(t))}function OH(n){for(let t=0;t<n.length;t++){let e=n[t];Array.isArray(e)?OH(e):n[t]=ff(e)}return n}var a1e,AH,MH=b(()=>{"use strict";Ee();Se();ze();a1e=.001,AH=.1});var FI,RH=b(()=>{"use strict";FI="2.8.6"});function d1e(){Te().set("PROD",!0)}function m1e(){Te().set("DEBUG",!0)}function g1e(){Te().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Pr(n){Te().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function y1e(){U.disposeVariables()}function eh(){return U}function Px(){return U.memory()}function x1e(n){return U.profile(n)}function de(n,t){return U.tidy(n,t)}function Mt(n){c0(n).forEach(e=>e.dispose())}function ur(n){return U.keep(n)}function v1e(n){return U.time(n)}function PH(n){return U.setBackend(n)}function b1e(){return U.ready()}function w1e(){return U.backendName}function S1e(n){U.removeBackend(n)}function C1e(n){return U.findBackend(n)}function _1e(n){return U.findBackendFactory(n)}function f0(n,t,e=1){return U.registerBackend(n,t,e)}function a2(){return U.backend}function T1e(n,t){Te().setPlatform(n,t)}var Ms=b(()=>{"use strict";Ee();gs();Ae();br();_W(Pr)});function I1e(n,t){let e=A(n,"a","add"),r=A(t,"b","add");[e,r]=sn(e,r);let o={a:e,b:r};return U.runKernel(ma,o)}var je,mr=b(()=>{"use strict";Ee();ae();br();Se();ye();je=z({add_:I1e})});function E1e(n,t){let e=A(n,"a","floorDiv"),r=A(t,"b","floorDiv");[e,r]=sn(e,r);let o={a:e,b:r};return U.runKernel(bu,o)}var xf,$I=b(()=>{"use strict";Ee();ae();br();Se();ye();xf=z({floorDiv_:E1e})});function N1e(n,t){let e=A(n,"a","div"),r=A(t,"b","div");if([e,r]=sn(e,r),e.dtype==="int32"&&r.dtype==="int32")return xf(e,r);let o={a:e,b:r},s={};return U.runKernel(du,o,s)}var ct,qn=b(()=>{"use strict";Ee();ae();br();Se();$I();ye();ct=z({div_:N1e})});function D1e(n,t){let e=A(n,"a","mul"),r=A(t,"b","mul");[e,r]=sn(e,r);let o={a:e,b:r};return U.runKernel(ku,o)}var oe,Rt=b(()=>{"use strict";Ee();ae();br();Se();ye();oe=z({mul_:D1e})});function k1e(n){let t=A(n,"x","abs");if(t.dtype==="complex64"){let e={x:t};return U.runKernel(lp,e)}else{let e={x:t};return U.runKernel(np,e)}}var Jn,Wm=b(()=>{"use strict";Ee();ae();Se();ye();Jn=z({abs_:k1e})});function A1e(n){let e={x:A(n,"x","acos")};return U.runKernel(ru,e)}var Fx,FH=b(()=>{"use strict";Ee();ae();Se();ye();Fx=z({acos_:A1e})});function O1e(n){let e={x:A(n,"x","acosh")};return U.runKernel(ou,e)}var $x,$H=b(()=>{"use strict";Ee();ae();Se();ye();$x=z({acosh_:O1e})});function M1e(n){q(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),q(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);let t=n.map((o,s)=>A(o,`tensors${s}`,"addN")),e=t[0];t.forEach(o=>{if(o.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(o=>{if(!As(o.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});let r=t;return U.runKernel(rp,r)}var LI,LH=b(()=>{"use strict";Ee();ae();Se();ze();ye();LI=z({addN_:M1e})});function R1e(n,t=null,e=!1){let o={x:A(n,"x","all","bool")},s={axis:t,keepDims:e};return U.runKernel(Qd,o,s)}var vf,c2=b(()=>{"use strict";Ee();ae();Se();ye();vf=z({all_:R1e})});function P1e(n,t=null,e=!1){let o={x:A(n,"x","any","bool")},s={axis:t,keepDims:e};return U.runKernel(Yd,o,s)}var th,u2=b(()=>{"use strict";Ee();ae();Se();ye();th=z({any_:P1e})});function F1e(n,t=0){let r={x:A(n,"x","argMax")},o={axis:t};return U.runKernel(op,r,o)}var nh,l2=b(()=>{"use strict";Ee();ae();Se();ye();nh=z({argMax_:F1e})});function $1e(n,t=0){let r={x:A(n,"x","argMin")},o={axis:t};return U.runKernel(sp,r,o)}var Lx,p2=b(()=>{"use strict";Ee();ae();Se();ye();Lx=z({argMin_:$1e})});function L1e(n){let e={x:A(n,"x","asin")};return U.runKernel(su,e)}var zx,zH=b(()=>{"use strict";Ee();ae();Se();ye();zx=z({asin_:L1e})});function z1e(n){let e={x:A(n,"x","asinh")};return U.runKernel(iu,e)}var Bx,BH=b(()=>{"use strict";Ee();ae();Se();ye();Bx=z({asinh_:z1e})});function B1e(n){let e={x:A(n,"x","atan")};return U.runKernel(au,e)}var Vx,VH=b(()=>{"use strict";Ee();ae();Se();ye();Vx=z({atan_:B1e})});function V1e(n,t){let e=A(n,"a","atan2"),r=A(t,"b","atan2");[e,r]=sn(e,r);let o={a:e,b:r};return U.runKernel(uu,o)}var qx,h2=b(()=>{"use strict";Ee();ae();br();Se();ye();qx=z({atan2_:V1e})});function q1e(n){let e={x:A(n,"x","atanh")};return U.runKernel(cu,e)}var Ux,qH=b(()=>{"use strict";Ee();ae();Se();ye();Ux=z({atanh_:q1e})});function U1e(n,t,e,r,o="NHWC",s){let i=n[3],a=[...t,i],c=jH(o);return Km(n,a,e,s,r,null,null,c)}function d2(n,t,e,r,o,s,i="channelsLast"){let[a,c]=zI(t),l;if(i==="channelsLast")l=[a,c,n[3],n[3]];else if(i==="channelsFirst")l=[a,c,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return Km(n,l,e,r,o,s,!1,i)}function j1e(n,t,e,r,o,s,i="NDHWC"){let[a,c,l]=f2(t),p,f;if(i==="NDHWC")f="channelsLast",p=[a,c,l,n[4],n[4]];else if(i==="NCDHW")f="channelsFirst",p=[a,c,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return UH(n,p,e,r,o,!1,f,s)}function Km(n,t,e,r,o,s,i=!1,a="channelsLast"){let[c,l,p,f]=[-1,-1,-1,-1];if(a==="channelsLast")[c,l,p,f]=n;else if(a==="channelsFirst")[c,f,l,p]=n;else throw new Error(`Unknown dataFormat ${a}`);let[y,d,,h]=t,[m,x]=zI(e),[w,_]=zI(r),I=jx(y,w),T=jx(d,_),{padInfo:D,outHeight:O,outWidth:R}=H1e(o,l,p,m,x,I,T,s,a),P=i?h*f:h,j;return a==="channelsFirst"?j=[c,P,O,R]:a==="channelsLast"&&(j=[c,O,R,P]),{batchSize:c,dataFormat:a,inHeight:l,inWidth:p,inChannels:f,outHeight:O,outWidth:R,outChannels:P,padInfo:D,strideHeight:m,strideWidth:x,filterHeight:y,filterWidth:d,effectiveFilterHeight:I,effectiveFilterWidth:T,dilationHeight:w,dilationWidth:_,inShape:n,outShape:j,filterShape:t}}function UH(n,t,e,r,o,s=!1,i="channelsLast",a){let[c,l,p,f,y]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[c,l,p,f,y]=n;else if(i==="channelsFirst")[c,y,l,p,f]=n;else throw new Error(`Unknown dataFormat ${i}`);let[d,h,m,,x]=t,[w,_,I]=f2(e),[T,D,O]=f2(r),R=jx(d,T),P=jx(h,D),j=jx(m,O),{padInfo:G,outDepth:Q,outHeight:ie,outWidth:pe}=K1e(o,l,p,f,w,_,I,R,P,j,a),xe=s?x*y:x,ne;return i==="channelsFirst"?ne=[c,xe,Q,ie,pe]:i==="channelsLast"&&(ne=[c,Q,ie,pe,xe]),{batchSize:c,dataFormat:i,inDepth:l,inHeight:p,inWidth:f,inChannels:y,outDepth:Q,outHeight:ie,outWidth:pe,outChannels:xe,padInfo:G,strideDepth:w,strideHeight:_,strideWidth:I,filterDepth:d,filterHeight:h,filterWidth:m,effectiveFilterDepth:R,effectiveFilterHeight:P,effectiveFilterWidth:j,dilationDepth:T,dilationHeight:D,dilationWidth:O,inShape:n,outShape:ne,filterShape:t}}function G1e(n,t,e,r,o){r==null&&(r=m2(n,t,e));let s=n[0],i=n[1],a=Hm((s-t+2*r)/e+1,o),c=Hm((i-t+2*r)/e+1,o);return[a,c]}function W1e(n,t,e,r,o,s){o==null&&(o=m2(n,t,r));let i=n[0],a=n[1],c=n[2],l=Hm((i-t+2*o)/r+1,s),p=Hm((a-t+2*o)/r+1,s),f=Hm((c-t+2*o)/r+1,s);return[l,p,f,e]}function m2(n,t,e,r=1){let o=jx(t,r);return Math.floor((n[0]*(e-1)-e+o)/2)}function zI(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function f2(n){return typeof n=="number"?[n,n,n]:n}function jx(n,t){return t<=1?n:n+(n-1)*(t-1)}function H1e(n,t,e,r,o,s,i,a,c){let l,p,f;if(typeof n=="number"){l={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};let d=G1e([t,e],s,r,n,a);p=d[0],f=d[1]}else if(n==="same"){p=Math.ceil(t/r),f=Math.ceil(e/o);let y=Math.max(0,(p-1)*r+s-t),d=Math.max(0,(f-1)*o+i-e),h=Math.floor(y/2),m=y-h,x=Math.floor(d/2),w=d-x;l={top:h,bottom:m,left:x,right:w,type:"SAME"}}else if(n==="valid")l={top:0,bottom:0,left:0,right:0,type:"VALID"},p=Math.ceil((t-s+1)/r),f=Math.ceil((e-i+1)/o);else if(typeof n=="object"){let y=c==="channelsLast"?n[1][0]:n[2][0],d=c==="channelsLast"?n[1][1]:n[2][1],h=c==="channelsLast"?n[2][0]:n[3][0],m=c==="channelsLast"?n[2][1]:n[3][1];l={top:y,bottom:d,left:h,right:m,type:y===0&&d===0&&h===0&&m===0?"VALID":"EXPLICIT"},p=Hm((t-s+y+d)/r+1,a),f=Hm((e-i+h+m)/o+1,a)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:l,outHeight:p,outWidth:f}}function K1e(n,t,e,r,o,s,i,a,c,l,p){let f,y,d,h;if(typeof n=="number"){f={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};let x=W1e([t,e,r,1],a,1,o,n,p);y=x[0],d=x[1],h=x[2]}else if(n==="same"){y=Math.ceil(t/o),d=Math.ceil(e/s),h=Math.ceil(r/i);let m=(y-1)*o+a-t,x=(d-1)*s+c-e,w=(h-1)*i+l-r,_=Math.floor(m/2),I=m-_,T=Math.floor(x/2),D=x-T,O=Math.floor(w/2),R=w-O;f={top:T,bottom:D,left:O,right:R,front:_,back:I,type:"SAME"}}else if(n==="valid")f={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},y=Math.ceil((t-a+1)/o),d=Math.ceil((e-c+1)/s),h=Math.ceil((r-l+1)/i);else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:f,outDepth:y,outHeight:d,outWidth:h}}function Hm(n,t){if(!t)return Math.trunc(n);switch(t){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${t}`)}}function Vi(n){let[t,e,r]=zI(n);return t===1&&e===1&&r===1}function wr(n,t){return Vi(n)||Vi(t)}function jH(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}var ys=b(()=>{"use strict";});function X1e(n,t){let r={x:A(n,"x","reshape","string_or_numeric")},o={shape:t};return U.runKernel(Fp,r,o)}var ue,bt=b(()=>{"use strict";Ee();ae();Se();ye();ue=z({reshape_:X1e})});function Q1e(n,t,e,r,o){let s=A(n,"x","avgPool","float32"),i=1;q(wr(e,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${e} and dilations '${i}'`);let a=s,c=!1;s.rank===3&&(c=!0,a=ue(s,[1,s.shape[0],s.shape[1],s.shape[2]])),q(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),o!=null&&q(Nn(r),()=>`Error in avgPool: pad must be an integer when using, dimRoundingMode ${o} but got pad ${r}.`);let l={x:a},p={filterSize:t,strides:e,pad:r,dimRoundingMode:o},f=U.runKernel(ip,l,p);return f=Ye(f,s.dtype),c?ue(f,[f.shape[1],f.shape[2],f.shape[3]]):f}var tl,BI=b(()=>{"use strict";Ee();ae();Se();ze();fn();ys();ye();bt();tl=z({avgPool_:Q1e})});function Y1e(n,t,e,r,o,s="NDHWC",i){i==null?i=[1,1,1]:Pr("dilations is deprecated, this field will be gone in v3.0.0.");let a=A(n,"x","avgPool3d","float32"),c=a,l=!1;a.rank===4&&(l=!0,c=ue(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),q(c.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${c.rank}.`),q(s==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),q(wr(e,i),()=>`Error in avgPool3d: Either strides or dilations must be 1. Got strides ${e} and dilations '${i}'`),o!=null&&q(Nn(r),()=>`Error in avgPool3d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${r}.`);let p={x:c},f={filterSize:t,strides:e,pad:r,dimRoundingMode:o,dataFormat:s,dilations:i},y=U.runKernel(ap,p,f);return y=Ye(y,c.dtype),l?ue(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}var Gx,GH=b(()=>{"use strict";Ee();Ms();ae();Se();ze();fn();ys();ye();bt();Gx=z({avgPool3d_:Y1e})});function Z1e(n,t=0){q(n.length>=1,()=>"Pass at least one tensor to concat");let e=Qp(n,"tensors","concat","string_or_numeric");if(e[0].dtype==="complex64"&&e.forEach(s=>{if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${s.dtype}. `)}),e.length===1)return bi(e[0]);let r=e,o={axis:t};return U.runKernel(pp,r,o)}var gn,wi=b(()=>{"use strict";Ee();ae();Se();ze();Mx();ye();gn=z({concat_:Z1e})});function J1e(n){let e={x:A(n,"x","sigmoid")};return U.runKernel(Vu,e)}var xs,d0=b(()=>{"use strict";Ee();ae();Se();ye();xs=z({sigmoid_:J1e})});function eEe(n,t,e){let r=A(n,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");let o={x:r},s={begin:t,size:e};return U.runKernel(Vp,o,s)}var Bt,Ys=b(()=>{"use strict";Ee();ae();Se();ye();Bt=z({slice_:eEe})});function tEe(n){let e={x:A(n,"x","tanh")};return U.runKernel(Hu,e)}var fc,g2=b(()=>{"use strict";Ee();ae();Se();ye();fc=z({tanh_:tEe})});function nEe(n,t,e,r,o,s){let i=A(n,"forgetBias","basicLSTMCell"),a=A(t,"lstmKernel","basicLSTMCell"),c=A(e,"lstmBias","basicLSTMCell"),l=A(r,"data","basicLSTMCell"),p=A(o,"c","basicLSTMCell"),f=A(s,"h","basicLSTMCell"),y=gn([l,f],1),d=an(y,a),h=je(d,c),m=h.shape[0],x=h.shape[1]/4,w=[m,x],_=Bt(h,[0,0],w),I=Bt(h,[0,x],w),T=Bt(h,[0,x*2],w),D=Bt(h,[0,x*3],w),O=je(oe(xs(_),fc(I)),oe(p,xs(je(i,T)))),R=oe(fc(O),xs(D));return[O,R]}var WH,HH=b(()=>{"use strict";Se();mr();wi();Ju();Rt();ye();d0();Ys();g2();WH=z({basicLSTMCell_:nEe})});function rEe(n,t,e){let r=A(n,"x","batchToSpaceND"),o=t.reduce((a,c)=>a*c);q(r.rank>=1+t.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`),q(e.length===t.length,()=>`crops.length is ${e.length} but should be equal to blockShape.length  ${t.length}`),q(r.shape[0]%o===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${o}`);let s={x:r},i={blockShape:t,crops:e};return U.runKernel(up,s,i)}var nl,m0=b(()=>{"use strict";Ee();ae();Se();ze();ye();nl=z({batchToSpaceND_:rEe})});function KH(n){let t;return n.rank===0||n.rank===1?t=ue(n,[1,1,1,n.size]):n.rank===2?t=ue(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?t=ue(n,[1,n.shape[0],n.shape[1],n.shape[2]]):t=n,t}var XH=b(()=>{"use strict";bt()});function oEe(n,t,e,r,o,s){s==null&&(s=.001);let i=A(n,"x","batchNorm"),a=A(t,"mean","batchNorm"),c=A(e,"variance","batchNorm"),l;o!=null&&(l=A(o,"scale","batchNorm"));let p;r!=null&&(p=A(r,"offset","batchNorm")),q(a.rank===c.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),q(p==null||a.rank===p.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),q(l==null||a.rank===l.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let y={x:KH(i),scale:l,offset:p,mean:a,variance:c},d={varianceEpsilon:s},h=U.runKernel(vp,y,d);return ue(h,i.shape)}var Ui,Wx=b(()=>{"use strict";Ee();ae();Se();ze();XH();ye();bt();Ui=z({batchNorm_:oEe})});function sEe(n,t,e,r,o,s){let i=A(n,"x","batchNorm"),a=A(t,"mean","batchNorm"),c=A(e,"variance","batchNorm"),l;o!=null&&(l=A(o,"scale","batchNorm"));let p;return r!=null&&(p=A(r,"offset","batchNorm")),q(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),q(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),q(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${c.rank}.`),l!=null&&q(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${l.rank}.`),p!=null&&q(p.rank===2||p.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${p.rank}.`),Ui(i,a,c,p,l,s)}var VI,QH=b(()=>{"use strict";Se();ze();Wx();ye();VI=z({batchNorm2d_:sEe})});function iEe(n,t,e,r,o,s){let i=A(n,"x","batchNorm"),a=A(t,"mean","batchNorm"),c=A(e,"variance","batchNorm"),l;o!=null&&(l=A(o,"scale","batchNorm"));let p;return r!=null&&(p=A(r,"offset","batchNorm")),q(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),q(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),q(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${c.rank}.`),l!=null&&q(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${l.rank}.`),p!=null&&q(p.rank===3||p.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${p.rank}.`),Ui(i,a,c,p,l,s)}var qI,YH=b(()=>{"use strict";Se();ze();Wx();ye();qI=z({batchNorm3d_:iEe})});function aEe(n,t,e,r,o,s){let i=A(n,"x","batchNorm"),a=A(t,"mean","batchNorm"),c=A(e,"variance","batchNorm"),l;o!=null&&(l=A(o,"scale","batchNorm"));let p;return r!=null&&(p=A(r,"offset","batchNorm")),q(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),q(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),q(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${c.rank}.`),l!=null&&q(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${l.rank}.`),p!=null&&q(p.rank===4||p.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${p.rank}.`),Ui(i,a,c,p,l,s)}var UI,ZH=b(()=>{"use strict";Se();ze();Wx();ye();UI=z({batchNorm4d_:aEe})});function cEe(n,t,e){let r=A(n,"x","bincount"),o=A(t,"weights","bincount");q(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),q(e>=0,()=>`size must be non-negative, but got ${e}.`),q(o.size===r.size||o.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${o.shape}.`);let s={x:r,weights:o},i={size:e};return U.runKernel(em,s,i)}var jI,JH=b(()=>{"use strict";Ee();ae();Se();ze();ye();jI=z({bincount_:cEe})});function uEe(n,t){let e=A(n,"broadcastTo","x"),r=e.shape;if(t.some(l=>!(l>0)||l%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${t}].`);if(t.length<e.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${e.rank}.`);if(t.length>e.rank){let l=e.shape.slice();for(;l.length<t.length;)l.unshift(1);e=ue(e,l)}let o=e.shape,s=Array.from(t);for(let l=t.length-1;l>=0;l--)if(o[l]===t[l])s[l]=1;else if(e.shape[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);if(s.map((l,p)=>l>1?p:-1).filter(l=>l>=0).length===0)return bi(e);let a={x:e},c={reps:s};return U.runKernel(pc,a,c)}var rh,GI=b(()=>{"use strict";Ee();ae();Se();Mx();ye();bt();rh=z({broadcastTo_:uEe})});function lEe(n){let e={x:A(n,"x","ceil")};return U.runKernel(lu,e)}var Hx,e5=b(()=>{"use strict";Ee();ae();Se();ye();Hx=z({ceil_:lEe})});function pEe(n,t,e){let r=A(n,"x","clipByValue");q(t<=e,()=>`Error in clip: min (${t}) must be less than or equal to max (${e}).`);let o={x:r},s={clipValueMin:t,clipValueMax:e};return U.runKernel(pu,o,s)}var oo,t5=b(()=>{"use strict";Ee();ae();Se();ze();ye();oo=z({clipByValue_:pEe})});function hEe(n){return gn(n,0)}var WI,n5=b(()=>{"use strict";wi();ye();WI=z({concat1d_:hEe})});function fEe(n,t){return gn(n,t)}var HI,r5=b(()=>{"use strict";wi();ye();HI=z({concat2d_:fEe})});function dEe(n,t){return gn(n,t)}var KI,o5=b(()=>{"use strict";wi();ye();KI=z({concat3d_:dEe})});function mEe(n,t){return gn(n,t)}var XI,s5=b(()=>{"use strict";wi();ye();XI=z({concat4d_:mEe})});function gEe(n,t,e,r,o="NHWC",s=[1,1],i){let a=A(n,"x","conv2d"),c=A(t,"filter","conv2d"),l=a,p=!1;a.rank===3&&(p=!0,l=ue(a,[1,a.shape[0],a.shape[1],a.shape[2]])),q(l.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${l.rank}.`),q(c.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${c.rank}.`),i!=null&&q(Nn(r),()=>`Error in conv2d: pad must be an integer when using, dimRoundingMode ${i} but got pad ${r}.`);let f=o==="NHWC"?l.shape[3]:l.shape[1];q(f===c.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${c.shape[2]}.`),q(wr(e,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`);let y={x:l,filter:c},d={strides:e,pad:r,dataFormat:o,dilations:s,dimRoundingMode:i},h=U.runKernel(hp,y,d);return p?ue(h,[h.shape[1],h.shape[2],h.shape[3]]):h}var vs,Xm=b(()=>{"use strict";Ee();ae();Se();ze();ys();ye();bt();vs=z({conv2d_:gEe})});function yEe(n,t,e,r,o="NWC",s=1,i){let a=A(n,"x","conv1d"),c=A(t,"filter","conv1d"),l=a,p=!1;a.rank===2&&(p=!0,l=ue(a,[1,a.shape[0],a.shape[1]])),q(l.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${l.rank}.`),q(c.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${c.rank}.`),i!=null&&q(Nn(r),()=>`Error in conv1d: pad must be an integer when using, dimRoundingMode ${i} but got pad ${r}.`),q(l.shape[2]===c.shape[1],()=>`Error in conv1d: depth of input (${l.shape[2]}) must match input depth for filter ${c.shape[1]}.`),q(wr(e,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${e} and dilation '${s}'`),q(o==="NWC",()=>`Error in conv1d: got dataFormat of ${o} but only NWC is currently supported.`);let f=ue(c,[1,c.shape[0],c.shape[1],c.shape[2]]),y=ue(l,[l.shape[0],1,l.shape[1],l.shape[2]]),x=vs(y,f,[1,e],r,"NHWC",[1,s],i);return p?ue(x,[x.shape[2],x.shape[3]]):ue(x,[x.shape[0],x.shape[2],x.shape[3]])}var bf,y2=b(()=>{"use strict";Se();ze();Xm();ys();ye();bt();bf=z({conv1d_:yEe})});function xEe(n,t,e,r,o,s="NHWC",i){q(n.length===t.rank,()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`);let a=n,c=t,l=!1;t.rank===3&&(l=!0,c=ue(t,[1,t.shape[0],t.shape[1],t.shape[2]]),a=[1,n[0],n[1],n[2]]),q(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),q(c.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${c.rank}`),q(e.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${e.rank}`);let p=s==="NHWC"?a[3]:a[1],f=s==="NHWC"?c.shape[3]:c.shape[1];q(p===e.shape[2],()=>`Error in conv2dDerInput: depth of input (${p}) must match input depth for filter ${e.shape[2]}.`),q(f===e.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${e.shape[3]}.`),i!=null&&q(Nn(o),()=>`Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode ${i} but got pad ${o}.`);let y={dy:c,filter:e},d={strides:r,pad:o,dataFormat:s,dimRoundingMode:i,inputShape:a},h=U.runKernel(fp,y,d);return l?ue(h,[h.shape[1],h.shape[2],h.shape[3]]):h}var Kx,QI=b(()=>{"use strict";Ee();ae();ze();ye();bt();Kx=z({conv2DBackpropInput_:xEe})});function vEe(n,t,e,r,o,s){let i=A(n,"x","conv2dTranspose"),a=A(t,"filter","conv2dTranspose");return Kx(e,i,a,r,o,"NHWC",s)}var wf,x2=b(()=>{"use strict";Se();QI();ye();wf=z({conv2dTranspose_:vEe})});function bEe(n,t,e,r,o="NDHWC",s=[1,1,1]){let i=A(n,"x","conv3d"),a=A(t,"filter","conv3d"),c=i,l=!1;i.rank===4&&(l=!0,c=ue(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),q(c.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${c.rank}.`),q(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),q(c.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${c.shape[4]}) must match input depth for filter ${a.shape[3]}.`),q(wr(e,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`),q(o==="NDHWC",()=>`Error in conv3d: got dataFormat of ${o} but only NDHWC is currently supported.`);let p={x:c,filter:a},f={strides:e,pad:r,dataFormat:o,dilations:s},y=U.runKernel(dp,p,f);return l?ue(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}var Xx,i5=b(()=>{"use strict";Ee();ae();Se();ze();ys();ye();bt();Xx=z({conv3d_:bEe})});function wEe(n,t,e,r,o){q(n.length===t.rank,()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`);let s=n,i=t,a=!1;t.rank===4&&(a=!0,i=ue(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),s=[1,n[0],n[1],n[2],n[3]]);let c=s[4],l=i.shape[4];q(s.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`),q(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),q(e.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${e.rank}`),q(c===e.shape[3],()=>`Error in conv3dDerInput: depth of input (${c}) must match input depth for filter ${e.shape[3]}.`),q(l===e.shape[4],()=>`Error in conv3dDerInput: depth of output (${l}) must match output depth for filter ${e.shape[4]}.`);let p={dy:i,filter:e},f={pad:o,strides:r,inputShape:s},y=U.runKernel(om,p,f);return a?ue(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}var YI,v2=b(()=>{"use strict";Ee();ae();ze();ye();bt();YI=z({conv3DBackpropInput_:wEe})});function SEe(n,t,e,r,o){let s=A(n,"x","conv3dTranspose"),i=A(t,"filter","conv3dTranspose");return YI(e,s,i,r,o)}var a5,c5=b(()=>{"use strict";Se();v2();ye();a5=z({conv3dTranspose_:SEe})});function CEe(n){let e={x:A(n,"x","cos")};return U.runKernel(hu,e)}var rl,ZI=b(()=>{"use strict";Ee();ae();Se();ye();rl=z({cos_:CEe})});function _Ee(n){let e={x:A(n,"x","cosh")};return U.runKernel(fu,e)}var Sf,b2=b(()=>{"use strict";Ee();ae();Se();ye();Sf=z({cosh_:_Ee})});function TEe(n,t=0,e=!1,r=!1){let s={x:A(n,"x","cumsum")},i={axis:t,exclusive:e,reverse:r};return U.runKernel(mp,s,i)}var Cf,JI=b(()=>{"use strict";Ee();ae();Se();ye();Cf=z({cumsum_:TEe})});function IEe(n,t,e,r=!1){let o=A(n,"x","denseBincount"),s=A(t,"weights","denseBincount");q(o.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${o.dtype}`),q(o.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${o.rank}.`),q(e>=0,()=>`size must be non-negative, but got ${e}.`),q(s.size===o.size||s.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${o.shape}, weights shape: ${s.shape}.`);let i={x:o,weights:s},a={size:e,binaryOutput:r};return U.runKernel(im,i,a)}var e1,u5=b(()=>{"use strict";Ee();ae();Se();ze();ye();e1=z({denseBincount_:IEe})});function EEe(n,t,e="NHWC"){let r=A(n,"x","depthToSpace"),o=e==="NHWC"?r.shape[1]:r.shape[2],s=e==="NHWC"?r.shape[2]:r.shape[3],i=e==="NHWC"?r.shape[3]:r.shape[1];q(o*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${t}  for depthToSpace with input shape
    ${r.shape}`),q(s*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${t} for depthToSpace with input shape
        ${r.shape}`),q(i%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${i} for depthToSpace with input shape ${r.shape}`);let a={x:r},c={blockSize:t,dataFormat:e};return U.runKernel(am,a,c)}var Qx,w2=b(()=>{"use strict";Ee();ae();Se();ze();ye();Qx=z({depthToSpace_:EEe})});function NEe(n,t,e,r,o="NHWC",s=[1,1],i){let a=A(n,"x","depthwiseConv2d"),c=A(t,"filter","depthwiseConv2d"),l=a,p=!1;a.rank===3&&(p=!0,l=ue(a,[1,a.shape[0],a.shape[1],a.shape[2]])),q(l.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${l.rank}.`),q(c.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${c.rank}.`),q(l.shape[3]===c.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),i!=null&&q(Nn(r),()=>`Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ${i} but got pad ${r}.`);let f={x:l,filter:c},y={strides:e,pad:r,dataFormat:o,dilations:s,dimRoundingMode:i},d=U.runKernel(gp,f,y);return p?ue(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var Si,Yx=b(()=>{"use strict";Ee();ae();Se();ze();ye();bt();Si=z({depthwiseConv2d_:NEe})});function DEe(n){let e={x:A(n,"x","diag")};return U.runKernel(lm,e)}var l5,p5=b(()=>{"use strict";Ee();ae();Se();ye();l5=z({diag_:DEe})});function kEe(n,t,e,r,o=[1,1],s="NHWC"){let i=A(n,"x","dilation2d"),a=A(t,"filter","dilation2d");q(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),q(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),q(s==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`);let c=i,l=!1;i.rank===3&&(c=ue(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=!0);let p={x:c,filter:a},f={strides:e,pad:r,dilations:o},y=U.runKernel(yp,p,f);return l?ue(y,[y.shape[1],y.shape[2],y.shape[3]]):y}var Zx,S2=b(()=>{"use strict";Ee();ae();Se();ze();ye();bt();Zx=z({dilation2d_:kEe})});function AEe(n,t){let e=n.length,r=[];for(let o=0;o<e;o++){let s=e-1-o,i=n[s]||1;(t[t.length-1-o]||1)>1&&i===1&&r.unshift(s)}return r}function er(n,t){let e=[];for(let r=0;r<t.length;r++){let o=n[n.length-r-1],s=t.length-r-1,i=t[s];(o==null||o===1&&i>1)&&e.unshift(s)}return e}function Zt(n,t){let e=[],r=Math.max(n.length,t.length);for(let o=0;o<r;o++){let s=n[n.length-o-1];s==null&&(s=1);let i=t[t.length-o-1];if(i==null&&(i=1),s===1)e.unshift(i);else if(i===1)e.unshift(s);else if(s!==i){let a=`Operands could not be broadcast together with shapes ${n} and ${t}.`;throw Error(a)}else e.unshift(s)}return e}var lr=b(()=>{"use strict";});function OEe(n,t){let e=A(n,"a","equal"),r=A(t,"b","equal");[e,r]=sn(e,r),Zt(e.shape,r.shape);let o={a:e,b:r};return U.runKernel(tf,o)}var bs,Jx=b(()=>{"use strict";Ee();ae();br();Se();lr();ye();bs=z({equal_:OEe})});function MEe(n,t,e){let r=A(t,"a","where"),o=A(e,"b","where"),s=A(n,"condition","where","bool"),i=Zt(r.shape,o.shape),a=rh(r,i),c=rh(o,i);s.rank===1&&q(s.shape[0]===r.shape[0],()=>"The first dimension of `a` must match the size of `condition`."),s.rank!==1&&rn(s.shape,c.shape,"Error in where: ");let l={condition:s,t:a,e:c};return U.runKernel(Bp,l)}var pr,ya=b(()=>{"use strict";Ee();ae();Se();ze();GI();lr();ye();pr=z({where_:MEe})});function REe(n){let e={x:A(n,"x","zerosLike")};return U.runKernel(Xp,e)}var Et,gr=b(()=>{"use strict";Ee();ae();Se();ye();Et=z({zerosLike_:REe})});function PEe(n,t){let e=A(n,"a","div"),r=A(t,"b","div");[e,r]=sn(e,r);let o=ct(e,r),s=Et(o),i=bs(r,s);return pr(i,s,o)}var ev,C2=b(()=>{"use strict";br();Se();qn();Jx();ye();ya();gr();ev=z({divNoNan_:PEe})});function FEe(n,t){let e=A(n,"t1","dot"),r=A(t,"t2","dot");q((e.rank===1||e.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${e.rank} and ${r.rank}.`);let o=e.rank===1?e.size:e.shape[1],s=r.rank===1?r.size:r.shape[0];if(q(o===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${o} and ${s}.`),e.rank===1&&r.rank===1){let i=ue(e,[1,-1]),a=ue(r,[-1,1]),c=an(i,a);return ue(c,[])}else if(e.rank===1&&r.rank===2){let i=ue(e,[1,-1]),a=ue(r,[r.shape[0],r.shape[1]]),c=an(i,a);return ue(c,[c.size])}else if(e.rank===2&&r.rank===1){let i=ue(r,[-1,1]),a=an(e,i);return ue(a,[a.size])}else{let i=ue(r,[r.shape[0],r.shape[1]]);return an(e,i)}}var t1,_2=b(()=>{"use strict";Se();ze();Ju();ye();bt();t1=z({dot_:FEe})});function $Ee(n){let e={x:A(n,"x","elu")};return U.runKernel(mu,e)}var xa,n1=b(()=>{"use strict";Ee();ae();Se();ye();xa=z({elu_:$Ee})});function LEe(n){let t=A(n,"x","erf");q(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=Ye(t,"float32"));let e={x:t};return U.runKernel(gu,e)}var tv,h5=b(()=>{"use strict";Ee();ae();Se();ze();fn();ye();tv=z({erf_:LEe})});function zEe(n){let e={x:A(n,"x","exp")};return U.runKernel(yu,e)}var Wr,ol=b(()=>{"use strict";Ee();ae();Se();ye();Wr=z({exp_:zEe})});function BEe(n,t=0){let e=A(n,"x","expandDims","string_or_numeric");q(t<=e.rank,()=>"Axis must be <= rank of the tensor");let r={input:e},o={dim:t};return U.runKernel(xp,r,o)}var Io,g0=b(()=>{"use strict";Ee();ae();Se();ze();ye();Io=z({expandDims_:BEe})});function VEe(n){let e={x:A(n,"x","expm1")};return U.runKernel(xu,e)}var nv,f5=b(()=>{"use strict";Ee();ae();Se();ye();nv=z({expm1_:VEe})});function qEe(n,t){let e=A(n,"x","tile","string_or_numeric");q(e.rank===t.length,()=>`Error in transpose: rank of input ${e.rank} must match length of reps ${t}.`);let r={x:e},o={reps:t};return U.runKernel(pc,r,o)}var Ci,y0=b(()=>{"use strict";Ee();ae();Se();ze();ye();Ci=z({tile_:qEe})});function UEe(n,t,e,r="float32"){t==null&&(t=n);let o=It([n,t],r),s=n<=t?n:t;for(let a=0;a<s;++a)o.set(1,a,a);let i=ue(o.toTensor(),[n,t]);if(e==null)return i;if(e.length===1)return Ci(Io(i,0),[e[0],1,1]);if(e.length===2)return Ci(Io(Io(i,0),0),[e[0],e[1],1,1]);if(e.length===3)return Ci(Io(Io(Io(i,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${e.length}D.`)}var Qm,T2=b(()=>{"use strict";Jp();g0();ye();bt();y0();Qm=z({eye_:UEe})});function sl(n,t,e){let r={shape:n,value:t,dtype:e};return U.runKernel(fm,{},r)}var r1=b(()=>{"use strict";Ee();ae();});function jEe(n){let e={x:A(n,"x","floor")};return U.runKernel(vu,e)}var va,o1=b(()=>{"use strict";Ee();ae();Se();ye();va=z({floor_:jEe})});function GEe(n,t,e=0,r=0){let o=A(n,"x","gather"),s=A(t,"indices","gather","int32"),i={x:o,indices:s},a={axis:e,batchDims:r};return U.runKernel(bp,i,a)}var ji,x0=b(()=>{"use strict";Ee();ae();Se();ye();ji=z({gather_:GEe})});function WEe(n,t){let e=A(n,"a","greater"),r=A(t,"b","greater");[e,r]=sn(e,r),Zt(e.shape,r.shape);let o={a:e,b:r};return U.runKernel(nf,o)}var Fr,il=b(()=>{"use strict";Ee();ae();br();Se();lr();ye();Fr=z({greater_:WEe})});function HEe(n,t){let e=A(n,"a","greaterEqual"),r=A(t,"b","greaterEqual");[e,r]=sn(e,r),Zt(e.shape,r.shape);let o={a:e,b:r};return U.runKernel(wu,o)}var Yo,Tf=b(()=>{"use strict";Ee();ae();br();Se();lr();ye();Yo=z({greaterEqual_:HEe})});function KEe(n){let e={input:A(n,"input","imag")};return U.runKernel(ym,e)}var If,s1=b(()=>{"use strict";Ee();ae();Se();ye();If=z({imag_:KEe})});function XEe(n){let e={x:A(n,"x","isFinite")};return U.runKernel(Su,e)}var i1,d5=b(()=>{"use strict";Ee();ae();Se();ye();i1=z({isFinite_:XEe})});function QEe(n){let e={x:A(n,"x","isInf")};return U.runKernel(Cu,e)}var a1,m5=b(()=>{"use strict";Ee();ae();Se();ye();a1=z({isInf_:QEe})});function YEe(n){let e={x:A(n,"x","isNaN")};return U.runKernel(_u,e)}var c1,g5=b(()=>{"use strict";Ee();ae();Se();ye();c1=z({isNaN_:YEe})});function ZEe(n,t=.2){let r={x:A(n,"x","leakyRelu")},o={alpha:t};return U.runKernel(Sp,r,o)}var al,u1=b(()=>{"use strict";Ee();ae();Se();ye();al=z({leakyRelu_:ZEe})});function JEe(n,t){let e=A(n,"a","less"),r=A(t,"b","less");[e,r]=sn(e,r),Zt(e.shape,r.shape);let o={a:e,b:r};return U.runKernel(rf,o)}var cl,v0=b(()=>{"use strict";Ee();ae();br();Se();lr();ye();cl=z({less_:JEe})});function eNe(n,t){let e=A(n,"a","lessEqual"),r=A(t,"b","lessEqual");[e,r]=sn(e,r),Zt(e.shape,r.shape);let o={a:e,b:r};return U.runKernel(of,o)}var Rs,Ef=b(()=>{"use strict";Ee();ae();br();Se();lr();ye();Rs=z({lessEqual_:eNe})});function l1(n,t,e){if(e<=0)throw new Error("The number of values should be positive.");let r={start:n,stop:t,num:e};return U.runKernel(xm,{},r)}var y5=b(()=>{"use strict";Ee();ae();});function tNe(n,t=5,e=1,r=1,o=.5){let s=A(n,"x","localResponseNormalization");q(s.rank===4||s.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${s.rank}.`),q(Nn(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let i=s,a=!1;s.rank===3&&(a=!0,i=ue(s,[1,s.shape[0],s.shape[1],s.shape[2]]));let c={x:i},l={depthRadius:t,bias:e,alpha:r,beta:o},p=U.runKernel(Cp,c,l);return a?ue(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var rv,I2=b(()=>{"use strict";Ee();ae();Se();ze();ye();bt();rv=z({localResponseNormalization_:tNe})});function nNe(n){let e={x:A(n,"x","log")};return U.runKernel(Tu,e)}var so,ov=b(()=>{"use strict";Ee();ae();Se();ye();so=z({log_:nNe})});function rNe(n){let e={x:A(n,"x","log1p")};return U.runKernel(Iu,e)}var Nf,E2=b(()=>{"use strict";Ee();ae();Se();ye();Nf=z({log1p_:rNe})});function x5(n){return q(tu(n),()=>"The f passed in grad(f) must be a function"),(t,e)=>{let r=A(t,"x","tf.grad","string_or_numeric"),o=e!=null?A(e,"dy","tf.grad"):null;return U.tidy(()=>{let{value:s,grads:i}=U.gradients(()=>n(r),[r],o);return o!=null&&rn(s.shape,o.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),p1(i),i[0]})}}function v5(n){return q(tu(n),()=>"The f passed in grads(f) must be a function"),(t,e)=>{q(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");let r=Qp(t,"args","tf.grads","string_or_numeric"),o=e!=null?A(e,"dy","tf.grads"):null;return U.tidy(()=>{let{value:s,grads:i}=U.gradients(()=>n(...r),r,o);return o!=null&&rn(s.shape,o.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),p1(i),i})}}function b5(n){return q(tu(n),()=>"The f passed in valueAndGrad(f) must be a function"),(t,e)=>{q(t instanceof K,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),q(e==null||e instanceof K,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");let{grads:r,value:o}=U.gradients(()=>n(t),[t],e);return p1(r),{grad:r[0],value:o}}}function w5(n){return q(tu(n),()=>"The f passed in valueAndGrads(f) must be a function"),(t,e)=>{q(Array.isArray(t)&&t.every(o=>o instanceof K),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),q(e==null||e instanceof K,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");let r=U.gradients(()=>n(...t),t,e);return e!=null&&rn(r.value.shape,e.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),p1(r.grads),r}}function b0(n,t){q(tu(n),()=>"The f passed in variableGrads(f) must be a function"),q(t==null||Array.isArray(t)&&t.every(l=>l instanceof Qu),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");let e=t!=null;if(!e){t=[];for(let l in U.registeredVariables)t.push(U.registeredVariables[l])}let r=e?t.filter(l=>!l.trainable):null,o=t.length;t=t.filter(l=>l.trainable),q(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${o} variables is trainable.`);let s=!0,{value:i,grads:a}=U.gradients(n,t,null,s);q(a.some(l=>l!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),q(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);let c={};return t.forEach((l,p)=>{a[p]!=null&&(c[l.name]=a[p])}),r?.forEach(l=>c[l.name]=null),{value:i,grads:c}}function ws(n){return U.customGrad(n)}function p1(n){if(n.filter(e=>e==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}var oh=b(()=>{"use strict";Ee();Ae();Se();ze();});function oNe(n){let e={x:A(n,"x","neg")};return U.runKernel(kp,e)}var un,Zo=b(()=>{"use strict";Ee();ae();Se();ye();un=z({neg_:oNe})});function sNe(n){let e={x:A(n,"x","softplus")};return U.runKernel(qu,e)}var ba,N2=b(()=>{"use strict";Ee();ae();Se();ye();ba=z({softplus_:sNe})});function iNe(n){let t=A(n,"x","logSigmoid");return ws(r=>({value:un(ba(un(r))),gradFunc:i=>oe(i,xs(un(r)))}))(t)}var h1,S5=b(()=>{"use strict";oh();Se();Rt();Zo();ye();d0();N2();h1=z({logSigmoid_:iNe})});function aNe(n,t=null,e=!1){let o={x:A(n,"x","max")},s={reductionIndices:t,keepDims:e};return U.runKernel(_p,o,s)}var io,sv=b(()=>{"use strict";Ee();ae();Se();ye();io=z({max_:aNe})});function cNe(n,t){let e=A(n,"a","sub"),r=A(t,"b","sub");[e,r]=sn(e,r);let o={a:e,b:r};return U.runKernel(Gu,o)}var at,Hn=b(()=>{"use strict";Ee();ae();br();Se();ye();at=z({sub_:cNe})});function uNe(n,t=null,e=!1){let r=A(n,"x","sum");r.dtype==="bool"&&(r=Ye(r,"int32"));let o={x:r},s={axis:t,keepDims:e};return U.runKernel(qp,o,s)}var gt,Hr=b(()=>{"use strict";Ee();ae();Se();fn();ye();gt=z({sum_:uNe})});function lNe(n,t=-1){let e=A(n,"logits","logSoftmax");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and axis was ${t}`);return ws((o,s)=>{let a=io(o,t,!0),c=at(o,a),l=at(Ye(c,"float32"),so(gt(Wr(c),t,!0)));return s([l]),{value:l,gradFunc:(f,y)=>{let[d]=y,h=!0,m=Wr(d);return at(f,oe(gt(f,t,h),m))}}})(e)}var Df,C5=b(()=>{"use strict";oh();Se();fn();ol();ov();sv();Rt();ye();Hn();Hr();Df=z({logSoftmax_:lNe})});function D2(n,t){for(let e=0;e<n.length;++e)if(n[n.length-e-1]!==t-1-e)return!1;return!0}function _5(n,t,e){let r=n.length+t.length,o=[],s=0,i=0;for(let a=0;a<r;a++)e.indexOf(a)===-1?o.push(n[s++]):o.push(t[i++]);return o}function k2(n,t){let e=[],r=n.length;for(let s=0;s<r;s++)t.indexOf(s)===-1&&e.push(n[s]);let o=t.map(s=>n[s]);return[e,o]}function wa(n,t){let e=t.map(r=>1);return _5(n,e,t)}function pNe(n,t,e){q(D2(t,e),()=>`${n} supports only inner-most axes for now. Got axes ${t} and rank-${e} input.`)}function A2(n,t){if(D2(n,t))return null;let e=[];for(let r=0;r<t;++r)n.indexOf(r)===-1&&e.push(r);return n.forEach(r=>e.push(r)),e}function w0(n){return n.map((t,e)=>[e,t]).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}function hNe(n,t){let e=[];for(let r=t-n;r<t;++r)e.push(r);return e}var dc=b(()=>{"use strict";ze();});function fNe(n,t=null,e=!1){let r=A(n,"x","logSumExp"),o=no(t,r.shape),s=io(r,o,!0),i=at(r,s),a=Wr(i),c=gt(a,o),l=so(c),p=je(ue(s,l.shape),l);if(e){let f=wa(p.shape,o);return ue(p,f)}return p}var iv,f1=b(()=>{"use strict";Se();ze();mr();dc();ol();ov();sv();ye();bt();Hn();Hr();iv=z({logSumExp_:fNe})});function dNe(n,t){let e=A(n,"a","logicalAnd","bool"),r=A(t,"b","logicalAnd","bool");Zt(e.shape,r.shape);let o={a:e,b:r};return U.runKernel(sf,o)}var vo,Ym=b(()=>{"use strict";Ee();ae();Se();lr();ye();vo=z({logicalAnd_:dNe})});function mNe(n){let e={x:A(n,"x","logicalNot","bool")};return U.runKernel(af,e)}var ul,S0=b(()=>{"use strict";Ee();ae();Se();ye();ul=z({logicalNot_:mNe})});function gNe(n,t){let e=A(n,"a","logicalOr","bool"),r=A(t,"b","logicalOr","bool");Zt(e.shape,r.shape);let o={a:e,b:r};return U.runKernel(cf,o)}var kf,d1=b(()=>{"use strict";Ee();ae();Se();lr();ye();kf=z({logicalOr_:gNe})});function yNe(n,t){let e=A(n,"a","logicalXor","bool"),r=A(t,"b","logicalXor","bool");return Zt(e.shape,r.shape),vo(kf(n,t),ul(vo(n,t)))}var m1,M2=b(()=>{"use strict";Se();lr();Ym();S0();d1();ye();m1=z({logicalXor_:yNe})});function xNe(n,t,e,r,o){let s=A(n,"x","maxPool"),i=1,a=s,c=!1;s.rank===3&&(c=!0,a=ue(s,[1,s.shape[0],s.shape[1],s.shape[2]])),q(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),q(wr(e,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${e} and dilations '${i}'`),o!=null&&q(Nn(r),()=>`Error in maxPool: pad must be an integer when using, dimRoundingMode ${o} but got pad ${r}.`);let l={x:a},p={filterSize:t,strides:e,pad:r,dimRoundingMode:o},f=U.runKernel(Tp,l,p);return c?ue(f,[f.shape[1],f.shape[2],f.shape[3]]):f}var ll,g1=b(()=>{"use strict";Ee();ae();Se();ze();ys();ye();bt();ll=z({maxPool_:xNe})});function vNe(n,t=[1,1,1],e,r,o,s="NDHWC",i){i==null?i=[1,1,1]:Pr("dilations is deprecated, this field will be gone in v3.0.0.");let a=A(n,"x","maxPool3d"),c=a,l=!1;a.rank===4&&(l=!0,c=ue(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),q(c.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${c.rank}.`),q(s==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),q(wr(e,i),()=>`Error in maxPool3d: Either strides or dilations must be 1. Got strides ${e} and dilations '${i}'`),o!=null&&q(Nn(r),()=>`Error in maxPool3d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${r}.`);let p={x:c},f={filterSize:t,strides:e,pad:r,dimRoundingMode:o,dataFormat:s,dilations:i},y=U.runKernel(Ip,p,f);return l?ue(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}var av,T5=b(()=>{"use strict";Ee();Ms();ae();Se();ze();ys();ye();bt();av=z({maxPool3d_:vNe})});function bNe(n,t,e,r,o=!1){let i={x:A(n,"x","maxPoolWithArgmax")},a={filterSize:t,strides:e,pad:r,includeBatchInIndex:o},c=U.runKernel(Sm,i,a);return{result:c[0],indexes:c[1]}}var y1,I5=b(()=>{"use strict";Ee();ae();Se();ye();y1=z({maxPoolWithArgmax_:bNe})});function wNe(n,t){let e=A(n,"a","maximum"),r=A(t,"b","maximum");[e,r]=sn(e,r),e.dtype==="bool"&&(e=Ye(e,"int32"),r=Ye(r,"int32")),Zt(e.shape,r.shape);let o={a:e,b:r};return U.runKernel(Eu,o)}var $o,cv=b(()=>{"use strict";Ee();ae();br();Se();lr();fn();ye();$o=z({maximum_:wNe})});function SNe(n,t=null,e=!1){let o={x:A(n,"x","mean")},s={axis:t,keepDims:e};return U.runKernel(Ep,o,s)}var Un,C0=b(()=>{"use strict";Ee();ae();Se();ye();Un=z({mean_:SNe})});function CNe(n,t=null,e=!1){let o={x:A(n,"x","min")},s={axis:t,keepDims:e};return U.runKernel(Np,o,s)}var mc,x1=b(()=>{"use strict";Ee();ae();Se();ye();mc=z({min_:CNe})});function _Ne(n,t){let e=A(n,"a","minimum"),r=A(t,"b","minimum");[e,r]=sn(e,r),e.dtype==="bool"&&(e=Ye(e,"int32"),r=Ye(r,"int32")),Zt(e.shape,r.shape);let o={a:e,b:r};return U.runKernel(Nu,o)}var _i,_0=b(()=>{"use strict";Ee();ae();br();Se();lr();fn();ye();_i=z({minimum_:_Ne})});function TNe(n,t,e){q(e==="reflect"||e==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${e}.`);let r=A(n,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");q(t.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`);let o=e==="reflect"?1:0;for(let a=0;a<r.rank;a++)q(t[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),q(t[a][0]>=0&&t[a][0]<=r.shape[a]-o&&t[a][1]>=0&&t[a][1]<=r.shape[a]-o,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-o} or less than 0 for input of shape ${r.shape}`);let s={paddings:t,mode:e},i={x:r};return U.runKernel(Dp,i,s)}var uv,R2=b(()=>{"use strict";Ee();ae();Se();ze();ye();uv=z({mirrorPad_:TNe})});function INe(n,t){let e=A(n,"a","mod"),r=A(t,"b","mod");[e,r]=sn(e,r);let o={a:e,b:r};return U.runKernel(Du,o)}var Af,v1=b(()=>{"use strict";Ee();ae();br();Se();ye();Af=z({mod_:INe})});function ENe(n){let t=A(n,"x","square"),e={};return U.runKernel("Square",{x:t},e)}var Gt,ao=b(()=>{"use strict";Ee();Se();ye();Gt=z({square_:ENe})});function NNe(n,t=null,e=!1){n=A(n,"x","moments");let r=no(t,n.shape),o=Un(n,r,e),s=o.shape;e||(s=wa(o.shape,r));let i=Gt(at(Ye(n,"float32"),ue(o,s))),a=Un(i,r,e);return{mean:o,variance:a}}var Zm,E5=b(()=>{"use strict";Se();ze();dc();fn();C0();ye();bt();ao();Hn();Zm=z({moments_:NNe})});function DNe(n,t,e,r){let o=A(t,"data","multiRNNCell"),s=Qp(e,"c","multiRNNCell"),i=Qp(r,"h","multiRNNCell"),a=o,c=[];for(let f=0;f<n.length;f++){let y=n[f](a,s[f],i[f]);c.push(y[0]),c.push(y[1]),a=y[1]}let l=[],p=[];for(let f=0;f<c.length;f+=2)l.push(c[f]),p.push(c[f+1]);return[l,p]}var N5,D5=b(()=>{"use strict";Se();ye();N5=z({multiRNNCell_:DNe})});function kNe(n,t,e,r=!1){let o=A(n,"logits","multinomial"),s=o.size,i=o.rank;if(s<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${s}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);e=e||Math.random();let c={logits:i===1?ue(o,[1,-1]):o},l={numSamples:t,seed:e,normalized:r},p=U.runKernel(Cm,c,l);return i===1?ue(p,[p.size]):p}var b1,k5=b(()=>{"use strict";Ee();ae();Se();ye();bt();b1=z({multinomial_:kNe})});function ANe(n,t){let e=A(n,"a","notEqual"),r=A(t,"b","notEqual");[e,r]=sn(e,r),Zt(e.shape,r.shape);let o={a:e,b:r};return U.runKernel(uf,o)}var Zs,T0=b(()=>{"use strict";Ee();ae();br();Se();lr();ye();Zs=z({notEqual_:ANe})});function An(n,t="float32"){if(t==="complex64"){let r=An(n,"float32"),o=An(n,"float32");return Xs(r,o)}let e=xx(Vn(n),t);return U.makeTensor(e,n,t)}var Jm=b(()=>{"use strict";Ee();ze();zm();});function Lo(n,t="float32"){if(t==="complex64"){let r=Lo(n,"float32"),o=An(n,"float32");return Xs(r,o)}let e=Zw(Vn(n),t);return U.makeTensor(e,n,t)}var lv=b(()=>{"use strict";Ee();ze();zm();Jm();});function ONe(n){let e={x:A(n,"x","onesLike")};return U.runKernel(Ap,e)}var Yr,A5=b(()=>{"use strict";Ee();ae();Se();ye();Yr=z({onesLike_:ONe})});function MNe(n,t){let e=A(n,"v1","outerProduct"),r=A(t,"v2","outerProduct");q(e.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${e.rank} and ${r.rank}.`);let o=ue(e,[-1,1]),s=ue(r,[1,-1]);return an(o,s)}var O5,M5=b(()=>{"use strict";Se();ze();Ju();ye();bt();O5=z({outerProduct_:MNe})});function RNe(n,t,e=0){let r=A(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");let o={paddings:t,constantValue:e},s={x:r};return U.runKernel(Rp,s,o)}var Jo,Of=b(()=>{"use strict";Ee();ae();Se();ye();Jo=z({pad_:RNe})});function PNe(n,t,e=0){return q(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),Jo(n,[t],e)}var R5,P5=b(()=>{"use strict";ze();ye();Of();R5=z({pad1d_:PNe})});function FNe(n,t,e=0){return q(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Jo(n,t,e)}var F5,$5=b(()=>{"use strict";ze();ye();Of();F5=z({pad2d_:FNe})});function $Ne(n,t,e=0){return q(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Jo(n,t,e)}var L5,z5=b(()=>{"use strict";ze();ye();Of();L5=z({pad3d_:$Ne})});function LNe(n,t,e=0){return q(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Jo(n,t,e)}var B5,V5=b(()=>{"use strict";ze();ye();Of();B5=z({pad4d_:LNe})});function zNe(n,t,e){let r=A(n,"x","spaceToBatchND");q(r.rank>=1+t.length,()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`),q(e.length===t.length,()=>`paddings.shape[0] ${e.length} must be equal to [blockShape] ${t.length}`),q(r.shape.reduce((i,a,c)=>c>0&&c<=t.length?i&&(a+e[c-1][0]+e[c-1][1])%t[c-1]===0:i,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${e.toString()} must be divisible by blockShapes ${t.toString()}`);let o={x:r},s={blockShape:t,paddings:e};return U.runKernel(Up,o,s)}var pl,I0=b(()=>{"use strict";Ee();ae();Se();ze();ye();pl=z({spaceToBatchND_:zNe})});function BNe(n,t,e,r,o,s){o==null&&(o=[1,1]),s==null&&(s=1),r===0&&(r="valid");let i=A(n,"x","maxPool"),a=i,c=!1;i.rank===3&&(c=!0,a=ue(i,[1,i.shape[0],i.shape[1],i.shape[2]])),q(wr(s,o),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${o}'`);let l=d2(a.shape,t,s,o,r),p=[l.dilationHeight,l.dilationWidth],f;r==="same"?f=qNe([l.filterHeight,l.filterWidth],p):f=[[0,0],[0,0]];let y=p[0]===1&&p[1]===1,[d,h]=VNe([l.inHeight,l.inWidth],p,f),m=y?r:"valid",x=y?a:pl(a,p,d),_=(e==="avg"?()=>tl(x,t,s,m):()=>ll(x,t,s,m))(),I=y?_:nl(_,p,h);return c?ue(I,[I.shape[1],I.shape[2],I.shape[3]]):I}function VNe(n,t,e){let r=e.map(p=>p[0]),o=e.map(p=>p[1]),s=n.concat(r,o),i=t.map((p,f)=>(p-s[f]%p)%p),a=o.map((p,f)=>p+i[f]),c=t.map((p,f)=>[r[f],a[f]]),l=t.map((p,f)=>[0,i[f]]);return[c,l]}function qNe(n,t){let r=n.map((i,a)=>i+(i-1)*(t[a]-1)).map(i=>i-1),o=r.map(i=>Math.floor(i/2)),s=r.map((i,a)=>i-o[a]);return r.map((i,a)=>[o[a],s[a]])}var w1,P2=b(()=>{"use strict";Se();ze();BI();m0();ys();g1();ye();bt();I0();w1=z({pool_:BNe})});function UNe(n,t){let e=A(n,"base","pow"),r=A(t,"exp","pow");[e,r]=sn(e,r);let o={a:e,b:r};return U.runKernel(Au,o)}var Eo,sh=b(()=>{"use strict";Ee();ae();br();Se();ye();Eo=z({pow_:UNe})});function jNe(n,t){let e=A(n,"x","prelu"),r=A(t,"alpha","prelu"),o={x:e,alpha:r};return U.runKernel(Pp,o)}var hl,S1=b(()=>{"use strict";Ee();ae();Se();ye();hl=z({prelu_:jNe})});function GNe(n,t=null,e=!1){let r=A(n,"x","prod");r.dtype==="bool"&&(r=Ye(r,"int32"));let o={x:r},s={axis:t,keepDims:e};return U.runKernel(Em,o,s)}var Mf,F2=b(()=>{"use strict";Ee();ae();Se();fn();ye();Mf=z({prod_:GNe})});function WNe(n,t,e){let r=Vn(n),o=null;if(e==null||e==="float32")o=new Float32Array(r);else if(e==="int32")o=new Int32Array(r);else if(e==="bool")o=new Uint8Array(r);else throw new Error(`Unknown data type ${e}`);for(let s=0;s<r;s++)o[s]=t();return U.makeTensor(o,n,e)}var q5,U5=b(()=>{"use strict";Ee();ze();ye();q5=z({rand_:WNe})});var G5=Pn((j5,$2)=>{"use strict";(function(n,t,e){function r(a){var c=this,l=i();c.next=function(){var p=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=p-(c.c=p|0)},c.c=1,c.s0=l(" "),c.s1=l(" "),c.s2=l(" "),c.s0-=l(a),c.s0<0&&(c.s0+=1),c.s1-=l(a),c.s1<0&&(c.s1+=1),c.s2-=l(a),c.s2<0&&(c.s2+=1),l=null}function o(a,c){return c.c=a.c,c.s0=a.s0,c.s1=a.s1,c.s2=a.s2,c}function s(a,c){var l=new r(a),p=c&&c.state,f=l.next;return f.int32=function(){return l.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,p&&(typeof p=="object"&&o(p,l),f.state=function(){return o(l,{})}),f}function i(){var a=4022871197,c=function(l){l=l.toString();for(var p=0;p<l.length;p++){a+=l.charCodeAt(p);var f=.02519603282416938*a;a=f>>>0,f-=a,f*=a,a=f>>>0,f-=a,a+=f*4294967296}return(a>>>0)*23283064365386963e-26};return c}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.alea=s})(j5,typeof $2=="object"&&$2,typeof define=="function"&&define)});var H5=Pn((W5,L2)=>{"use strict";(function(n,t,e){function r(i){var a=this,c="";a.x=0,a.y=0,a.z=0,a.w=0,a.next=function(){var p=a.x^a.x<<11;return a.x=a.y,a.y=a.z,a.z=a.w,a.w^=a.w>>>19^p^p>>>8},i===(i|0)?a.x=i:c+=i;for(var l=0;l<c.length+64;l++)a.x^=c.charCodeAt(l)|0,a.next()}function o(i,a){return a.x=i.x,a.y=i.y,a.z=i.z,a.w=i.w,a}function s(i,a){var c=new r(i),l=a&&a.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,y=(c.next()>>>0)/4294967296,d=(f+y)/(1<<21);while(d===0);return d},p.int32=c.next,p.quick=p,l&&(typeof l=="object"&&o(l,c),p.state=function(){return o(c,{})}),p}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.xor128=s})(W5,typeof L2=="object"&&L2,typeof define=="function"&&define)});var X5=Pn((K5,z2)=>{"use strict";(function(n,t,e){function r(i){var a=this,c="";a.next=function(){var p=a.x^a.x>>>2;return a.x=a.y,a.y=a.z,a.z=a.w,a.w=a.v,(a.d=a.d+362437|0)+(a.v=a.v^a.v<<4^(p^p<<1))|0},a.x=0,a.y=0,a.z=0,a.w=0,a.v=0,i===(i|0)?a.x=i:c+=i;for(var l=0;l<c.length+64;l++)a.x^=c.charCodeAt(l)|0,l==c.length&&(a.d=a.x<<10^a.x>>>4),a.next()}function o(i,a){return a.x=i.x,a.y=i.y,a.z=i.z,a.w=i.w,a.v=i.v,a.d=i.d,a}function s(i,a){var c=new r(i),l=a&&a.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,y=(c.next()>>>0)/4294967296,d=(f+y)/(1<<21);while(d===0);return d},p.int32=c.next,p.quick=p,l&&(typeof l=="object"&&o(l,c),p.state=function(){return o(c,{})}),p}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.xorwow=s})(K5,typeof z2=="object"&&z2,typeof define=="function"&&define)});var Y5=Pn((Q5,B2)=>{"use strict";(function(n,t,e){function r(i){var a=this;a.next=function(){var l=a.x,p=a.i,f,y,d;return f=l[p],f^=f>>>7,y=f^f<<24,f=l[p+1&7],y^=f^f>>>10,f=l[p+3&7],y^=f^f>>>3,f=l[p+4&7],y^=f^f<<7,f=l[p+7&7],f=f^f<<13,y^=f^f<<9,l[p]=y,a.i=p+1&7,y};function c(l,p){var f,y,d=[];if(p===(p|0))y=d[0]=p;else for(p=""+p,f=0;f<p.length;++f)d[f&7]=d[f&7]<<15^p.charCodeAt(f)+d[f+1&7]<<13;for(;d.length<8;)d.push(0);for(f=0;f<8&&d[f]===0;++f);for(f==8?y=d[7]=-1:y=d[f],l.x=d,l.i=0,f=256;f>0;--f)l.next()}c(a,i)}function o(i,a){return a.x=i.x.slice(),a.i=i.i,a}function s(i,a){i==null&&(i=+new Date);var c=new r(i),l=a&&a.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,y=(c.next()>>>0)/4294967296,d=(f+y)/(1<<21);while(d===0);return d},p.int32=c.next,p.quick=p,l&&(l.x&&o(l,c),p.state=function(){return o(c,{})}),p}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.xorshift7=s})(Q5,typeof B2=="object"&&B2,typeof define=="function"&&define)});var J5=Pn((Z5,V2)=>{"use strict";(function(n,t,e){function r(i){var a=this;a.next=function(){var l=a.w,p=a.X,f=a.i,y,d;return a.w=l=l+1640531527|0,d=p[f+34&127],y=p[f=f+1&127],d^=d<<13,y^=y<<17,d^=d>>>15,y^=y>>>12,d=p[f]=d^y,a.i=f,d+(l^l>>>16)|0};function c(l,p){var f,y,d,h,m,x=[],w=128;for(p===(p|0)?(y=p,p=null):(p=p+"\0",y=0,w=Math.max(w,p.length)),d=0,h=-32;h<w;++h)p&&(y^=p.charCodeAt((h+32)%p.length)),h===0&&(m=y),y^=y<<10,y^=y>>>15,y^=y<<4,y^=y>>>13,h>=0&&(m=m+1640531527|0,f=x[h&127]^=y+m,d=f==0?d+1:0);for(d>=128&&(x[(p&&p.length||0)&127]=-1),d=127,h=4*128;h>0;--h)y=x[d+34&127],f=x[d=d+1&127],y^=y<<13,f^=f<<17,y^=y>>>15,f^=f>>>12,x[d]=y^f;l.w=m,l.X=x,l.i=d}c(a,i)}function o(i,a){return a.i=i.i,a.w=i.w,a.X=i.X.slice(),a}function s(i,a){i==null&&(i=+new Date);var c=new r(i),l=a&&a.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,y=(c.next()>>>0)/4294967296,d=(f+y)/(1<<21);while(d===0);return d},p.int32=c.next,p.quick=p,l&&(l.X&&o(l,c),p.state=function(){return o(c,{})}),p}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.xor4096=s})(Z5,typeof V2=="object"&&V2,typeof define=="function"&&define)});var t8=Pn((e8,q2)=>{"use strict";(function(n,t,e){function r(i){var a=this,c="";a.next=function(){var p=a.b,f=a.c,y=a.d,d=a.a;return p=p<<25^p>>>7^f,f=f-y|0,y=y<<24^y>>>8^d,d=d-p|0,a.b=p=p<<20^p>>>12^f,a.c=f=f-y|0,a.d=y<<16^f>>>16^d,a.a=d-p|0},a.a=0,a.b=0,a.c=-1640531527,a.d=1367130551,i===Math.floor(i)?(a.a=i/4294967296|0,a.b=i|0):c+=i;for(var l=0;l<c.length+20;l++)a.b^=c.charCodeAt(l)|0,a.next()}function o(i,a){return a.a=i.a,a.b=i.b,a.c=i.c,a.d=i.d,a}function s(i,a){var c=new r(i),l=a&&a.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,y=(c.next()>>>0)/4294967296,d=(f+y)/(1<<21);while(d===0);return d},p.int32=c.next,p.quick=p,l&&(typeof l=="object"&&o(l,c),p.state=function(){return o(c,{})}),p}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.tychei=s})(e8,typeof q2=="object"&&q2,typeof define=="function"&&define)});var C1=Pn(()=>{"use strict"});var n8=Pn((Cct,_1)=>{"use strict";(function(n,t){var e=this,r=256,o=6,s=52,i="random",a=t.pow(r,o),c=t.pow(2,s),l=c*2,p=r-1,f;function y(I,T,D){var O=[];T=T==!0?{entropy:!0}:T||{};var R=x(m(T.entropy?[I,_(n)]:I??w(),3),O),P=new d(O),j=function(){for(var G=P.g(o),Q=a,ie=0;G<c;)G=(G+ie)*r,Q*=r,ie=P.g(1);for(;G>=l;)G/=2,Q/=2,ie>>>=1;return(G+ie)/Q};return j.int32=function(){return P.g(4)|0},j.quick=function(){return P.g(4)/4294967296},j.double=j,x(_(P.S),n),(T.pass||D||function(G,Q,ie,pe){return pe&&(pe.S&&h(pe,P),G.state=function(){return h(P,{})}),ie?(t[i]=G,Q):G})(j,R,"global"in T?T.global:this==t,T.state)}t["seed"+i]=y;function d(I){var T,D=I.length,O=this,R=0,P=O.i=O.j=0,j=O.S=[];for(D||(I=[D++]);R<r;)j[R]=R++;for(R=0;R<r;R++)j[R]=j[P=p&P+I[R%D]+(T=j[R])],j[P]=T;(O.g=function(G){for(var Q,ie=0,pe=O.i,xe=O.j,ne=O.S;G--;)Q=ne[pe=p&pe+1],ie=ie*r+ne[p&(ne[pe]=ne[xe=p&xe+Q])+(ne[xe]=Q)];return O.i=pe,O.j=xe,ie})(r)}function h(I,T){return T.i=I.i,T.j=I.j,T.S=I.S.slice(),T}function m(I,T){var D=[],O=typeof I,R;if(T&&O=="object")for(R in I)try{D.push(m(I[R],T-1))}catch{}return D.length?D:O=="string"?I:I+"\0"}function x(I,T){for(var D=I+"",O,R=0;R<D.length;)T[p&R]=p&(O^=T[p&R]*19)+D.charCodeAt(R++);return _(T)}function w(){try{var I;return f&&(I=f.randomBytes)?I=I(r):(I=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(I)),_(I)}catch{var T=e.navigator,D=T&&T.plugins;return[+new Date,e,D,e.screen,_(n)]}}function _(I){return String.fromCharCode.apply(0,I)}if(x(t.random(),n),typeof _1=="object"&&_1.exports){_1.exports=y;try{f=C1()}catch{}}else typeof define=="function"&&define.amd&&define(function(){return y})})([],Math)});var o8=Pn((_ct,r8)=>{"use strict";var HNe=G5(),KNe=H5(),XNe=X5(),QNe=Y5(),YNe=J5(),ZNe=t8(),eg=n8();eg.alea=HNe;eg.xor128=KNe;eg.xorwow=XNe;eg.xorshift7=QNe;eg.xor4096=YNe;eg.tychei=ZNe;r8.exports=eg});var E1,tg,T1,I1,E0=b(()=>{"use strict";E1=Jb(o8());tg=class{constructor(t,e,r,o,s){this.mean=t,this.stdDev=e,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);let i=s||Math.random();this.random=E1.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){let o=this.nextVal;return this.nextVal=NaN,o}let t,e,r=!1;for(;!r;){let o,s,i;do o=2*this.random()-1,s=2*this.random()-1,i=o*o+s*s;while(i>=1||i===0);let a=Math.sqrt(-2*Math.log(i)/i);t=this.mean+this.stdDev*o*a,e=this.mean+this.stdDev*s*a,(!this.truncated||this.isValidTruncated(t))&&(r=!0)}return(!this.truncated||this.isValidTruncated(e))&&(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}},T1=class{constructor(t,e,r,o){this.alpha=t,this.beta=1/e,this.dtype=r;let s=o||Math.random();this.randu=E1.alea(s.toString()),this.randn=new tg(0,1,r,!1,this.randu()),t<1?this.d=t+2/3:this.d=t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,r,o,s,i;for(;;){do o=this.randn.nextValue(),i=1+this.c*o;while(i<=0);if(i*=i*i,t=o*o,e=1-.331*t*t,r=.5*t+this.d*(1-i+Math.log(i)),s=this.randu(),s<e||Math.log(s)<r)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(t){return this.dtype==="float32"?t:Math.round(t)}},I1=class{constructor(t=0,e=1,r,o){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=e-t,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${e} <= 1 and dtype is not float`);this.random=E1.alea(o)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}});function JNe(n,t,e=1,r="float32",o){if(e==null&&(e=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);let s=new T1(t,e,r,o),i=It(n,r);for(let a=0;a<i.values.length;a++)i.values[a]=s.nextValue();return i.toTensor()}var s8,i8=b(()=>{"use strict";Jp();ye();E0();s8=z({randomGamma_:JNe})});function eDe(n,t=0,e=1,r,o){if(r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);let s=new tg(t,e,r,!1,o),i=It(n,r);for(let a=0;a<i.values.length;a++)i.values[a]=s.nextValue();return i.toTensor()}var N0,a8=b(()=>{"use strict";Jp();ye();E0();N0=z({randomNormal_:eDe})});function tDe(n,t=0,e=1,r="float32",o){let s=It(n,r),i=new I1(t,e,null,o);for(let a=0;a<s.values.length;a++)s.values[a]=i.nextValue();return s.toTensor()}var Sa,U2=b(()=>{"use strict";Jp();ye();E0();Sa=z({randomUniform_:tDe})});function ng(n,t,e=1,r="float32"){if(e===0)throw new Error("Cannot have a step of zero");let o={start:n,stop:t,step:e,dtype:r};return U.runKernel(Nm,{},o)}var j2=b(()=>{"use strict";Ee();ae();});function nDe(n){let e={input:A(n,"input","real")};return U.runKernel(Dm,e)}var ih,N1=b(()=>{"use strict";Ee();ae();Se();ye();ih=z({real_:nDe})});function rDe(n){let e={x:A(n,"x","reciprocal")};return U.runKernel(Ou,e)}var pv,c8=b(()=>{"use strict";Ee();ae();Se();ye();pv=z({reciprocal_:rDe})});function oDe(n){let e={x:A(n,"x","relu")};return U.runKernel(Mu,e)}var zo,hv=b(()=>{"use strict";Ee();ae();Se();ye();zo=z({relu_:oDe})});function sDe(n){let e={x:A(n,"x","relu6")};return U.runKernel(Ru,e)}var Rf,D1=b(()=>{"use strict";Ee();ae();Se();ye();Rf=z({relu6_:sDe})});function iDe(n,t){let r={x:A(n,"x","reverse")},o={dims:t};return U.runKernel(zp,r,o)}var $r,ah=b(()=>{"use strict";Ee();ae();Se();ye();$r=z({reverse_:iDe})});function aDe(n){let t=A(n,"x","reverse");return q(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),$r(t,0)}var u8,l8=b(()=>{"use strict";Se();ze();ye();ah();u8=z({reverse1d_:aDe})});function cDe(n,t){let e=A(n,"x","reverse");return q(e.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${e.rank}.`),$r(e,t)}var p8,h8=b(()=>{"use strict";Se();ze();ye();ah();p8=z({reverse2d_:cDe})});function uDe(n,t){let e=A(n,"x","reverse");return q(e.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${e.rank}.`),$r(e,t)}var f8,d8=b(()=>{"use strict";Se();ze();ye();ah();f8=z({reverse3d_:uDe})});function lDe(n,t){let e=A(n,"x","reverse");return q(e.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${e.rank}.`),$r(e,t)}var m8,g8=b(()=>{"use strict";Se();ze();ye();ah();m8=z({reverse4d_:lDe})});function pDe(n){let e={x:A(n,"x","round")};return U.runKernel(Pu,e)}var fv,y8=b(()=>{"use strict";Ee();ae();Se();ye();fv=z({round_:pDe})});function hDe(n){let e={x:A(n,"x","rsqrt")};return U.runKernel(Fu,e)}var Pf,G2=b(()=>{"use strict";Ee();ae();Se();ye();Pf=z({rsqrt_:hDe})});function it(n,t){if((xo(n)&&t!=="string"||Array.isArray(n))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&xo(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Os(n,[],[],t)}var sr=b(()=>{"use strict";ze();Yp();});function fDe(n){let e={x:A(n,"x","selu")};return U.runKernel($u,e)}var Ff,W2=b(()=>{"use strict";Ee();ae();Se();ye();Ff=z({selu_:fDe})});function dDe(n,t,e,r,o,s=[1,1],i="NHWC"){let a=A(n,"x","separableConv2d"),c=A(t,"depthwiseFilter","separableConv2d"),l=A(e,"pointwiseFilter","separableConv2d"),p=a,f=!1;if(a.rank===3&&(f=!0,p=ue(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");q(p.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${p.rank}.`),q(c.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${c.rank}.`),q(l.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${c.rank}.`),q(l.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${l.shape[0]}.`),q(l.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${l.shape[1]}.`);let y=c.shape[2],d=c.shape[3];q(l.shape[2]===y*d,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${y*d}, but got ${l.shape[2]}.`);let h=Si(p,c,r,o,i,s),x=vs(h,l,1,"valid",i);return f?ue(x,[x.shape[1],x.shape[2],x.shape[3]]):x}var dv,H2=b(()=>{"use strict";Se();ze();Xm();Yx();ye();bt();dv=z({separableConv2d_:dDe})});function mDe(n,t){return Y(this,null,function*(){let e=A(n,"x","setdiff1d"),r=A(t,"y","setdiff1d");q(e.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${e.dtype}) and y (${r.dtype}).`),q(e.rank===1,()=>`x should be 1D tensor, but got x (${e.shape}).`),q(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);let o=yield e.data(),s=yield r.data(),i=new Set(s),a=0;for(let p=0;p<o.length;p++)i.has(o[p])||a++;let c=new Dn([a],e.dtype),l=new Dn([a],"int32");for(let p=0,f=0;p<o.length;p++)i.has(o[p])||(c.values[f]=o[p],l.values[f]=p,f++);return[c.toTensor(),l.toTensor()]})}var k1,x8=b(()=>{"use strict";Ae();Se();ze();k1=mDe});function gDe(n){let e={x:A(n,"x","sign")};return U.runKernel(Bu,e)}var mv,v8=b(()=>{"use strict";Ee();ae();Se();ye();mv=z({sign_:gDe})});function yDe(n){let e={x:A(n,"x","sin")};return U.runKernel(Lu,e)}var $f,K2=b(()=>{"use strict";Ee();ae();Se();ye();$f=z({sin_:yDe})});function xDe(n){let e={x:A(n,"x","sinh")};return U.runKernel(zu,e)}var Lf,X2=b(()=>{"use strict";Ee();ae();Se();ye();Lf=z({sinh_:xDe})});function vDe(n,t,e){let r=A(n,"x","slice1d");return q(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Bt(r,[t],[e])}var gv,b8=b(()=>{"use strict";Se();ze();ye();Ys();gv=z({slice1d_:vDe})});function bDe(n,t,e){let r=A(n,"x","slice2d");return q(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Bt(r,t,e)}var D0,w8=b(()=>{"use strict";Se();ze();ye();Ys();D0=z({slice2d_:bDe})});function wDe(n,t,e){let r=A(n,"x","slice3d");return q(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Bt(r,t,e)}var yv,S8=b(()=>{"use strict";Se();ze();ye();Ys();yv=z({slice3d_:wDe})});function SDe(n,t,e){let r=A(n,"x","slice4d");return q(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Bt(r,t,e)}var rg,C8=b(()=>{"use strict";Se();ze();ye();Ys();rg=z({slice4d_:SDe})});function CDe(n,t=-1){let e=A(n,"logits","softmax","float32");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and dim was ${t}`);let r={logits:e},o={dim:t};return U.runKernel(Gp,r,o)}var fl,_8=b(()=>{"use strict";Ee();ae();Se();ye();fl=z({softmax_:CDe})});function _De(n){q(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);let t={input:n};return U.runKernel(hm,t)}var dl,A1=b(()=>{"use strict";Ee();ae();ze();ye();dl=z({fft_:_De})});function TDe(n){q(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);let t={input:n};return U.runKernel(gm,t)}var gc,O1=b(()=>{"use strict";Ee();ae();ze();ye();gc=z({ifft_:TDe})});function IDe(n){let t=n.shape[n.shape.length-1],e=n.size/t,r;if(t<=2){let o=ue(n,[e,t]);r=gc(o)}else{let o=[e,2*(t-1)],s=ue(ih(n),[e,t]),i=ue(If(n),[e,t]),a=$r(Bt(s,[0,1],[e,t-2]),1),c=oe($r(Bt(i,[0,1],[e,t-2]),1),it(-1)),l=gn([s,a],1),p=gn([i,c],1),f=ue(Xs(l,p),[o[0],o[1]]);r=gc(f)}if(r=ih(r),n.rank===3&&n.shape[0]!==0){let o=r,s=n.shape[0];r=ue(r,[s,r.shape[0]/s,r.shape[1]]),o.dispose()}return r}var zf,Q2=b(()=>{"use strict";zm();wi();s1();Rt();ye();N1();bt();ah();sr();Ys();O1();zf=z({irfft_:IDe})});function EDe(n,t,e=0){let o={x:A(n,"x","split")},s={numOrSizeSplits:t,axis:e};return U.runKernel(jp,o,s)}var co,xv=b(()=>{"use strict";Ee();ae();Se();ye();co=z({split_:EDe})});function NDe(n,t){q(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let e=n.shape[n.shape.length-1],r=n.size/e,o;if(t!=null&&t<e){let h=n.shape.map(x=>0),m=n.shape.map(x=>x);m[n.shape.length-1]=t,o=Bt(n,h,m),e=t}else if(t!=null&&t>e){let h=n.shape.map(m=>m);h[n.shape.length-1]=t-e,o=gn([n,An(h)],n.shape.length-1),e=t}else o=n;let s=Et(o),i=ue(Xs(o,s),[r,e]),a=dl(i),c=Math.floor(e/2)+1,l=ih(a),p=If(a),f=co(l,[c,e-c],l.shape.length-1),y=co(p,[c,e-c],p.shape.length-1),d=o.shape.slice();return d[o.shape.length-1]=c,ue(Xs(f[0],y[0]),d)}var ml,M1=b(()=>{"use strict";ze();zm();wi();s1();ye();N1();bt();Ys();xv();Jm();gr();A1();ml=z({rfft_:NDe})});function DDe(n){let e={x:A(n,"x","sqrt")};return U.runKernel(Uu,e)}var jn,yc=b(()=>{"use strict";Ee();ae();Se();ye();jn=z({sqrt_:DDe})});function kDe(n,t){let e=A(n,"a","squaredDifference"),r=A(t,"b","squaredDifference");[e,r]=sn(e,r),Zt(e.shape,r.shape);let o={a:e,b:r},s={};return U.runKernel(ju,o,s)}var gl,k0=b(()=>{"use strict";Ee();ae();br();Se();lr();ye();gl=z({squaredDifference_:kDe})});function ADe(n,t){let e=A(n,"x","squeeze");return ue(e,aR(e.shape,t).newShape)}var Js,A0=b(()=>{"use strict";Se();ze();ye();bt();Js=z({squeeze_:ADe})});function ODe(n,t=0){let e=Qp(n,"tensors","stack","string_or_numeric");q(e.length>=1,()=>"Pass at least one tensor to tf.stack"),e.length>0&&q(t<=e[0].rank,()=>"Axis must be <= rank of the tensor");let r=e,o={axis:t};return U.runKernel(Mp,r,o)}var Ir,og=b(()=>{"use strict";Ee();ae();Se();ze();ye();Ir=z({stack_:ODe})});function MDe(n,t=0){let r={x:A(n,"x","step")},o={alpha:t};return U.runKernel(Ku,r,o)}var Ca,vv=b(()=>{"use strict";Ee();ae();Se();ye();Ca=z({step_:MDe})});function RDe(n,t,e,r,o=0,s=0,i=0,a=0,c=0){let p={x:A(n,"x","stridedSlice")},f={begin:t,end:e,strides:r,beginMask:o,endMask:s,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:c};return U.runKernel(Pm,p,f)}var bv,T8=b(()=>{"use strict";Ee();ae();Se();ye();bv=z({stridedSlice_:RDe})});function PDe(n){let e={x:A(n,"x","tan")};return U.runKernel(Wu,e)}var wv,I8=b(()=>{"use strict";Ee();ae();Se();ye();wv=z({tan_:PDe})});function Er(n,t){zi(n);let e=Xo(n,t);if(e.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Os(n,null,e,t)}var Sv=b(()=>{"use strict";Se();ze();Yp();});function xc(n,t,e){if(zi(n),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");let r=Xo(n,e);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Os(n,t,r,e)}var R1=b(()=>{"use strict";Se();ze();Yp();});function E8(n,t,e){if(zi(n),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");let r=Xo(n,e);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Os(n,t,r,e)}var N8=b(()=>{"use strict";Se();ze();Yp();});function D8(n,t,e){if(zi(n),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");let r=Xo(n,e);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Os(n,t,r,e)}var k8=b(()=>{"use strict";Se();ze();Yp();});function A8(n,t,e){if(zi(n),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");let r=Xo(n,e);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,Os(n,t,r,e)}var O8=b(()=>{"use strict";Se();ze();Yp();});function FDe(n,t=1,e=!0){let r=A(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");let o=r.shape[r.shape.length-1];if(t>o)throw new Error(`'k' passed to topk() must be <= the last dimension (${o}) but got ${t}`);let s={x:r},i={k:t,sorted:e},[a,c]=U.runKernel(Fm,s,i);return{values:a,indices:c}}var Cv,Y2=b(()=>{"use strict";Ee();ae();Se();ye();Cv=z({topk_:FDe})});function $De(n,t=0,e=1,r,o){if(r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");let s=new tg(t,e,r,!0,o),i=It(n,r);for(let a=0;a<i.values.length;a++)i.values[a]=s.nextValue();return i.toTensor()}var Bf,M8=b(()=>{"use strict";Jp();ye();E0();Bf=z({truncatedNormal_:$De})});function LDe(n,t=0){let e=A(n,"x","unique","string_or_numeric");q(e.rank>0,()=>"The input tensor must be at least 1D");let r={x:e},o={axis:t},[s,i]=U.runKernel($m,r,o);return{values:s,indices:i}}var sg,Z2=b(()=>{"use strict";Ee();ae();Se();ze();ye();sg=z({unique_:LDe})});function zDe(n,t,e){let r=A(n,"x","unsortedSegmentSum"),o=A(t,"segmentIds","unsortedSegmentSum","int32");q(Nn(e),()=>"numSegments must be of dtype int");let s={x:r,segmentIds:o},i={numSegments:e};return U.runKernel(Kp,s,i)}var _v,P1=b(()=>{"use strict";Ee();ae();Se();ze();ye();_v=z({unsortedSegmentSum_:zDe})});function BDe(n,t=0){let e=A(n,"x","unstack","string_or_numeric");q(t>=-e.shape.length&&t<e.shape.length,()=>`Axis = ${t} is not in [-${e.shape.length}, ${e.shape.length})`);let r={value:e},o={axis:t};return U.runKernel(Hp,r,o)}var uo,Tv=b(()=>{"use strict";Ee();ae();Se();ze();ye();uo=z({unstack_:BDe})});function F1(n,t=!0,e,r){return U.makeVariable(n,t,e,r)}var R8=b(()=>{"use strict";Ee();});function $1(n,t){let e=[];for(let s=0;s<t.length;s++)t[s]&&e.push(s);let r=It(n,"int32"),o=It([e.length,n.length],"int32");for(let s=0;s<e.length;s++){let i=r.indexToLoc(e[s]),a=s*n.length;o.values.set(i,a)}return o.toTensor()}var J2=b(()=>{"use strict";Jp();});function VDe(n){return Y(this,null,function*(){let t=A(n,"condition","whereAsync","bool"),e=yield t.data(),r=$1(t.shape,e);return n!==t&&t.dispose(),r})}var Iv,eP=b(()=>{"use strict";J2();Se();Iv=VDe});function qDe(n,t,e){return Y(this,null,function*(){let r=A(n,"tensor","boolMask"),o=A(t,"mask","boolMask","bool"),s=e??0,i=o.rank,a=r.shape;q(i>0,()=>"mask cannot be scalar"),rn(a.slice(s,s+i),o.shape,"mask's shape must match the first K dimensions of tensor's shape,");let c=1;for(let m=s;m<s+i;m++)c*=a[m];let l=a.slice(0,s).concat([c],a.slice(s+i)),p=ue(r,l),f=ue(o,[-1]),y=yield Iv(f),d=Js(y,[1]),h=ji(p,d,s);return n!==r&&r.dispose(),t!==o&&o.dispose(),d.dispose(),p.dispose(),f.dispose(),y.dispose(),h})}var UDe,P8=b(()=>{"use strict";Se();ze();x0();bt();A0();eP();UDe=qDe});function jDe(n,t){Pr("strict variants of ops have been deprecated and will be removed in future");let e=A(n,"a","notEqualStrict"),r=A(t,"b","notEqualStrict");return rn(e.shape,r.shape,"Error in notEqualStrict: "),Zs(e,r)}function GDe(n,t){Pr("strict variants of ops have been deprecated and will be removed in future");let e=A(n,"a","lessStrict"),r=A(t,"b","lessStrict");return rn(e.shape,r.shape,"Error in lessStrict: "),cl(e,r)}function WDe(n,t){Pr("strict variants of ops have been deprecated and will be removed in future");let e=A(n,"a","equalStrict"),r=A(t,"b","equalStrict");return rn(e.shape,r.shape,"Error in equalStrict: "),bs(e,r)}function HDe(n,t){Pr("strict variants of ops have been deprecated and will be removed in future");let e=A(n,"a","lessEqualStrict"),r=A(t,"b","lessEqualStrict");return rn(e.shape,r.shape,"Error in lessEqualStrict: "),Rs(e,r)}function KDe(n,t){Pr("strict variants of ops have been deprecated and will be removed in future");let e=A(n,"a","greaterStrict"),r=A(t,"b","greaterStrict");return rn(e.shape,r.shape,"Error in greaterStrict: "),Fr(e,r)}function XDe(n,t){Pr("strict variants of ops have been deprecated and will be removed in future");let e=A(n,"a","greaterEqualStrict"),r=A(t,"b","greaterEqualStrict");return rn(e.shape,r.shape,"Error in greaterEqualStrict: "),Yo(e,r)}var tP,nP,rP,oP,sP,iP,F8=b(()=>{"use strict";Ms();Se();ze();Jx();il();Tf();v0();Ef();T0();ye();tP=z({equalStrict_:WDe}),nP=z({greaterEqualStrict_:XDe}),rP=z({greaterStrict_:KDe}),oP=z({lessEqualStrict_:HDe}),sP=z({lessStrict_:GDe}),iP=z({notEqualStrict_:jDe})});function QDe(n,t){Pr("strict variants of ops have been deprecated and will be removed in future");let e=A(n,"a","addStrict"),r=A(t,"b","addStrict");return rn(e.shape,r.shape,"Error in addStrict: "),je(e,r)}function YDe(n,t){Pr("strict variants of ops have been deprecated and will be removed in future");let e=A(n,"a","subStrict"),r=A(t,"b","subStrict");return rn(e.shape,r.shape,"Error in subStrict: "),at(e,r)}function ZDe(n,t){return Pr("strict variants of ops have been deprecated and will be removed in future"),rn(n.shape,t.shape,"Error in powStrict: "),Eo(n,t)}function JDe(n,t){Pr("strict variants of ops have been deprecated and will be removed in future");let e=A(n,"a","mul"),r=A(t,"b","mul");return rn(e.shape,r.shape,"Error in multiplyStrict: "),oe(e,r)}function eke(n,t){Pr("strict variants of ops have been deprecated and will be removed in future");let e=A(n,"a","div"),r=A(t,"b","div");return rn(e.shape,r.shape,"Error in divideStrict: "),ct(e,r)}function tke(n,t){Pr("strict variants of ops have been deprecated and will be removed in future");let e=A(n,"a","modStrict"),r=A(t,"b","modStrict");return rn(e.shape,r.shape,"Error in modStrict: "),Af(e,r)}function nke(n,t){Pr("strict variants of ops have been deprecated and will be removed in future");let e=A(n,"a","minimumStrict"),r=A(t,"b","minimumStrict");return rn(e.shape,r.shape,"Error in minimumStrict: "),_i(e,r)}function rke(n,t){Pr("strict variants of ops have been deprecated and will be removed in future");let e=A(n,"a","maximumStrict"),r=A(t,"b","maximumStrict");return rn(e.shape,r.shape,"Error in maximumStrict: "),$o(e,r)}function oke(n,t){Pr("strict variants of ops have been deprecated and will be removed in future");let e=A(n,"a","squaredDifferenceStrict"),r=A(t,"b","squaredDifferenceStrict");return rn(e.shape,r.shape,"Error in squaredDifferenceStrict: "),gl(e,r)}var aP,cP,uP,lP,pP,hP,fP,dP,mP,$8=b(()=>{"use strict";Ms();Se();ze();mr();qn();cv();_0();v1();Rt();ye();sh();k0();Hn();aP=z({addStrict_:QDe}),cP=z({divStrict_:eke}),uP=z({maximumStrict_:rke}),lP=z({minimumStrict_:nke}),pP=z({modStrict_:tke}),hP=z({mulStrict_:JDe}),fP=z({powStrict_:ZDe}),dP=z({squaredDifferenceStrict_:oke}),mP=z({subStrict_:YDe})});function ske(n,t="euclidean",e=null,r=!1){n=A(n,"x","norm");let o=L8(n,t,e),s=o.shape;if(r){let i=no(e,n.shape);s=wa(o.shape,i)}return ue(o,s)}function L8(n,t,e=null){if(n.rank===0)return Jn(n);if(n.rank!==1&&e===null)return L8(ue(n,[-1]),t,e);if(n.rank===1||typeof e=="number"||Array.isArray(e)&&e.length===1){if(t===1)return gt(Jn(n),e);if(t===1/0)return io(Jn(n),e);if(t===-1/0)return mc(Jn(n),e);if(t==="euclidean"||t===2)return jn(gt(Eo(Jn(n),it(2,"int32")),e));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(e)&&e.length===2){if(t===1)return io(gt(Jn(n),e[0]),e[1]-1);if(t===1/0)return io(gt(Jn(n),e[1]),e[0]);if(t===-1/0)return mc(gt(Jn(n),e[1]),e[0]);if(t==="fro"||t==="euclidean")return jn(gt(Gt(n),e));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${e}`)}var ig,L1=b(()=>{"use strict";Se();ze();Wm();dc();sv();x1();ye();sh();bt();sr();yc();ao();Hr();ig=z({norm_:ske})});function ike(n,t,e,r,o=!0){let s=A(n,"v","movingAverage"),i=A(t,"x","movingAverage"),a=A(e,"decay","movingAverage");IR(s,i),q(As(s.shape,i.shape),()=>"Shape mismatch in v and x");let c=it(1),l=at(c,a),p=oe(at(i,s),l);if(o){q(r!=null,()=>"When using zeroDebias: true, step is required.");let f=A(r,"step","movingAverage");p=ct(p,at(c,Eo(a,f)))}return je(s,p)}var ake,z8=b(()=>{"use strict";br();Se();ze();mr();qn();Rt();ye();sh();sr();Hn();ake=z({movingAverage_:ike})});function cke(n,t,e){let r=A(n,"indices","scatterND","int32"),o=A(t,"updates","scatterND");kI(o,r,e);let s={indices:r,updates:o},i={shape:e};return U.runKernel(Om,s,i)}var gP,B8=b(()=>{"use strict";Ee();ae();Se();ye();OI();gP=z({scatterND_:cke})});function V8(n,t,e,r){if(n.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);let o=n.rank>0?n.shape[0]:1,s=n.rank>1?n.shape[1]:1;if(e.length!==s)throw new Error(`outputShape has incorrect number of elements:, ${e.length}, should be: ${s}.`);let i=t.size;if(!(t.rank===0||t.rank===1&&i===o))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${o}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}var q8=b(()=>{"use strict"});function lke(n,t,e,r=0){let o=A(n,"sparseIndices","sparseToDense","int32"),s=A(t,"sparseValues","sparseToDense"),i=A(r,"defaultValue","sparseToDense",s.dtype);V8(o,s,e,i);let a={sparseIndices:o,sparseValues:s,defaultValue:i},c={outputShape:e};return U.runKernel(Rm,a,c)}var O0,U8=b(()=>{"use strict";Ee();ae();q8();Se();ye();O0=z({sparseToDense_:lke})});function pke(n,t){let e=A(t,"indices","gatherND","int32"),o={params:A(n,"x","gatherND"),indices:e};return U.runKernel(mm,o)}var yP,j8=b(()=>{"use strict";Ee();ae();Se();ye();yP=z({gatherND_:pke})});function G8(n,t){if(t==null)return n.shape.slice();if(As(n.shape,t))return t;if(n.shape.length===t.length){let e=[];for(let r=0;r<n.shape.length;r++)t[r]==null&&n.shape[r]!=null?e.push(n.shape[r]):e.push(t[r]);return e}return t}var W8=b(()=>{"use strict";ze();});function hke(n,t,e,r){let o=A(n,"x","dropout");if(q(o.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${o.dtype} tensor instead.`),q(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return n instanceof K?o.clone():o;let s=G8(o,e),i=1-t,a=ct(va(je(Sa(s,0,1,"float32",r),i)),i);return oe(o,a)}var xP,H8=b(()=>{"use strict";Ae();Se();ze();mr();qn();W8();o1();Rt();ye();U2();xP=z({dropout_:hke})});function vP(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function M0(n,t,e){let r=1-n%2,o=new Float32Array(n);for(let s=0;s<n;++s){let i=2*Math.PI*s/(n+r-1);o[s]=t-e*Math.cos(i)}return Er(o,"float32")}var R0=b(()=>{"use strict";Sv();});function fke(n,t,e=1){return Y(this,null,function*(){let r=A(n,"predictions","inTopK"),o=A(t,"targets","inTopK");q(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),q(r.rank-1===o.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${o.rank}`),rn(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");let s=r.shape[r.shape.length-1];q(e>0&&e<=s,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${s}), but got ${e}`);let i=yield r.data(),a=yield o.data(),[c,l]=[i.length/s,s],p=cR("bool",c);for(let f=0;f<c;f++){let y=f*l,d=i.subarray(y,y+l),h=[];for(let m=0;m<d.length;m++)h.push({value:d[m],index:m});h.sort((m,x)=>x.value-m.value),p[f]=0;for(let m=0;m<e;m++)if(h[m].index===a[f]){p[f]=1;break}}return n!==r&&r.dispose(),t!==o&&o.dispose(),Qo(p,o.shape,"bool")})}var dke,K8=b(()=>{"use strict";Se();ze();vI();dke=fke});function mke(n,t,e,r,o,s="NHWC",i){let a=n;n.rank===3&&(a=ue(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let c=t;c.rank===3&&(c=ue(t,[1,t.shape[0],t.shape[1],t.shape[2]])),q(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),q(c.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${c.shape}.`),q(e.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${e}.`);let l=s==="NHWC"?a.shape[3]:a.shape[1],p=s==="NHWC"?c.shape[3]:c.shape[1];q(l===e[2],()=>`Error in conv2dDerFilter: depth of input ${l}) must match input depth in filter (${e[2]}.`),q(p===e[3],()=>`Error in conv2dDerFilter: depth of dy (${p}) must match output depth for filter (${e[3]}).`),i!=null&&q(Nn(o),()=>`Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode ${i} but got pad ${o}.`);let f={x:a,dy:c},y={strides:r,pad:o,dataFormat:s,dimRoundingMode:i,filterShape:e};return U.runKernel(nm,f,y)}var Ev,z1=b(()=>{"use strict";Ee();ae();ze();ye();bt();Ev=z({conv2DBackpropFilter_:mke})});function ag(n,t,e){if(e==null||e==="linear")return n;if(e==="relu")return oe(n,Ca(t));throw new Error(`Cannot compute gradient for fused activation ${e}.`)}function cg(n,t){let e=t,r=er(n.shape,t.shape);return r.length>0&&(e=gt(e,r)),ue(e,n.shape)}function ug(n,t,e,r){if(t==="linear")return n;if(t==="relu")return zo(n);if(t==="elu")return xa(n);if(t==="relu6")return Rf(n);if(t==="prelu")return hl(n,e);if(t==="leakyrelu")return al(n,r);throw new Error(`Unknown fused activation ${t}.`)}var lg,Nv=b(()=>{"use strict";lr();n1();u1();Rt();S1();hv();D1();bt();vv();Hr();lg=(n,t)=>!(n>0)||t==="linear"});function gke({x:n,filter:t,strides:e,pad:r,dataFormat:o="NHWC",dilations:s=[1,1],dimRoundingMode:i,bias:a,activation:c="linear",preluActivationWeights:l,leakyreluAlpha:p}){if(c=c||"linear",lg(U.state.gradientDepth,c)===!1){let D=vs(n,t,e,r,o,s,i);return a!=null&&(D=je(D,a)),ug(D,c,l,p)}let f=A(n,"x","conv2d"),y=A(t,"filter","conv2d"),d=f,h=!1;f.rank===3&&(h=!0,d=ue(f,[1,f.shape[0],f.shape[1],f.shape[2]])),q(d.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${d.rank}.`),q(y.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${y.rank}.`),i!=null&&q(Nn(r),()=>`Error in fused conv2d: pad must be an integer when using, dimRoundingMode ${i} but got pad ${r}.`),q(d.shape[3]===y.shape[2],()=>`Error in conv2d: depth of input (${d.shape[3]}) must match input depth for filter ${y.shape[2]}.`),q(wr(e,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`),q(o==="NHWC",()=>`Error in conv2d: got dataFormat of ${o} but only NHWC is currently supported.`);let m=Km(d.shape,y.shape,e,s,r,i),x;a!=null&&(x=A(a,"bias","fused conv2d"),[x]=sn(x,f),Zt(m.outShape,x.shape));let w;l!=null&&(w=A(l,"prelu weights","fused conv2d"));let _=(D,O)=>{let[R,P,j,G]=O,Q=ag(D,j,c);q(Vi(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);let ie=Kx(P.shape,Q,R,e,r),pe=Ev(P,Q,R.shape,e,r),xe=[ie,pe];if(G!=null){let ne=cg(G,Q);xe.push(ne)}return xe},I={x:d,filter:y,bias:x,preluActivationWeights:w},T={strides:e,pad:r,dataFormat:o,dilations:s,dimRoundingMode:i,activation:c,leakyreluAlpha:p};return a==null?ws((O,R,P)=>{let j=U.runKernel(pf,I,T);return P([R,O,j]),h&&(j=ue(j,[j.shape[1],j.shape[2],j.shape[3]])),{value:j,gradFunc:_}})(d,y):ws((O,R,P,j)=>{let G=U.runKernel(pf,I,T);return j([R,O,G,P]),h&&(G=ue(G,[G.shape[1],G.shape[2],G.shape[3]])),{value:G,gradFunc:_}})(d,y,x)}var X8,Q8=b(()=>{"use strict";Ee();oh();ae();br();Se();ze();mr();lr();Xm();z1();QI();ys();Nv();ye();bt();X8=z({fusedConv2d_:gke})});function yke(n,t,e,r,o,s=[1,1],i){let a=n;n.rank===3&&(a=ue(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let c=t;c.rank===3&&(c=ue(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l={x:a,dy:c},p={strides:r,pad:o,dimRoundingMode:i,dilations:s,filterShape:e};return U.runKernel(cm,l,p)}var B1,bP=b(()=>{"use strict";Ee();ae();ye();bt();B1=z({depthwiseConv2dNativeBackpropFilter_:yke})});function xke(n,t,e,r,o,s=[1,1],i){let a=t,c=!1;t.rank===3&&(c=!0,a=ue(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l={dy:a,filter:e},p={strides:r,pad:o,dimRoundingMode:i,dilations:s,inputShape:n},f=U.runKernel(um,l,p);return c?ue(f,[f.shape[1],f.shape[2],f.shape[3]]):f}var V1,wP=b(()=>{"use strict";Ee();ae();ye();bt();V1=z({depthwiseConv2dNativeBackpropInput_:xke})});function vke({x:n,filter:t,strides:e,pad:r,dataFormat:o="NHWC",dilations:s=[1,1],dimRoundingMode:i,bias:a,activation:c="linear",preluActivationWeights:l,leakyreluAlpha:p}){if(lg(U.state.gradientDepth,c)===!1){let D=Si(n,t,e,r,o,s,i);return a!=null&&(D=je(D,a)),ug(D,c,l,p)}let f=A(n,"x","depthwiseConv2d"),y=A(t,"filter","depthwiseConv2d"),d=f,h=!1;f.rank===3&&(h=!0,d=ue(f,[1,f.shape[0],f.shape[1],f.shape[2]])),q(d.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${d.rank}.`),q(y.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${y.rank}.`),q(d.shape[3]===y.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${d.shape[3]}) must match the inChannels dimension in filter ${y.shape[2]}.`),s==null&&(s=[1,1]),q(wr(e,s),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`),i!=null&&q(Nn(r),()=>`Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode ${i} but got pad ${r}.`);let m=Km(d.shape,y.shape,e,s,r,i,!0),x;a!=null&&(x=A(a,"bias","fused conv2d"),[x]=sn(x,f),Zt(m.outShape,x.shape));let w;l!=null&&(w=A(l,"prelu weights","fused depthwiseConv2d"));let _=(D,O)=>{q(Vi(s),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);let[R,P,j,G]=O,Q=ag(D,j,c),ie=V1(P.shape,Q,R,e,r,s,i),pe=B1(P,Q,R.shape,e,r,s,i);if(G!=null){let xe=cg(x,Q);return[ie,pe,xe]}return[ie,pe]},I={x:d,filter:y,bias:x,preluActivationWeights:w},T={strides:e,pad:r,dataFormat:o,dilations:s,dimRoundingMode:i,activation:c,leakyreluAlpha:p};return a==null?ws((O,R,P)=>{let j=U.runKernel(hf,I,T);return P([R,O,j]),h&&(j=ue(j,[j.shape[1],j.shape[2],j.shape[3]])),{value:j,gradFunc:_}})(d,y):ws((O,R,P,j)=>{let G=U.runKernel(hf,I,T);return j([R,O,G,P]),h&&(G=ue(G,[G.shape[1],G.shape[2],G.shape[3]])),{value:G,gradFunc:_}})(d,y,x)}var Y8,Z8=b(()=>{"use strict";Ee();oh();ae();br();Se();ze();mr();lr();ys();Yx();bP();wP();Nv();ye();bt();Y8=z({fusedDepthwiseConv2d_:vke})});function bke({a:n,b:t,transposeA:e=!1,transposeB:r=!1,bias:o,activation:s="linear",preluActivationWeights:i,leakyreluAlpha:a}){if(lg(U.state.gradientDepth,s)===!1){let G=an(n,t,e,r);return o!=null&&(G=je(G,o)),ug(G,s,i,a)}let c=A(n,"a","fused matMul"),l=A(t,"b","fused matMul");[c,l]=sn(c,l);let p=e?c.shape[c.rank-2]:c.shape[c.rank-1],f=r?l.shape[l.rank-1]:l.shape[l.rank-2],y=e?c.shape[c.rank-1]:c.shape[c.rank-2],d=r?l.shape[l.rank-2]:l.shape[l.rank-1],h=c.shape.slice(0,-2),m=l.shape.slice(0,-2),x=Vn(h),w=Vn(m);q(c.rank>=2&&l.rank>=2&&c.rank===l.rank,()=>`Error in fused matMul: inputs must have the same rank of at least 2, got ranks ${c.rank} and ${l.rank}.`),q(As(h,m),()=>`Error in fused matMul: outer dimensions (${h}) and (${m}) of Tensors with shapes ${c.shape} and ${l.shape} must match.`),q(p===f,()=>`Error in fused matMul: inner shapes (${p}) and (${f}) of Tensors with shapes ${c.shape} and ${l.shape} and transposeA=${e} and transposeB=${r} must match.`);let _=c.shape.slice(0,-2).concat([y,d]),I=e?ue(c,[x,p,y]):ue(c,[x,y,p]),T=r?ue(l,[w,d,f]):ue(l,[w,f,d]),D;o!=null&&(D=A(o,"bias","fused matMul"),[D]=sn(D,c),Zt(_,D.shape));let O;i!=null&&(O=A(i,"prelu weights","fused matMul"));let R=(G,Q)=>{let[ie,pe,xe,ne]=Q,fe=ag(ue(G,xe.shape),xe,s),te,se;if(!e&&!r?(te=an(fe,pe,!1,!0),se=an(ie,fe,!0,!1)):!e&&r?(te=an(fe,pe,!1,!1),se=an(fe,ie,!0,!1)):e&&!r?(te=an(pe,fe,!1,!0),se=an(ie,fe,!1,!1)):(te=an(pe,fe,!0,!0),se=an(fe,ie,!0,!0)),o!=null){let ee=cg(ne,fe);return[te,se,ee]}else return[te,se]},P={a:I,b:T,bias:D,preluActivationWeights:O},j={transposeA:e,transposeB:r,activation:s,leakyreluAlpha:a};return o==null?ws((Q,ie,pe)=>{let xe=U.runKernel(lf,P,j);return pe([Q,ie,xe]),{value:ue(xe,_),gradFunc:R}})(I,T):ws((Q,ie,pe,xe)=>{let ne=U.runKernel(lf,P,j);return xe([Q,ie,ne,pe]),{value:ue(ne,_),gradFunc:R}})(I,T,D)}var J8,e6=b(()=>{"use strict";Ee();oh();ae();br();Se();ze();mr();lr();Nv();Ju();ye();bt();J8=z({fusedMatMul_:bke})});var Gi={};xn(Gi,{conv2d:()=>X8,depthwiseConv2d:()=>Y8,matMul:()=>J8});var t6=b(()=>{"use strict";Q8();Z8();e6();});function wke(n){return M0(n,.54,.46)}var n6,r6=b(()=>{"use strict";ye();R0();n6=z({hammingWindow_:wke})});function Ske(n){return M0(n,.5,.5)}var q1,SP=b(()=>{"use strict";ye();R0();q1=z({hannWindow_:Ske})});function Cke(n,t,e,r=!1,o=0){let s=0,i=[];for(;s+t<=n.size;)i.push(Bt(n,s,t)),s+=e;if(r)for(;s<n.size;){let a=s+t-n.size,c=gn([Bt(n,s,t-a),sl([a],o)]);i.push(c),s+=e}return i.length===0?xc([],[0,t]):ue(gn(i),[i.length,t])}var U1,CP=b(()=>{"use strict";wi();r1();ye();bt();Ys();R1();U1=z({frame_:Cke})});function _ke(n,t,e,r,o=q1){r==null&&(r=vP(t));let s=U1(n,t,e),i=oe(s,o(t)),a=[];for(let c=0;c<s.shape[0];c++)a.push(ml(Bt(i,[c,0],[1,t]),r));return gn(a)}var o6,s6=b(()=>{"use strict";wi();Rt();ye();R0();Ys();M1();CP();SP();o6=z({stft_:_ke})});function Tke(n,t,e,r,o="bilinear",s=0){let i=A(n,"image","cropAndResize"),a=A(t,"boxes","cropAndResize","float32"),c=A(e,"boxInd","cropAndResize","int32"),l=a.shape[0];q(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),q(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${l},4] but had shape ${a.shape}.`),q(c.rank===1&&c.shape[0]===l,()=>`Error in cropAndResize: boxInd must be have size [${l}] but had shape ${a.shape}.`),q(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),q(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),q(o==="bilinear"||o==="nearest",()=>`method must be bilinear or nearest, but was ${o}`);let p={image:i,boxes:a,boxInd:c},f={method:o,extrapolationValue:s,cropSize:r};return U.runKernel(sm,p,f)}var i6,a6=b(()=>{"use strict";Ee();ae();Se();ze();ye();i6=z({cropAndResize_:Tke})});function Ike(n){let t=A(n,"image","flipLeftRight","float32");q(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);let e={image:t};return U.runKernel(dm,e,{})}var c6,u6=b(()=>{"use strict";Ee();ae();Se();ze();ye();c6=z({flipLeftRight_:Ike})});function Eke(n,t,e=0,r=.5){let o=A(n,"image","rotateWithOffset","float32");q(o.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${o.rank}.`);let s={image:o},i={radians:t,fillValue:e,center:r};return U.runKernel(Lm,s,i)}var l6,p6=b(()=>{"use strict";Ee();ae();Se();ze();ye();l6=z({rotateWithOffset_:Eke})});function _a(n,t,e,r,o,s){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),s==null&&(s=0);let i=n.shape[0];return e=Math.min(e,i),q(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),q(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),q(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),q(t.rank===1,()=>"scores must be a 1D tensor"),q(t.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${t.shape[0]}`),q(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:e,iouThreshold:r,scoreThreshold:o,softNmsSigma:s}}var pg=b(()=>{"use strict";ze();});function Nke(n,t,e,r=.5,o=Number.NEGATIVE_INFINITY){let s=A(n,"boxes","nonMaxSuppression"),i=A(t,"scores","nonMaxSuppression"),a=_a(s,i,e,r,o);e=a.maxOutputSize,r=a.iouThreshold,o=a.scoreThreshold;let c={maxOutputSize:e,iouThreshold:r,scoreThreshold:o};return U.runKernel(_m,{boxes:s,scores:i},c)}var h6,f6=b(()=>{"use strict";Ee();ae();Se();pg();ye();h6=z({nonMaxSuppression_:Nke})});function d6(n,t,e){let r=Dke(n,t,e),o=r<0?-(r+1):r;n.splice(o,0,t)}function Dke(n,t,e){return Ake(n,t,e||kke)}function kke(n,t){return n>t?1:n<t?-1:0}function Ake(n,t,e){let r=0,o=n.length,s=0,i=!1;for(;r<o;){s=r+(o-r>>>1);let a=e(t,n[s]);a>0?r=s+1:(o=s,i=!a)}return i?r:-r-1}var m6=b(()=>{"use strict";});function j1(n,t,e,r,o){return _P(n,t,e,r,o,0)}function G1(n,t,e,r,o,s){return _P(n,t,e,r,o,0,!1,s,!0)}function W1(n,t,e,r,o,s){return _P(n,t,e,r,o,s,!0)}function _P(n,t,e,r,o,s,i=!1,a=!1,c=!1){let l=[];for(let x=0;x<t.length;x++)t[x]>o&&l.push({score:t[x],boxIndex:x,suppressBeginIndex:0});l.sort(g6);let p=s>0?-.5/s:0,f=[],y=[];for(;f.length<e&&l.length>0;){let x=l.pop(),{score:w,boxIndex:_,suppressBeginIndex:I}=x;if(w<o)break;let T=!1;for(let D=f.length-1;D>=I;--D){let O=Oke(n,_,f[D]);if(O>=r){T=!0;break}if(x.score=x.score*Mke(r,p,O),x.score<=o)break}x.suppressBeginIndex=f.length,T||(x.score===w?(f.push(_),y.push(x.score)):x.score>o&&d6(l,x,g6))}let d=f.length,h=e-d;a&&h>0&&(f.push(...new Array(h).fill(0)),y.push(...new Array(h).fill(0)));let m={selectedIndices:f};return i&&(m.selectedScores=y),c&&(m.validOutputs=d),m}function Oke(n,t,e){let r=n.subarray(t*4,t*4+4),o=n.subarray(e*4,e*4+4),s=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),l=Math.min(o[0],o[2]),p=Math.min(o[1],o[3]),f=Math.max(o[0],o[2]),y=Math.max(o[1],o[3]),d=(a-s)*(c-i),h=(f-l)*(y-p);if(d<=0||h<=0)return 0;let m=Math.max(s,l),x=Math.max(i,p),w=Math.min(a,f),_=Math.min(c,y),I=Math.max(w-m,0)*Math.max(_-x,0);return I/(d+h-I)}function Mke(n,t,e){let r=Math.exp(t*e*e);return e<=n?r:0}function g6(n,t){return n.score-t.score||n.score===t.score&&t.boxIndex-n.boxIndex}var P0=b(()=>{"use strict";m6();});function Rke(s,i,a){return Y(this,arguments,function*(n,t,e,r=.5,o=Number.NEGATIVE_INFINITY){let c=A(n,"boxes","nonMaxSuppressionAsync"),l=A(t,"scores","nonMaxSuppressionAsync"),p=_a(c,l,e,r,o);e=p.maxOutputSize,r=p.iouThreshold,o=p.scoreThreshold;let f=yield Promise.all([c.data(),l.data()]),y=f[0],d=f[1],{selectedIndices:h}=j1(y,d,e,r,o);return c!==n&&c.dispose(),l!==t&&l.dispose(),Er(h,"int32")})}var y6,x6=b(()=>{"use strict";P0();Se();pg();Sv();y6=Rke});function Pke(n,t,e,r=.5,o=Number.NEGATIVE_INFINITY,s=0){let i=A(n,"boxes","nonMaxSuppression"),a=A(t,"scores","nonMaxSuppression"),c=_a(i,a,e,r,o,s);e=c.maxOutputSize,r=c.iouThreshold,o=c.scoreThreshold,s=c.softNmsSigma;let l={boxes:i,scores:a},p={maxOutputSize:e,iouThreshold:r,scoreThreshold:o,softNmsSigma:s},f=U.runKernel(Im,l,p);return{selectedIndices:f[0],selectedScores:f[1]}}var v6,b6=b(()=>{"use strict";Ee();ae();Se();pg();ye();v6=z({nonMaxSuppressionWithScore_:Pke})});function Fke(i,a,c){return Y(this,arguments,function*(n,t,e,r=.5,o=Number.NEGATIVE_INFINITY,s=0){let l=A(n,"boxes","nonMaxSuppressionAsync"),p=A(t,"scores","nonMaxSuppressionAsync"),f=_a(l,p,e,r,o,s);e=f.maxOutputSize,r=f.iouThreshold,o=f.scoreThreshold,s=f.softNmsSigma;let y=yield Promise.all([l.data(),p.data()]),d=y[0],h=y[1],{selectedIndices:m,selectedScores:x}=W1(d,h,e,r,o,s);return l!==n&&l.dispose(),p!==t&&p.dispose(),{selectedIndices:Er(m,"int32"),selectedScores:Er(x)}})}var w6,S6=b(()=>{"use strict";P0();Se();pg();Sv();w6=Fke});function $ke(n,t,e,r=.5,o=Number.NEGATIVE_INFINITY,s=!1){let i=A(n,"boxes","nonMaxSuppression"),a=A(t,"scores","nonMaxSuppression"),c=_a(i,a,e,r,o,null),l=c.maxOutputSize,p=c.iouThreshold,f=c.scoreThreshold,y={boxes:i,scores:a},d={maxOutputSize:l,iouThreshold:p,scoreThreshold:f,padToMaxOutputSize:s},h=U.runKernel(Tm,y,d);return{selectedIndices:h[0],validOutputs:h[1]}}var C6,_6=b(()=>{"use strict";Ee();ae();Se();pg();ye();C6=z({nonMaxSuppressionPadded_:$ke})});function Lke(i,a,c){return Y(this,arguments,function*(n,t,e,r=.5,o=Number.NEGATIVE_INFINITY,s=!1){let l=A(n,"boxes","nonMaxSuppressionAsync"),p=A(t,"scores","nonMaxSuppressionAsync"),f=_a(l,p,e,r,o,null),y=f.maxOutputSize,d=f.iouThreshold,h=f.scoreThreshold,[m,x]=yield Promise.all([l.data(),p.data()]),{selectedIndices:w,validOutputs:_}=G1(m,x,y,d,h,s);return l!==n&&l.dispose(),p!==t&&p.dispose(),{selectedIndices:Er(w,"int32"),validOutputs:it(_,"int32")}})}var T6,I6=b(()=>{"use strict";P0();Se();pg();sr();Sv();T6=Lke});function zke(n,t,e=!1,r=!1){let o=A(n,"images","resizeBilinear");q(o.rank===3||o.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${o.rank}.`),q(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),q(r===!1||e===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=o,i=!1;o.rank===3&&(i=!0,s=ue(o,[1,o.shape[0],o.shape[1],o.shape[2]]));let[]=t,a={images:s},c={alignCorners:e,halfPixelCenters:r,size:t},l=U.runKernel(Lp,a,c);return i?ue(l,[l.shape[1],l.shape[2],l.shape[3]]):l}var H1,TP=b(()=>{"use strict";Ee();ae();Se();ze();ye();bt();H1=z({resizeBilinear_:zke})});function Bke(n,t,e=!1,r=!1){let o=A(n,"images","resizeNearestNeighbor");q(o.rank===3||o.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${o.rank}.`),q(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),q(o.dtype==="float32"||o.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),q(r===!1||e===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=o,i=!1;o.rank===3&&(i=!0,s=ue(o,[1,o.shape[0],o.shape[1],o.shape[2]]));let[]=t,a={images:s},c={alignCorners:e,halfPixelCenters:r,size:t},l=U.runKernel($p,a,c);return i?ue(l,[l.shape[1],l.shape[2],l.shape[3]]):l}var K1,IP=b(()=>{"use strict";Ee();ae();Se();ze();ye();bt();K1=z({resizeNearestNeighbor_:Bke})});function Vke(n,t,e){q(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),q(e%1===0,()=>`bandPart(): numUpper must be an integer, got ${e}.`);let r=A(n,"a","bandPart");q(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);let o=r.shape,[s,i]=r.shape.slice(-2);if(!(t<=s))throw new Error(`bandPart(): numLower (${t}) must not be greater than the number of rows (${s}).`);if(!(e<=i))throw new Error(`bandPart(): numUpper (${e}) must not be greater than the number of columns (${i}).`);t<0&&(t=s),e<0&&(e=i);let a=ue(ng(0,s,1,"int32"),[-1,1]),c=ng(0,i,1,"int32"),l=at(a,c),p=vo(Rs(l,it(+t,"int32")),Yo(l,it(-e,"int32"))),f=An([s,i],r.dtype);return ue(Ir(uo(ue(r,[-1,s,i])).map(y=>pr(p,y,f))),o)}var E6,N6=b(()=>{"use strict";Se();ze();Tf();Ef();Ym();ye();j2();bt();sr();og();Hn();Tv();ya();Jm();E6=z({bandPart_:Vke})});function qke(n){let t;if(Array.isArray(n)){t=!1,q(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");let o=n[0].shape[0];for(let s=1;s<n.length;++s)q(n[s].shape[0]===o,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[s].shape[0]} vs. ${o})`)}else t=!0,n=co(n,n.shape[0],0).map(o=>Js(o,[0]));q(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);let e=[],r=n;for(let o=0;o<n.length;++o)e.push(U.tidy(()=>{let s=r[o];if(o>0)for(let i=0;i<o;++i){let a=oe(gt(oe(e[i],s)),e[i]);s=at(s,a)}return ct(s,ig(s,"euclidean"))}));return t?Ir(e,0):e}var D6,k6=b(()=>{"use strict";Ee();ze();qn();Rt();L1();ye();xv();A0();og();Hn();Hr();D6=z({gramSchmidt_:qke})});function Uke(n,t=!1){if(q(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return A6(n,t);{let e=n.shape.slice(0,n.shape.length-2).reduce((c,l)=>c*l),r=uo(ue(n,[e,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),o=[],s=[];r.forEach(c=>{let[l,p]=A6(c,t);o.push(l),s.push(p)});let i=ue(Ir(o,0),n.shape),a=ue(Ir(s,0),n.shape);return[i,a]}}function A6(n,t=!1){return U.tidy(()=>{q(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);let e=n.shape[0],r=n.shape[1],o=Qm(e),s=bi(n),i=xc([[1]],[1,1]),a=bi(i),c=e>=r?r:e;for(let l=0;l<c;++l){let p=s,f=a,y=o;[a,s,o]=U.tidy(()=>{let d=Bt(s,[l,l],[e-l,1]),h=ig(d),m=Bt(s,[l,l],[1,1]),x=pr(Fr(m,0),xc([[-1]]),xc([[1]])),w=at(m,oe(x,h)),_=ct(d,w);_.shape[0]===1?a=bi(i):a=gn([i,Bt(_,[1,0],[_.shape[0]-1,_.shape[1]])],0);let I=un(ct(an(x,w),h)),T=Bt(s,[l,0],[e-l,r]),D=oe(I,a),O=pn(a);if(l===0)s=at(T,an(D,an(O,T)));else{let j=at(T,an(D,an(O,T)));s=gn([Bt(s,[0,0],[l,r]),j],0)}let R=pn(D),P=Bt(o,[0,l],[e,o.shape[1]-l]);if(l===0)o=at(P,an(an(P,a),R));else{let j=at(P,an(an(P,a),R));o=gn([Bt(o,[0,0],[e,l]),j],1)}return[a,s,o]}),Mt([p,f,y])}return!t&&e>r&&(o=Bt(o,[0,0],[e,r]),s=Bt(s,[0,0],[r,r])),[o,s]})}var O6,M6=b(()=>{"use strict";Ee();Ms();ze();Mx();wi();qn();T2();il();Ju();Rt();Zo();L1();ye();bt();Ys();og();Hn();R1();yf();Tv();ya();O6=z({qr_:Uke})});var Lr,vc=b(()=>{"use strict";Lr=function(n){return n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS",n}(Lr||{})});function jke(n,t,e=Lr.SUM_BY_NONZERO_WEIGHTS){let r=A(n,"losses","computeWeightedLoss"),o=null;t!=null&&(o=A(t,"weights","computeWeightedLoss"));let s=o==null?r:oe(r,o);if(e===Lr.NONE)return s;if(e===Lr.SUM)return gt(s);if(e===Lr.MEAN){if(o==null)return Un(s);{let i=r.size/o.size,a=ct(gt(s),gt(o));return i>1?ct(a,it(i)):a}}if(e===Lr.SUM_BY_NONZERO_WEIGHTS){if(o==null)return ct(gt(s),it(r.size));{let i=oe(o,Lo(r.shape)),a=Ye(gt(Zs(i,it(0))),"float32");return ct(gt(s),a)}}throw Error(`Unknown reduction: ${e}`)}var es,yl=b(()=>{"use strict";Se();fn();qn();vc();C0();Rt();T0();lv();ye();sr();Hr();es=z({computeWeightedLoss_:jke})});function Gke(n,t,e,r=Lr.SUM_BY_NONZERO_WEIGHTS){let o=A(n,"labels","absoluteDifference"),s=A(t,"predictions","absoluteDifference"),i=null;e!=null&&(i=A(e,"weights","absoluteDifference")),rn(o.shape,s.shape,"Error in absoluteDifference: ");let a=Jn(at(o,s));return es(a,i,r)}var R6,P6=b(()=>{"use strict";Se();ze();Wm();vc();ye();Hn();yl();R6=z({absoluteDifference_:Gke})});function Wke(n,t,e,r,o=Lr.SUM_BY_NONZERO_WEIGHTS){let s=A(n,"labels","cosineDistance"),i=A(t,"predictions","cosineDistance"),a=null;r!=null&&(a=A(r,"weights","cosineDistance")),rn(s.shape,i.shape,"Error in cosineDistance: ");let c=it(1),l=at(c,gt(oe(s,i),e,!0));return es(l,a,o)}var F6,$6=b(()=>{"use strict";Se();ze();vc();Rt();ye();sr();Hn();Hr();yl();F6=z({cosineDistance_:Wke})});function Hke(n,t,e,r=Lr.SUM_BY_NONZERO_WEIGHTS){let o=A(n,"labels","hingeLoss"),s=A(t,"predictions","hingeLoss"),i=null;e!=null&&(i=A(e,"weights","hingeLoss")),rn(o.shape,s.shape,"Error in hingeLoss: ");let a=it(1);o=at(oe(it(2),o),a);let c=zo(at(a,oe(o,s)));return es(c,i,r)}var L6,z6=b(()=>{"use strict";Se();ze();vc();Rt();ye();hv();sr();Hn();yl();L6=z({hingeLoss_:Hke})});function Kke(n,t,e,r=1,o=Lr.SUM_BY_NONZERO_WEIGHTS){let s=A(n,"labels","huberLoss"),i=A(t,"predictions","huberLoss"),a=null;e!=null&&(a=A(e,"weights","huberLoss")),rn(s.shape,i.shape,"Error in huberLoss: ");let c=it(r),l=Jn(at(i,s)),p=_i(l,c),f=at(l,p),y=je(oe(it(.5),Gt(p)),oe(c,f));return es(y,a,o)}var B6,V6=b(()=>{"use strict";Se();ze();Wm();mr();vc();_0();Rt();ye();sr();ao();Hn();yl();B6=z({huberLoss_:Kke})});function Xke(n,t,e,r=1e-7,o=Lr.SUM_BY_NONZERO_WEIGHTS){let s=A(n,"labels","logLoss"),i=A(t,"predictions","logLoss"),a=null;e!=null&&(a=A(e,"weights","logLoss")),rn(s.shape,i.shape,"Error in logLoss: ");let c=it(1),l=it(r),p=un(oe(s,so(je(i,l)))),f=oe(at(c,s),so(je(at(c,i),l))),y=at(p,f);return es(y,a,o)}var q6,U6=b(()=>{"use strict";Se();ze();mr();ov();vc();Rt();Zo();ye();sr();Hn();yl();q6=z({logLoss_:Xke})});function Qke(n,t,e,r=Lr.SUM_BY_NONZERO_WEIGHTS){let o=A(n,"labels","meanSquaredError"),s=A(t,"predictions","meanSquaredError"),i=null;e!=null&&(i=A(e,"weights","meanSquaredError")),rn(o.shape,s.shape,"Error in meanSquaredError: ");let a=gl(o,s);return es(a,i,r)}var j6,G6=b(()=>{"use strict";Se();ze();vc();ye();k0();yl();j6=z({meanSquaredError_:Qke})});function Yke(n,t){let e=A(n,"labels","sigmoidCrossEntropyWithLogits"),r=A(t,"logits","sigmoidCrossEntropyWithLogits");rn(e.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");let o=zo(r),s=oe(r,e),i=Nf(Wr(un(Jn(r))));return je(at(o,s),i)}function Zke(n,t,e,r=0,o=Lr.SUM_BY_NONZERO_WEIGHTS){let s=A(n,"multiClassLabels","sigmoidCrossEntropy"),i=A(t,"logits","sigmoidCrossEntropy"),a=null;if(e!=null&&(a=A(e,"weights","sigmoidCrossEntropy")),rn(s.shape,i.shape,"Error in sigmoidCrossEntropy: "),r>0){let l=it(r),p=it(1),f=it(.5);s=je(oe(s,at(p,l)),oe(f,l))}let c=Yke(s,i);return es(c,a,o)}var W6,H6=b(()=>{"use strict";Se();ze();Wm();mr();ol();E2();vc();Rt();Zo();ye();hv();sr();Hn();yl();W6=z({sigmoidCrossEntropy_:Zke})});function Jke(n,t,e=-1){if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${e}`);return ws((o,s,i)=>{let c=iv(s,[e],!0),l=at(Ye(s,"float32"),c);i([o,l]);let p=un(oe(l,o));return{value:gt(p,[e]),gradFunc:(d,h)=>{let[m,x]=h,w=wa(d.shape,[e]);return[oe(ue(d,w),at(Ye(m,"float32"),Wr(x))),oe(ue(d,w),at(Wr(x),Ye(m,"float32")))]}}})(n,t)}function eAe(n,t,e,r=0,o=Lr.SUM_BY_NONZERO_WEIGHTS){let s=A(n,"onehotLabels","softmaxCrossEntropy"),i=A(t,"logits","softmaxCrossEntropy"),a=null;if(e!=null&&(a=A(e,"weights","softmaxCrossEntropy")),rn(s.shape,i.shape,"Error in softmaxCrossEntropy: "),r>0){let l=it(r),p=it(1),f=it(s.shape[1]);s=je(oe(s,at(p,l)),ct(l,f))}let c=Jke(s,i);return es(c,a,o)}var K6,X6=b(()=>{"use strict";oh();Se();ze();mr();dc();fn();qn();ol();f1();vc();Rt();Zo();ye();bt();sr();Hn();Hr();yl();K6=z({softmaxCrossEntropy_:eAe})});var tAe,nAe,bc,EP,rAe,Ct=b(()=>{"use strict";Wm();FH();$H();mr();LH();c2();u2();l2();p2();zH();BH();VH();h2();qH();BI();GH();HH();m0();Wx();QH();YH();ZH();JH();GI();Jp();fn();e5();t5();Mx();zm();wi();n5();r5();o5();s5();y2();Xm();x2();i5();c5();ZI();b2();JI();u5();w2();Yx();p5();S2();qn();C2();_2();n1();Jx();h5();ol();g0();f5();T2();r1();o1();$I();x0();il();Tf();s1();d5();m5();g5();u1();v0();Ef();y5();I2();ov();E2();S5();C5();f1();Ym();S0();d1();M2();Ju();sv();g1();T5();I5();cv();C0();x1();_0();R2();v1();E5();Rt();D5();k5();Zo();T0();NI();lv();A5();M5();Of();P5();$5();z5();V5();P2();sh();S1();UR();F2();U5();i8();a8();U2();j2();N1();c8();hv();D1();bt();ah();l8();h8();d8();g8();y8();G2();sr();W2();H2();x8();d0();v8();K2();X2();Ys();b8();w8();S8();C8();_8();N2();I0();A1();O1();Q2();M1();xv();yc();ao();k0();A0();og();vv();T8();Hn();Hr();I8();g2();vI();Sv();R1();ZR();N8();k8();O8();y0();Y2();M8();Z2();P1();Tv();R8();ya();eP();Jm();gr();P8();F8();$8();yf();L1();z8();B8();U8();j8();H8();R0();K8();ye();M1();A1();O1();Q2();t6();r6();SP();CP();s6();a6();u6();p6();f6();x6();b6();S6();_6();I6();TP();IP();N6();k6();M6();P6();yl();$6();z6();V6();U6();G6();H6();X6();tAe={fft:dl,ifft:gc,rfft:ml,irfft:zf},nAe={hammingWindow:n6,hannWindow:q1,frame:U1,stft:o6},bc={flipLeftRight:c6,resizeNearestNeighbor:K1,resizeBilinear:H1,rotateWithOffset:l6,cropAndResize:i6,nonMaxSuppression:h6,nonMaxSuppressionAsync:y6,nonMaxSuppressionWithScore:v6,nonMaxSuppressionWithScoreAsync:w6,nonMaxSuppressionPadded:C6,nonMaxSuppressionPaddedAsync:T6},EP={bandPart:E6,gramSchmidt:D6,qr:O6},rAe={absoluteDifference:R6,computeWeightedLoss:es,cosineDistance:F6,hingeLoss:L6,huberLoss:B6,logLoss:q6,meanSquaredError:j6,sigmoidCrossEntropy:W6,softmaxCrossEntropy:K6}});var Bo,Vf=b(()=>{"use strict";Ms();oh();Ct();el();Bo=class extends h0{minimize(t,e=!1,r){let{value:o,grads:s}=this.computeGradients(t,r);if(r!=null){let i=r.map(a=>({name:a.name,tensor:s[a.name]}));this.applyGradients(i)}else this.applyGradients(s);return Mt(s),e?o:(o.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return b0(t,e)}dispose(){this.iterations_!=null&&Mt(this.iterations_)}saveIterations(){return Y(this,null,function*(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:it(this.iterations_,"int32")}})}getWeights(){return Y(this,null,function*(){throw new Error("getWeights() is not implemented for this optimizer yet.")})}setWeights(t){return Y(this,null,function*(){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)})}extractIterations(t){return Y(this,null,function*(){return this.iterations_=(yield t[0].tensor.data())[0],t.slice(1)})}};Object.defineProperty(Bo,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null})});var F0,NP=b(()=>{"use strict";Ee();Ms();mr();qn();Rt();Ct();ao();gr();el();Vf();F0=(()=>{class n extends Bo{constructor(e,r,o=null){super(),this.learningRate=e,this.rho=r,this.epsilon=o,this.accumulatedGrads=[],this.accumulatedUpdates=[],o==null&&(this.epsilon=U.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(o=>o.name):Object.keys(e)).forEach((o,s)=>{let i=U.registeredVariables[o],a=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${o}/accum_grad`,variable:de(()=>Et(i).variable(a))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${o}/accum_var`,variable:de(()=>Et(i).variable(a))});let c=Array.isArray(e)?e[s].tensor:e[o];if(c==null)return;let l=this.accumulatedGrads[s].variable,p=this.accumulatedUpdates[s].variable;de(()=>{let f=je(oe(l,this.rho),oe(Gt(c),1-this.rho)),y=oe(ct(jn(je(p,this.epsilon)),jn(je(l,this.epsilon))),c),d=je(oe(p,this.rho),oe(Gt(y),1-this.rho));l.assign(f),p.assign(d);let h=je(oe(y,-this.learningRate),i);i.assign(h)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Mt(this.accumulatedGrads.map(e=>e.variable)),Mt(this.accumulatedUpdates.map(e=>e.variable)))}getWeights(){return Y(this,null,function*(){let e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[yield this.saveIterations()].concat(e.map(r=>({name:r.originalName,tensor:r.variable})))})}setWeights(e){return Y(this,null,function*(){e=yield this.extractIterations(e);let r=e.length/2,o=!1;this.accumulatedGrads=e.slice(0,r).map(s=>({originalName:s.name,variable:s.tensor.variable(o)})),this.accumulatedUpdates=e.slice(r,r*2).map(s=>({originalName:s.name,variable:s.tensor.variable(o)}))})}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,r){return new e(r.learningRate,r.rho,r.epsilon)}}return n.className="Adadelta",n})();Qs(F0)});var $0,DP=b(()=>{"use strict";Ee();Ms();mr();qn();r1();Rt();yc();ao();el();Vf();$0=(()=>{class n extends Bo{constructor(e,r=.1){super(),this.learningRate=e,this.initialAccumulatorValue=r,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(o=>o.name):Object.keys(e)).forEach((o,s)=>{let i=U.registeredVariables[o];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${o}/accumulator`,variable:de(()=>sl(i.shape,this.initialAccumulatorValue).variable(!1))});let a=Array.isArray(e)?e[s].tensor:e[o];if(a==null)return;let c=this.accumulatedGrads[s].variable;de(()=>{let l=je(c,Gt(a));c.assign(l);let p=je(oe(ct(a,jn(je(l,U.backend.epsilon()))),-this.learningRate),i);i.assign(p)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Mt(this.accumulatedGrads.map(e=>e.variable))}getWeights(){return Y(this,null,function*(){return[yield this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))})}setWeights(e){return Y(this,null,function*(){e=yield this.extractIterations(e);let r=!1;this.accumulatedGrads=e.map(o=>({originalName:o.name,variable:o.tensor.variable(r)}))})}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,r){return new e(r.learningRate,r.initialAccumulatorValue)}}return n.className="Adagrad",n})();Qs($0)});var L0,kP=b(()=>{"use strict";Ee();Ms();mr();qn();Rt();sh();sr();yc();ao();Hn();gr();el();Vf();L0=(()=>{class n extends Bo{constructor(e,r,o,s=null){super(),this.learningRate=e,this.beta1=r,this.beta2=o,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],de(()=>{this.accBeta1=it(r).variable(),this.accBeta2=it(o).variable()}),s==null&&(this.epsilon=U.backend.epsilon())}applyGradients(e){let r=Array.isArray(e)?e.map(o=>o.name):Object.keys(e);de(()=>{let o=at(1,this.accBeta1),s=at(1,this.accBeta2);r.forEach((i,a)=>{let c=U.registeredVariables[i],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:de(()=>Et(c).variable(l))}),this.accumulatedSecondMoment[a]==null&&(this.accumulatedSecondMoment[a]={originalName:`${i}/v`,variable:de(()=>Et(c).variable(l))});let p=Array.isArray(e)?e[a].tensor:e[i];if(p==null)return;let f=this.accumulatedFirstMoment[a].variable,y=this.accumulatedSecondMoment[a].variable,d=je(oe(f,this.beta1),oe(p,1-this.beta1)),h=je(oe(y,this.beta2),oe(Gt(p),1-this.beta2)),m=ct(d,o),x=ct(h,s);f.assign(d),y.assign(h);let w=je(oe(ct(m,je(jn(x),this.epsilon)),-this.learningRate),c);c.assign(w)}),this.accBeta1.assign(oe(this.accBeta1,this.beta1)),this.accBeta2.assign(oe(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Mt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Mt(this.accumulatedSecondMoment.map(e=>e.variable))}getWeights(){return Y(this,null,function*(){let e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[yield this.saveIterations()].concat(e.map(r=>({name:r.originalName,tensor:r.variable})))})}setWeights(e){return Y(this,null,function*(){e=yield this.extractIterations(e),de(()=>{this.accBeta1.assign(Eo(this.beta1,this.iterations_+1)),this.accBeta2.assign(Eo(this.beta2,this.iterations_+1))});let r=e.length/2,o=!1;this.accumulatedFirstMoment=e.slice(0,r).map(s=>({originalName:s.name,variable:s.tensor.variable(o)})),this.accumulatedSecondMoment=e.slice(r,r*2).map(s=>({originalName:s.name,variable:s.tensor.variable(o)}))})}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,r){return new e(r.learningRate,r.beta1,r.beta2,r.epsilon)}}return n.className="Adam",n})();Qs(L0)});var z0,AP=b(()=>{"use strict";Ee();Ms();Wm();mr();qn();cv();Rt();sr();Hn();gr();el();Vf();z0=(()=>{class n extends Bo{constructor(e,r,o,s=null,i=0){super(),this.learningRate=e,this.beta1=r,this.beta2=o,this.epsilon=s,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],de(()=>{this.iteration=it(0).variable(),this.accBeta1=it(r).variable()}),s==null&&(this.epsilon=U.backend.epsilon())}applyGradients(e){let r=Array.isArray(e)?e.map(o=>o.name):Object.keys(e);de(()=>{let o=at(1,this.accBeta1),s=ct(-this.learningRate,je(oe(this.iteration,this.decay),1));r.forEach((i,a)=>{let c=U.registeredVariables[i],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:Et(c).variable(l)}),this.accumulatedWeightedInfNorm[a]==null&&(this.accumulatedWeightedInfNorm[a]={originalName:`${i}/v`,variable:Et(c).variable(l)});let p=Array.isArray(e)?e[a].tensor:e[i];if(p==null)return;let f=this.accumulatedFirstMoment[a].variable,y=this.accumulatedWeightedInfNorm[a].variable,d=je(oe(f,this.beta1),oe(p,1-this.beta1)),h=oe(y,this.beta2),m=Jn(p),x=$o(h,m);f.assign(d),y.assign(x);let w=je(oe(ct(s,o),ct(d,je(x,this.epsilon))),c);c.assign(w)}),this.iteration.assign(je(this.iteration,1)),this.accBeta1.assign(oe(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Mt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Mt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}getWeights(){return Y(this,null,function*(){throw new Error("getWeights() is not implemented for Adamax yet.")})}setWeights(e){return Y(this,null,function*(){throw new Error("setWeights() is not implemented for Adamax yet.")})}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,r){return new e(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)}}return n.className="Adamax",n})();Qs(z0)});var hg,X1=b(()=>{"use strict";Ee();Ms();mr();Rt();sr();el();Vf();hg=(()=>{class n extends Bo{constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(o=>o.name):Object.keys(e)).forEach((o,s)=>{let i=Array.isArray(e)?e[s].tensor:e[o];if(i==null)return;let a=U.registeredVariables[o];de(()=>{let c=je(oe(this.c,i),a);a.assign(c)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=ur(it(-e))}dispose(){this.c.dispose()}getWeights(){return Y(this,null,function*(){return[yield this.saveIterations()]})}setWeights(e){return Y(this,null,function*(){if(e=yield this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")})}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,r){return new e(r.learningRate)}}return n.className="SGD",n})();Qs(hg)});var B0,OP=b(()=>{"use strict";Ee();Ms();mr();Rt();sr();gr();el();X1();B0=(()=>{class n extends hg{constructor(e,r,o=!1){super(e),this.learningRate=e,this.momentum=r,this.useNesterov=o,this.accumulations=[],this.m=it(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(o=>o.name):Object.keys(e)).forEach((o,s)=>{let i=U.registeredVariables[o];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${o}/momentum`,variable:de(()=>Et(i).variable(!1))});let a=this.accumulations[s].variable,c=Array.isArray(e)?e[s].tensor:e[o];c!=null&&de(()=>{let l,p=je(oe(this.m,a),c);this.useNesterov?l=je(oe(this.c,je(c,oe(p,this.m))),i):l=je(oe(this.c,p),i),a.assign(p),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Mt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}getWeights(){return Y(this,null,function*(){return[yield this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))})}setWeights(e){return Y(this,null,function*(){e=yield this.extractIterations(e);let r=!1;this.accumulations=e.map(o=>({originalName:o.name,variable:o.tensor.variable(r)}))})}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,r){return new e(r.learningRate,r.momentum,r.useNesterov)}}return n.className="Momentum",n})();Qs(B0)});var V0,MP=b(()=>{"use strict";Ee();Ms();mr();qn();Rt();yc();ao();Hn();gr();el();Vf();V0=(()=>{class n extends Bo{constructor(e,r=.9,o=0,s=null,i=!1){if(super(),this.learningRate=e,this.decay=r,this.momentum=o,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,s==null&&(this.epsilon=U.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(o=>o.name):Object.keys(e)).forEach((o,s)=>{let i=U.registeredVariables[o],a=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${o}/rms`,variable:de(()=>Et(i).variable(a))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${o}/momentum`,variable:de(()=>Et(i).variable(a))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${o}/mg`,variable:de(()=>Et(i).variable(a))});let c=Array.isArray(e)?e[s].tensor:e[o];if(c==null)return;let l=this.accumulatedMeanSquares[s].variable,p=this.accumulatedMoments[s].variable;de(()=>{let f=je(oe(l,this.decay),oe(Gt(c),1-this.decay));if(this.centered){let y=this.accumulatedMeanGrads[s].variable,d=je(oe(y,this.decay),oe(c,1-this.decay)),h=ct(oe(c,this.learningRate),jn(at(f,je(Gt(d),this.epsilon)))),m=je(oe(p,this.momentum),h);l.assign(f),y.assign(d),p.assign(m);let x=at(i,m);i.assign(x)}else{let y=je(oe(l,this.decay),oe(Gt(c),1-this.decay)),d=je(oe(p,this.momentum),ct(oe(c,this.learningRate),jn(je(y,this.epsilon))));l.assign(y),p.assign(d);let h=at(i,d);i.assign(h)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Mt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Mt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Mt(this.accumulatedMoments.map(e=>e.variable))}getWeights(){return Y(this,null,function*(){let e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[yield this.saveIterations()].concat(e.map(r=>({name:r.originalName,tensor:r.variable})))})}setWeights(e){return Y(this,null,function*(){e=yield this.extractIterations(e);let r=this.centered?e.length/3:e.length/2,o=!1;this.accumulatedMeanSquares=e.slice(0,r).map(s=>({originalName:s.name,variable:s.tensor.variable(o)})),this.accumulatedMoments=e.slice(r,r*2).map(s=>({originalName:s.name,variable:s.tensor.variable(o)})),this.centered&&(this.accumulatedMeanGrads=e.slice(r*2,r*3).map(s=>({originalName:s.name,variable:s.tensor.variable(o)})))})}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,r){return new e(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)}}return n.className="RMSProp",n})();Qs(V0)});var xl,Q6=b(()=>{"use strict";NP();DP();kP();AP();OP();MP();X1();xl=class{static sgd(t){return new hg(t)}static momentum(t,e,r=!1){return new B0(t,e,r)}static rmsprop(t,e=.9,r=0,o=null,s=!1){return new V0(t,e,r,o,s)}static adam(t=.001,e=.9,r=.999,o=null){return new L0(t,e,r,o)}static adadelta(t=.001,e=.95,r=null){return new F0(t,e,r)}static adamax(t=.002,e=.9,r=.999,o=null,s=0){return new z0(t,e,r,o,s)}static adagrad(t,e=.1){return new $0(t,e)}}});var qf,Y6=b(()=>{"use strict";Q6();qf={sgd:xl.sgd,momentum:xl.momentum,adadelta:xl.adadelta,adagrad:xl.adagrad,rmsprop:xl.rmsprop,adamax:xl.adamax,adam:xl.adam}});function Dv(){return new Promise(n=>oAe(()=>n()))}var oAe,Z6=b(()=>{"use strict";oAe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n()});function sAe(n,t){let e=n[0].length;n.forEach((o,s)=>{q(o.length===e,()=>`Error in concat${e}D: rank of tensors[${s}] must be the same as the rank of the rest (${e})`)}),q(t>=0&&t<e,()=>`Error in concat${e}D: axis must be between 0 and ${e-1}.`);let r=n[0];n.forEach((o,s)=>{for(let i=0;i<e;i++)q(i===t||o[i]===r[i],()=>`Error in concat${e}D: Shape of tensors[${s}] (${o}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`)})}function iAe(n,t){let e=n[0].slice();for(let r=1;r<n.length;r++)e[t]+=n[r][t];return e}var J6=b(()=>{"use strict";ze();});function aAe(n){return n<=Q1?n:yx(n,Math.floor(Math.sqrt(n)))}var Q1,RP=b(()=>{"use strict";ze();Q1=30});function cAe(n,t,e){let r=e*(typeof n=="number"?n:n[0]),o=t*(typeof n=="number"?n:n[1]);return[r,o]}var e7=b(()=>{"use strict";});function uAe(n,t,e,r=!0){let o=[];if(r)o=o.concat(t.slice(0)),o.push(n[0]/e),o=o.concat(n.slice(1));else{o=o.concat(n[0]);let s=t.length;for(let i=0;i<s;++i)o=o.concat([n[i+1]/t[i],t[i]]);o=o.concat(n.slice(s+1))}return o}function lAe(n,t,e=!0){let r=[];if(e){r.push(t);for(let o=t+1;o<n;++o)o<=2*t?(r.push(o),r.push(o-(t+1))):r.push(o)}else{let o=[],s=[];for(let i=1;i<n;++i)i>=t*2+1||i%2===1?s.push(i):o.push(i);r.push(...o),r.push(0),r.push(...s)}return r}function pAe(n,t,e,r=!0){let o=[];r?o.push(n[0]/e):o.push(n[0]*e);for(let s=1;s<n.length;++s)s<=t.length?r?o.push(t[s-1]*n[s]):o.push(n[s]/t[s-1]):o.push(n[s]);return o}function hAe(n,t){let e=[0];for(let r=0;r<t;++r)e.push(n[r][0]);return e}function fAe(n,t,e){let r=n.slice(0,1);for(let o=0;o<e;++o)r.push(n[o+1]-t[o][0]-t[o][1]);return r}var t7=b(()=>{"use strict";});var PP,FP,$P=b(()=>{"use strict";PP=1.7580993408473768,FP=1.0507009873554805});var dAe,mAe,gAe,yAe,xAe,vAe,n7=b(()=>{"use strict";dAe=.3275911,mAe=.254829592,gAe=-.284496736,yAe=1.421413741,xAe=-1.453152027,vAe=1.061405429});function bAe(...n){Te().getBool("IS_TEST")||console.warn(...n)}function wAe(...n){Te().getBool("IS_TEST")||console.log(...n)}var r7=b(()=>{"use strict";gs();});function SAe(n,t){if(n.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${t.length}.`);let e=new Float32Array(n.length*2);for(let r=0;r<e.length;r+=2)e[r]=n[r/2],e[r+1]=t[r/2];return e}function CAe(n){let t=new Float32Array(n.length/2),e=new Float32Array(n.length/2);for(let r=0;r<n.length;r+=2)t[r/2]=n[r],e[r/2]=n[r+1];return{real:t,imag:e}}function _Ae(n){let t=Math.ceil(n.length/4),e=new Float32Array(t),r=new Float32Array(t);for(let o=0;o<n.length;o+=4)e[Math.floor(o/4)]=n[o],r[Math.floor(o/4)]=n[o+1];return{real:e,imag:r}}function TAe(n){let t=Math.floor(n.length/4),e=new Float32Array(t),r=new Float32Array(t);for(let o=2;o<n.length;o+=4)e[Math.floor(o/4)]=n[o],r[Math.floor(o/4)]=n[o+1];return{real:e,imag:r}}function IAe(n,t){let e=n[t*2],r=n[t*2+1];return{real:e,imag:r}}function EAe(n,t,e,r){n[r*2]=t,n[r*2+1]=e}function NAe(n,t){let e=new Float32Array(n/2),r=new Float32Array(n/2);for(let o=0;o<Math.ceil(n/2);o++){let s=(t?2:-2)*Math.PI*(o/n);e[o]=Math.cos(s),r[o]=Math.sin(s)}return{real:e,imag:r}}function DAe(n,t,e){let r=(e?2:-2)*Math.PI*(n/t),o=Math.cos(r),s=Math.sin(r);return{real:o,imag:s}}var o7=b(()=>{"use strict";});function kAe(n,t,e=0){let r=[];if(typeof t=="number")q(n.shape[e]%t===0,()=>"Number of splits must evenly divide the axis."),r=new Array(t).fill(n.shape[e]/t);else{let o=t.reduce((i,a)=>(a===-1&&(i+=1),i),0);q(o<=1,()=>"There should be only one negative value in split array.");let s=t.indexOf(-1);if(s!==-1){let i=t.reduce((a,c)=>c>0?a+c:a);t[s]=n.shape[e]-i}q(n.shape[e]===t.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}var s7=b(()=>{"use strict";ze()});var LP={};xn(LP,{collectGatherOpShapeInfo:()=>MAe,computeOutShape:()=>OAe,segOpComputeOptimalWindowSize:()=>AAe});function AAe(n,t){let e=!1,r;for(n<=Q1?(r=n,e=!0):r=yx(n,Math.floor(Math.sqrt(n)));!e;)r>t||r===n?e=!0:r=yx(n,r+1);return r}function OAe(n,t,e){let r=[],o=n.length;for(let s=0;s<o;s++)s!==t?r.push(n[s]):r.push(e);return r}function MAe(n,t,e,r){let o=t.shape.length,s=n.shape.length;if(r!==0&&(r<-o||r>o))throw new Error(`Expect batchDims in the range of [-${o}, ${o}], but got ${r}`);if(r<0&&(r+=o),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${s}).`);if(e<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${e}).`);for(let f=0;f<r;++f)if(n.shape[f]!==t.shape[f])throw new Error(`x.shape[${f}]: ${n.shape[f]} should be equal to indices.shape[${f}]: ${t.shape[f]}.`);let i=n.shape[e],a=[],c=1,l=1,p=1;for(let f=0;f<r;++f)a.push(n.shape[f]),c*=n.shape[f];for(let f=r;f<e;f++)a.push(n.shape[f]),l*=n.shape[f];for(let f=r;f<o;f++)a.push(t.shape[f]);for(let f=e+1;f<s;f++)a.push(n.shape[f]),p*=n.shape[f];return{batchSize:c,sliceSize:p,outerSize:l,dimSize:i,outputShape:a}}var i7=b(()=>{"use strict";ze();RP();});var H={};xn(H,{ERF_A1:()=>mAe,ERF_A2:()=>gAe,ERF_A3:()=>yAe,ERF_A4:()=>xAe,ERF_A5:()=>vAe,ERF_P:()=>dAe,PARALLELIZE_THRESHOLD:()=>Q1,SELU_SCALE:()=>FP,SELU_SCALEALPHA:()=>PP,applyActivation:()=>ug,assertAndGetBroadcastShape:()=>Zt,assertAxesAreInnerMostDims:()=>pNe,assertParamsConsistent:()=>sAe,assignToTypedArray:()=>EAe,axesAreInnerMostDims:()=>D2,calculateShapes:()=>bH,castTensor:()=>RAe,combineLocations:()=>_5,complexWithEvenIndex:()=>_Ae,complexWithOddIndex:()=>TAe,computeConv2DInfo:()=>Km,computeConv3DInfo:()=>UH,computeDefaultPad:()=>m2,computeDilation2DInfo:()=>U1e,computeOptimalWindowSize:()=>aAe,computeOutAndReduceShapes:()=>k2,computeOutShape:()=>iAe,computePool2DInfo:()=>d2,computePool3DInfo:()=>j1e,convertConv2DDataFormat:()=>jH,eitherStridesOrDilationsAreOne:()=>wr,expandShapeToKeepDim:()=>wa,exponent:()=>DAe,exponents:()=>NAe,fromStringArrayToUint8:()=>$Ae,fromUint8ToStringArray:()=>FAe,getAxesPermutation:()=>A2,getBroadcastDims:()=>AEe,getComplexWithIndex:()=>IAe,getFusedBiasGradient:()=>cg,getFusedDyActivation:()=>ag,getImageCenter:()=>cAe,getInnerMostAxes:()=>hNe,getPermuted:()=>lAe,getReductionAxes:()=>er,getReshaped:()=>uAe,getReshapedPermuted:()=>pAe,getSliceBeginCoords:()=>hAe,getSliceSize:()=>fAe,getUndoAxesPermutation:()=>w0,log:()=>wAe,mergeRealAndImagArrays:()=>SAe,prepareAndValidate:()=>vH,prepareSplitSize:()=>kAe,reshapeTensor:()=>PAe,segment_util:()=>LP,shouldFuse:()=>lg,slice_util:()=>Fo,splitRealAndImagArrays:()=>CAe,tupleValuesAreOne:()=>Vi,upcastType:()=>ro,validateInput:()=>kI,validateUpdateShape:()=>t2,warn:()=>bAe});function RAe(n,t,e){if(t==="complex64"){if(n.dtype==="complex64")return n.clone();let r=An(n.shape),o=Ye(n,"float32"),s=e.complex(o,r);return r.dispose(),o.dispose(),s}if(!hR(n.dtype,t))return U.makeTensorFromDataId(n.dataId,n.shape,t);if(n.dtype==="complex64"){let r=e.real(n),o=Ye(r,t);return r.dispose(),o}if(t==="int32")return e.int(n);if(t==="bool"){let r=it(0,n.dtype),o=e.notEqual(n,r);return r.dispose(),o}else throw new Error(`Error in Cast: failed to cast ${n.dtype} to ${t}`)}function PAe(n,t){return U.makeTensorFromDataId(n.dataId,t,n.dtype)}function FAe(n){try{return n.map(t=>Ix(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function $Ae(n){return n.map(t=>ff(t))}var a7=b(()=>{"use strict";Ee();fn();sr();Jm();ze();dc();lr();J6();ys();Nv();RP();RI();yI();e7();t7();e2();OI();$P();Nv();n7();r7();o7();s7();i7();});var Vo={};xn(Vo,{nonMaxSuppressionV3Impl:()=>j1,nonMaxSuppressionV4Impl:()=>G1,nonMaxSuppressionV5Impl:()=>W1,whereImpl:()=>$1});var c7=b(()=>{"use strict";P0();J2();});var u7=b(()=>{"use strict";dH();yH();xH();e2();OI();RI();el();br();MH();ze();RH();NP();DP();kP();AP();OP();Vf();MP();X1();Ae();yI();Ct();vc();Y6();Ms();o0();oh();gs();Z6();a7();DR();c7();iR();ae();});var Y1,zP=b(()=>{"use strict";ae();fn();Rt();vv();Y1={kernelName:np,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>oe(n,Ca(Ye(e,"float32"),-1))}}}});var l7,p7=b(()=>{"use strict";ae();fn();qn();Zo();sr();yc();ao();Hn();l7={kernelName:ru,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>{let r=Gt(Ye(e,"float32")),o=jn(at(it(1),r));return un(ct(n,o))}}}}});var h7,f7=b(()=>{"use strict";ae();fn();qn();yc();ao();Hn();h7={kernelName:ou,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>{let r=jn(at(Gt(Ye(e,"float32")),1));return ct(n,r)}}}}});var d7,m7=b(()=>{"use strict";ae();lr();bt();Hr();d7={kernelName:ma,inputsToSave:["a","b"],gradFunc:(n,t)=>{let[e,r]=t,o=Zt(e.shape,r.shape);return{a:()=>{let a=n,c=er(e.shape,o);return c.length>0&&(a=gt(a,c)),ue(a,e.shape)},b:()=>{let a=n,c=er(r.shape,o);return c.length>0&&(a=gt(a,c)),ue(a,r.shape)}}}}});var g7,y7=b(()=>{"use strict";ae();g7={kernelName:rp,saveAllInputs:!0,gradFunc:(n,t)=>{let e={};return t.forEach((r,o)=>{e[o]=()=>n.clone()}),e}}});var x7,v7=b(()=>{"use strict";ae();gr();x7={kernelName:op,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>Et(e)}}}});var b7,w7=b(()=>{"use strict";ae();gr();b7={kernelName:sp,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>Et(e)}}}});var S7,C7=b(()=>{"use strict";ae();fn();qn();sr();yc();ao();Hn();S7={kernelName:su,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>ct(n,jn(at(it(1),Gt(Ye(e,"float32")))))}}}});var _7,T7=b(()=>{"use strict";ae();mr();fn();qn();sr();yc();ao();_7={kernelName:iu,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>{let r=jn(je(it(1),Gt(Ye(e,"float32"))));return ct(n,r)}}}}});var I7,E7=b(()=>{"use strict";ae();mr();lr();qn();Rt();Zo();bt();ao();Hr();I7={kernelName:uu,inputsToSave:["a","b"],gradFunc:(n,t)=>{let[e,r]=t,o=Zt(e.shape,r.shape);return{a:()=>{let a=je(Gt(e),Gt(r)),c=oe(n,ct(r,a)),l=er(e.shape,o);return l.length>0&&(c=gt(c,l)),ue(c,e.shape)},b:()=>{let a=je(Gt(e),Gt(r)),c=un(oe(n,ct(e,a))),l=er(r.shape,o);return l.length>0&&(c=gt(c,l)),ue(c,r.shape)}}}}});var N7,D7=b(()=>{"use strict";ae();mr();fn();qn();ao();N7={kernelName:au,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>ct(n,je(Gt(Ye(e,"float32")),1))}}}});var k7,A7=b(()=>{"use strict";ae();fn();qn();ao();Hn();sr();k7={kernelName:cu,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>ct(n,at(it(1),Gt(Ye(e,"float32"))))}}}});function LAe(n,t,e,r,o=[1,1,1],s,i){let a=A(n,"dy","avgPool3dGrad"),c=A(t,"input","avgPool3dGrad"),l=a,p=c,f=!1;c.rank===4&&(f=!0,l=ue(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),p=ue(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),q(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),q(p.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${p.rank}.`),q(wr(r,o),()=>`Error in avgPool3dGrad: Either strides or dilations must be 1. Got strides ${r} and dilations '${o}'`),i!=null&&q(Nn(s),()=>`Error in avgPool3dGrad: pad must be an integer when using, dimRoundingMode ${i} but got pad ${s}.`);let y={dy:l,input:p},d={filterSize:e,strides:r,dilations:o,pad:s,dimRoundingMode:i},h=U.runKernel(Jd,y,d);return f?ue(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}var O7,M7=b(()=>{"use strict";Ee();ae();Se();ze();ys();ye();bt();O7=z({avgPool3dGrad_:LAe})});var R7,P7=b(()=>{"use strict";ae();M7();R7={kernelName:ap,inputsToSave:["x"],gradFunc:(n,t,e)=>{let[r]=t,{filterSize:o,strides:s,dilations:i,pad:a,dimRoundingMode:c}=e,l=i??[1,1,1];return{x:()=>O7(n,r,o,s,l,a,c)}}}});function zAe(n,t,e,r,o){let s=A(n,"dy","avgPoolGrad"),i=A(t,"input","avgPoolGrad");q(i.rank===s.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${s.rank})`);let a=i,c=s,l=!1;i.rank===3&&(l=!0,a=ue(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=ue(s,[1,s.shape[0],s.shape[1],s.shape[2]])),q(c.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${c.rank}.`),q(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);let p={dy:c,input:a},f={filterSize:e,strides:r,pad:o},y=U.runKernel(Zd,p,f);return l?ue(y,[y.shape[1],y.shape[2],y.shape[3]]):y}var F7,$7=b(()=>{"use strict";Ee();ae();Se();ze();ye();bt();F7=z({avgPoolGrad_:zAe})});var L7,z7=b(()=>{"use strict";ae();$7();L7={kernelName:ip,inputsToSave:["x"],gradFunc:(n,t,e)=>{let[r]=t,{filterSize:o,strides:s,pad:i}=e;return{x:()=>F7(n,r,o,s,i)}}}});var B7,V7=b(()=>{"use strict";ae();Ju();B7={kernelName:cp,inputsToSave:["a","b"],gradFunc:(n,t,e)=>{let[r,o]=t,{transposeA:s,transposeB:i}=e;return!s&&!i?{a:()=>an(n,o,!1,!0),b:()=>an(r,n,!0,!1)}:!s&&i?{a:()=>an(n,o,!1,!1),b:()=>an(n,r,!0,!1)}:s&&!i?{a:()=>an(o,n,!1,!0),b:()=>an(r,n,!1,!1)}:{a:()=>an(o,n,!0,!0),b:()=>an(n,r,!0,!0)}}}});var q7,U7=b(()=>{"use strict";ae();I0();q7={kernelName:up,gradFunc:(n,t,e)=>{let{blockShape:r,crops:o}=e;return{x:()=>pl(n,r,o)}}}});var j7,G7=b(()=>{"use strict";ae();Hr();j7={kernelName:vR,gradFunc:(n,t,e)=>{let r=e,o=r.inputShape,s=r.shape,i=Array.from(s);for(let c=o.length-1;c>=0;c--)if(o[c]===s[c])i[c]=1;else if(o[c]!==1)throw new Error(`broadcastTo(): [${o}] cannot be broadcast to [${s}].`);let a=[];for(let c=0;c<i.length;c++)i[c]>1&&a.push(c);return{x:()=>gt(n,a,!0)}}}});var W7,H7=b(()=>{"use strict";ae();W7={kernelName:lc,gradFunc:n=>({x:()=>n.clone()})}});var K7,X7=b(()=>{"use strict";ae();gr();K7={kernelName:lu,gradFunc:n=>({x:()=>Et(n)})}});var Q7,Y7=b(()=>{"use strict";ae();Tf();Ef();Ym();ya();gr();Q7={kernelName:pu,inputsToSave:["x"],gradFunc:(n,t,e)=>{let[r]=t,{clipValueMin:o,clipValueMax:s}=e;return{x:()=>pr(vo(Yo(r,o),Rs(r,s)),n,Et(n))}}}});var Z7,J7=b(()=>{"use strict";ae();zP();Z7={kernelName:lp,inputsToSave:["x"],gradFunc:Y1.gradFunc}});var eK,tK=b(()=>{"use strict";ae();xv();ze();eK={kernelName:pp,saveAllInputs:!0,gradFunc:(n,t,e)=>{let r=t.map(c=>c.shape),{axis:o}=e,s=no(o,t[0].shape)[0],i=r.map(c=>c[s]);return co(n,i,s).map(c=>()=>c)}}});var nK,rK=b(()=>{"use strict";ae();z1();QI();ys();ze();nK={kernelName:hp,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{let[r,o]=t,{dilations:s,strides:i,pad:a,dataFormat:c}=e;return q(Vi(s),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`),{x:()=>Kx(r.shape,n,o,i,a,c),filter:()=>Ev(r,n,o.shape,i,a,c)}}}});var oK,sK=b(()=>{"use strict";ae();Xm();z1();oK={kernelName:fp,inputsToSave:["dy","filter"],gradFunc:(n,t,e)=>{let[r,o]=t,{strides:s,pad:i,dataFormat:a,dimRoundingMode:c}=e;return{dy:()=>vs(n,o,s,i,a,1,c),filter:()=>Ev(n,r,o.shape,s,i,a,c)}}}});function BAe(n,t,e,r,o){let s=n;n.rank===4&&(s=ue(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let i=t;i.rank===4&&(i=ue(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),q(s.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${s.shape}.`),q(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),q(e.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${e}.`),q(s.shape[4]===e[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${e[3]}.`),q(i.shape[4]===e[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${e[4]}).`);let a={x:s,dy:i},c={strides:r,pad:o,filterShape:e};return U.runKernel(rm,a,c)}var iK,aK=b(()=>{"use strict";Ee();ae();ze();ye();bt();iK=z({conv3DBackpropFilter_:BAe})});var cK,uK=b(()=>{"use strict";ae();aK();v2();ys();ze();cK={kernelName:dp,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{let{dilations:r,strides:o,pad:s}=e;q(Vi(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);let[i,a]=t;return{x:()=>YI(i.shape,n,a,o,s),filter:()=>iK(i,n,a.shape,o,s)}}}});var lK,pK=b(()=>{"use strict";ae();fn();Rt();Zo();K2();lK={kernelName:hu,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>oe(un($f(Ye(e,"float32"))),n)}}}});var hK,fK=b(()=>{"use strict";ae();fn();Rt();X2();hK={kernelName:fu,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>oe(Lf(Ye(e,"float32")),n)}}}});var dK,mK=b(()=>{"use strict";ae();dc();JI();yf();dK={kernelName:mp,inputsToSave:["x"],gradFunc:(n,t,e)=>{let[r]=t,{axis:o,exclusive:s,reverse:i}=e;return{x:()=>{let a=A2([o],r.rank),c=Cf(n,o,s,!i);return a!=null&&(c=pn(c,a)),c}}}}});var gK,yK=b(()=>{"use strict";ae();ys();bP();wP();ze();gK={kernelName:gp,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{let{dilations:r,strides:o,pad:s,dimRoundingMode:i}=e,a=r??[1,1];q(Vi(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);let[c,l]=t;return q(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${c.rank}.`),q(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${l.rank}.`),q(c.shape[3]===l.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${c.shape[3]}) must match the inChannels dimension in filter ${l.shape[2]}.`),q(wr(o,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${o} and dilations '${a}'.`),i!=null&&q(Nn(s),()=>`Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ${i} but got pad ${s}.`),{x:()=>V1(c.shape,n,l,o,s,r,i),filter:()=>B1(c,n,l.shape,o,s,r,i)}}}});var xK,vK=b(()=>{"use strict";Ee();ae();xK={kernelName:yp,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{let[r,o]=t,s={x:r,filter:o,dy:n},i={x:r,filter:o,dy:n};return{x:()=>U.runKernel(bx,s,e),filter:()=>U.runKernel(wx,i,e)}}}});var bK,wK=b(()=>{"use strict";Ee();ae();bK={kernelName:mu,outputsToSave:[!0],gradFunc:(n,t)=>{let[e]=t,r={dy:n,y:e};return{x:()=>U.runKernel(pm,r)}}}});var SK,CK=b(()=>{"use strict";ae();ol();Rt();Zo();ao();SK={kernelName:gu,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t,r=oe(Wr(un(Gt(e))),2/Math.sqrt(Math.PI));return{x:()=>oe(n,r)}}}});var _K,TK=b(()=>{"use strict";ae();Rt();_K={kernelName:yu,outputsToSave:[!0],gradFunc:(n,t)=>{let[e]=t;return{x:()=>oe(n,e)}}}});var IK,EK=b(()=>{"use strict";ae();bt();IK={kernelName:xp,inputsToSave:["input"],gradFunc:(n,t)=>{let[e]=t;return{input:()=>ue(n,e.shape)}}}});var NK,DK=b(()=>{"use strict";ae();ol();Rt();NK={kernelName:xu,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>oe(n,Wr(e))}}}});var kK,AK=b(()=>{"use strict";ae();gr();kK={kernelName:vu,gradFunc:n=>({x:()=>Et(n)})}});var OK,MK=b(()=>{"use strict";ae();lr();fn();qn();Rt();Zo();bt();ao();Hr();OK={kernelName:bu,inputsToSave:["a","b"],gradFunc:(n,t)=>{let[e,r]=t,o=Zt(e.shape,r.shape);return{a:()=>{let a=ct(n,Ye(r,"float32")),c=er(e.shape,o);return c.length>0?ue(gt(a,c),e.shape):a},b:()=>{let a=oe(n,Ye(e,"float32")),c=er(r.shape,o);c.length>0&&(a=ue(gt(a,c),r.shape));let l=Gt(r);return un(ct(a,Ye(l,"float32")))}}}}});var RK,PK=b(()=>{"use strict";ae();mr();lr();Rt();bt();G2();sr();Hn();Hr();y0();RK={kernelName:vp,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,t,e)=>{let{varianceEpsilon:r}=e,[o,s,i,a]=t,c=a??it(1),l=er(s.shape,o.shape),p=[];if(s.rank===1){for(let T=0;T<o.shape.length-1;++T)p.push(o.shape[T]);p.push(1)}let f=at(o,s),y=oe(n,c),d=Pf(je(i,it(r))),h=oe(oe(oe(d,d),d),it(-.5));return{x:()=>s.rank===1?ue(oe(oe(n,Ci(ue(d,[1,1,1,s.shape[0]]),p)),c),o.shape):ue(oe(oe(n,d),c),o.shape),mean:()=>{let T=oe(oe(d,it(-1)),y);return s.rank===1&&(T=gt(T,l)),ue(T,s.shape)},variance:()=>{let T=oe(oe(h,f),y);return s.rank===1&&(T=gt(T,l)),ue(T,s.shape)},scale:()=>{let T=oe(f,d),D=oe(n,T);return s.rank===1&&(D=gt(D,l)),ue(D,s.shape)},offset:()=>{let T=n;return s.rank===1&&(T=gt(T,l)),ue(T,s.shape)}}}}});function FK(n,t){let e=[];for(let r=n;r<t;++r)e.push(r);return e}function $K(n){let t=[];for(let e=0;e<n.length;++e)for(let r=0;r<n[e].length;++r)t.push(n[e][r]);return t}var LK,zK=b(()=>{"use strict";ae();dc();bt();yf();P1();ze();LK={kernelName:bp,inputsToSave:["x","indices"],gradFunc:(n,t,e)=>{let[r,o]=t,{axis:s}=e,i=no(s,r.shape)[0];return{x:()=>{let c=r.shape,l=o.size,p=c.slice(0,i),f=p.length,y=c.slice(s,c.length).slice(1),d=y.length,h=FK(0,f),m=FK(f+1,f+1+d),x=$K([p,[l],y]),w=ue(n,x),_=ue(o,[l]),I=$K([[f],h,m]),T=pn(w,I),D=_v(T,_,r.shape[i]),O=w0(I);return D=pn(D,O),D},indices:()=>o}}}});var BK,VK=b(()=>{"use strict";ae();gr();BK={kernelName:wu,inputsToSave:["a","b"],gradFunc:(n,t)=>{let[e,r]=t;return{a:()=>Et(e),b:()=>Et(r)}}}});var qK,UK=b(()=>{"use strict";ae();fn();qK={kernelName:wp,gradFunc:n=>({x:()=>Ye(n,"float32")})}});var jK,GK=b(()=>{"use strict";ae();gr();jK={kernelName:Su,gradFunc:n=>({x:()=>Et(n)})}});var WK,HK=b(()=>{"use strict";ae();gr();WK={kernelName:Cu,gradFunc:n=>({x:()=>Et(n)})}});var KK,XK=b(()=>{"use strict";ae();gr();KK={kernelName:_u,gradFunc:n=>({x:()=>Et(n)})}});var QK,YK=b(()=>{"use strict";ae();il();Rt();ya();QK={kernelName:Sp,inputsToSave:["x"],gradFunc:(n,t,e)=>{let[r]=t,{alpha:o}=e,s=Fr(r,0);return{x:()=>pr(s,n,oe(n,o))}}}});var ZK,JK=b(()=>{"use strict";ae();mr();qn();ZK={kernelName:Iu,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>ct(n,je(e,1))}}}});var e9,t9=b(()=>{"use strict";ae();fn();qn();e9={kernelName:Tu,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>ct(n,Ye(e,"float32"))}}}});var n9,r9=b(()=>{"use strict";ae();ol();Rt();Hn();Hr();n9={kernelName:bR,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,t,e)=>{let[r]=t,{axis:o}=e;return{logits:()=>{let i=Wr(r);return at(n,oe(gt(n,o,!0),i))}}}}});function VAe(n,t,e,r=5,o=1,s=1,i=.5){let a={x:n,y:t,dy:e},c={depthRadius:r,bias:o,alpha:s,beta:i};return U.runKernel(vm,a,c)}var o9,s9=b(()=>{"use strict";Ee();ae();ye();o9=z({localResponseNormalizationBackprop_:VAe})});var i9,a9=b(()=>{"use strict";ae();s9();i9={kernelName:Cp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{let[r,o]=t,{depthRadius:s,bias:i,alpha:a,beta:c}=e;return{x:()=>o9(r,o,n,s,i,a,c)}}}});function Z1(n,t,e,r){return t.rank<e.rank&&(t=ue(t,wa(t.shape,r))),n.rank<e.rank&&(n=ue(n,wa(n.shape,r))),{x:()=>oe(n,Ye(bs(e,t),n.dtype))}}var BP=b(()=>{"use strict";dc();fn();Jx();Rt();bt();});var VP,c9=b(()=>{"use strict";ae();ze();BP();VP={kernelName:_p,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{let r=e,{reductionIndices:o}=r,s=t[0],i=t[1],a=no(o,s.shape),c=Z1(n,i,s,a);return{x:()=>c.x()}}}});var u9,l9=b(()=>{"use strict";ae();fn();Tf();v0();Rt();u9={kernelName:Eu,inputsToSave:["a","b"],gradFunc:(n,t)=>{let[e,r]=t;return{a:()=>oe(n,Ye(Yo(e,r),"float32")),b:()=>oe(n,Ye(cl(e,r),"float32"))}}}});function qAe(n,t,e,r,o,s=[1,1,1],i,a){let c=A(n,"dy","maxPool3dGrad"),l=A(t,"input","maxPool3dGrad"),p=A(e,"output","maxPool3dGrad"),f=c,y=l,d=p,h=!1;l.rank===4&&(h=!0,f=ue(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),y=ue(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=ue(p,[1,p.shape[0],p.shape[1],p.shape[2],p.shape[3]])),q(f.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${f.rank}.`),q(y.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${y.rank}.`),q(d.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`),q(wr(o,s),()=>`Error in maxPool3dGrad: Either strides or dilations must be 1. Got strides ${o} and dilations '${s}'`),a!=null&&q(Nn(i),()=>`Error in maxPool3dGrad: pad must be an integer when using, dimRoundingMode ${a} but got pad ${i}.`);let m={dy:f,input:y,output:d},x={filterSize:r,strides:o,dilations:s,pad:i,dimRoundingMode:a},w=U.runKernel(wm,m,x);return h?ue(w,[w.shape[1],w.shape[2],w.shape[3],w.shape[4]]):w}var p9,h9=b(()=>{"use strict";Ee();ae();Se();ze();ys();ye();bt();p9=z({maxPool3dGrad_:qAe})});var f9,d9=b(()=>{"use strict";ae();h9();f9={kernelName:Ip,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{let[r,o]=t,{filterSize:s,strides:i,dilations:a,pad:c,dimRoundingMode:l}=e,p=a??[1,1,1];return{x:()=>p9(n,r,o,s,i,p,c,l)}}}});function UAe(n,t,e,r,o,s,i){let a=A(n,"dy","maxPoolGrad"),c=A(t,"input","maxPoolGrad"),l=A(e,"output","maxPoolGrad");q(c.rank===a.rank,()=>`Rank of input (${c.rank}) does not match rank of dy (${a.rank})`),q(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),q(c.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${c.rank}.`),i!=null&&q(Nn(s),()=>`Error in maxPoolGrad: pad must be an integer when using, dimRoundingMode ${i} but got pad ${s}.`);let p={dy:a,input:c,output:l},f={filterSize:r,strides:o,pad:s,dimRoundingMode:i};return U.runKernel(bm,p,f)}var m9,g9=b(()=>{"use strict";Ee();ae();Se();ze();ye();m9=z({maxPoolGrad_:UAe})});var y9,x9=b(()=>{"use strict";ae();g9();y9={kernelName:Tp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{let[r,o]=t,{filterSize:s,strides:i,pad:a}=e;return{x:()=>m9(n,r,o,s,i,a)}}}});var v9,b9=b(()=>{"use strict";ae();dc();qn();Rt();lv();bt();ze();v9={kernelName:Ep,inputsToSave:["x"],gradFunc:(n,t,e)=>{let[r]=t,{axis:o}=e,s=no(o,r.shape),a=k2(r.shape,s)[1],c=Vn(a);return{x:()=>{let p=r.shape.slice();s.forEach(d=>{p[d]=1});let f=ue(n,p);return ct(oe(f,Lo(r.shape,"float32")),c)}}}}});var w9,S9=b(()=>{"use strict";ae();ze();BP();w9={kernelName:Np,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{let r=e,{axis:o}=r,[s,i]=t,a=no(o,s.shape),c=Z1(n,i,s,a);return{x:()=>c.x()}}}});var C9,_9=b(()=>{"use strict";ae();fn();il();Ef();Rt();C9={kernelName:Nu,inputsToSave:["a","b"],gradFunc:(n,t)=>{let[e,r]=t;return{a:()=>oe(n,Ye(Rs(e,r),"float32")),b:()=>oe(n,Ye(Fr(e,r),"float32"))}}}});var T9,I9=b(()=>{"use strict";ae();Ys();T9={kernelName:Dp,inputsToSave:["x"],gradFunc:(n,t,e)=>{let r=t[0],{paddings:o}=e,s=o.map(i=>i[0]);return{x:()=>Bt(n,s,r.shape)}}}});var E9,N9=b(()=>{"use strict";ae();lr();qn();o1();Rt();Zo();bt();Hr();E9={kernelName:Du,inputsToSave:["a","b"],gradFunc:(n,t)=>{let[e,r]=t,o=Zt(e.shape,r.shape);return{a:()=>{let a=er(e.shape,o);return a.length>0?ue(gt(n,a),e.shape):n},b:()=>{let a=oe(n,un(va(ct(e,r)))),c=er(r.shape,o);return c.length>0?ue(gt(a,c),r.shape):a}}}}});var D9,k9=b(()=>{"use strict";ae();lr();fn();Rt();bt();Hr();D9={kernelName:ku,inputsToSave:["a","b"],gradFunc:(n,t)=>{let[e,r]=t,o=Zt(e.shape,r.shape);return{a:()=>{let a=oe(n,Ye(r,"float32")),c=er(e.shape,o);return c.length>0?ue(gt(a,c),e.shape):a},b:()=>{let a=oe(n,Ye(e,"float32")),c=er(r.shape,o);return c.length>0?ue(gt(a,c),r.shape):a}}}}});var A9,O9=b(()=>{"use strict";ae();Zo();A9={kernelName:kp,gradFunc:n=>({x:()=>un(n)})}});var M9,R9=b(()=>{"use strict";ae();Jm();M9={kernelName:Op,inputsToSave:["indices"],gradFunc:(n,t)=>{let e=t[0];return{indices:()=>An(e.shape,"float32")}}}});var P9,F9=b(()=>{"use strict";ae();gr();P9={kernelName:Ap,gradFunc:n=>({x:()=>Et(n)})}});var $9,L9=b(()=>{"use strict";ae();Tv();$9={kernelName:Mp,saveAllInputs:!0,gradFunc:(n,t,e)=>{let{axis:r}=e;return uo(n,r).map(s=>()=>s)}}});var qP,z9=b(()=>{"use strict";ae();Ys();qP={kernelName:Rp,inputsToSave:["x"],gradFunc:(n,t,e)=>{let r=t[0],{paddings:o}=e,s=o.map(i=>i[0]);return{x:()=>Bt(n,s,r.shape)}}}});var B9,V9=b(()=>{"use strict";ae();lr();fn();il();ov();Rt();sh();bt();sr();Hn();Hr();ya();gr();B9={kernelName:Au,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,t)=>{let[e,r,o]=t,s=e,i=r,a=Zt(s.shape,i.shape);return{a:()=>{let p=Ye(i,"float32"),f=oe(n,oe(p,Eo(s,at(p,it(1))))),y=er(s.shape,a);return y.length>0&&(f=gt(f,y)),ue(f,s.shape)},b:()=>{let p=Fr(s,0),f=pr(p,so(s),Et(s)),y=oe(n,oe(o,f)),d=er(i.shape,a);return d.length>0&&(y=gt(y,d)),ue(y,i.shape)}}}}});var q9,U9=b(()=>{"use strict";ae();lr();il();Rt();bt();Hr();ya();gr();q9={kernelName:Pp,inputsToSave:["x","alpha"],gradFunc:(n,t)=>{let[e,r]=t,o=Fr(e,0);return{x:()=>pr(o,n,oe(n,r)),alpha:()=>{let s=pr(o,Et(n),oe(n,e)),i=er(r.shape,n.shape);return i.length>0&&(s=gt(s,i)),ue(s,r.shape)}}}}});var j9,G9=b(()=>{"use strict";ae();lr();fn();qn();Rt();Zo();bt();ao();Hr();j9={kernelName:du,inputsToSave:["a","b"],gradFunc:(n,t)=>{let[e,r]=t,o=Zt(e.shape,r.shape);return{a:()=>{let a=ct(n,Ye(r,"float32")),c=er(e.shape,o);return c.length>0?ue(gt(a,c),e.shape):a},b:()=>{let a=oe(n,Ye(e,"float32")),c=er(r.shape,o);c.length>0&&(a=ue(gt(a,c),r.shape));let l=Gt(r);return un(ct(a,Ye(l,"float32")))}}}}});var W9,H9=b(()=>{"use strict";ae();qn();Zo();ao();W9={kernelName:Ou,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>ct(n,un(Gt(e)))}}}});var K9,X9=b(()=>{"use strict";ae();fn();Ef();Rt();vv();K9={kernelName:Ru,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t,r=oe(Rs(e,6),Ca(e));return{x:()=>oe(n,Ye(r,"float32"))}}}});var Q9,Y9=b(()=>{"use strict";ae();fn();Rt();vv();Q9={kernelName:Mu,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>oe(n,Ye(Ca(e),"float32"))}}}});var Z9,J9=b(()=>{"use strict";ae();bt();Z9={kernelName:Fp,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>ue(n,e.shape)}}}});var eX,tX=b(()=>{"use strict";Ee();ae();eX={kernelName:Lp,inputsToSave:["images"],gradFunc:(n,t,e)=>{let[r]=t,o={dy:n,images:r};return{images:()=>U.runKernel(Am,o,e)}}}});var nX,rX=b(()=>{"use strict";Ee();ae();nX={kernelName:$p,inputsToSave:["images"],gradFunc:(n,t,e)=>{let[r]=t,o={dy:n,images:r};return{images:()=>U.runKernel(km,o,e)}}}});var oX,sX=b(()=>{"use strict";ae();ah();ze();oX={kernelName:zp,gradFunc:(n,t,e)=>{let{dims:r}=e,o=no(r,n.shape);return{x:()=>$r(n,o)}}}});var iX,aX=b(()=>{"use strict";ae();gr();iX={kernelName:Pu,gradFunc:n=>({x:()=>Et(n)})}});var cX,uX=b(()=>{"use strict";ae();qn();Rt();Zo();sh();cX={kernelName:Fu,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>un(ct(n,oe(Eo(e,1.5),2)))}}}});var lX,pX=b(()=>{"use strict";ae();fn();S0();Rt();gr();lX={kernelName:Bp,inputsToSave:["condition"],gradFunc:(n,t)=>{let[e]=t;return{condition:()=>Ye(Et(e),"float32"),t:()=>oe(n,Ye(e,n.dtype)),e:()=>oe(n,Ye(ul(e),n.dtype))}}}});var hX,fX=b(()=>{"use strict";ae();fn();ol();il();Rt();sr();$P();ya();hX={kernelName:$u,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>{let r=Fr(e,it(0)),o=it(PP),s=it(FP),i=oe(n,s),a=oe(oe(n,o),Wr(Ye(e,"float32")));return pr(r,i,a)}}}}});var dX,mX=b(()=>{"use strict";ae();Rt();sr();Hn();dX={kernelName:Vu,outputsToSave:[!0],gradFunc:(n,t)=>{let[e]=t;return{x:()=>oe(n,oe(e,at(it(1),e)))}}}});var gX,yX=b(()=>{"use strict";ae();gr();gX={kernelName:Bu,gradFunc:n=>({x:()=>Et(n)})}});var xX,vX=b(()=>{"use strict";ae();fn();ZI();Rt();xX={kernelName:Lu,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>oe(rl(Ye(e,"float32")),n)}}}});var bX,wX=b(()=>{"use strict";ae();fn();b2();Rt();bX={kernelName:zu,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>oe(Sf(Ye(e,"float32")),n)}}}});var SX,CX=b(()=>{"use strict";ae();Of();RI();SX={kernelName:Vp,inputsToSave:["x"],gradFunc:(n,t,e)=>{let[r]=t,{begin:o,size:s}=e,i=r.shape,[a,c]=n2(r,o,s),l=[];for(let p=0;p<n.rank;p++)l.push([a[p],i[p]-a[p]-c[p]]);return{x:()=>Jo(n,l)}}}});var _X,TX=b(()=>{"use strict";ae();Rt();Hn();Hr();_X={kernelName:Gp,outputsToSave:[!0],gradFunc:(n,t,e)=>{let[r]=t,{dim:o}=e,s=!0,i=oe(n,r);return{logits:()=>at(i,oe(gt(i,[o],s),r))}}}});var IX,EX=b(()=>{"use strict";ae();Rt();d0();IX={kernelName:qu,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>oe(n,xs(e))}}}});var UP,NX=b(()=>{"use strict";ae();m0();UP={kernelName:Up,gradFunc:(n,t,e)=>{let{blockShape:r,paddings:o}=e;return{x:()=>nl(n,r,o)}}}});var jP,DX=b(()=>{"use strict";ae();wi();jP={kernelName:jp,gradFunc:(n,t,e)=>{let{axis:r}=e;return{x:()=>gn(n,r)}}}});var kX,AX=b(()=>{"use strict";ae();fn();qn();Rt();yc();kX={kernelName:Uu,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>ct(n,oe(jn(Ye(e,"float32")),2))}}}});var OX,MX=b(()=>{"use strict";ae();fn();Rt();OX={kernelName:Mm,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>oe(n,oe(Ye(e,"float32"),2))}}}});var RX,PX=b(()=>{"use strict";ae();Rt();sr();Hn();RX={kernelName:ju,inputsToSave:["a","b"],gradFunc:(n,t)=>{let[e,r]=t,o=it(2);return{a:()=>oe(n,oe(o,at(e,r))),b:()=>oe(n,oe(o,at(r,e)))}}}});var FX,$X=b(()=>{"use strict";ae();gr();FX={kernelName:Ku,gradFunc:n=>({x:()=>Et(n)})}});var LX,zX=b(()=>{"use strict";ae();lr();Zo();bt();Hr();LX={kernelName:Gu,inputsToSave:["a","b"],gradFunc:(n,t)=>{let[e,r]=t,o=Zt(e.shape,r.shape);return{a:()=>{let a=n,c=er(e.shape,o);return c.length>0&&(a=gt(a,c)),ue(a,e.shape)},b:()=>{let a=n,c=er(r.shape,o);return c.length>0&&(a=gt(a,c)),ue(un(a),r.shape)}}}}});var BX,VX=b(()=>{"use strict";ae();Rt();lv();bt();ze();BX={kernelName:qp,inputsToSave:["x"],gradFunc:(n,t,e)=>{let[r]=t,o=r.shape.slice(),{axis:s}=e;no(s,r.shape).forEach(l=>{o[l]=1});let a=ue(n,o),c=oe(a,Lo(r.shape,"float32"));return{x:()=>c}}}});var qX,UX=b(()=>{"use strict";ae();ZI();qn();ao();qX={kernelName:Wu,inputsToSave:["x"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>ct(n,Gt(rl(e)))}}}});var jX,GX=b(()=>{"use strict";ae();Rt();sr();ao();Hn();jX={kernelName:Hu,outputsToSave:[!0],gradFunc:(n,t)=>{let[e]=t;return{x:()=>oe(at(it(1),Gt(e)),n)}}}});var WX,HX=b(()=>{"use strict";ae();mr();Ys();gr();WX={kernelName:pc,inputsToSave:["x"],gradFunc:(n,t,e)=>{let[r]=t,{reps:o}=e;return{x:()=>{let i=Et(r);if(r.rank===1)for(let a=0;a<o[0];++a)i=je(i,Bt(n,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<o[0];++a)for(let c=0;c<o[1];++c)i=je(i,Bt(n,[a*r.shape[0],c*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<o[0];++a)for(let c=0;c<o[1];++c)for(let l=0;l<o[2];++l)i=je(i,Bt(n,[a*r.shape[0],c*r.shape[1],l*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<o[0];++a)for(let c=0;c<o[1];++c)for(let l=0;l<o[2];++l)for(let p=0;p<o[3];++p)i=je(i,Bt(n,[a*r.shape[0],c*r.shape[1],l*r.shape[2],p*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return i}}}}});var KX,XX=b(()=>{"use strict";ae();dc();yf();KX={kernelName:Wp,gradFunc:(n,t,e)=>{let r=e,{perm:o}=r,s=w0(o);return{x:()=>pn(n,s)}}}});var QX,YX=b(()=>{"use strict";ae();og();QX={kernelName:Hp,gradFunc:(n,t,e)=>{let r=e,{axis:o}=r;return{value:()=>Ir(n,o)}}}});function jAe(n,t){let e=$o(t,Et(t)),r=ji(n,e),o=Yo(t,it(0,"int32")),s=r.rank-o.rank;for(let a=0;a<s;++a)o=Io(o,a+1);o=vo(o,Lo(r.shape,"bool"));let i=Et(r);return pr(o,r,i)}var ZX,JX=b(()=>{"use strict";ae();g0();x0();Tf();Ym();cv();lv();sr();ya();gr();ZX={kernelName:Kp,inputsToSave:["segmentIds"],gradFunc:(n,t)=>{let[e]=t;return{x:()=>jAe(n,e)}}}});var eQ,tQ=b(()=>{"use strict";ae();gr();eQ={kernelName:Xp,gradFunc:n=>({x:()=>Et(n)})}});var GAe,nQ=b(()=>{"use strict";zP();p7();f7();m7();y7();v7();w7();C7();T7();E7();D7();A7();P7();z7();V7();U7();G7();H7();X7();Y7();J7();tK();rK();sK();uK();pK();fK();mK();yK();vK();wK();CK();TK();EK();DK();AK();MK();PK();zK();VK();UK();GK();HK();XK();YK();JK();t9();r9();a9();c9();l9();d9();x9();b9();S9();_9();I9();N9();k9();O9();R9();F9();L9();z9();V9();U9();G9();H9();X9();Y9();J9();tX();rX();sX();aX();uX();pX();fX();mX();yX();vX();wX();CX();TX();EX();NX();DX();AX();MX();PX();$X();zX();VX();UX();GX();HX();XX();YX();JX();tQ();o0();GAe=[Y1,l7,h7,d7,g7,x7,b7,S7,_7,I7,N7,k7,R7,L7,B7,q7,j7,W7,K7,Q7,Z7,eK,oK,nK,cK,lK,hK,dK,gK,xK,j9,bK,SK,_K,IK,NK,OK,kK,RK,LK,BK,qK,jK,WK,KK,QK,ZK,e9,n9,i9,VP,VP,u9,f9,y9,v9,w9,C9,T9,E9,D9,A9,M9,P9,$9,qP,qP,B9,q9,W9,K9,Q9,Z9,eX,nX,oX,iX,cX,lX,hX,dX,gX,xX,bX,SX,_X,IX,UP,UP,jP,jP,kX,RX,OX,FX,LX,BX,qX,jX,WX,KX,QX,ZX,eQ];for(let n of GAe)wR(n)});var rQ=b(()=>{"use strict";Ct();Ae();K.prototype.abs=function(){return this.throwIfDisposed(),Jn(this)}});var oQ=b(()=>{"use strict";Ct();Ae();K.prototype.acos=function(){return this.throwIfDisposed(),Fx(this)}});var sQ=b(()=>{"use strict";Ct();Ae();K.prototype.acosh=function(){return this.throwIfDisposed(),$x(this)}});var iQ=b(()=>{"use strict";Ct();Ae();K.prototype.addStrict=function(n){return this.throwIfDisposed(),aP(this,n)}});var aQ=b(()=>{"use strict";mr();Ae();K.prototype.add=function(n){return this.throwIfDisposed(),je(this,n)}});var cQ=b(()=>{"use strict";c2();Ae();K.prototype.all=function(n,t){return this.throwIfDisposed(),vf(this,n,t)}});var uQ=b(()=>{"use strict";u2();Ae();K.prototype.any=function(n,t){return this.throwIfDisposed(),th(this,n,t)}});var lQ=b(()=>{"use strict";l2();Ae();K.prototype.argMax=function(n){return this.throwIfDisposed(),nh(this,n)}});var pQ=b(()=>{"use strict";p2();Ae();K.prototype.argMin=function(n){return this.throwIfDisposed(),Lx(this,n)}});var hQ=b(()=>{"use strict";bt();Ae();ze();K.prototype.asScalar=function(){return this.throwIfDisposed(),q(this.size===1,()=>"The array must have only 1 element."),ue(this,[])}});var fQ=b(()=>{"use strict";Ct();Ae();K.prototype.asType=function(n){return this.throwIfDisposed(),Ye(this,n)}});var dQ=b(()=>{"use strict";bt();Ae();K.prototype.as1D=function(){return this.throwIfDisposed(),ue(this,[this.size])}});var mQ=b(()=>{"use strict";bt();Ae();K.prototype.as2D=function(n,t){return this.throwIfDisposed(),ue(this,[n,t])}});var gQ=b(()=>{"use strict";bt();Ae();K.prototype.as3D=function(n,t,e){return this.throwIfDisposed(),ue(this,[n,t,e])}});var yQ=b(()=>{"use strict";bt();Ae();K.prototype.as4D=function(n,t,e,r){return this.throwIfDisposed(),ue(this,[n,t,e,r])}});var xQ=b(()=>{"use strict";bt();Ae();K.prototype.as5D=function(n,t,e,r,o){return this.throwIfDisposed(),ue(this,[n,t,e,r,o])}});var vQ=b(()=>{"use strict";Ct();Ae();K.prototype.asin=function(){return this.throwIfDisposed(),zx(this)}});var bQ=b(()=>{"use strict";Ct();Ae();K.prototype.asinh=function(){return this.throwIfDisposed(),Bx(this)}});var wQ=b(()=>{"use strict";Ct();Ae();K.prototype.atan=function(){return this.throwIfDisposed(),Vx(this)}});var SQ=b(()=>{"use strict";h2();Ae();K.prototype.atan2=function(n){return this.throwIfDisposed(),qx(this,n)}});var CQ=b(()=>{"use strict";Ct();Ae();K.prototype.atanh=function(){return this.throwIfDisposed(),Ux(this)}});var _Q=b(()=>{"use strict";BI();Ae();K.prototype.avgPool=function(n,t,e,r){return this.throwIfDisposed(),tl(this,n,t,e,r)}});var TQ=b(()=>{"use strict";m0();Ae();K.prototype.batchToSpaceND=function(n,t){return this.throwIfDisposed(),nl(this,n,t)}});var IQ=b(()=>{"use strict";Wx();Ae();K.prototype.batchNorm=function(n,t,e,r,o){return this.throwIfDisposed(),Ui(this,n,t,e,r,o)}});var EQ=b(()=>{"use strict";GI();Ae();K.prototype.broadcastTo=function(n){return this.throwIfDisposed(),rh(this,n)}});var NQ=b(()=>{"use strict";Ct();Ae();K.prototype.cast=function(n){return this.throwIfDisposed(),Ye(this,n)}});var DQ=b(()=>{"use strict";Ct();Ae();K.prototype.ceil=function(){return this.throwIfDisposed(),Hx(this)}});var kQ=b(()=>{"use strict";Ct();Ae();K.prototype.clipByValue=function(n,t){return this.throwIfDisposed(),oo(this,n,t)}});var AQ=b(()=>{"use strict";wi();Ae();K.prototype.concat=function(n,t){return this.throwIfDisposed(),n instanceof K&&(n=[n]),gn([this,...n],t)}});var OQ=b(()=>{"use strict";y2();Ae();K.prototype.conv1d=function(n,t,e,r,o,s){return this.throwIfDisposed(),bf(this,n,t,e,r,o,s)}});var MQ=b(()=>{"use strict";x2();Ae();K.prototype.conv2dTranspose=function(n,t,e,r,o){return this.throwIfDisposed(),wf(this,n,t,e,r,o)}});var RQ=b(()=>{"use strict";Xm();Ae();K.prototype.conv2d=function(n,t,e,r,o,s){return this.throwIfDisposed(),vs(this,n,t,e,r,o,s)}});var PQ=b(()=>{"use strict";Ct();Ae();K.prototype.cos=function(){return this.throwIfDisposed(),rl(this)}});var FQ=b(()=>{"use strict";Ct();Ae();K.prototype.cosh=function(){return this.throwIfDisposed(),Sf(this)}});var $Q=b(()=>{"use strict";JI();Ae();K.prototype.cumsum=function(n,t,e){return this.throwIfDisposed(),Cf(this,n,t,e)}});var LQ=b(()=>{"use strict";w2();Ae();K.prototype.depthToSpace=function(n,t){return this.throwIfDisposed(),Qx(this,n,t)}});var zQ=b(()=>{"use strict";Ms();Yx();Ae();K.prototype.depthwiseConv2D=function(n,t,e,r,o,s){return Pr("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),Si(this,n,t,e,r,o,s)}});var BQ=b(()=>{"use strict";Yx();Ae();K.prototype.depthwiseConv2d=function(n,t,e,r,o,s){return this.throwIfDisposed(),Si(this,n,t,e,r,o,s)}});var VQ=b(()=>{"use strict";S2();Ae();K.prototype.dilation2d=function(n,t,e,r,o){return this.throwIfDisposed(),Zx(this,n,t,e,r,o)}});var qQ=b(()=>{"use strict";C2();Ae();K.prototype.divNoNan=function(n){return this.throwIfDisposed(),ev(this,n)}});var UQ=b(()=>{"use strict";Ct();Ae();K.prototype.divStrict=function(n){return this.throwIfDisposed(),cP(this,n)}});var jQ=b(()=>{"use strict";qn();Ae();K.prototype.div=function(n){return this.throwIfDisposed(),ct(this,n)}});var GQ=b(()=>{"use strict";_2();Ae();K.prototype.dot=function(n){return this.throwIfDisposed(),t1(this,n)}});var WQ=b(()=>{"use strict";n1();Ae();K.prototype.elu=function(){return this.throwIfDisposed(),xa(this)}});var HQ=b(()=>{"use strict";Ct();Ae();K.prototype.equalStrict=function(n){return this.throwIfDisposed(),tP(this,n)}});var KQ=b(()=>{"use strict";Jx();Ae();K.prototype.equal=function(n){return this.throwIfDisposed(),bs(this,n)}});var XQ=b(()=>{"use strict";Ct();Ae();K.prototype.erf=function(){return this.throwIfDisposed(),tv(this)}});var QQ=b(()=>{"use strict";Ct();Ae();K.prototype.exp=function(){return this.throwIfDisposed(),Wr(this)}});var YQ=b(()=>{"use strict";g0();Ae();K.prototype.expandDims=function(n){return this.throwIfDisposed(),Io(this,n)}});var ZQ=b(()=>{"use strict";Ct();Ae();K.prototype.expm1=function(){return this.throwIfDisposed(),nv(this)}});var JQ=b(()=>{"use strict";Ct();Ae();K.prototype.fft=function(){return this.throwIfDisposed(),dl(this)}});var eY=b(()=>{"use strict";bt();Ae();K.prototype.flatten=function(){return this.throwIfDisposed(),ue(this,[this.size])}});var tY=b(()=>{"use strict";Ct();Ae();K.prototype.floor=function(){return this.throwIfDisposed(),va(this)}});var nY=b(()=>{"use strict";$I();Ae();K.prototype.floorDiv=function(n){return this.throwIfDisposed(),xf(this,n)}});var rY=b(()=>{"use strict";x0();Ae();K.prototype.gather=function(n,t){return this.throwIfDisposed(),ji(this,n,t)}});var oY=b(()=>{"use strict";Ct();Ae();K.prototype.greaterEqualStrict=function(n){return this.throwIfDisposed(),nP(this,n)}});var sY=b(()=>{"use strict";Tf();Ae();K.prototype.greaterEqual=function(n){return this.throwIfDisposed(),Yo(this,n)}});var iY=b(()=>{"use strict";Ct();Ae();K.prototype.greaterStrict=function(n){return this.throwIfDisposed(),rP(this,n)}});var aY=b(()=>{"use strict";il();Ae();K.prototype.greater=function(n){return this.throwIfDisposed(),Fr(this,n)}});var cY=b(()=>{"use strict";Ct();Ae();K.prototype.ifft=function(){return this.throwIfDisposed(),gc(this)}});var uY=b(()=>{"use strict";Ct();Ae();K.prototype.irfft=function(){return this.throwIfDisposed(),zf(this)}});var lY=b(()=>{"use strict";Ct();Ae();K.prototype.isFinite=function(){return this.throwIfDisposed(),i1(this)}});var pY=b(()=>{"use strict";Ct();Ae();K.prototype.isInf=function(){return this.throwIfDisposed(),a1(this)}});var hY=b(()=>{"use strict";Ct();Ae();K.prototype.isNaN=function(){return this.throwIfDisposed(),c1(this)}});var fY=b(()=>{"use strict";u1();Ae();K.prototype.leakyRelu=function(n){return this.throwIfDisposed(),al(this,n)}});var dY=b(()=>{"use strict";Ct();Ae();K.prototype.lessEqualStrict=function(n){return this.throwIfDisposed(),oP(this,n)}});var mY=b(()=>{"use strict";Ef();Ae();K.prototype.lessEqual=function(n){return this.throwIfDisposed(),Rs(this,n)}});var gY=b(()=>{"use strict";Ct();Ae();K.prototype.lessStrict=function(n){return this.throwIfDisposed(),sP(this,n)}});var yY=b(()=>{"use strict";v0();Ae();K.prototype.less=function(n){return this.throwIfDisposed(),cl(this,n)}});var xY=b(()=>{"use strict";I2();Ae();K.prototype.localResponseNormalization=function(n,t,e,r){return this.throwIfDisposed(),rv(this,n,t,e,r)}});var vY=b(()=>{"use strict";Ct();Ae();K.prototype.logSigmoid=function(){return this.throwIfDisposed(),h1(this)}});var bY=b(()=>{"use strict";Ct();Ae();K.prototype.logSoftmax=function(n){return this.throwIfDisposed(),Df(this,n)}});var wY=b(()=>{"use strict";f1();Ae();K.prototype.logSumExp=function(n,t){return this.throwIfDisposed(),iv(this,n,t)}});var SY=b(()=>{"use strict";Ct();Ae();K.prototype.log=function(){return this.throwIfDisposed(),so(this)}});var CY=b(()=>{"use strict";Ct();Ae();K.prototype.log1p=function(){return this.throwIfDisposed(),Nf(this)}});var _Y=b(()=>{"use strict";Ym();Ae();K.prototype.logicalAnd=function(n){return this.throwIfDisposed(),vo(this,n)}});var TY=b(()=>{"use strict";S0();Ae();K.prototype.logicalNot=function(){return this.throwIfDisposed(),ul(this)}});var IY=b(()=>{"use strict";d1();Ae();K.prototype.logicalOr=function(n){return this.throwIfDisposed(),kf(this,n)}});var EY=b(()=>{"use strict";M2();Ae();K.prototype.logicalXor=function(n){return this.throwIfDisposed(),m1(this,n)}});var NY=b(()=>{"use strict";Ju();Ae();K.prototype.matMul=function(n,t,e){return this.throwIfDisposed(),an(this,n,t,e)}});var DY=b(()=>{"use strict";g1();Ae();K.prototype.maxPool=function(n,t,e,r){return this.throwIfDisposed(),ll(this,n,t,e,r)}});var kY=b(()=>{"use strict";sv();Ae();K.prototype.max=function(n,t){return this.throwIfDisposed(),io(this,n,t)}});var AY=b(()=>{"use strict";Ct();Ae();K.prototype.maximumStrict=function(n){return this.throwIfDisposed(),uP(this,n)}});var OY=b(()=>{"use strict";cv();Ae();K.prototype.maximum=function(n){return this.throwIfDisposed(),$o(this,n)}});var MY=b(()=>{"use strict";C0();Ae();K.prototype.mean=function(n,t){return this.throwIfDisposed(),Un(this,n,t)}});var RY=b(()=>{"use strict";x1();Ae();K.prototype.min=function(n,t){return this.throwIfDisposed(),mc(this,n,t)}});var PY=b(()=>{"use strict";Ct();Ae();K.prototype.minimumStrict=function(n){return this.throwIfDisposed(),lP(this,n)}});var FY=b(()=>{"use strict";_0();Ae();K.prototype.minimum=function(n){return this.throwIfDisposed(),_i(this,n)}});var $Y=b(()=>{"use strict";R2();Ae();K.prototype.mirrorPad=function(n,t){return this.throwIfDisposed(),uv(this,n,t)}});var LY=b(()=>{"use strict";Ct();Ae();K.prototype.modStrict=function(n){return this.throwIfDisposed(),pP(this,n)}});var zY=b(()=>{"use strict";v1();Ae();K.prototype.mod=function(n){return this.throwIfDisposed(),Af(this,n)}});var BY=b(()=>{"use strict";Ct();Ae();K.prototype.mulStrict=function(n){return this.throwIfDisposed(),hP(this,n)}});var VY=b(()=>{"use strict";Rt();Ae();K.prototype.mul=function(n){return this.throwIfDisposed(),oe(this,n)}});var qY=b(()=>{"use strict";Ct();Ae();K.prototype.neg=function(){return this.throwIfDisposed(),un(this)}});var UY=b(()=>{"use strict";Ct();Ae();K.prototype.norm=function(n,t,e){return this.throwIfDisposed(),ig(this,n,t,e)}});var jY=b(()=>{"use strict";Ct();Ae();K.prototype.notEqualStrict=function(n){return this.throwIfDisposed(),iP(this,n)}});var GY=b(()=>{"use strict";T0();Ae();K.prototype.notEqual=function(n){return this.throwIfDisposed(),Zs(this,n)}});var WY=b(()=>{"use strict";NI();Ae();K.prototype.oneHot=function(n,t=1,e=0){return this.throwIfDisposed(),ga(this,n,t,e)}});var HY=b(()=>{"use strict";Ct();Ae();K.prototype.onesLike=function(){return this.throwIfDisposed(),Yr(this)}});var KY=b(()=>{"use strict";Of();Ae();K.prototype.pad=function(n,t){return this.throwIfDisposed(),Jo(this,n,t)}});var XY=b(()=>{"use strict";P2();Ae();K.prototype.pool=function(n,t,e,r,o){return this.throwIfDisposed(),w1(this,n,t,e,r,o)}});var QY=b(()=>{"use strict";Ct();Ae();K.prototype.powStrict=function(n){return this.throwIfDisposed(),fP(this,n)}});var YY=b(()=>{"use strict";sh();Ae();K.prototype.pow=function(n){return this.throwIfDisposed(),Eo(this,n)}});var ZY=b(()=>{"use strict";S1();Ae();K.prototype.prelu=function(n){return this.throwIfDisposed(),hl(this,n)}});var JY=b(()=>{"use strict";F2();Ae();K.prototype.prod=function(n,t){return this.throwIfDisposed(),Mf(this,n,t)}});var eZ=b(()=>{"use strict";Ct();Ae();K.prototype.reciprocal=function(){return this.throwIfDisposed(),pv(this)}});var tZ=b(()=>{"use strict";hv();Ae();K.prototype.relu=function(){return this.throwIfDisposed(),zo(this)}});var nZ=b(()=>{"use strict";D1();Ae();K.prototype.relu6=function(){return this.throwIfDisposed(),Rf(this)}});var rZ=b(()=>{"use strict";bt();Ae();K.prototype.reshapeAs=function(n){return this.throwIfDisposed(),ue(this,n.shape)}});var oZ=b(()=>{"use strict";bt();Ae();K.prototype.reshape=function(n){return this.throwIfDisposed(),ue(this,n)}});var sZ=b(()=>{"use strict";TP();Ae();K.prototype.resizeBilinear=function(n,t,e){return this.throwIfDisposed(),H1(this,n,t,e)}});var iZ=b(()=>{"use strict";IP();Ae();K.prototype.resizeNearestNeighbor=function(n,t,e){return this.throwIfDisposed(),K1(this,n,t,e)}});var aZ=b(()=>{"use strict";ah();Ae();K.prototype.reverse=function(n){return this.throwIfDisposed(),$r(this,n)}});var cZ=b(()=>{"use strict";Ct();Ae();K.prototype.rfft=function(){return this.throwIfDisposed(),ml(this)}});var uZ=b(()=>{"use strict";Ct();Ae();K.prototype.round=function(){return this.throwIfDisposed(),fv(this)}});var lZ=b(()=>{"use strict";Ct();Ae();K.prototype.rsqrt=function(){return this.throwIfDisposed(),Pf(this)}});var pZ=b(()=>{"use strict";W2();Ae();K.prototype.selu=function(){return this.throwIfDisposed(),Ff(this)}});var hZ=b(()=>{"use strict";H2();Ae();K.prototype.separableConv2d=function(n,t,e,r,o,s){return this.throwIfDisposed(),dv(this,n,t,e,r,o,s)}});var fZ=b(()=>{"use strict";Ct();Ae();K.prototype.sigmoid=function(){return this.throwIfDisposed(),xs(this)}});var dZ=b(()=>{"use strict";Ct();Ae();K.prototype.sign=function(){return this.throwIfDisposed(),mv(this)}});var mZ=b(()=>{"use strict";Ct();Ae();K.prototype.sin=function(){return this.throwIfDisposed(),$f(this)}});var gZ=b(()=>{"use strict";Ct();Ae();K.prototype.sinh=function(){return this.throwIfDisposed(),Lf(this)}});var yZ=b(()=>{"use strict";Ct();Ae();K.prototype.slice=function(n,t){return this.throwIfDisposed(),Bt(this,n,t)}});var xZ=b(()=>{"use strict";Ct();Ae();K.prototype.softmax=function(n){return this.throwIfDisposed(),fl(this,n)}});var vZ=b(()=>{"use strict";Ct();Ae();K.prototype.softplus=function(){return this.throwIfDisposed(),ba(this)}});var bZ=b(()=>{"use strict";I0();Ae();K.prototype.spaceToBatchND=function(n,t){return this.throwIfDisposed(),pl(this,n,t)}});var wZ=b(()=>{"use strict";xv();Ae();K.prototype.split=function(n,t){return this.throwIfDisposed(),co(this,n,t)}});var SZ=b(()=>{"use strict";Ct();Ae();K.prototype.sqrt=function(){return this.throwIfDisposed(),jn(this)}});var CZ=b(()=>{"use strict";Ct();Ae();K.prototype.square=function(){return this.throwIfDisposed(),Gt(this)}});var _Z=b(()=>{"use strict";k0();Ae();K.prototype.squaredDifference=function(n){return this.throwIfDisposed(),gl(this,n)}});var TZ=b(()=>{"use strict";Ct();Ae();K.prototype.squaredDifferenceStrict=function(n){return this.throwIfDisposed(),dP(this,n)}});var IZ=b(()=>{"use strict";A0();Ae();K.prototype.squeeze=function(n){return this.throwIfDisposed(),Js(this,n)}});var EZ=b(()=>{"use strict";og();Ae();K.prototype.stack=function(n,t){this.throwIfDisposed();let e=n instanceof K?[this,n]:[this,...n];return Ir(e,t)}});var NZ=b(()=>{"use strict";Ct();Ae();K.prototype.step=function(n){return this.throwIfDisposed(),Ca(this,n)}});var DZ=b(()=>{"use strict";Ct();Ae();K.prototype.stridedSlice=function(n,t,e,r,o,s,i,a){return this.throwIfDisposed(),bv(this,n,t,e,r,o,s,i,a)}});var kZ=b(()=>{"use strict";Ct();Ae();K.prototype.subStrict=function(n){return this.throwIfDisposed(),mP(this,n)}});var AZ=b(()=>{"use strict";Hn();Ae();K.prototype.sub=function(n){return this.throwIfDisposed(),at(this,n)}});var OZ=b(()=>{"use strict";Hr();Ae();K.prototype.sum=function(n,t){return this.throwIfDisposed(),gt(this,n,t)}});var MZ=b(()=>{"use strict";Ct();Ae();K.prototype.tan=function(){return this.throwIfDisposed(),wv(this)}});var RZ=b(()=>{"use strict";Ct();Ae();K.prototype.tanh=function(){return this.throwIfDisposed(),fc(this)}});var PZ=b(()=>{"use strict";y0();Ae();K.prototype.tile=function(n){return this.throwIfDisposed(),Ci(this,n)}});var FZ=b(()=>{"use strict";Ct();Ae();K.prototype.toBool=function(){return this.throwIfDisposed(),Ye(this,"bool")}});var $Z=b(()=>{"use strict";Ct();Ae();K.prototype.toFloat=function(){return this.throwIfDisposed(),Ye(this,"float32")}});var LZ=b(()=>{"use strict";Ct();Ae();K.prototype.toInt=function(){return this.throwIfDisposed(),Ye(this,"int32")}});var zZ=b(()=>{"use strict";Y2();Ae();K.prototype.topk=function(n,t){return this.throwIfDisposed(),Cv(this,n,t)}});var BZ=b(()=>{"use strict";yf();Ae();K.prototype.transpose=function(n){return this.throwIfDisposed(),pn(this,n)}});var VZ=b(()=>{"use strict";Z2();Ae();K.prototype.unique=function(n){return this.throwIfDisposed(),sg(this,n)}});var qZ=b(()=>{"use strict";P1();Ae();K.prototype.unsortedSegmentSum=function(n,t){return this.throwIfDisposed(),_v(this,n,t)}});var UZ=b(()=>{"use strict";Tv();Ae();K.prototype.unstack=function(n){return this.throwIfDisposed(),uo(this,n)}});var jZ=b(()=>{"use strict";ya();Ae();K.prototype.where=function(n,t){return this.throwIfDisposed(),pr(n,this,t)}});var GZ=b(()=>{"use strict";Ct();Ae();K.prototype.zerosLike=function(){return this.throwIfDisposed(),Et(this)}});var WZ=b(()=>{"use strict";rQ();oQ();sQ();iQ();aQ();cQ();uQ();lQ();pQ();hQ();fQ();dQ();mQ();gQ();yQ();xQ();vQ();bQ();wQ();SQ();CQ();_Q();TQ();IQ();EQ();NQ();DQ();kQ();AQ();OQ();MQ();RQ();PQ();FQ();$Q();LQ();zQ();BQ();VQ();qQ();UQ();jQ();GQ();WQ();HQ();KQ();XQ();QQ();YQ();ZQ();JQ();eY();tY();nY();rY();oY();sY();iY();aY();cY();uY();lY();pY();hY();fY();dY();mY();gY();yY();xY();vY();bY();wY();SY();CY();_Y();TY();IY();EY();NY();DY();kY();AY();OY();MY();RY();PY();FY();$Y();LY();zY();BY();VY();qY();UY();jY();GY();WY();HY();KY();XY();QY();YY();ZY();JY();eZ();tZ();nZ();rZ();oZ();sZ();iZ();aZ();cZ();uZ();lZ();pZ();hZ();fZ();dZ();mZ();gZ();yZ();xZ();vZ();bZ();wZ();SZ();CZ();_Z();TZ();IZ();EZ();NZ();DZ();kZ();AZ();OZ();MZ();RZ();PZ();FZ();$Z();LZ();zZ();BZ();VZ();qZ();UZ();jZ();GZ();});var $=b(()=>{"use strict";tH();u7();nQ();WZ();});function Zr(){return GP==null&&(GP=a2().epsilon()),GP}function Ps(){return"channelsLast"}var GP,ch=b(()=>{"use strict";$();});var Wi,Fs,he,At,J1,Gn=b(()=>{"use strict";Wi=class n extends Error{constructor(t){super(t),Object.setPrototypeOf(this,n.prototype)}},Fs=class n extends Error{constructor(t){super(t),Object.setPrototypeOf(this,n.prototype)}},he=class n extends Error{constructor(t){super(t),Object.setPrototypeOf(this,n.prototype)}},At=class n extends Error{constructor(t){super(t),Object.setPrototypeOf(this,n.prototype)}},J1=class n extends Error{constructor(t){super(t),Object.setPrototypeOf(this,n.prototype)}}});function Ia(n,t){if(Array.isArray(n)){let e=[];for(let r=0;r<t;r++)e=e.concat(n);return e}else{let e=new Array(t);return e.fill(n),e}}function Hi(n,t){if(!n)throw new J1(t)}function HP(n,t){let e=0;for(let r of n)r===t&&e++;return e}function No(n){return n.length===1?n[0]:n}function Kn(n){return Array.isArray(n)?n:[n]}function Ea(n){let e=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return e[0]!=="_"?e:"private"+e}function uh(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,(t,e)=>e.toUpperCase())}function kv(n){if(n==null)return null;let t={};return t.className=n.getClassName(),t.config=n.getConfig(),t}function WP(n){if(!(n==null||typeof n!="object"))if(Array.isArray(n))n.forEach(t=>WP(t));else{let t=Object.keys(n);for(let e of t){let r=n[e];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?n[e]=r.value:WP(r))}}}function vl(n,t={},e={},r="object",o=!1){if(typeof n=="string"){let s=n,i;if(s in e)i=e[s];else if(s in Ta)i=Ta[s];else if(i=t[s],i==null)throw new he(`Unknown ${r}: ${n}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{let s=n;if(s.className==null||s.config==null)throw new he(`${r}: Improper config format: ${JSON.stringify(s)}.
'className' and 'config' must set.`);let i=s.className,a,c;if(i in e?[a,c]=e[i]:i in Ta?[a,c]=Ta.className:i in t&&([a,c]=t[i]),a==null)throw new he(`Unknown ${r}: ${i}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(c!=null){let l={};for(let d of Object.keys(Ta))l[d]=Ta[d];for(let d of Object.keys(e))l[d]=e[d];let p=s.config;p.customObjects=l;let f=Object.assign({},Ta);for(let d of Object.keys(e))Ta[d]=e[d];WP(s.config);let y=c(a,s.config,e,o);return Ta=Object.assign({},f),y}else{let l=Object.assign({},Ta);for(let f of Object.keys(e))Ta[f]=e[f];let p=new a(s.config);return Ta=Object.assign({},l),p}}}function WAe(n,t){return n<t?-1:n>t?1:0}function q0(n,t){return-1*WAe(n,t)}function Na(n){if(n==null)return n;let t=[];for(let e of n)t.indexOf(e)===-1&&t.push(e);return t}function HZ(n){if(n==null)throw new he(`Invalid value in obj: ${JSON.stringify(n)}`);for(let t in n)if(n.hasOwnProperty(t))return!1;return!0}function bl(n,t,e){if(e!=null&&n.indexOf(e)<0)throw new he(`${e} is not a valid ${t}.  Valid values are ${n} or null/undefined.`)}function eE(n,t,e=0,r=1/0){return Hi(e>=0),Hi(r>=e),Array.isArray(n)&&n.length>=e&&n.length<=r&&n.every(o=>typeof o===t)}function zr(n,t){Array.isArray(n)?(N.assert(n.length>0,()=>`${t} is unexpectedly an empty array.`),n.forEach((e,r)=>zr(e,`element ${r+1} of ${t}`))):N.assert(Number.isInteger(n)&&n>0,()=>`Expected ${t} to be a positive integer, but got ${KZ(n)}.`)}function KZ(n){return n===null?"null":Array.isArray(n)?"["+n.map(t=>KZ(t)).join(",")+"]":typeof n=="string"?`"${n}"`:`${n}`}function XZ(n,t){let e=N.now(),r;return(...s)=>{let i=N.now();return i-e<t||(e=i,r=n(...s)),r}}function tE(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}var Ta,Dr=b(()=>{"use strict";$();Gn();Ta={}});function KP(n,t){return de(()=>jn(gt(oe(n,n),t,!0)))}function Sr(n){return kv(n)}function YZ(n,t={}){return vl(n,He.SerializationMap.getMap().classNameMap,t,"constraint")}function Cr(n){if(n==null)return null;if(typeof n=="string"){let e={className:n in QZ?QZ[n]:n,config:{}};return YZ(e)}else return n instanceof fg?n:YZ(n)}var fg,XP,QP,YP,ZP,QZ,lh=b(()=>{"use strict";$();$();ch();Dr();fg=class extends He.Serializable{getConfig(){return{}}},XP=(()=>{class n extends fg{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return de(()=>{let r=KP(e,this.axis),o=oo(r,0,this.maxValue);return oe(e,ct(o,je(Zr(),r)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}return n.className="MaxNorm",n})();He.registerClass(XP);QP=(()=>{class n extends fg{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return de(()=>ct(e,je(Zr(),KP(e,this.axis))))}getConfig(){return{axis:this.axis}}}return n.className="UnitNorm",n})();He.registerClass(QP);YP=(()=>{class n extends fg{apply(e){return zo(e)}}return n.className="NonNeg",n})();He.registerClass(YP);ZP=(()=>{class n extends fg{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return de(()=>{let r=KP(e,this.axis),o=je(oe(this.rate,oo(r,this.minValue,this.maxValue)),oe(1-this.rate,r));return oe(e,ct(o,je(Zr(),r)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}return n.className="MinMaxNorm",n})();He.registerClass(ZP);QZ={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"}});var JP={};xn(JP,{maxNorm:()=>HAe,minMaxNorm:()=>QAe,nonNeg:()=>XAe,unitNorm:()=>KAe});function HAe(n){return new XP(n)}function KAe(n){return new QP(n)}function XAe(){return new YP}function QAe(n){return new ZP(n)}var ZZ=b(()=>{"use strict";lh();});var JZ,eJ,tJ,nJ,rJ,eF=b(()=>{"use strict";JZ=["channelsFirst","channelsLast"],eJ=["nearest","bilinear"],tJ=["valid","same","causal"],nJ=["max","avg"],rJ=["sum","mul","concat","ave"]});function yr(n){bl(JZ,"DataFormat",n)}function sJ(n){bl(eJ,"InterpolationFormat",n)}function $s(n){bl(tJ,"PaddingMode",n)}function tF(n){bl(nJ,"PoolMode",n)}function Sc(n,t){U0.push(n);try{let e=t();return U0.pop(),e}catch(e){throw U0.pop(),e}}function YAe(){return U0.length===0?"":U0.join(oJ)+oJ}function nE(n){if(!iJ(n))throw new Error("Not a valid tensor name: '"+n+"'");return YAe()+n}function rE(n){if(!iJ(n))throw new Error("Not a valid tensor name: '"+n+"'");Av.has(n)||Av.set(n,0);let t=Av.get(n);if(Av.set(n,Av.get(n)+1),t>0){let e=`${n}_${t}`;return Av.set(e,1),e}else return n}function iJ(n){return!!n.match(ZAe)}var Av,U0,oJ,ZAe,Da=b(()=>{"use strict";eF();Dr();Av=new Map;U0=[],oJ="/";ZAe=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/)});function aJ(n){return n===parseInt(n.toString(),10)}function ka(n,t,e){t==null&&(t=0),e==null&&(e=n.length);let r=1;for(let o=t;o<e;++o)r*=n[o];return r}function cJ(n){return n=Array.isArray(n)?new Float32Array(n):n,Er(n)}function dg(n){return mc(cJ(n)).dataSync()[0]}function Cc(n){return io(cJ(n)).dataSync()[0]}function Ss(n,t){if(t<n)throw new he(`end (${t}) < begin (${n}) is forbidden.`);let e=[];for(let r=n;r<t;++r)e.push(r);return e}var wl=b(()=>{"use strict";$();$();Gn();});function hh(n,t){return n.asType(t)}function fh(n,t=-1){let e=n.shape.slice();return t<0&&(t=e.length+t+1),e.splice(t,0,1),n.reshape(e)}function uJ(n,t){return de(()=>{if(n.shape.length!==2)throw new he(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);let e=fh(n,1);return sE(e,[1,t,1])})}function lJ(n){let t=[ka(n.shape)];return n.reshape(t)}function pJ(n){if(n.rank<=1)throw new he(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);let t=[n.shape[0],ka(n.shape,1)];return n.reshape(t)}function ph(n,t,e){return de(()=>{switch(n.rank){case 1:return gv(n,t,e);case 2:return D0(n,[t,0],[e,n.shape[1]]);case 3:return yv(n,[t,0,0],[e,n.shape[1],n.shape[2]]);case 4:return rg(n,[t,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3]]);case 5:return Bt(n,[t,0,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return Bt(n,[t,0,0,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new he(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function nF(n,t,e){return de(()=>{switch(n.rank){case 1:return gv(n,t,e);case 2:return D0(n,[0,t],[n.shape[0],e]);case 3:return yv(n,[0,0,t],[n.shape[0],n.shape[1],e]);case 4:return rg(n,[0,0,0,t],[n.shape[0],n.shape[1],n.shape[2],e]);default:throw new he(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function j0(n,t,e,r){return de(()=>{switch(n.rank){case 1:return gv(n,t,e);case 2:switch(r){case 1:return ph(n,t,e);case 2:return nF(n,t,e);default:throw new he(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return ph(n,t,e);case 2:return yv(n,[0,t,0],[n.shape[0],e,n.shape[2]]);case 3:return nF(n,t,e);default:throw new he(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return ph(n,t,e);case 2:return rg(n,[0,t,0,0],[n.shape[0],e,n.shape[2],n.shape[3]]);case 3:return rg(n,[0,0,t,0],[n.shape[0],n.shape[1],e,n.shape[3]]);case 4:return nF(n,t,e);default:throw new he(`The axis is not within the rank of the tensor ${r}`)}default:throw new he(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function Ov(n,t=-1){let e;return t<0&&(e=n[0].rank,e!==0?t=e:t=0),t===n[0].rank&&(t=-1),gn(n,t)}function oF(n,t){switch(n.rank){case 1:return WI([n,t]);case 2:return HI([n,t],0);case 3:return KI([n,t],0);case 4:return XI([n,t],0);default:throw new he(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function sE(n,t){if(Array.isArray(t)||(t=[t]),n.rank!==t.length)throw new he(`The length of input n (${t.length}) does not match the number of dimensions in input x (${n.rank})`);return Ci(n,t)}function Mv(n,t=0,e=1,r,o){return N0(n,t,e,r,o)}function Aa(n,t,e,r){if(n.rank<2||t.rank<2)throw new At(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${t.shape}`);if(t.rank>=3){let o=n.shape.slice(-1)[0],s=t.shape.slice(-2)[0];if(o!==s)throw new At(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${t.shape}`)}if(n.rank===2&&t.rank===2)return Gi.matMul({a:n,b:t,transposeA:!1,transposeB:!1,bias:r?rF(n.rank,r,Ps()):null,activation:e});{let o=n.shape.slice(),s=o.pop();n=n.reshape([-1,s]);let i=t.shape.slice(),a=i.pop(),c=i.pop(),l=[...i,a],p=Array.from({length:t.rank},(h,m)=>m===0?t.rank-2:m<=t.rank-2?m-1:m);t=t.transpose(p).reshape([c,-1]);let f=[...o,...l];return Gi.matMul({a:n,b:t,transposeA:!1,transposeB:!1,bias:r?rF(n.rank,r,Ps()):null,activation:e}).reshape(f)}}function iE(n,t,e){return de(()=>(Array.isArray(t)?t=Er(t,"int32"):t=t.toInt(),ji(n,t,e)))}function mg(n){return oe(n,n)}function rF(n,t,e){let r=t.shape;if(t.rank!==1&&t.rank!==n)throw new he(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${n}`);if(n===5){if(e==="channelsFirst")return r.length===1?t.reshape([1,r[0],1,1,1]):t.reshape([1,r[3],r[0],r[1],r[2]]);if(e==="channelsLast")return r.length===1?t.reshape([1,1,1,1,r[0]]):t.reshape([1].concat(r))}else if(n===4){if(e==="channelsFirst")return r.length===1?t.reshape([1,r[0],1,1]):t.reshape([1,r[2],r[0],r[1]]);if(e==="channelsLast")return r.length===1?t.reshape([1,1,1,r[0]]):t.reshape([1].concat(r))}else if(n===3){if(e==="channelsFirst")return r.length===1?t.reshape([1,r[0],1]):t.reshape([1,r[1],r[0]]);if(e==="channelsLast")return r.length===1?t.reshape([1,1,r[0]]):t.reshape([1].concat(r))}else if(n<3)return t;throw new he(`Unsupported input rank by biasAdd: ${t.rank}`)}function ei(n,t,e){return de(()=>(e==null&&(e=Ps()),yr(e),n.add(rF(n.rank,t,e))))}function hJ(n,t=1){if(t!==1)throw new At(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return xa(n)}function fJ(n){return de(()=>ct(n,Jn(n).add(1)))}function aE(n,t,e,r){return de(()=>xP(n,t,e,r))}function dJ(n){return de(()=>{let t=je(.5,oe(.2,n));return oo(t,0,1)})}function Uf(n,t,e=!1){return e?n():t()}var qo=b(()=>{"use strict";$();$();Da();Gn();wl();ch();});var mJ,gJ,yJ=b(()=>{"use strict";mJ=["fanIn","fanOut","fanAvg"],gJ=["normal","uniform","truncatedNormal"]});function JAe(n){bl(mJ,"FanMode",n)}function eOe(n){bl(gJ,"Distribution",n)}function tOe(n,t="channelsLast"){let e,r;if(yr(t),n.length===2)e=n[0],r=n[1];else if([3,4,5].indexOf(n.length)!==-1){if(t==="channelsFirst"){let o=ka(n,2);e=n[1]*o,r=n[0]*o}else if(t==="channelsLast"){let o=ka(n,0,n.length-2);e=n[n.length-2]*o,r=n[n.length-1]*o}}else{let o=ka(n);e=Math.sqrt(o),r=Math.sqrt(o)}return[e,r]}function vJ(n,t={}){return vl(n,He.SerializationMap.getMap().classNameMap,t,"initializer")}function tr(n){return kv(n)}function Wn(n){if(typeof n=="string"){let t=n in xJ?xJ[n]:n;if(t==="GlorotNormal")return new uE;if(t==="GlorotUniform")return new cE;if(t==="HeNormal")return new lE;if(t==="HeUniform")return new pE;if(t==="LeCunNormal")return new hE;if(t==="LeCunUniform")return new fE;{let e={};return e.className=t,e.config={},vJ(e)}}else return n instanceof zs?n:vJ(n)}var zs,sF,G0,iF,aF,cF,uF,lF,ti,cE,uE,lE,pE,hE,fE,pF,xJ,_c=b(()=>{"use strict";$();qo();Da();Gn();yJ();Dr();wl();zs=class extends He.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}},sF=(()=>{class n extends zs{apply(e,r){return An(e,r)}}return n.className="Zeros",n})();He.registerClass(sF);G0=(()=>{class n extends zs{apply(e,r){return Lo(e,r)}}return n.className="Ones",n})();He.registerClass(G0);iF=(()=>{class n extends zs{constructor(e){if(super(),typeof e!="object")throw new he(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new he(`config must have value set but got ${e}`);this.value=e.value}apply(e,r){return de(()=>oe(it(this.value),Lo(e,r)))}getConfig(){return{value:this.value}}}return n.className="Constant",n})();He.registerClass(iF);aF=(()=>{class n extends zs{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,r){return Sa(e,this.minval,this.maxval,r)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}return n.className="RandomUniform",n})();He.registerClass(aF);cF=(()=>{class n extends zs{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,r){if(r=r||"float32",r!=="float32"&&r!=="int32")throw new At(`randomNormal does not support dType ${r}.`);return Mv(e,this.mean,this.stddev,r,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}return n.className="RandomNormal",n})();He.registerClass(cF);uF=(()=>{class n extends zs{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,r){if(r=r||"float32",r!=="float32"&&r!=="int32")throw new At(`truncatedNormal does not support dType ${r}.`);return Bf(e,this.mean,this.stddev,r,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}return n.className="TruncatedNormal",n})();He.registerClass(uF);lF=(()=>{class n extends zs{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,r){return de(()=>{if(e.length!==2||e[0]!==e[1])throw new he("Identity matrix initializer can only be used for 2D square matrices.");return oe(this.gain,Qm(e[0]))})}getConfig(){return{gain:this.gain}}}return n.className="Identity",n})();He.registerClass(lF);ti=(()=>{class n extends zs{constructor(e){if(super(),e.scale<0)throw new he(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,JAe(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,eOe(this.distribution),this.seed=e.seed}apply(e,r){let o=tOe(e),s=o[0],i=o[1],a=this.scale;if(this.mode==="fanIn"?a/=Math.max(1,s):this.mode==="fanOut"?a/=Math.max(1,i):a/=Math.max(1,(s+i)/2),this.distribution==="normal"){let c=Math.sqrt(a);if(r=r||"float32",r!=="float32"&&r!=="int32")throw new At(`${this.getClassName()} does not support dType ${r}.`);return Bf(e,0,c,r,this.seed)}else{let c=Math.sqrt(3*a);return Sa(e,-c,c,r)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}return n.className="VarianceScaling",n})();He.registerClass(ti);cE=(()=>{class n extends ti{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return ti.className}}return n.className="GlorotUniform",n})();He.registerClass(cE);uE=(()=>{class n extends ti{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return ti.className}}return n.className="GlorotNormal",n})();He.registerClass(uE);lE=(()=>{class n extends ti{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return ti.className}}return n.className="HeNormal",n})();He.registerClass(lE);pE=(()=>{class n extends ti{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return ti.className}}return n.className="HeUniform",n})();He.registerClass(pE);hE=(()=>{class n extends ti{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return ti.className}}return n.className="LeCunNormal",n})();He.registerClass(hE);fE=(()=>{class n extends ti{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return ti.className}}return n.className="LeCunNormal",n})();He.registerClass(fE);pF=(()=>{class n extends zs{constructor(e){if(super(),this.DEFAULT_GAIN=1,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed,this.seed!=null)throw new At("Random seed is not implemented for Orthogonal Initializer yet.")}apply(e,r){return de(()=>{if(e.length<2)throw new At("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn(`Orthogonal initializer is being called on a matrix with more than 2000 (${e[0]*e[1]}) elements: Slowness may result.`);let o=e[0]>e[1]?[e[1],e[0]]:e,s=Mv(o,0,1,"float32"),i=EP.gramSchmidt(s);return e[0]>e[1]&&(i=i.transpose()),oe(this.gain,i)})}getConfig(){return{gain:this.gain,seed:this.seed}}}return n.className="Orthogonal",n})();He.registerClass(pF);xJ={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"}});var hF={};xn(hF,{constant:()=>oOe,glorotNormal:()=>pOe,glorotUniform:()=>lOe,heNormal:()=>hOe,heUniform:()=>fOe,identity:()=>cOe,leCunNormal:()=>dOe,leCunUniform:()=>mOe,ones:()=>rOe,orthogonal:()=>gOe,randomNormal:()=>iOe,randomUniform:()=>sOe,truncatedNormal:()=>aOe,varianceScaling:()=>uOe,zeros:()=>nOe});function nOe(){return new sF}function rOe(){return new G0}function oOe(n){return new iF(n)}function sOe(n){return new aF(n)}function iOe(n){return new cF(n)}function aOe(n){return new uF(n)}function cOe(n){return new lF(n)}function uOe(n){return new ti(n)}function lOe(n){return new cE(n)}function pOe(n){return new uE(n)}function hOe(n){return new lE(n)}function fOe(n){return new pE(n)}function dOe(n){return new hE(n)}function mOe(n){return new fE(n)}function gOe(n){return new pF(n)}var bJ=b(()=>{"use strict";_c();});function mE(){return yOe++}function jf(n=""){return n in dE||(dE[n]=0),dE[n]+=1,n+dE[n].toString()}var yOe,dE,Rv=b(()=>{"use strict";yOe=0;dE={}});function gE(n){return Array.isArray(n)&&Array.isArray(n[0])}function Pv(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function jt(n){let t;if(Array.isArray(n)){if(n.length!==1)throw new he(`Expected Tensor length to be 1; got ${n.length}`);t=n[0]}else t=n;return t}function bn(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return n=n,n[0];throw new he(`Expected exactly 1 Shape; got ${n.length}`)}else return n}var Cs=b(()=>{"use strict";Gn();});function Fv(n){let t=0;for(let e of n)e.shape.length===0?t+=1:t+=e.shape.reduce((r,o)=>r*o);return t}var fF=b(()=>{"use strict";});function vOe(n,t){if(n.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(t.shape))}function W0(n){return n.map(t=>t.read())}function Lv(n){n.forEach(t=>{t[0].write(t[1])})}var SJ,$v,H0=b(()=>{"use strict";$();$();Rv();Da();Gn();SJ="Variable",$v=class{constructor(t,e="float32",r=SJ,o=!0,s=null){this.dtype=e??"float32",this.shape=t.shape,this.id=mE(),r=r??SJ,this.originalName=nE(r),this.name=rE(this.originalName),this.trainable_=o,this.constraint=s,this.val=F1(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),vOe(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}});function SOe(n){n=Kn(n);let t=[];for(let e of n)t.push(e.shape);return No(t)}function COe(n){return"float32"}function dF(n,t,e){if((t==null||e!=null&&e>0)&&(t=n.sourceLayer,e=n.nodeIndex),t.inboundNodes.length===0)return[n];{let r=t.inboundNodes[e];if(r.inboundLayers.length===0)return r.inputTensors;{let o=[];for(let s=0;s<r.inboundLayers.length;s++){let i=r.inputTensors[s],a=r.inboundLayers[s],c=r.nodeIndices[s],l=dF(i,a,c);for(let p of l)o.indexOf(p)===-1&&o.push(p)}return o}}}var nr,ts,bOe,dh,wOe,Wt,bo=b(()=>{"use strict";$();Rv();Da();Gn();_c();Dr();Cs();fF();H0();nr=class{constructor(t){this.dtype=t.dtype,this.shape=t.shape,t.shape!=null?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}},ts=class{constructor(t,e,r,o,s,i,a){this.dtype=t,this.shape=e,this.sourceLayer=r,this.inputs=o,this.callArgs=s,this.outputTensorIndex=a,this.id=mE(),i!=null&&(this.originalName=nE(i),this.name=rE(this.originalName)),this.rank=e.length}},bOe=0,dh=class{constructor(t,e){this.callArgs=e,this.id=bOe++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(let r of t.inboundLayers)r?.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){let t=[];for(let e of this.inboundLayers)e!=null?t.push(e.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},wOe=0,Wt=class extends He.Serializable{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=wOe++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){let r=this.getClassName();e=Ea(r)+"_"+jf(r)}if(this.name=e,this.trainable_=t.trainable==null?!0:t.trainable,t.inputShape!=null||t.batchInputShape!=null){let r;if(t.batchInputShape!=null)r=t.batchInputShape;else if(t.inputShape!=null){let s=null;t.batchSize!=null&&(s=t.batchSize),r=[s].concat(t.inputShape)}this.batchInputShape=r;let o=t.dtype;o==null&&(o=t.inputDType),o==null&&(o="float32"),this.dtype=o}t.weights!=null?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(this.inboundNodes.length===0)throw new Fs(`The layer has never been called and thus has no defined ${e}.`);if(this.inboundNodes.length<=t)throw new he(`Asked to get ${e} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return No(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return No(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Wi(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Wi(`Layer ${this.name} is not connected, no input to return.`);return No(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Wi(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Wi(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return No(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(e=>e.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=Kn(t),this.inputSpec==null||this.inputSpec.length===0)return;let e=Kn(this.inputSpec);if(t.length!==e.length)throw new he(`Layer ${this.name} expects ${e.length} inputs, but it received ${t.length} input tensors. Input received: ${t}`);for(let r=0;r<t.length;r++){let o=t[r],s=e[r];if(s==null)continue;let i=o.rank;if(s.ndim!=null&&i!==s.ndim)throw new he(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${s.ndim}, found ndim=${i}`);if(s.maxNDim!=null&&i>s.maxNDim)throw new he(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${s.maxNDim}, found ndim=${i}`);if(s.minNDim!=null&&i<s.minNDim)throw new he(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${s.minNDim}, found ndim=${i}.`);if(s.dtype!=null&&o.dtype!==s.dtype)throw new he(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${s.dtype}, found dtype=${o.dtype}.`);if(s.axes){let a=o.shape;for(let c in s.axes){let l=Number(c),p=s.axes[c],f=l>=0?a[l]:a[a.length+l];if(p!=null&&[p,null].indexOf(f)===-1)throw new he(`Input ${r} is incompatible with layer ${this.name}: expected axis ${l} of input shape to have value ${p} but got shape ${a}.`)}}if(s.shape!=null)for(let a=0;a<s.shape.length;++a){let c=s.shape[a],l=o.shape[a];if(c!=null&&l!=null&&c!==l)throw new he(`Input ${r} is incompatible with layer ${this.name}: expected shape=${s.shape}, found shape=${o.shape}.`)}}}call(t,e){return t}invokeCallHook(t,e){this._callHook!=null&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();let r=Kn(t),o=!0;for(let i of r)if(!(i instanceof ts)){o=!1;break}let s=!0;for(let i of r)if(i instanceof ts){s=!1;break}if(o===s)throw new he("Arguments to apply() must be all SymbolicTensors or all Tensors");return Sc(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);let i=[];for(let a of Kn(t))i.push(a.shape);this.build(No(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&s&&(this._refCount=1)}if(this.assertInputCompatibility(t),s){let i=this.call(t,e),a=Kn(i),c=[];for(let l of a)r.indexOf(l)!==-1&&(l=l.clone()),c.push(l);if(i=No(c),this.activityRegularizer!=null)throw new At("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{let i=SOe(t),a=this.computeOutputShape(i),c,l=COe(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?i[0]:i),a!=null&&a.length>0&&Array.isArray(a[0])?c=a.map((p,f)=>new ts(l,p,this,Kn(t),e,this.name,f)):c=new ts(l,a,this,Kn(t),e,this.name),this.addInboundNode(t,c,null,null,i,a,e),this._refCount++,this.activityRegularizer!=null)throw new At("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return c}})}warnOnIncompatibleInputShape(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let e=!1;this.batchInputShape.forEach((r,o)=>{r!=null&&t[o]!=null&&t[o]!==r&&(e=!0)}),e&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Wi(`The layer ${this.name} has never been called and thus has no defined output shape.`);let t=[];for(let e of this.inboundNodes){let r=JSON.stringify(e.outputShapes);t.indexOf(r)===-1&&t.push(r)}if(t.length===1){let e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&e.length===1?e[0]:e}else throw new Wi(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Fs(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Fv(this.weights)}build(t){this.built=!0}getWeights(t=!1){return W0(t?this.trainableWeights:this.weights)}setWeights(t){de(()=>{let e=this.weights;if(e.length!==t.length)throw new he(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${e.length} weights. Provided weights: ${t}...`);if(e.length===0)return;let r=[],o=W0(e);for(let s=0;s<o.length;++s){let i=o[s],a=e[s],c=t[s];if(!N.arraysEqual(i.shape,c.shape))throw new he(`Layer weight shape ${i.shape} not compatible with provided weight shape ${c.shape}`);r.push([a,c])}Lv(r)})}addWeight(t,e,r,o,s,i,a){if(this._addedWeightNames.indexOf(t)!==-1)throw new he(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(o=Wn("zeros"));let c=o.apply(e,r),l=new $v(c,r,t,i,a);return c.dispose(),s!=null&&this.addLoss(()=>s.apply(l.read())),i==null&&(i=!0),i?this._trainableWeights.push(l):this._nonTrainableWeights.push(l),l}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){t==null||Array.isArray(t)&&t.length===0||(t=Kn(t),this._losses!==void 0&&this._losses!==null&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(e!=null)if(Array.isArray(e))e.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return e}addInboundNode(t,e,r,o,s,i,a=null){let c=Kn(t);e=Kn(e),r=Kn(r),o=Kn(o),s=Pv(s),i=Pv(i);let l=[],p=[],f=[];for(let y of c)l.push(y.sourceLayer),p.push(y.nodeIndex),f.push(y.tensorIndex);new dh({outboundLayer:this,inboundLayers:l,nodeIndices:p,tensorIndices:f,inputTensors:c,outputTensors:e,inputMasks:r,outputMasks:o,inputShapes:s,outputShapes:i},a);for(let y=0;y<e.length;y++)e[y].sourceLayer=this,e[y].nodeIndex=this.inboundNodes.length-1,e[y].tensorIndex=y}getConfig(){let t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return--this._refCount===0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}});function yE(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new he("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=n.batchShape;n.shape!=null&&t==null&&(t=[null].concat(n.shape));let e=n.dtype;return e==null&&(e="float32"),new Gf({batchInputShape:t,name:n.name,dtype:e,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}var Gf,zv=b(()=>{"use strict";$();Rv();Gn();bo();Gf=(()=>{class n extends Wt{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:jf("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new he("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let r=e.batchInputShape;if(r==null){if(e.inputShape==null)throw new he("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");r=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new he("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");let o=e.dtype||"float32";this.batchInputShape=r,this.dtype=o,this.inputSpec=[{shape:r}];let s=new ts(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new dh({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[r],outputShapes:[r]})}apply(e,r){throw new he(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}return n.className="InputLayer",n})();He.registerClass(Gf)});function Sl(n){return Y(this,null,function*(){if(n==null)return;let t=[],e=[],r=[];for(let o in n){let s=n[o];if(typeof s!="number"){let i=s;t.push(i.data()),e.push(o),r.push(i)}}if(t.length>0){let o=yield Promise.all(t);for(let s=0;s<o.length;++s)n[e[s]]=o[s][0];Mt(r)}})}function xE(n){if(n!=null)for(let t in n){let e=n[t];typeof e!="number"&&e.dispose()}}var K0=b(()=>{"use strict";$();});function vE(n,t){return n==null&&(n={}),n instanceof mh?[n]:Array.isArray(n)&&n[0]instanceof mh?n:Kn(n).map(r=>new Y0(r,t))}function bE(n,t,e,r,o,s,i,a,c){let l=new Q0,p=[new mF,...gF.createCallbacks(t)];n!=null&&p.push(...n),p.push(l);let f=new X0(p);return f.setParams({epochs:e,initialEpoch:r,samples:o,steps:s,batchSize:i,verbose:t,doValidation:a,metrics:c}),{callbackList:f,history:l}}var _Oe,mh,X0,mF,Q0,Y0,gF,Bv=b(()=>{"use strict";$();Gn();K0();Dr();_Oe=125,mh=class{constructor(){this.validationData=null}setParams(t){this.params=t}onEpochBegin(t,e){return Y(this,null,function*(){})}onEpochEnd(t,e){return Y(this,null,function*(){})}onBatchBegin(t,e){return Y(this,null,function*(){})}onBatchEnd(t,e){return Y(this,null,function*(){})}onTrainBegin(t){return Y(this,null,function*(){})}onTrainEnd(t){return Y(this,null,function*(){})}setModel(t){}},X0=class{constructor(t,e=10){t==null&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(let e of this.callbacks)e.setParams(t)}setModel(t){for(let e of this.callbacks)e.setModel(t)}onEpochBegin(t,e){return Y(this,null,function*(){e==null&&(e={});for(let r of this.callbacks)yield r.onEpochBegin(t,e)})}onEpochEnd(t,e){return Y(this,null,function*(){e==null&&(e={});for(let r of this.callbacks)yield r.onEpochEnd(t,e)})}onBatchBegin(t,e){return Y(this,null,function*(){e==null&&(e={});for(let r of this.callbacks)yield r.onBatchBegin(t,e)})}onBatchEnd(t,e){return Y(this,null,function*(){e==null&&(e={});for(let r of this.callbacks)yield r.onBatchEnd(t,e)})}onTrainBegin(t){return Y(this,null,function*(){t==null&&(t={});for(let e of this.callbacks)yield e.onTrainBegin(t)})}onTrainEnd(t){return Y(this,null,function*(){t==null&&(t={});for(let e of this.callbacks)yield e.onTrainEnd(t)})}},mF=class extends mh{constructor(){super()}onEpochBegin(t){return Y(this,null,function*(){this.seen=0,this.totals={}})}onBatchEnd(t,e){return Y(this,null,function*(){e==null&&(e={});let r=e.size==null?0:e.size;this.seen+=r;for(let o in e){let s=e[o];if(typeof s=="number")this.totals.hasOwnProperty(o)||(this.totals[o]=0),this.totals[o]=this.totals[o]+s*r;else{let i;o in this.totals?i=this.totals[o]:this.totals[o]=0;let a=de(()=>je(this.totals[o],oe(s,r)));this.totals[o]=a,i?.dispose()}}})}onEpochEnd(t,e){return Y(this,null,function*(){if(e!=null)for(let r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?e[r]=this.totals[r]/this.seen:de(()=>{let o=oe(ct(1,this.seen),this.totals[r]);e[r]=o,this.totals[r].dispose(),ur(e[r])}))})}},Q0=class extends mh{onTrainBegin(t){return Y(this,null,function*(){this.epoch=[],this.history={}})}onEpochEnd(t,e){return Y(this,null,function*(){e==null&&(e={}),this.epoch.push(t);for(let r in e)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(e[r])})}syncData(){return Y(this,null,function*(){let t=[],e=[],r=[];for(let s in this.history){let i=this.history[s];for(let a=0;a<i.length;++a)if(typeof i[a]!="number"){let c=i[a];t.push(c.data()),e.push(s),r.push(a)}}let o=yield Promise.all(t);for(let s=0;s<o.length;++s)this.history[e[s]][r[s]].dispose(),this.history[e[s]][r[s]]=o[s][0]})}},Y0=class extends mh{constructor(t,e){if(super(),this.currentEpoch=0,this.yieldEvery=e||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=_Oe),this.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");N.isNumber(this.yieldEvery)&&(this.maybeWait=XZ(this.maybeWait.bind(this),this.yieldEvery)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}maybeWait(t,e,r){return Y(this,null,function*(){let o=[];this.yield!=null&&(yield Sl(r),o.push(this.yield(t,e,r))),o.push(Dv()),yield Promise.all(o)})}onEpochBegin(t,e){return Y(this,null,function*(){this.currentEpoch=t,this.epochBegin!=null&&(yield Sl(e),yield this.epochBegin(t,e))})}onEpochEnd(t,e){return Y(this,null,function*(){let r=[];this.epochEnd!=null&&(yield Sl(e),r.push(this.epochEnd(t,e))),this.yieldEvery==="epoch"&&r.push(Dv()),yield Promise.all(r)})}onBatchBegin(t,e){return Y(this,null,function*(){this.batchBegin!=null&&(yield Sl(e),yield this.batchBegin(t,e))})}onBatchEnd(t,e){return Y(this,null,function*(){let r=[];this.batchEnd!=null&&(yield Sl(e),r.push(this.batchEnd(t,e))),this.yieldEvery==="batch"?r.push(Dv()):N.isNumber(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,e)),yield Promise.all(r)})}onTrainBegin(t){return Y(this,null,function*(){this.trainBegin!=null&&(yield Sl(t),yield this.trainBegin(t))})}onTrainEnd(t){return Y(this,null,function*(){this.trainEnd!=null&&(yield Sl(t),yield this.trainEnd(t))})}};gF=(()=>{class n{constructor(){}static registerCallbackConstructor(e,r){N.assert(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),n.checkForDuplicate(r),n.constructors[e]==null&&(n.constructors[e]=[]),n.constructors[e].push(r)}static checkForDuplicate(e){for(let r in n.constructors)n.constructors[+r].forEach(s=>{if(s===e)throw new he("Duplicate callback constructor.")})}static clear(){n.constructors={}}static createCallbacks(e){let r=[];for(let o in n.constructors){let s=+o;e>=s&&r.push(...n.constructors[s])}return r.map(o=>new o)}}return n.constructors={},n})()});function Bs(n,t={},e=!1){return vl(n,He.SerializationMap.getMap().classNameMap,t,"layer",e)}var Vv=b(()=>{"use strict";$();Dr();});function Z0(n,t){return de(()=>{n.dtype!=="float32"&&(n=n.asType("float32"));let e=gt(mg(n),t,!0),r=sl(e.shape,Zr()),o=jn($o(e,r));return ct(n,o)})}function Cl(n,t){return de(()=>Un(mg(at(t,n)),-1))}function qv(n,t){return de(()=>Un(Jn(at(t,n)),-1))}function Wf(n,t){return de(()=>{let e=at(n,t),r=oo(Jn(n),Zr(),Number.MAX_VALUE),o=Jn(ct(e,r));return oe(100,Un(o,-1))})}function TOe(n,t){return de(()=>{let e=oo(t,Zr(),Number.MAX_VALUE),r=so(je(1,e)),o=oo(n,Zr(),Number.MAX_VALUE),s=so(je(1,o));return Un(mg(at(r,s)),-1)})}function IOe(n,t){return de(()=>{let e=$o(0,at(1,oe(n,t)));return Un(mg(e),-1)})}function EOe(n,t){return de(()=>{let e=$o(0,at(1,oe(n,t)));return Un(e,-1)})}function NOe(n,t){return de(()=>{let e=gt(oe(n,t),-1),r=io(oe(at(1,n),t),-1);return $o(0,je(1,at(r,e)))})}function DOe(n,t){return de(()=>{let e=Math.log(2),r=at(t,n),o=at(je(r,ba(oe(-2,r))),e);return Un(o,-1)})}function gg(n,t,e=!1){return de(()=>{if(e)t=fl(t);else{let r=gt(t,t.shape.length-1,!0);t=ct(t,r)}return t=oo(t,Zr(),1-Zr()),un(gt(oe(n.toFloat(),so(t)),t.shape.length-1))})}function Uv(n,t,e=!1){return de(()=>{let r=va(lJ(n)).toInt();t=oo(t,Zr(),1-Zr());let o=t.shape,s=ga(r,o[o.length-1]).reshape(o);return gg(s,t,e)})}function kOe(n,t){if(!N.arraysEqual(n.shape,t.shape))throw new he(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(t.shape)}`);return de(()=>{let e=t.relu(),r=t.abs().neg();return e.sub(t.mul(n)).add(r.exp().log1p())})}function jv(n,t){return de(()=>{let e;return e=oo(t,Zr(),1-Zr()),e=so(ct(e,at(1,e))),Un(kOe(n,e),-1)})}function AOe(n,t){return de(()=>{let e=oo(n,Zr(),1),r=oo(t,Zr(),1);return gt(oe(n,so(ct(e,r))),-1)})}function OOe(n,t){return de(()=>{let e=so(je(Zr(),t));return Un(at(t,oe(n,e)),-1)})}function eS(n,t){return de(()=>{let e=Z0(n,-1),r=Z0(t,-1),o=oe(e,r);return un(gt(o,-1))})}function wE(n){if(typeof n=="string"){if(n in J0)return J0[n];let t=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new he(t)}else return n}var J0,yg=b(()=>{"use strict";$();$();ch();qo();Gn();J0={meanSquaredError:Cl,meanAbsoluteError:qv,meanAbsolutePercentageError:Wf,meanSquaredLogarithmicError:TOe,squaredHinge:IOe,hinge:EOe,categoricalHinge:NOe,logcosh:DOe,categoricalCrossentropy:gg,sparseCategoricalCrossentropy:Uv,binaryCrossentropy:jv,kullbackLeiblerDivergence:AOe,poisson:OOe,cosineProximity:eS}});function tS(n,t){return de(()=>{let e=oe(.5,Yr(t)),r=hh(Fr(t,e),n.dtype);return Un(bs(n,r),-1)})}function nS(n,t){return de(()=>hh(bs(nh(n,-1),nh(t,-1)),"float32"))}function _J(n,t){return de(()=>vo(n.equal(1),t.equal(1)).sum().cast("float32"))}function MOe(n,t){return de(()=>vo(n.equal(1),t.equal(0)).sum().cast("float32"))}function ROe(n,t){return de(()=>vo(n.equal(0),t.equal(1)).sum().cast("float32"))}function yF(n,t){return de(()=>{let e=_J(n,t),r=ROe(n,t),o=e.add(r);return pr(Fr(o,0),e.div(o),0).cast("float32")})}function TJ(n,t){return de(()=>{let e=_J(n,t),r=MOe(n,t),o=e.add(r);return pr(Fr(o,0),e.div(o),0).cast("float32")})}function CE(n,t){return jv(n,t)}function _E(n,t){return n.rank===t.rank&&(n=n.squeeze([n.rank-1])),t=t.argMax(-1),t.dtype!==n.dtype&&(t=t.asType(n.dtype)),bs(n,t).asType("float32")}function IJ(n){if(typeof n=="string"&&n in SE)return SE[n];if(typeof n!="string"&&n!=null)return n;throw new he(`Unknown metric ${n}`)}function oS(n){if(Hi(n!==null,`Unknown LossOrMetricFn ${n}`),typeof n=="string")return n;{let t;for(let e of Object.keys(J0))if(J0[e]===n){t=e;break}if(t!==void 0)return t;for(let e of Object.keys(SE))if(SE[e]===n){t=e;break}return t!==void 0?t:n.name}}var POe,FOe,$Oe,LOe,zOe,BOe,rS,VOe,xF,SE,vF=b(()=>{"use strict";$();$();qo();Gn();yg();yg();yg();Dr();POe=Cl,FOe=Cl,$Oe=qv,LOe=qv,zOe=Wf,BOe=Wf,rS=gg,VOe=eS,xF=Uv,SE={binaryAccuracy:tS,categoricalAccuracy:nS,precision:yF,categoricalCrossentropy:rS,sparseCategoricalCrossentropy:xF,mse:POe,MSE:FOe,mae:$Oe,MAE:LOe,mape:zOe,MAPE:BOe,cosine:VOe}});function NJ(n){let t={Adagrad:()=>qf.adagrad(.01),Adadelta:()=>qf.adadelta(1,.95,Zr()),Adam:()=>qf.adam(.001,.9,.999,Zr()),Adamax:()=>qf.adamax(.002,.9,.999,Zr(),0),RMSProp:()=>qf.rmsprop(.001,.9,0,Zr()),SGD:()=>qf.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,n in t)return t[n]();throw new he(`Unknown Optimizer ${n}`)}var DJ=b(()=>{"use strict";$();ch();Gn();});function wF(n,t,e=!1){if(n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!bF(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(e){let r=JSON.stringify(n);r.length>1048576&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function bF(n){if(n===null)return!0;if(typeof n=="object")if(Object.getPrototypeOf(n)===Object.prototype){let t=Object.keys(n);for(let e of t)if(typeof e!="string"||!bF(n[e]))return!1;return!0}else if(Array.isArray(n)){for(let t of n)if(!bF(t))return!1;return!0}else return!1;else{let t=typeof n;return t==="string"||t==="number"||t==="boolean"}}var kJ=b(()=>{"use strict";});function AJ(n,t,e,r=console.log){let o=jOe(n),s=["Layer (type)","Output shape","Param #"];o?(t=t||65,e=e||[.45,.85,1]):(t=t||98,e=e||[.33,.55,.67,1]),e[e.length-1]<=1&&(e=e.map(p=>Math.floor(t*p)));let i;if(!o){s.push("Receives inputs"),i=[];for(let p in n.nodesByDepth)i.push(...n.nodesByDepth[p])}r("_".repeat(t)),TE(s,e,r),r("=".repeat(t));let a=n.layers;for(let p=0;p<a.length;++p)o?GOe(a[p],e,r):WOe(a[p],e,i,r),r((p===a.length-1?"=":"_").repeat(t));n.checkTrainableWeightsConsistency();let c=UOe(n),l=Fv(n.nonTrainableWeights);r(`Total params: ${c+l}`),r(`Trainable params: ${c}`),r(`Non-trainable params: ${l}`),r("_".repeat(t))}function UOe(n){let t;return n.collectedTrainableWeights!=null?t=Fv(n.collectedTrainableWeights):t=Fv(n.trainableWeights),t}function jOe(n){let t=!0,e=[],r=[];for(let o in n.nodesByDepth)e.push(n.nodesByDepth[o]);for(let o of e){if(o.length>1||o.length===1&&o[0].inboundLayers.length>1){t=!1;break}r.push(...o)}if(t)for(let o of n.layers){let s=!1;for(let i of o.inboundNodes)if(r.indexOf(i)!==-1)if(s){t=!1;break}else s=!0;if(!t)break}return t}function TE(n,t,e=console.log){let r="";for(let o=0;o<n.length;++o)o>0&&(r=r.slice(0,r.length-1)+" "),r+=n[o],r=r.slice(0,t[o]),r+=" ".repeat(t[o]-r.length);e(r)}function GOe(n,t,e){let r;try{r=JSON.stringify(n.outputShape)}catch{r="multiple"}let o=n.name,s=n.getClassName(),i=[`${o} (${s})`,r,n.countParams().toString()];TE(i,t,e)}function WOe(n,t,e,r){let o;try{o=JSON.stringify(n.outputShape)}catch{o="multiple"}let s=[];for(let p of n.inboundNodes)if(!(e!=null&&e.length>0&&e.indexOf(p)===-1))for(let f=0;f<p.inboundLayers.length;++f){let y=p.inboundLayers[f].name,d=p.nodeIndices[f],h=p.tensorIndices[f];s.push(`${y}[${d}][${h}]`)}let i=n.name,a=n.getClassName(),c=s.length===0?"":s[0],l=[`${i} (${a})`,o,n.countParams().toString(),c];TE(l,t,r);for(let p=1;p<s.length;++p)TE(["","","",s[p]],t,r)}var OJ=b(()=>{"use strict";fF();});function MJ(n,t,e){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&t===0&&typeof e=="string"}function xg(n,t){if(n===null)return null;if(typeof n=="string")return uh(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){let e=[],r=n.length;for(let o=0;o<r;++o){let s=n[o];MJ(t,o,s)?e.push(s):e.push(xg(s,t))}return e}else{let e={};for(let r of Object.keys(n)){let o=n[r];if(r==="name"&&typeof o=="string")e[r]=o;else{let s=uh(r);e[s]=xg(o,s)}}return e}}function IE(n,t){if(n==null)return null;if(typeof n=="string")return Ea(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){let e=[],r=n.length;for(let o=0;o<r;++o){let s=n[o];MJ(t,o,s)?e.push(s):e.push(IE(s,t))}return e}else{let e={};for(let r of Object.keys(n)){let o=n[r],s=Ea(r);(r==="name"||r==="className")&&typeof o=="string"?e[s]=o:e[s]=IE(o,r)}return e}}var EE=b(()=>{"use strict";Dr();});var Hf,NE=b(()=>{"use strict";Hf="2.8.6"});function HOe(n,t){if(n.dtype==null||n.dtype===t.dtype)return t;try{return Ye(t,n.dtype)}catch{throw new he(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}function vg(n,t,e,r){let o=e==null?!1:e.training,s=Array.isArray(n),i=s?n:[n],a=i.map(h=>h.name),c=[],l=t.names();for(let h of a)l.indexOf(h)!==-1?c.push(t.getValue(h)):c.push(null);r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);let p=a.join(",")+"|"+t.names().join(","),f,y;if(SF[p]==null){let h=KOe(i,t);f=h.sorted,y=h.recipientCounts,SF[p]=f,RJ[p]=y}f=SF[p],y={},o||Object.assign(y,RJ[p]);let d=new _l(t);for(let h=0;h<f.length;++h){if(r!=null){let j=Px().numTensors;j>r.maxNumTensors&&(r.maxNumTensors=j),j<r.minNumTensors&&(r.minNumTensors=j)}let m=f[h],x=m.sourceLayer;if(x instanceof Gf)continue;let w=[],_=[],I=[],T=!1;for(let j of m.inputs){let G=d.getValue(j),Q=d.getMask(j);w.push(G),_.push(Q),Q!=null&&(T=!0),o||(y[j.name]--,y[j.name]===0&&!t.hasKey(j)&&a.indexOf(j.name)===-1&&!G.isDisposed&&j.sourceLayer.stateful!==!0&&I.push(G))}T&&(e=e||{},e.mask=_[0]);let D=Kn(x.apply(w,e)),O=null;x.supportsMasking&&(O=x.computeMask(w,_));let R=QOe(m),P=Array.isArray(R)?R:[R];for(let j=0;j<P.length;++j){d.hasKey(P[j])||d.add(P[j],D[j],Array.isArray(O)?O[0]:O);let G=a.indexOf(P[j].name);G!==-1&&(c[G]=D[j])}o||Mt(I)}return d.disposeMasks(),s?c:c[0]}function KOe(n,t){N.assert(n!=null&&n.length>0,()=>"Expected at least one fetch, got none");let e=[],r={};if(n.length===1){let o=PJ(n[0],t);e=o.sorted,r=o.recipientMap}else{let o=new Set;for(let s of n){let{sorted:i,recipientMap:a}=PJ(s,t);for(let c of i)o.has(c.name)||(e.push(c),o.add(c.name));for(let c in a)r[c]==null&&(r[c]=new Set),a[c].forEach(l=>r[c].add(l))}}return{sorted:e,recipientCounts:XOe(r)}}function XOe(n){let t={};for(let e in n)t[e]=n[e].size;return t}function PJ(n,t){let e=new Set,r=[],o={};for(let a of t.names())e.add(a);let s=[],i=[];for(s.push(n);s.length>0;){let a=s[s.length-1];if(e.has(a.name)){s.pop();continue}let c=i[i.length-1]===s.length-1;if(a.inputs.length===0||c)s.pop(),r.push(a),e.add(a.name),c&&i.pop();else{i.push(s.length-1);for(let l of a.inputs)o[l.name]==null&&(o[l.name]=new Set),o[l.name].add(a.name),!e.has(l.name)&&s.push(l)}}return{sorted:r,recipientMap:o}}function QOe(n){let t;if(n.sourceLayer.inboundNodes.length===1)t=n.sourceLayer.output;else{let e=null;for(let r=0;r<n.sourceLayer.inboundNodes.length;++r)for(let o of n.sourceLayer.inboundNodes[r].outputTensors)if(o.id===n.id){e=r;break}t=n.sourceLayer.getOutputAt(e)}return t}var _l,SF,RJ,CF=b(()=>{"use strict";$();Gn();Dr();zv();bo();_l=class n{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof n)for(let e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(t==null)return;for(let e of t)this.add(e.key,e.value)}}add(t,e,r){if(this.id2Value[t.id]==null)this.id2Value[t.id]=HOe(t,e),this.name2Id[t.name]=t.id,r!=null&&(this.id2Mask[t.id]=r);else throw new he(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof ts){if(this.id2Value[t.id]==null)throw new he(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{let e=this.name2Id[t];if(e==null)throw new he(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[e]}}getMask(t){if(t instanceof ts){if(this.id2Value[t.id]==null)throw new he(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{let e=this.name2Id[t];if(e==null)throw new he(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[e]}}disposeMasks(){this.id2Mask!=null&&Mt(this.id2Mask)}},SF={},RJ={}});var DE,FJ=b(()=>{"use strict";$();Rv();Gn();Vv();Dr();EE();Cs();H0();NE();CF();zv();bo();DE=class n extends Wt{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){let _=this.getClassName().toLowerCase();this.name=jf(_)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],Na(this.inputs).length!==this.inputs.length)throw new he(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(_=>_.name)}`);Na(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(_=>_.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(let _ of this.outputs){let I=_.sourceLayer,T=_.nodeIndex,D=_.tensorIndex;this.outputLayers.push(I),this.outputLayersNodeIndices.push(T),this.outputLayersTensorIndices.push(D)}for(let _ of this.inputs){let I=_.sourceLayer,T=_.nodeIndex,D=_.tensorIndex;Hi(T===0,"input layer has >1 nodes"),Hi(D===0,"input layer has >1 tensors"),this.inputLayers.push(I),this.inputLayersNodeIndices.push(T),this.inputLayersTensorIndices.push(D)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let _=0;_<this.inputLayers.length;_++){let I=this.inputLayers[_];if(!(I instanceof Gf))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${_} (0-based) originates from layer type ${I.getClassName()}.`);this.inputNames.push(I.name),this.feedInputShapes.push(I.batchInputShape),this.feedInputNames.push(I.name)}for(let _ of this.outputLayers)this.outputNames.push(_.name);this.internalInputShapes=this.inputs.map(_=>_.shape),this.internalOutputShapes=this.outputs.map(_=>_.shape);let e={},r={},o={},s={},i={},a=[],c=(_,I,T,D,O,R)=>{(D==null||O==null||R==null)&&(D=_.sourceLayer,O=_.nodeIndex,R=_.tensorIndex);let P=D.inboundNodes[O];if(T.indexOf(P)!==-1)throw new Fs(`The tensor ${_.name} at layer "${D.name}" is part of a cycle.`);if(I.indexOf(P)!==-1)return;this.containerNodes.add(n.nodeKey(D,O)),D.id in i||(i[D.id]=Object.keys(i).length),T.indexOf(P)===-1&&T.push(P);let j=P.inboundLayers.length;for(let G=0;G<j;G++){let Q=P.inputTensors[G],ie=P.inboundLayers[G],pe=P.nodeIndices[G],xe=P.tensorIndices[G];c(Q,I,T,ie,pe,xe)}for(I.push(P);T.indexOf(P)>=0;)T.splice(T.indexOf(P),1);a.push(P)},l=[],p=[];for(let _ of this.outputs)c(_,l,p);let f=a.slice().reverse();for(let _ of f){r[_.id]=_,_.id in e||(e[_.id]=0);let I=e[_.id],T=o[_.outboundLayer.id]==null?0:o[_.outboundLayer.id];I=Math.max(I,T),o[_.outboundLayer.id]=I,s[_.outboundLayer.id]=_.outboundLayer,e[_.id]=I;for(let D=0;D<_.inboundLayers.length;D++){let O=_.inboundLayers[D],R=_.nodeIndices[D],P=O.inboundNodes[R],j=e[P.id]==null?0:e[P.id];e[P.id]=Math.max(I+1,j),r[P.id]=P}}let y={};for(let _ in e){let I=e[_];I in y||(y[I]=[]),y[I].push(r[_])}let d={};for(let _ in o){let I=o[_];I in d||(d[I]=[]),d[I].push(s[_])}let h=Object.keys(d).map(_=>parseInt(_,10)).sort(q0);this.layers=[];for(let _ of h){let I=d[_];I.sort((T,D)=>{let O=i[T.id],R=i[D.id];return O<R?-1:O>R?1:0});for(let T of I)T instanceof n&&this.internalContainerRefs.push(T),this.layers.push(T)}this.layersByDepth=d,h=Object.keys(y).map(_=>parseInt(_,10)).sort(q0);let m=this.inputs.slice(),x=[];for(let _ of h)for(let I of y[_]){let T=I.outboundLayer;if(T!=null){for(let D of I.inputTensors)if(m.indexOf(D)===-1)throw new Fs(`Graph disconnected: cannot obtain value for tensor ${D} at layer "${T.name}". The following previous layers were accessed without issue: ${x}`);for(let D of I.outputTensors)m.push(D);x.push(T.name)}}this.nodesByDepth=y;let w=this.layers.map(_=>_.name);for(let _ of w){let I=w.filter(T=>T===_).length;if(I!==1)throw new Fs(`The name "${_}" is used ${I} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(w))}this.outboundNodes=[],this.inboundNodes=[],new dh({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(_=>null),outputMasks:this.outputs.map(_=>null),inputShapes:this.inputs.map(_=>_.shape),outputShapes:this.outputs.map(_=>_.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();let t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(let e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(let e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(e=>{e._trainableWeights.forEach(r=>r.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new he("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(let e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){let t=[];for(let e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){let e=[];for(let r of this.layers)e.push(...r.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,e=!0){let r={},o=0;for(let i of this.layers)for(let a of i.weights){if(r[a.originalName]!=null)throw new he(`Duplicate weight name: ${a.originalName}`);r[a.originalName]=a,o++}let s=[];for(let i in t){let a=i;if(r[i]==null){let c=i.split("/");a=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(r[a]!=null)s.push([r[a],t[i]]);else if(e)throw new he(`Provided weight data has no target variable: ${i}`);delete r[a]}if(e){let i=[];for(let a in r)i.push(a);if(i.length>0)throw new he(`${i.length} of ${o} weights are not set: ${i}`)}Lv(s)}updatedConfig(){let t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion=`tfjs-layers ${Hf}`,e.backend="TensorFlow.js",e}toJSON(t,e=!0){let r=IE(this.updatedConfig());return e?JSON.stringify(r):r}call(t,e){return de(()=>{t=Kn(t);let r=new _l;for(let o=0;o<this.inputs.length;++o)r.add(this.inputs[o],t[o]);return vg(this.outputs,r,e)})}computeMask(t,e){return de(()=>{t=Kn(t);let r;return e==null?r=Ia(null,t.length):r=Kn(e),this.runInternalGraph(t,r)[1]})}computeOutputShape(t){let e=Pv(t);if(e.length!==this.inputLayers.length)throw new he(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);let r={};for(let a=0;a<e.length;a++){let c=this.inputLayers[a],l=e[a],p=c.name+"_0_0";r[p]=l}let o=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(q0);if(o.length>1)for(let a of o){let c=this.nodesByDepth[a];for(let l of c){let p=l.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(p.id)!==-1)continue;let f=[];for(let m=0;m<l.inboundLayers.length;m++){let x=l.inboundLayers[m],w=l.nodeIndices[m],_=l.tensorIndices[m],I=`${x.name}_${w}_${_}`,T=r[I];f.push(T)}let y=p.computeOutputShape(No(f)),d=Pv(y),h=p.inboundNodes.indexOf(l);for(let m=0;m<d.length;m++){let x=`${p.name}_${h}_${m}`;r[x]=d[m]}}}let s=[],i=[];for(let a=0;a<this.outputLayers.length;a++){let c=this.outputLayers[a],l=this.outputLayersNodeIndices[a],p=this.outputLayersTensorIndices[a],f=`${c.name}_${l}_${p}`;i.push(f)}for(let a=0;a<i.length;a++){let c=i[a];Hi(c in r),s.push(r[c])}return No(s)}runInternalGraph(t,e){e==null&&(e=Ia(null,t.length));let r={};for(let c=0;c<this.inputs.length;++c){let l=this.inputs[c],p=t[c],f=e[c];r[l.id]=[p,f]}let o=Object.keys(this.nodesByDepth).map(c=>parseInt(c,10)).sort(q0);for(let c of o){let l=this.nodesByDepth[c];for(let p of l){let f=p.outboundLayer,y=p.inputTensors,d=p.outputTensors,h=new Array;for(let m of y)m.id in r&&h.push(r[m.id]);if(h.length===y.length){let m={},x,w,_,I;if(p.callArgs!=null&&(m=p.callArgs),h.length===1){let[T,D]=h[0];m.mask==null&&(m.mask=D),_=Kn(f.call(T,m)),I=Kn(f.computeMask(T,D)),x=[T],w=[D]}else x=h.map(T=>T[0]),w=h.map(T=>T[1]),m.mask==null&&(m.mask=w),_=Kn(f.call(x,m)),I=Kn(f.computeMask(x,w));if(f.activityRegularizer)throw new At("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let T=0;T<d.length;++T){let D=d[T],O=_[T],R=I[T];r[D.id]=[O,R]}}}}let s=[],i=[],a=[];for(let c of this.outputs){Hi(c.id in r,`Could not compute output ${c.name} : ${c.id}`);let[l,p]=r[c.id];a.push(l.shape),s.push(l),i.push(p)}return[s,i,a]}buildNodeConversionMap(t){let e={},r;for(let o of this.layers){r=o instanceof n?1:0;for(let s=0;s<o.inboundNodes.length;s++){let i=n.nodeKey(o,s);this.containerNodes.has(i)&&(e[i]=r,r+=1)}}return e}getLayer(t,e){if(e!=null){if(this.layers.length<=e)throw new he(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}else if(t==null)throw new he("Provide either a layer name or layer index");for(let r of this.layers)if(r.name===t)return r;throw new he(`No such layer: ${t}`)}calculateLosses(){return de(()=>{let t=[];for(let e of this.layers)for(let r=0;r<e.inboundNodes.length;++r){let o=n.nodeKey(e,r);this.containerNodes.has(o)&&t.push(...e.calculateLosses())}return t})}getConfig(){let t={name:this.name},e=this.buildNodeConversionMap(this.layers),r=[];for(let i of this.layers){let a=i.getClassName(),c=i.getConfig(),l=[];for(let f=0;f<i.inboundNodes.length;f++){let y=i.inboundNodes[f],d=n.nodeKey(i,f),h={};if(this.containerNodes.has(d)){if(y.callArgs)try{JSON.stringify(y.callArgs),h=y.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${y.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),h={}}if(y.inboundLayers.length>0){let m=[];for(let x=0;x<y.inboundLayers.length;x++){let w=y.inboundLayers[x],_=y.nodeIndices[x],I=y.tensorIndices[x],T=n.nodeKey(w,_),D=e[T];D==null&&(D=0),m.push([w.name,D,I,h])}l.push(m)}}}let p={};p.name=i.name,p.className=a,p.config=c,p.inboundNodes=l,r.push(p)}t.layers=r;let o=[];for(let i=0;i<this.inputLayers.length;i++){let a=this.inputLayers[i],c=this.inputLayersNodeIndices[i],l=n.nodeKey(a,c);if(!this.containerNodes.has(l))continue;let p=e[l];p==null&&(p=0);let f=this.inputLayersTensorIndices[i];o.push([a.name,p,f])}t.inputLayers=o;let s=[];for(let i=0;i<this.outputLayers.length;i++){let a=this.outputLayers[i],c=this.outputLayersNodeIndices[i],l=n.nodeKey(a,c);if(!this.containerNodes.has(l))continue;let p=e[l];p==null&&(p=0);let f=this.outputLayersTensorIndices[i];s.push([a.name,p,f])}return t.outputLayers=s,t}static fromConfig(t,e,r={},o=!1){let s={},i={};function a(x,w){x.name in i?i[x.name].push(w):i[x.name]=[w]}function c(x,w){let _=[],I;for(let T of w){let D=T[0],O=T[1],R=T[2];if(I=T[3]==null?{}:T[3],!(D in s)){a(x,w);return}let P=s[D];if(P.inboundNodes.length<=O){a(x,w);return}let j=P.inboundNodes[O];_.push(j.outputTensors[R])}_.length>0&&x.apply(No(_),I)}function l(x){let w=x.name,_=Bs(x,e.customObjects!=null?e.customObjects:{});_.setFastWeightInitDuringBuild(o),s[w]=_,x.inboundNodes.forEach(T=>{if(!(T instanceof Array))throw new he(`Corrupted configuration, expected array for nodeData: ${T}`);a(_,T)})}let p=e.name,f=e.layers;for(let x of f)l(x);for(;!HZ(i);)for(let x of f){let w=s[x.name];if(w.name in i){let _=i[w.name];delete i[w.name];for(let I of _)c(w,I)}}let y=[],d=[],h=e.inputLayers;for(let x of h){let w=x[0],_=x[1],I=x[2];Hi(w in s);let D=s[w].inboundNodes[_].outputTensors;y.push(D[I])}let m=e.outputLayers;for(let x of m){let w=x[0],_=x[1],I=x[2];Hi(w in s);let D=s[w].inboundNodes[_].outputTensors;d.push(D[I])}return new t({inputs:y,outputs:d,name:p})}get stateful(){if(this._stateful)throw new he("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(let t of this.layers)if(t.stateful)return!0;return!1}resetStates(){de(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}});function YOe(n,t,e){let r=t.length;if(n==null||Array.isArray(n)&&n.length===0)return t.map(o=>null);if(r===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&t[0]in n?[n[t[0]]]:[n];if(Array.isArray(n)){if(n.length!==r)throw new Error(`Provided ${e} is an array of ${n.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return n}else if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){let o=[];return t.forEach(s=>{s in n?o.push(n[s]):o.push(null)}),o}else throw new Error(`The model has multiple (${r}) outputs, so ${e} must be either an array with ${r} elements or an object with ${t} keys. Provided ${e} not understood: ${JSON.stringify(n)}`)}function kE(n,t){return YOe(n,t,"classWeight")}function AE(n,t,e,r){return Y(this,null,function*(){if(t!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");if(e!=null){let o=de(()=>{if(n.shape.length===1)return n.clone();if(n.shape.length===2){if(n.shape[1]>1)return n.argMax(1);if(n.shape[1]===1)return n.reshape([n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),s=Array.from(yield o.data());Mt(o);let i=[];return s.forEach(a=>{if(e[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);i.push(e[a])}),Er(i,"float32")}else return null})}function $J(n,t){return oe(n,t)}var _F=b(()=>{"use strict";$();});function BJ(n,t){let e,r,o=t;e=o.xs,r=o.ys,N.assert(e!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);let s=LJ("input",n.inputNames,e),i=LJ("output",n.outputNames,r),a=s[0].shape[0];N.assert(s.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${s.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),N.assert(i.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let c=0;c<s.length;c++)N.assert(s[c].shape[0]===a,()=>`Batch size mismatch: input ${n.inputNames[c]} has ${s[c].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);for(let c=0;c<i.length;c++)N.assert(i[c].shape[0]===a,()=>`Batch size mismatch: output ${n.outputNames[c]} has ${i[c].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);return{xs:s,ys:i}}function LJ(n,t,e){if(e instanceof K)return[e];if(Array.isArray(e))return N.assert(e.length===t.length,()=>`Received an array of ${e.length} Tensors, but expected ${t.length} to match the ${n} keys ${t}.`),e;{let r=[];for(let o of t){if(e[o]==null)throw new he(`The feature data generated by the dataset lacks the required ${n} key '${o}'.`);r.push(e[o])}return r}}function JOe(n){if(n.length===3)throw new At("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}function VJ(n,t,e){return Y(this,null,function*(){let r=e.batchesPerEpoch!=null;if(N.assert(n.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),N.assert(e!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),N.assert(e.epochs!=null&&e.epochs>0&&Number.isInteger(e.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${e.epochs}`),N.assert(!r||e.batchesPerEpoch>0&&Number.isInteger(e.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${e.batchesPerEpoch}`),N.assert(e.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{let o=e.validationData!=null,s,i;if(o)if(zJ(e.validationData))N.assert(e.validationBatches==null||e.validationBatches>0&&Number.isInteger(e.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${e.validationBatches}`);else{let x=JOe(e.validationData);s=x.xs,i=x.ys}let a=n.makeTrainFunction(),c=n.getDedupedMetricsNames(),l;o?l=c.slice().concat(c.map(x=>"val_"+x)):l=c.slice();let p=vE(e.callbacks,e.yieldEvery),f=e.verbose==null?1:e.verbose,{callbackList:y,history:d}=bE(p,f,e.epochs,null,null,eMe(t,e),null,o,l);y.setModel(n),n.history=d,yield y.onTrainBegin(),n.stopTraining_=!1;let h=e.initialEpoch==null?0:e.initialEpoch,m=yield t.iterator();for(;h<e.epochs;){let x={};yield y.onEpochBegin(h);let w=0,_=0;for(r||(m=yield t.iterator());!r||w<e.batchesPerEpoch;){let I=yield m.next();if(r&&I.done){console.warn(`You provided \`batchesPerEpoch\` as ${e.batchesPerEpoch}, but your dataset iterator ran out of data after ${w} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${e.batchesPerEpoch*e.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(I.value!=null){let{xs:T,ys:D}=BJ(n,I.value),O={};O.batch=_,O.size=T[0].shape[0],yield y.onBatchBegin(_,O);let R=[];if(e.classWeight!=null){let G=kE(e.classWeight,n.outputNames);for(let Q=0;Q<G.length;++Q)R.push(yield AE(D[Q],null,G[Q]))}let P=T.concat(D).concat(R),j=a(P);Mt(P);for(let G=0;G<c.length;++G){let Q=c[G],ie=j[G];O[Q]=ie,ur(ie)}yield y.onBatchEnd(_,O),xE(O),_++,w++}if(r?w>=e.batchesPerEpoch:I.done){if(o){let T;zJ(e.validationData)?T=Kn(yield n.evaluateDataset(e.validationData,{batches:e.validationBatches})):T=Kn(n.evaluate(s,i,{batchSize:e.validationBatchSize==null?ZOe:e.validationBatchSize,verbose:0}));for(let D=0;D<n.metricsNames.length;++D)x[`val_${n.metricsNames[D]}`]=T[D]}break}if(n.stopTraining_)break}if(yield y.onEpochEnd(h,x),h++,n.stopTraining_)break}return yield y.onTrainEnd(),yield n.history.syncData(),n.history}finally{n.isTraining=!1}})}function eMe(n,t){let e=null;return t.batchesPerEpoch!=null?e=t.batchesPerEpoch:Number.isFinite(n.size)&&(e=n.size),e}function zJ(n){return typeof n.iterator=="function"}function tMe(n){return typeof n.next=="function"}function qJ(n,t,e){return Y(this,null,function*(){e=e||{};let r=e.batches!=null,o=n.testFunction,s=[];if(e.verbose>0)throw new At("Verbose mode is not implemented yet.");N.assert(!r||e.batches>0&&Number.isInteger(e.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(e.batches)}`);let i=tMe(t)?t:yield t.iterator(),a=0,c=0;for(;!r||c<e.batches;){let l=yield i.next();if(s=de(()=>{if(l.value){let{xs:p,ys:f}=BJ(n,l.value),y=p.concat(f),d=de(()=>o(y));if(Mt(y),c===0)for(let m=0;m<d.length;++m)s.push(it(0));let h=y[0].shape[0];for(let m=0;m<d.length;++m){let x=d[m],w=s[m];s[m]=de(()=>je(s[m],oe(h,x))),c>0&&Mt(w)}Mt(d),a+=h,++c}return s}),l.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${e.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let l=0;l<s.length;++l){let p=s[l];s[l]=ct(s[l],a),Mt(p)}return No(s)})}var ZOe,UJ=b(()=>{"use strict";$();$();Bv();Gn();K0();Dr();_F();ZOe=32});function OE(n){N.assert(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function Gv(n,t,e){return n==null?[null]:Array.isArray(n)?n.map(r=>ph(r,t,e-t)):ph(n,t,e-t)}function ME(n,t){return de(()=>n==null?null:Array.isArray(n)?n.map(e=>ME(e,t)):iE(n,t.dtype==="int32"?t:t.toInt()))}function RE(n,t){let e=[],r=0,o=null;for(;r<n;)o=r+t,o>=n&&(o=n),e.push([r,o]),r=o;return e}function nMe(n,t,e,r,o,s,i,a,c,l,p,f,y,d,h){return Y(this,null,function*(){o==null&&(o=32),s==null&&(s=1),p==null&&(p=!0),y==null&&(y=0);let m=!1;if(c!=null&&l!=null&&(m=!0),h!=null&&(m=!0,d==null))throw new he("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let x=n.checkNumSamples(e,o,d,"steps_per_epoch"),w;x!=null&&(w=Ss(0,x)),i==null&&(i=1);let{callbackList:_,history:I}=bE(a,i,s,y,x,d,o,m,f);_.setModel(n),n.history=I,yield _.onTrainBegin(),n.stopTraining_=!1;for(let T=y;T<s;++T){yield _.onEpochBegin(T);let D={};if(d!=null)throw new At("stepsPerEpoch mode is not implemented yet.");{if(p==="batch")throw new At("batch shuffling is not implemneted yet");p&&N.shuffle(w);let O=Er(w),R=RE(x,o);for(let P=0;P<R.length;++P){let j={};if(yield _.onBatchBegin(P,j),de(()=>{let G=R[P][0],Q=R[P][1],ie=ph(O,G,Q-G);j.batch=P,j.size=Q-G;let pe=ME(e,ie),xe=t(pe);for(let ne=0;ne<r.length;++ne){let fe=r[ne],te=xe[ne];j[fe]=te,ur(te)}if(P===R.length-1&&m){let ne=n.testLoop(c,l,o);for(let fe=0;fe<r.length;++fe){let te=r[fe],se=ne[fe];ur(se),D["val_"+te]=se}}}),yield _.onBatchEnd(P,j),xE(j),n.stopTraining_)break}O.dispose()}if(yield _.onEpochEnd(T,D),n.stopTraining_)break}return yield _.onTrainEnd(),yield n.history.syncData(),n.history})}function jJ(o,s,i){return Y(this,arguments,function*(n,t,e,r={}){if(n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;let a,c,l,p,f,y,d;try{let h=r.batchSize==null?32:r.batchSize;OE(h);let x=yield n.standardizeUserData(t,e,r.sampleWeight,r.classWeight,!1,h);a=x[0],c=x[1],d=x[2];let w=!1,_;if(r.validationData!=null&&r.validationData.length>0){if(w=!0,r.validationData.length===2)l=r.validationData[0],p=r.validationData[1];else throw r.validationData.length===3?new At("validationData including sample weights is not supported yet."):new he(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);let Q=yield n.standardizeUserData(l,p,null,null,!0,h);f=Q[0],y=Q[1],_=f.concat(y)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){w=!0;let G=Math.floor(a[0].shape[0]*(1-r.validationSplit)),Q=a[0].shape[0];f=Gv(a,G,Q),a=Gv(a,0,G),y=Gv(c,G,Q),c=Gv(c,0,G),_=f.concat(y)}else r.validationSteps!=null&&(w=!0);let I=a.concat(c).concat(d);n.checkTrainableWeightsConsistency();let T=n.makeTrainFunction(),D=n.getDedupedMetricsNames(),O,R;w?(n.makeTestFunction(),O=n.testFunction,R=D.slice().concat(D.map(G=>"val_"+G))):(O=null,_=[],R=D.slice());let P=vE(r.callbacks,r.yieldEvery);return yield nMe(n,T,I,D,h,r.epochs,r.verbose,P,O,_,r.shuffle,R,r.initialEpoch,null,null)}finally{n.isTraining=!1,Kf(a,t),Kf(c,e),Kf(f,l),Kf(y,p),d!=null&&Mt(d)}})}function TF(n){let t=[];n instanceof K&&(n=[n]);for(let e=0;e<n.length;++e){let r=n[e];if(r.rank===1)t.push(fh(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function Kf(n,t){if(n==null)return;let e=[];if(t instanceof K)e.push(t.id);else if(Array.isArray(t))t.forEach(o=>e.push(o.id));else if(t!=null)for(let o in t){let s=t[o];e.push(s.id)}let r=[];if(n instanceof K)e.indexOf(n.id)===-1&&r.push(n);else if(Array.isArray(n))n.forEach(o=>{e.indexOf(o.id)===-1&&r.push(o)});else if(n!=null)for(let o in n){let s=n[o];e.indexOf(s.id)===-1&&r.push(s)}r.forEach(o=>{o.isDisposed||o.dispose()})}var GJ=b(()=>{"use strict";$();$();qo();Bv();Gn();K0();wl();});function rMe(n){return n instanceof K}function IF(n){return Array.isArray(n)}function WJ(n){return!rMe(n)&&!IF(n)}function HJ(n,t,e,r=!0,o=""){if(t==null||t.length===0){if(n!=null){let i=!1;if(IF(n)&&n.length>0)i=!0;else if(WJ(n)){for(let a in n)if(n.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new he(`Error when checking model ${o} expected no data, but got ${n}`)}return[]}if(n==null)return t.map(i=>null);let s;if(WJ(n)){n=n,s=[];for(let i of t){if(n[i]==null)throw new he(`No data provided for "${i}". Need data for each key in: ${t}`);s.push(n[i])}}else if(IF(n)){if(n=n,n.length!==t.length)throw new he(`Error when checking model ${o}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);s=n}else{if(n=n,t.length>1)throw new he(`The model ${o} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);s=[n]}if(s=TF(s),e!=null)for(let i=0;i<t.length;++i){if(e[i]==null)continue;let a=s[i];if(a.shape.length!==e[i].length)throw new he(`Error when checking ${o}: expected ${t[i]} to have ${e[i].length} dimension(s). but got array with shape ${a.shape}`);for(let c=0;c<e[i].length;++c){if(c===0&&!r)continue;let l=a.shape[c],p=e[i][c];if(p!=null&&p>=0&&l!==p)throw new he(`Error when checking ${o}: expected ${t[i]} to have shape [${e[i]}], but got array with shape [${a.shape}].`)}}return s}function oMe(n,t,e){let r=Na(n.map(s=>s.shape[0]));r.sort();let o=Na(t.map(s=>s.shape[0]));if(o.sort(),r.length>1)throw new he(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(s=>s.shape))}`);if(o.length>1)throw new he(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(s=>s.shape))}`);if(r.length>0&&o.length>0&&!N.arraysEqual(r,o))throw new he(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${o[0]} target sample(s).`)}function sMe(n,t,e){let r=[Cl,jv,gg];for(let o=0;o<n.length;++o){let s=n[o],i=t[o],a=e[o];if(i!=null){if(i===gg&&s.shape[s.shape.length-1]===1)throw new he(`You are passing a target array of shape ${s.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(i)!==-1){let c=s.shape.slice(1),l=a.slice(1);for(let p=0;p<c.length;++p){let f=c[p],y=l[p];if(y!=null&&f!==y)throw new he(`A target Tensor with shape ${s.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function KJ(n,t,e,r=!0,o=""){let s;if(Array.isArray(n)){if(n.length!==t.length)throw new he(`Error when checking model ${o}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${n.length} Tensors(s).`);s=n}else{if(t.length>1)throw new he(`The model expects ${t.length} ${o} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);s=[n]}if(e!=null)for(let i=0;i<t.length;++i){if(e[i]==null)continue;let a=s[i];if(a.shape.length!==e[i].length)throw new he(`Error when checking ${o}: expected ${t[i]} to have ${e[i].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let c=0;c<e[i].length;++c){if(c===0&&!r)continue;let l=a.shape[c],p=e[i][c];if(p!=null&&p!==l)throw new he(`Error when checking ${o}: expected ${t[i]} to have shape ${JSON.stringify(e[i])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function iMe(n,t){if(n==null||Array.isArray(n)&&n.length===0)return t.map(r=>[]);let e;if(typeof n=="string"||typeof n=="function")e=[n];else if(Array.isArray(n)||typeof n=="object")e=n;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);if(Array.isArray(e))return t.map(r=>e);{let r=[];for(let o of t){let s=e.hasOwnProperty(o)?e[o]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}}var aMe,Oa,cMe,sS=b(()=>{"use strict";$();$();qo();Da();Gn();Vv();yg();vF();DJ();kJ();Dr();OJ();wl();EE();NE();FJ();CF();UJ();GJ();_F();aMe="layers-model",Oa=(()=>{class n extends DE{constructor(e){super(e),this.isTraining=!1}summary(e,r,o=console.log){if(!this.built)throw new he("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");AJ(this,e,r,o)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=NJ(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Bo))throw new he("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let r=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(let a in e.loss)if(this.outputNames.indexOf(a)===-1)throw new he(`Unknown entry in loss dictionary: "${a}". Only expected the following keys: ${this.outputNames}`);for(let a of this.outputNames)e.loss[a]==null&&console.warn(`Output "${a}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${a} during training`),r.push(wE(e.loss[a]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new he(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);r=e.loss.map(c=>wE(c))}else{let a=wE(e.loss);this.outputs.forEach(c=>{r.push(a)})}this.lossFunctions=r,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){let c=this.internalOutputShapes[a],l=this.outputNames[a];this.feedOutputNames.push(l),this.feedOutputShapes.push(c),this.feedLossFns.push(this.lossFunctions[a])}let o=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Sc("loss",()=>{for(let a=0;a<this.outputs.length;++a){if(o.indexOf(a)!==-1)continue;let c=this.lossFunctions[a];this.outputs.length>1&&(this.metricsTensors.push([c,a]),this.metricsNames.push(this.outputNames[a]+"_loss"))}});let s=iMe(e.metrics,this.outputNames),i=(a,c,l)=>{this.outputNames.length>1&&(c=this.outputNames[a]+"_"+c),this.metricsNames.push(c),this.metricsTensors.push([l,a])};Sc("metric",()=>{for(let a=0;a<this.outputs.length;++a){if(o.indexOf(a)!==-1)continue;let c=s[a];(p=>{let f="",y,d,h;for(let m of p){if(typeof m=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(m)!==-1){let w=this.internalOutputShapes[a];w[w.length-1]===1||this.lossFunctions[a]===jv?["accuracy","acc"].indexOf(m)!==-1?d=tS:["crossentropy","ce"].indexOf(m)!==-1&&(d=CE):this.lossFunctions[a]===Uv?["accuracy","acc"].indexOf(m)!==-1?d=_E:["crossentropy","ce"].indexOf(m)!==-1&&(d=xF):["accuracy","acc"].indexOf(m)!==-1?d=nS:["crossentropy","ce"].indexOf(m)!==-1&&(d=rS);let _;["accuracy","acc"].indexOf(m)!==-1?_="acc":["crossentropy","ce"].indexOf(m)!==-1&&(_="ce"),h=d,y=f+_}else h=IJ(m),y=f+oS(m);let x;Sc(y,()=>{x=h}),i(a,y,x)}})(c)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,r,o={}){let s=o.batchSize==null?32:o.batchSize;OE(s);let a=this.standardizeUserDataXY(e,r,!0,s);try{let c=a[0].concat(a[1]);this.makeTestFunction();let l=this.testFunction,p=this.testLoop(l,c,s,o.verbose,o.steps);return No(p)}finally{Kf(a[0],e),Kf(a[1],r)}}evaluateDataset(e,r){return Y(this,null,function*(){return this.makeTestFunction(),qJ(this,e,r)})}checkNumSamples(e,r,o,s="steps"){let i;if(o!=null){if(i=null,r!=null)throw new he(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${r}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new he(`Either the input data should have a defined shape, or ${s} shoud be specified.`);return i}execute(e,r){if(Array.isArray(r)&&r.length===0)throw new he("`outputs` is an empty Array, which is not allowed.");let o=Array.isArray(r),s=o?r:[r],i=this.retrieveSymbolicTensors(s),a=new _l;if(e instanceof K&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new he(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)a.add(this.inputs[l],e[l])}else for(let l of this.inputs){let p=e[l.name];if(p==null)throw new he(`No value is provided for the model's input ${l.name}`);a.add(l,p)}let c=vg(i,a);return o?c:c[0]}retrieveSymbolicTensors(e){let r=Ia(null,e.length),o=e.length;for(let s of this.layers){let i=Array.isArray(s.output)?s.output:[s.output],a=i.map(c=>c.name);for(let c=0;c<e.length;++c){let l=a.indexOf(e[c]);if(l!==-1&&(r[c]=i[l],o--),o===0)break}if(o===0)break}if(o>0){let s=[];throw r.forEach((i,a)=>{i==null&&s.push(e[a])}),new he(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return r}predictLoop(e,r=32,o=!1){return de(()=>{let s=this.checkNumSamples(e);if(o)throw new At("Verbose predictLoop() is not implemented yet.");let i=RE(s,r),a=this.outputs.map(c=>[]);for(let c=0;c<i.length;++c)de(()=>{let p=i[c][0],f=i[c][1],y=Gv(e,p,f),d=[];if(Array.isArray(y))for(let m=0;m<y.length;++m)d.push({key:this.inputs[m],value:y[m]});else d.push({key:this.inputs[0],value:y});let h=new _l(d);return vg(this.outputs,h)}).forEach((p,f)=>a[f].push(p));return No(a.map(c=>gn(c,0)))})}predict(e,r={}){let o=TF(e);KJ(o,this.inputNames,this.feedInputShapes,!1);try{let s=r.batchSize==null?32:r.batchSize;return OE(s),this.predictLoop(o,s)}finally{Kf(o,e)}}predictOnBatch(e){KJ(e,this.inputNames,this.feedInputShapes,!0);let r=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,r)}standardizeUserDataXY(e,r,o=!0,s){if(this.optimizer_==null)throw new Fs("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");let i=[];for(let a=0;a<this.feedOutputShapes.length;++a){let c=this.feedOutputShapes[a];this.feedLossFns[a]===Uv?i.push(c.slice(0,c.length-1).concat([1])):i.push(c)}if(e=HJ(e,this.feedInputNames,this.feedInputShapes,!1,"input"),r=HJ(r,this.feedOutputNames,i,!1,"target"),oMe(e,r,null),sMe(r,this.feedLossFns,this.feedOutputShapes),this.stateful&&s!=null&&s>0&&e[0].shape[0]%s!==0)throw new he(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,r]}standardizeUserData(e,r,o,s,i=!0,a){return Y(this,null,function*(){let[c,l]=this.standardizeUserDataXY(e,r,i,a);if(o!=null)throw new Error("sample weight is not supported yet.");let p=null;if(s!=null){let f=kE(s,this.outputNames);p=[];for(let y=0;y<f.length;++y)p.push(yield AE(l[y],null,f[y]))}return[c,l,p]})}testLoop(e,r,o,s=0,i){return de(()=>{let a=this.checkNumSamples(r,o,i,"steps"),c=[];if(s>0)throw new At("Verbose mode is not implemented yet.");if(i!=null)throw new At("steps mode in testLoop() is not implemented yet");{let l=RE(a,o),p=Er(Ss(0,a));for(let f=0;f<l.length;++f){let y=l[f][0],d=l[f][1],h=ph(p,y,d-y),m=ME(r,h),x=e(m);if(f===0)for(let w=0;w<x.length;++w)c.push(it(0));for(let w=0;w<x.length;++w){let _=x[w];c[w]=je(c[w],oe(d-y,_))}}for(let f=0;f<c.length;++f)c[f]=ct(c[f],a)}return c})}getDedupedMetricsNames(){let e=this.metricsNames,r=[];for(let o=0;o<e.length;++o){let s=e[o],i=s;if(HP(e,s)>1){let a=HP(e.slice(0,o),s);i+=`_${a}`}r.push(i)}return r}makeTrainFunction(){return e=>{let r=[],o=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),a=[],c=()=>{let y=[];for(let x=0;x<this.inputs.length;++x)y.push({key:this.inputs[x],value:o[x]});let d=new _l(y),h=vg(this.outputs,d,{training:!0}),m;for(let x=0;x<this.lossFunctions.length;++x){let w=this.lossFunctions[x],_=w(s[x],h[x]);i[x]!=null&&(_=$J(_,i[x]));let I=Un(_);r.push(I),x===0?m=_:m=je(m,_)}for(let x=0;x<this.metricsTensors.length;++x){let w;if(this.outputs.length>1&&x<this.outputs.length)w=r[x];else{let _=this.metricsTensors[x][0],I=this.metricsTensors[x][1];w=Un(_(s[I],h[I]))}ur(w),a.push(w)}return m=Un(m),this.calculateLosses().forEach(x=>{m=je(m,x)}),m},l=this.collectedTrainableWeights.map(y=>y.read());return[this.optimizer_.minimize(c,!0,l)].concat(a)}}makeTestFunction(){this.testFunction=e=>de(()=>{let r=[],o,s=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let p=0;p<this.inputs.length;++p)a.push({key:this.inputs[p],value:s[p]});let c=new _l(a),l=vg(this.outputs,c);for(let p=0;p<this.lossFunctions.length;++p){let f=this.lossFunctions[p],y=Un(f(i[p],l[p]));p===0?o=y:o=je(o,y),r.push(o)}for(let p=0;p<this.metricsTensors.length;++p){let f=this.metricsTensors[p][0],y=this.metricsTensors[p][1],d=Un(f(i[y],l[y]));r.push(d)}return r})}fit(s,i){return Y(this,arguments,function*(e,r,o={}){return jJ(this,e,r,o)})}fitDataset(e,r){return Y(this,null,function*(){return VJ(this,e,r)})}trainOnBatch(e,r){return Y(this,null,function*(){let o=yield this.standardizeUserData(e,r),s=o[0],i=o[1],c=this.makeTrainFunction()(s.concat(i)),l=[];for(let p of c){let f=yield p.data();l.push(f[0])}return Mt(c),No(l)})}getNamedWeights(e){let r=[],o=e!=null&&e.trainableOnly,s=o?this.trainableWeights:this.weights,i=this.getWeights(o);for(let a=0;a<s.length;++a)o&&!s[a].trainable||r.push({name:s[a].originalName,tensor:i[a]});return r}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){let e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){let r=Px().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=r-Px().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Ea(this.loss);else if(Array.isArray(this.loss)){for(let r of this.loss)if(typeof r!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(r=>Ea(r))}else{let r=Object.keys(this.loss);e={};let o=this.loss;for(let s of r)if(typeof o[s]=="string")e[s]=Ea(o[s]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Ea(oS(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Ea(oS(e)));{let e={};for(let r in this.metrics)e[r]=Ea(oS(this.metrics[r]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");let r=xg(e.optimizer_config),o=Bs(r),s;if(typeof e.loss=="string")s=uh(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(a=>uh(a));else if(e.loss!=null){s={};for(let a in e.loss)s[a]=uh(e.loss[a])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(a=>uh(a));else if(e.metrics!=null){i={};for(let a in e.metrics)i[a]=uh(e.metrics[a])}this.compile({loss:s,metrics:i,optimizer:o})}save(e,r){return Y(this,null,function*(){if(typeof e=="string"){let p=Po.getSaveHandlers(e);if(p.length===0)throw new he(`Cannot find any save handlers for URL '${e}'`);if(p.length>1)throw new he(`Found more than one (${p.length}) save handlers for URL '${e}'`);e=p[0]}if(e.save==null)throw new he("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");let o=yield Po.encodeWeights(this.getNamedWeights(r)),c={modelTopology:this.toJSON(null,!1),format:aMe,generatedBy:`TensorFlow.js tfjs-layers v${Hf}`,convertedBy:null};if((r==null?!1:r.includeOptimizer)&&this.optimizer!=null){c.trainingConfig=this.getTrainingConfig();let p="optimizer",{data:f,specs:y}=yield Po.encodeWeights(yield this.optimizer.getWeights(),p);o.specs.push(...y),o.data=Po.concatenateArrayBuffers([o.data,f])}return this.userDefinedMetadata!=null&&(wF(this.userDefinedMetadata,this.name,!0),c.userDefinedMetadata=this.userDefinedMetadata),c.weightData=o.data,c.weightSpecs=o.specs,e.save(c)})}setUserDefinedMetadata(e){wF(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}return n.className="Model",n})();He.registerClass(Oa);cMe=(()=>{class n extends Oa{}return n.className="Functional",n})();He.registerClass(cMe)});function XJ(n,t){return Y(this,null,function*(){"modelTopology"in n||(n={modelTopology:n}),n=n;let e=n.modelTopology;e.model_config!=null&&(e=e.model_config);let r=xg(e),o=Bs(r,t);if(n.weightsManifest!=null){let s=yield Po.loadWeights(n.weightsManifest,n.pathPrefix,o.weights.map(a=>a.originalName)),i={};for(let a of o.weights)i[a.originalName]=s[a.originalName];o.loadWeights(i),Mt(s)}return o})}function QJ(n,t){return Y(this,null,function*(){if(t==null&&(t={}),typeof n=="string"){let e=Po.getLoadHandlers(n,t);if(e.length===0)e.push(Po.browserHTTPRequest(n,t));else if(e.length>1)throw new he(`Found more than one (${e.length}) load handlers for URL '${n}'`);n=e[0]}return uMe(n,void 0,t)})}function uMe(n,t,e){return Y(this,null,function*(){if(e==null&&(e={}),n.load==null)throw new he("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let r=yield n.load(),o=r.modelTopology;o.model_config!=null&&(o=o.model_config);let s=e.strict==null?!0:e.strict,i=r.weightData!=null&&r.weightSpecs!=null&&s,a=Bs(xg(o),t,i),c=r.trainingConfig;if(c!=null&&a.loadTrainingConfig(c),r.userDefinedMetadata!=null&&a.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData!=null){if(r.weightSpecs==null)throw new he("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");let{modelWeights:l,optimizerWeights:p}=lMe(r.weightData,r.weightSpecs);a.loadWeights(l,s),a.optimizer!=null&&p.length>0&&(yield a.optimizer.setWeights(p)),Mt(l),Mt(p.map(f=>f.tensor))}return a})}function lMe(n,t){let e=Po.decodeWeights(n,t),r={},o=[];return t.forEach(s=>{s.group==="optimizer"?o.push({name:s.name,tensor:e[s.name]}):r[s.name]=e[s.name]}),{modelWeights:r,optimizerWeights:o}}var iS,PE=b(()=>{"use strict";$();Rv();zv();bo();sS();Gn();Vv();Dr();EE();Cs();iS=(()=>{class n extends Oa{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:jf("sequential_"),e.layers!=null)for(let r of e.layers)this.add(r)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(o=>o<0))throw new he(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){let r=e instanceof n||e instanceof Oa,o;if(r){if(o=e,o.outputs.length!==1)throw new he("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(o.inputs.length!==1)throw new he("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new he("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let s=yE({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(r)this.outputs=o.outputs,this.inputs=o.inputs;else{if(e.inboundNodes.length!==1)throw new he(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new he("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=dF(this.outputs[0])}this.inboundNodes=[],new dh({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Ia(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{let s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,r){return this.model==null&&this.build(),this.model.call(e,r)}build(e){if(bn(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Oa({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,r,o=console.log){this.built||this.build(),super.summary(e,r,o)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,r,o={}){if(!this.built)throw new Fs("The model needs to be compiled before being used.");return this.model.evaluate(e,r,o)}evaluateDataset(e,r){return Y(this,null,function*(){if(!this.built)throw new Fs("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,r)})}predict(e,r={}){return this.model==null&&this.build(),this.model.predict(e,r)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}fit(s,i){return Y(this,arguments,function*(e,r,o={}){if(!this.built)throw new Fs("The model needs to be compiled before being used.");return this.model.fit(e,r,o)})}fitDataset(e,r){return Y(this,null,function*(){if(!this.built)throw new Fs("The model needs to be compiled before being used.");return this.model.fitDataset(e,r)})}trainOnBatch(e,r){return Y(this,null,function*(){return this.model.trainOnBatch(e,r)})}static fromConfig(e,r,o={},s=!1){let i,a={};if(r instanceof Array){if(r[0].className==null||r[0].className==="Merge")throw new he("Legacy serialization format not supported yet.");i=r}else N.assert(r.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=r.layers,delete r.layers,a=r;let c=new e(a);if(!(c instanceof n))throw new At(`Sequential.fromConfig called on non-Sequential input: ${c}`);for(let l of i){let f=Bs(l,void 0,s);s&&f.setFastWeightInitDuringBuild(!0),c.add(f)}return c}set stopTraining(e){if(this.model==null)throw new he("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new he("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){let e=[];for(let r of this.layers){let o={};o.className=r.getClassName(),o.config=r.getConfig(),e.push(o)}return{name:this.name,layers:e}}}return n.className="Sequential",n})();He.registerClass(iS)});function YJ(n){return new Oa(n)}function ZJ(n){return new iS(n)}function JJ(n,t){return t==null&&(t={}),QJ(n,t)}function FE(n){return yE(n)}function eee(n,t){gF.registerCallbackConstructor(n,t)}var EF=b(()=>{"use strict";Bv();zv();sS();PE();});function Tc(n){return n.getClassName()}function NF(n,t={}){return vl(n,He.SerializationMap.getMap().classNameMap,t,"activation")}function Ic(n){if(n==null){let t={};return t.className="linear",t.config={},NF(t)}if(typeof n=="string"){let t={};return t.className=n,t.config={},NF(t)}else return n instanceof Vs?n:NF(n)}var Vs,pMe,hMe,fMe,dMe,mMe,gMe,yMe,xMe,vMe,bMe,DF,wMe,SMe,aS=b(()=>{"use strict";$();$();qo();Dr();Vs=class extends He.Serializable{getConfig(){return{}}},pMe=(()=>{class n extends Vs{apply(e,r=1){return hJ(e,r)}}return n.className="elu",n})();He.registerClass(pMe);hMe=(()=>{class n extends Vs{apply(e){return Ff(e)}}return n.className="selu",n})();He.registerClass(hMe);fMe=(()=>{class n extends Vs{apply(e){return zo(e)}}return n.className="relu",n})();He.registerClass(fMe);dMe=(()=>{class n extends Vs{apply(e){return de(()=>_i(6,zo(e)))}}return n.className="relu6",n})();He.registerClass(dMe);mMe=(()=>{class n extends Vs{apply(e){return e}}return n.className="linear",n})();He.registerClass(mMe);gMe=(()=>{class n extends Vs{apply(e){return xs(e)}}return n.className="sigmoid",n})();He.registerClass(gMe);yMe=(()=>{class n extends Vs{apply(e){return dJ(e)}}return n.className="hardSigmoid",n})();He.registerClass(yMe);xMe=(()=>{class n extends Vs{apply(e){return ba(e)}}return n.className="softplus",n})();He.registerClass(xMe);vMe=(()=>{class n extends Vs{apply(e){return fJ(e)}}return n.className="softsign",n})();He.registerClass(vMe);bMe=(()=>{class n extends Vs{apply(e){return fc(e)}}return n.className="tanh",n})();He.registerClass(bMe);DF=(()=>{class n extends Vs{apply(e,r=-1){return fl(e,r)}}return n.className="softmax",n})();He.registerClass(DF);wMe=(()=>{class n extends Vs{apply(e,r=-1){return Df(e,r)}}return n.className="logSoftmax",n})();He.registerClass(wMe);SMe=(()=>{class n extends Vs{apply(e,r=1){return de(()=>xs(e.mul(r)).mul(e))}}return n.className="swish",n})();He.registerClass(SMe)});function kF(n){if(n!=null&&typeof n!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}function ree(n){return kF(n),new cS({l1:n!=null?n.l1:null,l2:0})}function oee(n){return kF(n),new cS({l2:n!=null?n.l2:null,l1:0})}function On(n){return kv(n)}function nee(n,t={}){return vl(n,He.SerializationMap.getMap().classNameMap,t,"regularizer")}function Xn(n){if(n==null)return null;if(typeof n=="string"){let e={className:n in tee?tee[n]:n,config:{}};return nee(e)}else return n instanceof $E?n:nee(n)}var $E,cS,tee,Tl=b(()=>{"use strict";$();$();qo();Dr();$E=class extends He.Serializable{},cS=(()=>{class n extends $E{constructor(e){super(),kF(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return de(()=>{let r=An([1]);return this.hasL1&&(r=je(r,gt(oe(this.l1,Jn(e))))),this.hasL2&&(r=je(r,gt(oe(this.l2,mg(e))))),r.asScalar()})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,r){return new e({l1:r.l1,l2:r.l2})}}return n.className="L1L2",n})();He.registerClass(cS);tee={l1l2:"L1L2"}});var AF,OF,MF,RF,PF,FF,see=b(()=>{"use strict";$();aS();qo();lh();bo();Gn();_c();Tl();Cs();AF=(()=>{class n extends Wt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,r){e=jt(e);let o=zo(e);return this.maxValue!=null&&(o=oo(o,0,this.maxValue)),o}computeOutputShape(e){return e}getConfig(){let e={maxValue:this.maxValue},r=super.getConfig();return Object.assign(e,r),e}}return n.className="ReLU",n})();He.registerClass(AF);OF=(()=>{class n extends Wt{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,r){let o=jt(e);return al(o,this.alpha)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},r=super.getConfig();return Object.assign(e,r),e}}return n.className="LeakyReLU",n})();He.registerClass(OF);MF=(()=>{class n extends Wt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Wn(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Xn(e.alphaRegularizer),this.alphaConstraint=Cr(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new he(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=bn(e);let r=e.slice(1);if(this.sharedAxes!=null)for(let s of this.sharedAxes)r[s-1]=1;this.alpha=this.addWeight("alpha",r,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let o={};if(this.sharedAxes!=null)for(let s=1;s<e.length;++s)o[s]=e[s];this.inputSpec=[new nr({ndim:e.length,axes:o})],this.built=!0}call(e,r){return e=jt(e),hl(e,this.alpha.read())}getConfig(){let e={alphaInitializer:tr(this.alphaInitializer),alphaRegularizer:On(this.alphaRegularizer),alphaConstraint:Sr(this.alphaConstraint),sharedAxes:this.sharedAxes},r=super.getConfig();return Object.assign(e,r),e}}return n.className="PReLU",n})();He.registerClass(MF);RF=(()=>{class n extends Wt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new At(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,r){let o=jt(e);return xa(o)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},r=super.getConfig();return Object.assign(e,r),e}}return n.className="ELU",n})();He.registerClass(RF);PF=(()=>{class n extends Wt{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,r){let o=jt(e);return o.mul(hh(o.greater(this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){let e={theta:this.theta},r=super.getConfig();return Object.assign(e,r),e}}return n.className="ThresholdedReLU",n})();He.registerClass(PF);FF=(()=>{class n extends Wt{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new DF().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,r){let o=jt(e);return this.softmax(o,this.axis)}computeOutputShape(e){return e}getConfig(){let e={axis:this.axis},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Softmax",n})();He.registerClass(FF)});function Xf(n,t,e){if(typeof n=="number")return Ia(n,t);if(n.length!==t)throw new he(`The ${e} argument must be an integer or tuple of ${t} integers. Received: ${n.length} elements.`);for(let r=0;r<t;++r){let o=n[r];if(!aJ(o))throw new he(`The ${e} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(n)} including a non-integer number ${o}`)}return n}function ni(n,t,e,r,o=1){if(n==null)return n;let s=t+(t-1)*(o-1),i;return e==="same"?i=n:i=n-s+1,Math.floor((i+r-1)/r)}function uS(n,t,e,r){if(n==null)return null;if(r==="valid")n=n*t+Cc([e-t,0]);else if(r==="same")n=n*t;else throw new he(`Unsupport padding mode: ${r}.`);return n}var lS=b(()=>{"use strict";Gn();Dr();wl();});function hS(n,t){return de(()=>(yr(t),t==="channelsFirst"?pn(n,[0,2,3,1]):n))}function $F(n,t){return de(()=>(yr(t),t==="channelsFirst"?pn(n,[0,2,3,4,1]):n))}function _Me(n,t,e,r=1,o="valid",s,i=1){return de(()=>{if(s==null&&(s=Ps()),yr(s),n.shape.length!==3)throw new he(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(t.shape.length!==3)throw new he(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(e!=null&&e.shape.length!==1)throw new he(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(s==="channelsFirst"&&(n=pn(n,[0,2,1])),o==="causal")throw new At("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=bf(n,t,r,o==="same"?"same":"valid","NWC",i);return e!=null&&(a=ei(a,e)),a})}function iee(n,t,e,r=[1,1],o="valid",s,i,a=null){return de(()=>{if(s==null&&(s=Ps()),yr(s),n.rank!==3&&n.rank!==4)throw new he(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(t.rank!==3&&t.rank!==4)throw new he(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let c=hS(n,s);if(o==="causal")throw new At("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return c=Gi.conv2d({x:c,filter:t,strides:r,pad:o==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:e,activation:a}),s==="channelsFirst"&&(c=pn(c,[0,3,1,2])),c})}function TMe(n,t,e,r=[1,1,1],o="valid",s,i){return de(()=>{if(s==null&&(s=Ps()),yr(s),n.rank!==4&&n.rank!==5)throw new he(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(t.rank!==4&&t.rank!==5)throw new he(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let a=$F(n,s);if(o==="causal")throw new At("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=Xx(a,t,r,o==="same"?"same":"valid","NDHWC",i),e!=null&&(a=ei(a,e)),s==="channelsFirst"&&(a=pn(a,[0,4,1,2,3])),a})}var pS,Wv,LE,LF,zF,IMe,BF,VF,qF,UF,zE=b(()=>{"use strict";$();$();aS();ch();qo();Da();lh();bo();Gn();_c();Tl();lS();Dr();Cs();pS=class n extends Wt{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",n.verifyArgs(e),this.rank=t,zr(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new At(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Xf(e.kernelSize,t,"kernelSize"),this.strides=Xf(e.strides==null?1:e.strides,t,"strides"),this.padding=e.padding==null?"valid":e.padding,$s(this.padding),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,yr(this.dataFormat),this.activation=Ic(e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.biasInitializer=Wn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Cr(e.biasConstraint),this.biasRegularizer=Xn(e.biasRegularizer),this.activityRegularizer=Xn(e.activityRegularizer),this.dilationRate=Xf(e.dilationRate==null?1:e.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new he(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new he(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new he(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(Hi("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!eE(t.kernelSize,"number",1,3))throw new he(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){let t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Tc(this.activation),useBias:this.useBias,biasInitializer:tr(this.biasInitializer),biasRegularizer:On(this.biasRegularizer),activityRegularizer:On(this.activityRegularizer),biasConstraint:Sr(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}},Wv=class n extends pS{constructor(t,e){super(t,e),this.kernel=null,n.verifyArgs(e),this.filters=e.filters,zr(this.filters,"filters"),this.kernelInitializer=Wn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Cr(e.kernelConstraint),this.kernelRegularizer=Xn(e.kernelRegularizer)}build(t){t=bn(t);let e=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[e]==null)throw new he(`The channel dimension of the input should be defined. Found ${t[e]}`);let r=t[e],o=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:r}}],this.built=!0}call(t,e){return de(()=>{t=jt(t);let r,o=this.bias==null?null:this.bias.read(),s=tE(this.activation.getClassName());if(s!=null&&this.rank===2)r=iee(t,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate,s);else{if(this.rank===1)r=_Me(t,this.kernel.read(),o,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=iee(t,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=TMe(t,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new At("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(t){t=bn(t);let e=[],r=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let s=0;s<r.length;++s){let i=ni(r[s],this.kernelSize[s],this.padding,this.strides[s],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[s]);e.push(i)}let o=[t[0]];return this.dataFormat==="channelsLast"?(o=o.concat(e),o.push(this.filters)):(o.push(this.filters),o=o.concat(e)),o}getConfig(){let t={filters:this.filters,kernelInitializer:tr(this.kernelInitializer),kernelRegularizer:On(this.kernelRegularizer),kernelConstraint:Sr(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new he(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}},LE=(()=>{class n extends Wv{constructor(e){super(2,e),n.verifyArgs(e)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!eE(e.kernelSize,"number",1,2))throw new he(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}return n.className="Conv2D",n})();He.registerClass(LE);LF=(()=>{class n extends Wv{constructor(e){super(3,e),n.verifyArgs(e)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new he(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}return n.className="Conv3D",n})();He.registerClass(LF);zF=(()=>{class n extends LE{constructor(e){if(super(e),this.inputSpec=[new nr({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new he(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=bn(e),e.length!==4)throw new he("Input should have rank 4; Received input shape: "+JSON.stringify(e));let r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new he("The channel dimension of the inputs should be defined. Found `None`.");let o=e[r],s=this.kernelSize.concat([this.filters,o]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new nr({ndim:4,axes:{[r]:o}})],this.built=!0}call(e,r){return de(()=>{let o=jt(e);if(o.shape.length!==4)throw new he(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${o.shape.length}`);let s=o.shape,i=s[0],a,c;this.dataFormat==="channelsFirst"?(a=2,c=3):(a=1,c=2);let l=s[a],p=s[c],f=this.kernelSize[0],y=this.kernelSize[1],d=this.strides[0],h=this.strides[1],m=uS(l,d,f,this.padding),x=uS(p,h,y,this.padding),w=[i,m,x,this.filters];this.dataFormat!=="channelsLast"&&(o=pn(o,[0,2,3,1]));let _=wf(o,this.kernel.read(),w,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(_=pn(_,[0,3,1,2])),this.bias!=null&&(_=ei(_,this.bias.read(),this.dataFormat)),this.activation!=null&&(_=this.activation.apply(_)),_})}computeOutputShape(e){e=bn(e);let r=e.slice(),o,s,i;this.dataFormat==="channelsFirst"?(o=1,s=2,i=3):(o=3,s=1,i=2);let a=this.kernelSize[0],c=this.kernelSize[1],l=this.strides[0],p=this.strides[1];return r[o]=this.filters,r[s]=uS(r[s],l,a,this.padding),r[i]=uS(r[i],p,c,this.padding),r}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}}return n.className="Conv2DTranspose",n})();He.registerClass(zF);IMe=(()=>{class n extends Wv{constructor(e,r){if(super(e,r),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,r.filters==null)throw new he("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(r.kernelInitializer!=null||r.kernelRegularizer!=null||r.kernelConstraint!=null)throw new he("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(r.padding!=null&&r.padding!=="same"&&r.padding!=="valid")throw new he(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(r.padding)}`);this.depthMultiplier=r.depthMultiplier==null?1:r.depthMultiplier,this.depthwiseInitializer=Wn(r.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Xn(r.depthwiseRegularizer),this.depthwiseConstraint=Cr(r.depthwiseConstraint),this.pointwiseInitializer=Wn(r.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Xn(r.pointwiseRegularizer),this.pointwiseConstraint=Cr(r.pointwiseConstraint)}build(e){if(e=bn(e),e.length<this.rank+2)throw new he(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);let r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null||e[r]<0)throw new he(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[r])}`);let o=e[r],s=this.kernelSize.concat([o,this.depthMultiplier]),i=[];for(let c=0;c<this.rank;++c)i.push(1);i.push(o*this.depthMultiplier,this.filters);let a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new nr({ndim:this.rank+2,axes:{[r]:o}})],this.built=!0}call(e,r){return de(()=>{e=jt(e);let o;if(this.rank===1)throw new At("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=pn(e,[0,2,3,1])),o=dv(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(o=ei(o,this.bias.read(),this.dataFormat)),this.activation!=null&&(o=this.activation.apply(o)),this.dataFormat==="channelsFirst"&&(o=pn(o,[0,3,1,2])),o})}getConfig(){let e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=tr(this.depthwiseInitializer),e.pointwiseInitializer=tr(this.pointwiseInitializer),e.depthwiseRegularizer=On(this.depthwiseRegularizer),e.pointwiseRegularizer=On(this.pointwiseRegularizer),e.depthwiseConstraint=Sr(this.depthwiseConstraint),e.pointwiseConstraint=Sr(this.pointwiseConstraint),e}}return n.className="SeparableConv",n})(),BF=(()=>{class n extends IMe{constructor(e){super(2,e)}}return n.className="SeparableConv2D",n})();He.registerClass(BF);VF=(()=>{class n extends Wv{constructor(e){super(1,e),n.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){let e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!eE(e.kernelSize,"number",1,1))throw new he(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}return n.className="Conv1D",n})();He.registerClass(VF);qF=(()=>{class n extends Wt{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,r){return de(()=>{if(e=jt(e),this.dataFormat==="channelsLast"){let o=j0(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return j0(o,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{let o=j0(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return j0(o,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){let e={cropping:this.cropping,dataFormat:this.dataFormat},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Cropping2D",n})();He.registerClass(qF);UF=(()=>{class n extends Wt{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,yr(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,sJ(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){let r=e[2]==null?null:this.size[0]*e[2],o=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],r,o]}else{let r=e[1]==null?null:this.size[0]*e[1],o=e[2]==null?null:this.size[1]*e[2];return[e[0],r,o,e[3]]}}call(e,r){return de(()=>{let o=jt(e),s=o.shape;if(this.dataFormat==="channelsFirst"){o=pn(o,[0,2,3,1]);let i=this.size[0]*s[2],a=this.size[1]*s[3],c=this.interpolation==="nearest"?o.resizeNearestNeighbor([i,a]):o.resizeBilinear([i,a]);return pn(c,[0,3,1,2])}else{let i=this.size[0]*s[1],a=this.size[1]*s[2];return this.interpolation==="nearest"?o.resizeNearestNeighbor([i,a]):o.resizeBilinear([i,a])}})}getConfig(){let e={size:this.size,dataFormat:this.dataFormat},r=super.getConfig();return Object.assign(e,r),e}}return n.className="UpSampling2D",n})();He.registerClass(UF)});function EMe(n,t,e=[1,1],r="valid",o,s){return de(()=>{o==null&&(o=Ps()),yr(o);let i=hS(n,o);if(n.rank!==4)throw new he(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(t.rank!==4)throw new he(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return i=Si(i,t,e,r==="same"?"same":"valid","NHWC",s),o==="channelsFirst"&&(i=pn(i,[0,3,1,2])),i})}var jF,aee=b(()=>{"use strict";$();$();ch();qo();Da();lh();Gn();_c();Tl();lS();Cs();zE();jF=(()=>{class n extends pS{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Wn(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Cr(e.depthwiseConstraint),this.depthwiseRegularizer=Xn(e.depthwiseRegularizer)}build(e){if(e=bn(e),e.length<4)throw new he(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);let r=this.dataFormat==="channelsFirst"?1:3;if(e[r]==null||e[r]<0)throw new he(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[r]}).`);let o=e[r],s=[this.kernelSize[0],this.kernelSize[1],o,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",s,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[o*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,r){return de(()=>{e=jt(e);let o=EMe(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(o=ei(o,this.bias.read(),this.dataFormat)),this.activation!=null&&(o=this.activation.apply(o)),o})}computeOutputShape(e){e=bn(e);let r=this.dataFormat==="channelsFirst"?e[2]:e[1],o=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=ni(r,this.kernelSize[0],this.padding,this.strides[0]),a=ni(o,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],s,i,a]:[e[0],i,a,s]}getConfig(){let e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=tr(this.depthwiseInitializer),e.depthwiseRegularizer=On(this.depthwiseRegularizer),e.depthwiseConstraint=Sr(this.depthwiseRegularizer),e}}return n.className="DepthwiseConv2D",n})();He.registerClass(jF)});function GF(n,t,e,r){if(Array.isArray(n)){if(t!=null||e!=null)throw new he("When inputs is an array, neither initialState or constants should be provided");r!=null&&(e=n.slice(n.length-r,n.length),n=n.slice(0,n.length-r)),n.length>1&&(t=n.slice(1,n.length)),n=n[0]}function o(s){return s==null||Array.isArray(s)?s:[s]}return t=o(t),e=o(e),{inputs:n,initialState:t,constants:e}}function WF(n,t,e,r=!1,o,s,i=!1,a=!1){return de(()=>{let c=t.shape.length;if(c<3)throw new he(`Input should be at least 3D, but is ${c}D.`);let l=[1,0].concat(Ss(2,c));if(t=pn(t,l),s!=null)throw new At("The rnn() functoin of the deeplearn.js backend does not support constants yet.");i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),o!=null&&(o=o.asType("bool").asType("float32"),o.rank===c-1&&(o=Io(o,-1)),o=pn(o,l)),r&&(t=$r(t,0),o!=null&&(o=$r(o,0)));let p=[],f,y=e,d=t.shape[0],h=uo(t),m;o!=null&&(m=uo(o));for(let w=0;w<d;++w){let _=h[w],I=de(()=>n(_,y));if(o==null)f=I[0],y=I[1];else{let T=de(()=>{let D=m[w],O=Yr(D).sub(D),R=I[0].mul(D).add(y[0].mul(O)),P=y.map((j,G)=>I[1][G].mul(D).add(j.mul(O)));return{output:R,newStates:P}});f=T.output,y=T.newStates}a&&p.push(f)}let x;return a&&(x=Ir(p,1)),[f,x,y]})}function yh(n){let{ones:t,rate:e,training:r=!1,count:o=1}=n,s=()=>aE(t(),e),i=()=>Uf(s,t,r);return!o||o<=1?ur(i().clone()):Array(o).fill(void 0).map(i).map(c=>ur(c.clone()))}var Ec,gh,BE,HF,VE,KF,Hv,XF,qE,fS=b(()=>{"use strict";$();$();aS();qo();Da();lh();bo();bo();Gn();_c();Tl();Dr();wl();Cs();H0();Vv();Ec=(()=>{class n extends Wt{constructor(e){super(e);let r;if(e.cell==null)throw new he("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?r=new qE({cells:e.cell}):r=e.cell,r.stateSize==null)throw new he("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=r,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new nr({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Ss(0,e).map(r=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){gE(e)&&(e=e[0]),e=e;let r=this.cell.stateSize;Array.isArray(r)||(r=[r]);let o=r[0],s;if(this.returnSequences?s=[e[0],e[1],o]:s=[e[0],o],this.returnState){let i=[];for(let a of r)i.push([e[0],a]);return[s].concat(i)}else return s}computeMask(e,r){return de(()=>{Array.isArray(r)&&(r=r[0]);let o=this.returnSequences?r:null;if(this.returnState){let s=this.states.map(i=>null);return[o].concat(s)}else return o})}get states(){if(this.states_==null){let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,r=[];for(let o=0;o<e;++o)r.push(null);return r}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new At("Constants support is not implemented in RNN yet.");gE(e)&&(e=e[0]),e=e;let o=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new nr({shape:[o,null,...s]});let i=[e[0]].concat(e.slice(2));this.cell.build(i);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!N.arraysEqual(this.stateSpec.map(c=>c.shape[c.shape.length-1]),a))throw new he(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(c=>new nr({shape:[null,c]}));this.stateful&&this.resetStates()}resetStates(e,r=!1){de(()=>{if(!this.stateful)throw new Wi("Cannot call resetStates() on an RNN Layer that is not stateful.");let o=this.inputSpec[0].shape[0];if(o==null)throw new he("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>An([o,s])):this.states_=[An([o,this.cell.stateSize])];else if(e==null)Mt(this.states_),this.keptStates!=null&&(Mt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>An([o,s])):this.states_[0]=An([o,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new he(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);r===!0?this.keptStates.push(this.states_.slice()):Mt(this.states_);for(let s=0;s<this.states_.length;++s){let i=e[s],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,c=[o,a];if(!N.arraysEqual(i.shape,c))throw new he(`State ${s} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${i.shape}`);this.states_[s]=i}}this.states_=this.states_.map(s=>ur(s.clone()))})}apply(e,r){let o=r==null?null:r.initialState,s=r==null?null:r.constants;r==null&&(r={});let i=GF(e,o,s,this.numConstants);e=i.inputs,o=i.initialState,s=i.constants;let a=[],c=[];if(o!=null){r.initialState=o,a=a.concat(o),this.stateSpec=[];for(let p of o)this.stateSpec.push(new nr({shape:p.shape}));c=c.concat(this.stateSpec)}if(s!=null&&(r.constants=s,a=a.concat(s),this.numConstants=s.length),a[0]instanceof ts){let p=[e].concat(a),f=this.inputSpec.concat(c),y=this.inputSpec;this.inputSpec=f;let d=super.apply(p,r);return this.inputSpec=y,d}else return super.apply(e,r)}call(e,r){return de(()=>{let o=r==null?null:r.mask,s=r==null?null:r.training,i=r==null?null:r.initialState;e=jt(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));let a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==a)throw new he(`RNN Layer has ${a} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");let c={training:s},p=WF((m,x)=>{let w=this.cell.call([m].concat(x),c);return[w[0],w.slice(1)]},e,i,this.goBackwards,o,null,this.unroll,this.returnSequences),f=p[0],y=p[1],d=p[2];this.stateful&&this.resetStates(d,s);let h=this.returnSequences?y:f;return this.returnState?[h].concat(d):h})}getInitialState(e){return de(()=>{let r=An(e.shape);return r=gt(r,[1,2]),r=fh(r),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(o=>o>1?sE(r,[1,o]):r):this.cell.stateSize>1?[sE(r,[1,this.cell.stateSize])]:[r]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){let e=super.getConfig(),r={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(r.numConstants=this.numConstants);let o=this.cell.getConfig();return this.getClassName()===n.className&&(r.cell={className:this.cell.getClassName(),config:o}),Object.assign({},o,e,r)}static fromConfig(e,r,o={}){let s=r.cell,i=Bs(s,o);return new e(Object.assign(r,{cell:i}))}}return n.className="RNN",n})();He.registerClass(Ec);gh=class extends Wt{},BE=(()=>{class n extends gh{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,zr(this.units,"units"),this.activation=Ic(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Wn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Wn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Wn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Xn(e.kernelRegularizer),this.recurrentRegularizer=Xn(e.recurrentRegularizer),this.biasRegularizer=Xn(e.biasRegularizer),this.kernelConstraint=Cr(e.kernelConstraint),this.recurrentConstraint=Cr(e.recurrentConstraint),this.biasConstraint=Cr(e.biasConstraint),this.dropout=dg([1,Cc([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=dg([1,Cc([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=bn(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,r){return de(()=>{if(e=e,e.length!==2)throw new he(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let o=e[1];e=e[0];let s=r.training==null?!1:r.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=yh({ones:()=>Yr(e),rate:this.dropout,training:s})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=yh({ones:()=>Yr(o),rate:this.recurrentDropout,training:s}));let i,a=this.dropoutMask,c=this.recurrentDropoutMask;a!=null?i=Aa(oe(e,a),this.kernel.read()):i=Aa(e,this.kernel.read()),this.bias!=null&&(i=ei(i,this.bias.read())),c!=null&&(o=oe(o,c));let l=je(i,Aa(o,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){let e=super.getConfig(),r={units:this.units,activation:Tc(this.activation),useBias:this.useBias,kernelInitializer:tr(this.kernelInitializer),recurrentInitializer:tr(this.recurrentInitializer),biasInitializer:tr(this.biasInitializer),kernelRegularizer:On(this.kernelRegularizer),recurrentRegularizer:On(this.recurrentRegularizer),biasRegularizer:On(this.biasRegularizer),activityRegularizer:On(this.activityRegularizer),kernelConstraint:Sr(this.kernelConstraint),recurrentConstraint:Sr(this.recurrentConstraint),biasConstraint:Sr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},e,r)}}return n.className="SimpleRNNCell",n})();He.registerClass(BE);HF=(()=>{class n extends Ec{constructor(e){e.cell=new BE(e),super(e)}call(e,r){return de(()=>{this.cell.dropoutMask!=null&&(Mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let o=r==null?null:r.mask,s=r==null?null:r.training,i=r==null?null:r.initialState;return super.call(e,{mask:o,training:s,initialState:i})})}static fromConfig(e,r){return new e(r)}}return n.className="SimpleRNN",n})();He.registerClass(HF);VE=(()=>{class n extends gh{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new he("GRUCell does not support reset_after parameter set to true.");this.units=e.units,zr(this.units,"units"),this.activation=Ic(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Ic(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Wn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Wn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Wn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Xn(e.kernelRegularizer),this.recurrentRegularizer=Xn(e.recurrentRegularizer),this.biasRegularizer=Xn(e.biasRegularizer),this.kernelConstraint=Cr(e.kernelConstraint),this.recurrentConstraint=Cr(e.recurrentConstraint),this.biasConstraint=Cr(e.biasConstraint),this.dropout=dg([1,Cc([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=dg([1,Cc([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=bn(e);let r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,r){return de(()=>{if(e=e,e.length!==2)throw new he(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);let o=r.training==null?!1:r.training,s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=yh({ones:()=>Yr(e),rate:this.dropout,training:o,count:3})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=yh({ones:()=>Yr(s),rate:this.recurrentDropout,training:o,count:3}));let i=this.dropoutMask,a=this.recurrentDropoutMask,c,l,p;0<this.dropout&&this.dropout<1&&(e=oe(e,i[0]));let f=Aa(e,this.kernel.read());this.useBias&&(f=ei(f,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=oe(s,a[0]));let y=this.recurrentKernel.read(),[d,h]=co(y,[2*this.units,this.units],y.rank-1),m=Aa(s,d),[x,w,_]=co(f,3,f.rank-1),[I,T]=co(m,2,m.rank-1);c=this.recurrentActivation.apply(je(x,I)),l=this.recurrentActivation.apply(je(w,T));let D=Aa(oe(l,s),h);p=this.activation.apply(je(_,D));let O=je(oe(c,s),oe(je(1,un(c)),p));return[O,O]})}getConfig(){let e=super.getConfig(),r={units:this.units,activation:Tc(this.activation),recurrentActivation:Tc(this.recurrentActivation),useBias:this.useBias,kernelInitializer:tr(this.kernelInitializer),recurrentInitializer:tr(this.recurrentInitializer),biasInitializer:tr(this.biasInitializer),kernelRegularizer:On(this.kernelRegularizer),recurrentRegularizer:On(this.recurrentRegularizer),biasRegularizer:On(this.biasRegularizer),activityRegularizer:On(this.activityRegularizer),kernelConstraint:Sr(this.kernelConstraint),recurrentConstraint:Sr(this.recurrentConstraint),biasConstraint:Sr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},e,r)}}return n.className="GRUCell",n})();He.registerClass(VE);KF=(()=>{class n extends Ec{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new VE(e),super(e)}call(e,r){return de(()=>{this.cell.dropoutMask!=null&&(Mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let o=r==null?null:r.mask,s=r==null?null:r.training,i=r==null?null:r.initialState;return super.call(e,{mask:o,training:s,initialState:i})})}static fromConfig(e,r){return r.implmentation===0&&(r.implementation=1),new e(r)}}return n.className="GRU",n})();He.registerClass(KF);Hv=(()=>{class n extends gh{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,zr(this.units,"units"),this.activation=Ic(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Ic(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Wn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Wn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Wn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Xn(e.kernelRegularizer),this.recurrentRegularizer=Xn(e.recurrentRegularizer),this.biasRegularizer=Xn(e.biasRegularizer),this.kernelConstraint=Cr(e.kernelConstraint),this.recurrentConstraint=Cr(e.recurrentConstraint),this.biasConstraint=Cr(e.biasConstraint),this.dropout=dg([1,Cc([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=dg([1,Cc([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var r;e=bn(e);let o=e[e.length-1];this.kernel=this.addWeight("kernel",[o,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let s;if(this.useBias){if(this.unitForgetBias){let i=this.biasInitializer,a=this.units;s=new(r=class extends zs{apply(l,p){let f=i.apply([a]),y=new G0().apply([a]),d=i.apply([a*2]);return oF(oF(f,y),d)}},r.className="CustomInit",r)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,r){return de(()=>{let o=r.training==null?!1:r.training;if(e=e,e.length!==3)throw new he(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1],i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=yh({ones:()=>Yr(e),rate:this.dropout,training:o,count:4})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=yh({ones:()=>Yr(s),rate:this.recurrentDropout,training:o,count:4}));let a=this.dropoutMask,c=this.recurrentDropoutMask,l,p,f,y;0<this.dropout&&this.dropout<1&&(e=oe(e,a[0]));let d=Aa(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=oe(s,c[0])),d=je(d,Aa(s,this.recurrentKernel.read())),this.useBias&&(d=ei(d,this.bias.read()));let[h,m,x,w]=co(d,4,d.rank-1);l=this.recurrentActivation.apply(h),p=this.recurrentActivation.apply(m),f=je(oe(p,i),oe(l,this.activation.apply(x))),y=this.recurrentActivation.apply(w);let _=oe(y,this.activation.apply(f));return[_,_,f]})}getConfig(){let e=super.getConfig(),r={units:this.units,activation:Tc(this.activation),recurrentActivation:Tc(this.recurrentActivation),useBias:this.useBias,kernelInitializer:tr(this.kernelInitializer),recurrentInitializer:tr(this.recurrentInitializer),biasInitializer:tr(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:On(this.kernelRegularizer),recurrentRegularizer:On(this.recurrentRegularizer),biasRegularizer:On(this.biasRegularizer),activityRegularizer:On(this.activityRegularizer),kernelConstraint:Sr(this.kernelConstraint),recurrentConstraint:Sr(this.recurrentConstraint),biasConstraint:Sr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},e,r)}}return n.className="LSTMCell",n})();He.registerClass(Hv);XF=(()=>{class n extends Ec{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Hv(e),super(e)}call(e,r){return de(()=>{this.cell.dropoutMask!=null&&(Mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let o=r==null?null:r.mask,s=r==null?null:r.training,i=r==null?null:r.initialState;return super.call(e,{mask:o,training:s,initialState:i})})}static fromConfig(e,r){return r.implmentation===0&&(r.implementation=1),new e(r)}}return n.className="LSTM",n})();He.registerClass(XF);qE=(()=>{class n extends gh{constructor(e){super(e),this.cells=e.cells}get stateSize(){let e=[];for(let r of this.cells.slice().reverse())Array.isArray(r.stateSize)?e.push(...r.stateSize):e.push(r.stateSize);return e}call(e,r){return de(()=>{e=e;let o=e.slice(1),s=[];for(let c of this.cells.slice().reverse())Array.isArray(c.stateSize)?s.push(o.splice(0,c.stateSize.length)):s.push(o.splice(0,1));s.reverse();let i=[],a;for(let c=0;c<this.cells.length;++c){let l=this.cells[c];o=s[c],c===0?a=[e[0]].concat(o):a=[a[0]].concat(o),a=l.call(a,r),i.push(a.slice(1))}o=[];for(let c of i.slice().reverse())o.push(...c);return[a[0]].concat(o)})}build(e){gE(e)&&(e=e[0]),e=e;let r;this.cells.forEach((o,s)=>{Sc(`RNNCell_${s}`,()=>{o.build(e),Array.isArray(o.stateSize)?r=o.stateSize[0]:r=o.stateSize,e=[e[0],r]})}),this.built=!0}getConfig(){let e=super.getConfig(),r=i=>({className:i.getClassName(),config:i.getConfig()}),s={cells:this.cells.map(r)};return Object.assign({},e,s)}static fromConfig(e,r,o={}){let s=[];for(let i of r.cells)s.push(Bs(i,o));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];let e=[];for(let r of this.cells)e.push(...r.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let r of this.cells)e.push(...r.nonTrainableWeights);if(!this.trainable){let r=[];for(let o of this.cells)r.push(...o.trainableWeights);return r.concat(e)}return e}getWeights(){let e=[];for(let r of this.cells)e.push(...r.weights);return W0(e)}setWeights(e){let r=[];for(let o of this.cells){let s=o.weights.length,i=e.splice(s);for(let a=0;a<o.weights.length;++a)r.push([o.weights[a],i[a]])}Lv(r)}}return n.className="StackedRNNCells",n})();He.registerClass(qE)});var NMe,DMe,UE,QF,cee=b(()=>{"use strict";$();$();qo();Da();bo();Gn();_c();lS();Dr();Cs();fS();NMe=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(e[r[o]]=n[r[o]]);return e},DMe=(()=>{class n extends Ec{constructor(e){if(e.unroll)throw new At("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new At("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new nr({ndim:5})]}call(e,r){return de(()=>{if(this.cell.dropoutMask!=null&&(Mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),r&&r.constants)throw new he("ConvRNN2D cell does not support constants");let o=r==null?null:r.mask,s=r==null?null:r.training,i=r==null?null:r.initialState;return super.call(e,{mask:o,training:s,initialState:i})})}computeOutputShape(e){let r=this.computeSingleOutputShape(e);return this.returnSequences||(r=[r[0],...r.slice(2)]),this.returnState&&(r=[r,...Array(2).fill([e[0],...r.slice(-3)])]),r}getInitialState(e){return de(()=>{let{stateSize:r}=this.cell,o=e.shape,s=this.computeSingleOutputShape(o),i=[s[0],...s.slice(2)],a=An(i);return Array.isArray(r)?Array(r.length).fill(a):[a]})}resetStates(e,r=!1){de(()=>{if(!this.stateful)throw new Wi("Cannot call resetStates() on an RNN Layer that is not stateful.");let o=this.inputSpec[0].shape,s=this.computeSingleOutputShape(o),i=[s[0],...s.slice(2)];if(o[0]==null)throw new he("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>An(i)):this.states_=[An(i)];else if(e==null)Mt(this.states_),this.keptStates!=null&&(Mt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>An(i)):this.states_[0]=An(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new he(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);r?this.keptStates.push(this.states_.slice()):Mt(this.states_);for(let c=0;c<this.states_.length;++c){let l=e[c],p=i;if(!N.arraysEqual(l.shape,p))throw new he(`State ${c} is incompatible with layer ${this.name}: expected shape=${p}, received shape=${l.shape}`);this.states_[c]=l}}this.states_=this.states_.map(c=>ur(c.clone()))})}computeSingleOutputShape(e){let{dataFormat:r,filters:o,kernelSize:s,padding:i,strides:a,dilationRate:c}=this.cell,l=r==="channelsFirst",p=e[l?3:2],f=e[l?4:3],y=ni(p,s[0],i,a[0],c[0]),d=ni(f,s[1],i,a[1],c[1]);return[...e.slice(0,2),...l?[o,y,d]:[y,d,o]]}}return n.className="ConvRNN2D",n})(),UE=(()=>{class n extends Hv{constructor(e){let{filters:r,kernelSize:o,strides:s,padding:i,dataFormat:a,dilationRate:c}=e;super(Object.assign({},e,{units:r})),this.filters=r,zr(this.filters,"filters"),this.kernelSize=Xf(o,2,"kernelSize"),this.kernelSize.forEach(l=>zr(l,"kernelSize")),this.strides=Xf(s||1,2,"strides"),this.strides.forEach(l=>zr(l,"strides")),this.padding=i||"valid",$s(this.padding),this.dataFormat=a||"channelsLast",yr(this.dataFormat),this.dilationRate=Xf(c||1,2,"dilationRate"),this.dilationRate.forEach(l=>zr(l,"dilationRate"))}build(e){var r;e=bn(e);let o=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[o]==null)throw new he(`The channel dimension of the input should be defined. Found ${e[o]}`);let s=e[o],i=4,a=this.kernelSize.concat([s,this.filters*i]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let c=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",c,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){let p=this.biasInitializer,f=this.filters;l=new(r=class extends zs{apply(d,h){let m=p.apply([f]),x=Lo([f]),w=p.apply([f*2]);return Ov([m,x,w])}},r.className="CustomInit",r)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,r){return de(()=>{if(e.length!==3)throw new he(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let o=r.training||!1,s=e[0],i=e[1],a=e[2],c=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=yh({ones:()=>Yr(s),rate:this.dropout,training:o,count:c}));let l=this.dropoutMask,p=(be,ke,De)=>!ke||!ke[De]?be:oe(ke[De],be),f=p(s,l,0),y=p(s,l,1),d=p(s,l,2),h=p(s,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=yh({ones:()=>Yr(i),rate:this.recurrentDropout,training:o,count:c}));let m=this.recurrentDropoutMask,x=p(i,m,0),w=p(i,m,1),_=p(i,m,2),I=p(i,m,3),T=3,[D,O,R,P]=co(this.kernel.read(),c,T),[j,G,Q,ie]=this.useBias?co(this.bias.read(),c):[null,null,null,null];f=this.inputConv(f,D,j,this.padding),y=this.inputConv(y,O,G,this.padding),d=this.inputConv(d,R,Q,this.padding),h=this.inputConv(h,P,ie,this.padding);let[pe,xe,ne,fe]=co(this.recurrentKernel.read(),c,T);x=this.recurrentConv(x,pe),w=this.recurrentConv(w,xe),_=this.recurrentConv(_,ne),I=this.recurrentConv(I,fe);let te=this.recurrentActivation.apply(je(f,x)),se=this.recurrentActivation.apply(je(y,w)),ee=je(oe(se,a),oe(te,this.activation.apply(je(d,_)))),we=oe(this.recurrentActivation.apply(je(h,I)),this.activation.apply(ee));return[we,we,ee]})}getConfig(){let e=super.getConfig(),{units:r}=e,o=NMe(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},o,s)}inputConv(e,r,o,s){let i=vs(e,r,this.strides,s||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return o?ei(i,o,this.dataFormat):i}recurrentConv(e,r){return vs(e,r,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}return n.className="ConvLSTM2DCell",n})();He.registerClass(UE);QF=(()=>{class n extends DMe{constructor(e){let r=new UE(e);super(Object.assign({},e,{cell:r}))}static fromConfig(e,r){return new e(r)}}return n.className="ConvLSTM2D",n})();He.registerClass(QF)});var jE,YF,ZF,JF,e$,t$,n$,r$,o$,uee=b(()=>{"use strict";$();aS();qo();lh();bo();Gn();_c();Tl();Dr();wl();Cs();jE=(()=>{class n extends Wt{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;let r=e.shape,o=[];for(let s=0;s<this.noiseShape.length;++s)o.push(this.noiseShape[s]==null?r[s]:this.noiseShape[s]);return o}call(e,r){return de(()=>{this.invokeCallHook(e,r);let o=jt(e);if(0<this.rate&&this.rate<1){let s=r.training==null?!1:r.training,i=this.getNoiseShape(o);return Uf(()=>aE(o,this.rate,i,this.seed),()=>o,s)}return e})}getConfig(){let e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},r=super.getConfig();return Object.assign(e,r),e}dispose(){return super.dispose()}}return n.className="Dropout",n})();He.registerClass(jE);YF=(()=>{class n extends jE{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){let r=e.shape;return[r[0],1,r[2]]}}return n.className="SpatialDropout1D",n})();He.registerClass(YF);ZF=(()=>{class n extends Wt{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let r=null;e.batchSize!=null&&(r=e.batchSize),this.batchInputShape=[r,e.inputDim]}this.units=e.units,zr(this.units,"units"),this.activation=Ic(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=Wn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Wn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Cr(e.kernelConstraint),this.biasConstraint=Cr(e.biasConstraint),this.kernelRegularizer=Xn(e.kernelRegularizer),this.biasRegularizer=Xn(e.biasRegularizer),this.activityRegularizer=Xn(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=bn(e);let r=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[r,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:r}}],this.built=!0}computeOutputShape(e){e=bn(e);let r=e.slice();return r[r.length-1]=this.units,r}call(e,r){return de(()=>{this.invokeCallHook(e,r);let o=jt(e),s=tE(this.activation.getClassName()),i;return s!=null?i=Aa(o,this.kernel.read(),s,this.bias?this.bias.read():null):(i=Aa(o,this.kernel.read()),this.bias!=null&&(i=ei(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){let e={units:this.units,activation:Tc(this.activation),useBias:this.useBias,kernelInitializer:tr(this.kernelInitializer),biasInitializer:tr(this.biasInitializer),kernelRegularizer:On(this.kernelRegularizer),biasRegularizer:On(this.biasRegularizer),activityRegularizer:On(this.activityRegularizer),kernelConstraint:Sr(this.kernelConstraint),biasConstraint:Sr(this.biasConstraint)},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Dense",n})();He.registerClass(ZF);JF=(()=>{class n extends Wt{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=bn(e);for(let r of e.slice(1))if(r==null)throw new he(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],ka(e,1)]}call(e,r){return de(()=>{this.invokeCallHook(e,r);let o=jt(e);if(this.dataFormat==="channelsFirst"&&o.rank>1){let s=[0];for(let i=2;i<o.rank;++i)s.push(i);s.push(1),o=o.transpose(s)}return pJ(o)})}getConfig(){let e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);let r=super.getConfig();return Object.assign(e,r),e}}return n.className="Flatten",n})();He.registerClass(JF);e$=(()=>{class n extends Wt{constructor(e){super(e),this.supportsMasking=!0,this.activation=Ic(e.activation)}call(e,r){return de(()=>{this.invokeCallHook(e,r);let o=jt(e);return this.activation.apply(o)})}getConfig(){let e={activation:Tc(this.activation)},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Activation",n})();He.registerClass(e$);t$=(()=>{class n extends Wt{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,r){return de(()=>(e=jt(e),uJ(e,this.n)))}getConfig(){let e={n:this.n},r=super.getConfig();return Object.assign(e,r),e}}return n.className="RepeatVector",n})();He.registerClass(t$);n$=(()=>{class n extends Wt{constructor(e){super(e),this.targetShape=e.targetShape;for(let r=0;r<this.targetShape.length;++r)this.isUnknown(this.targetShape[r])&&(this.targetShape[r]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,r){let o="Total size of new array must be unchanged.",s=r.slice(),i=1,a=null;for(let l=0;l<s.length;++l){let p=s[l];if(this.isUnknown(p))if(a===null)a=l;else throw new he("Can only specifiy one unknown dimension.");else i*=p}let c=ka(e);if(a!==null){if(i===0||c%i!==0)throw new he(o);s[a]=c/i}else if(c!==i)throw new he(o);return s}computeOutputShape(e){let r=!1;for(let o=0;o<e.length;++o)if(this.isUnknown(e[o])){r=!0;break}return r?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,r){return de(()=>{this.invokeCallHook(e,r);let o=jt(e),s=o.shape,i=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return o.reshape(i)})}getConfig(){let e={targetShape:this.targetShape},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Reshape",n})();He.registerClass(n$);r$=(()=>{class n extends Wt{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);let r=Ss(1,e.dims.length+1);if(!N.arraysEqual(e.dims.slice().sort(),r))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new nr({ndim:this.dims.length+1})]}computeOutputShape(e){e=bn(e);let r=e.slice();return this.dims.forEach((o,s)=>{r[s+1]=e[o]}),r}call(e,r){return pn(jt(e),this.dimsIncludingBatch)}getConfig(){let e={dims:this.dims},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Permute",n})();He.registerClass(r$);o$=(()=>{class n extends Wt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),r={maskValue:this.maskValue};return Object.assign(r,e),r}computeMask(e,r){let o=jt(e);return th(Zs(o,this.maskValue),-1)}call(e,r){return de(()=>{this.invokeCallHook(e,r);let o=jt(e),a=th(Zs(o,this.maskValue),-1,!0);return o.mul(a.asType(o.dtype))})}}return n.className="Masking",n})();He.registerClass(o$)});var s$,lee=b(()=>{"use strict";$();qo();lh();bo();Gn();_c();Tl();Dr();Cs();s$=(()=>{class n extends Wt{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let r=null;e.batchSize!=null&&(r=e.batchSize),e.inputLength==null?this.batchInputShape=[r,null]:this.batchInputShape=[r].concat(Kn(e.inputLength))}this.inputDim=e.inputDim,zr(this.inputDim,"inputDim"),this.outputDim=e.outputDim,zr(this.outputDim,"outputDim"),this.embeddingsInitializer=Wn(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Xn(e.embeddingsRegularizer),this.activityRegularizer=Xn(e.activityRegularizer),this.embeddingsConstraint=Cr(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,r){return de(()=>this.maskZero?(e=jt(e),Zs(e,Et(e))):null)}computeOutputShape(e){if(e=bn(e),this.inputLength==null)return[...e,this.outputDim];let r=Kn(this.inputLength);if(r.length!==e.length-1)throw new he(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let o=0;for(let s=0;s<r.length;++s){let i=r[s],a=e[s+1];if(i!=null&&a!=null&&i!==a)throw new he(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(r[o]=a),o++}}return[e[0],...r,this.outputDim]}call(e,r){return de(()=>{this.invokeCallHook(e,r);let o=jt(e);return o.dtype!=="int32"&&(o=hh(o,"int32")),iE(this.embeddings.read(),o.as1D()).reshape(bn(this.computeOutputShape(o.shape)))})}getConfig(){let e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:tr(this.embeddingsInitializer),embeddingsRegularizer:On(this.embeddingsRegularizer),activityRegularizer:On(this.activityRegularizer),embeddingsConstraint:Sr(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Embedding",n})();He.registerClass(s$)});function dS(n,t){for(;n<0;)n+=t;return n}function kMe(n,t,e){if(n.shape.length>3||t.shape.length>3)throw new At("batchDot is not implemented for tensors of 4D or higher rank yet");if(N.assert(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),N.assert(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof e=="number"&&(e=[e,e]),n.dtype==="complex64"||t.dtype==="complex64")throw new At("batchDot is not implemented for complex64-type Tensors yet.");let r=n.shape.length,o=t.shape.length;e==null&&(e=[r-1,o-2]);let s=e;return de(()=>{let i;if(r>o){i=r-o;let c=[];for(let l=0;l<i;++l)c.push(1);t=t.reshape(t.shape.concat(c))}else if(o>r){i=o-r;let c=[];for(let l=0;l<i;++l)c.push(1);n=n.reshape(n.shape.concat(c))}else i=0;let a;if(n.shape.length===2&&t.shape.length===2)s[0]===s[1]?a=n.mul(t).sum(s[0]):a=n.transpose([1,0]).mul(t).sum(s[1]);else{let c=s[0]!==n.shape.length-1,l=s[1]===t.shape.length-1;a=n.matMul(t,c,l)}if(i>0){let c;r>o?c=r+o-3:c=r-1;let l=[];for(let p=c;p<c+i;++p)l.push(p);a=a.squeeze(l)}return a.shape.length===1&&(a=a.expandDims(1)),a})}var xh,i$,a$,c$,u$,l$,p$,h$,pee=b(()=>{"use strict";$();$();qo();bo();Gn();yg();Dr();wl();Cs();xh=class extends Wt{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new At}computeElementwiseOpOutputShape(t,e){if(t==null||e==null)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(e.length===0)return t;let r=t.slice(0,t.length-e.length);for(let o=0;o<e.length;++o){let s=t[t.length-e.length+o],i=e[o];if(s==null||i==null||s<0||i<0)r.push(null);else if(s===1)r.push(i);else if(i===1)r.push(s);else{if(s!==i)throw new he("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));r.push(s)}}return r}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[bn(t)]),t=t,t.length<2)throw new he(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let e=[];for(let s of t)s!=null&&s[0]!==null&&e.push(s[0]);if(e=Na(e),e.length>1)throw new he(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let r=t[0]==null?null:t[0].slice(1);for(let s=1;s<t.length;++s){let i=t[s]==null?null:t[s].slice(1);r=this.computeElementwiseOpOutputShape(r,i)}let o=t.map(s=>s.length);t.indexOf(null)===-1&&Na(o).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,e){return de(()=>{if(t=t,this.reshapeRequired){let r=[],o=t.map(s=>s.rank);if(o.indexOf(null)===-1){let s=Cc(o);for(let i of t){let a=i.rank;for(let c=0;c<s-a;++c)i=fh(i,1);r.push(i)}return this.mergeFunction(r)}else{let s=!1;for(let c of t){let l=c.rank;if(l==null){let p=c.shape,f=p[0],y=p.slice(1).concat([f]),d=c.reshape([f].concat(ka(p.slice(1))));d=pn(d,[1,0]),d=d.reshape(y),r.push(d),s=!0}else if(l>1){let p=Ss(1,l).concat([0]);r.push(pn(c,p)),s=!0}else r.push(c)}let i=this.mergeFunction(r),a=i.rank;if(s){if(a==null){let c=i.shape,l=c.length,p=c[l-1],f=[p].concat(c.slice(0,c.length-1));i=pn(i.reshape([-1,p]),[1,0]).reshape(f)}else if(a>1){let c=[a-1].concat(Ss(0,a-1));i=pn(i,c)}}return i}}else return this.mergeFunction(t)})}computeOutputShape(t){t=t;let e;t[0]==null?e=null:e=t[0].slice(1);for(let o=1;o<t.length;++o){let s=t[o]==null?null:t[o].slice(1);e=this.computeElementwiseOpOutputShape(e,s)}let r=[];for(let o of t)o!=null&&o[0]!==null&&r.push(o[0]);return r=Na(r),r.length===1?e=r.concat(e):e=[null].concat(e),e}computeMask(t,e){return de(()=>{if(e==null)return null;if(!Array.isArray(e))throw new he("`mask` should be an Array");if(!Array.isArray(t))throw new he("`inputs` should be an Array");if(e.length!==t.length)throw new he(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${e.length})`);if(e.every(o=>o==null))return null;e=e.map(o=>o==null?o:Io(o,0));let r=e[0];for(let o=1;o<e.length-1;++o)r=vo(r,e[o]);return r})}},i$=(()=>{class n extends xh{constructor(e){super(e)}mergeFunction(e){return de(()=>{let r=e[0].clone();for(let o=1;o<e.length;++o)r=je(r,e[o]);return r})}}return n.className="Add",n})();He.registerClass(i$);a$=(()=>{class n extends xh{constructor(e){super(e)}mergeFunction(e){return de(()=>{let r=e[0].clone();for(let o=1;o<e.length;++o)r=oe(r,e[o]);return r})}}return n.className="Multiply",n})();He.registerClass(a$);c$=(()=>{class n extends xh{constructor(e){super(e)}mergeFunction(e){return de(()=>{let r=e[0].clone();for(let o=1;o<e.length;++o)r=je(r,e[o]);return oe(1/e.length,r)})}}return n.className="Average",n})();He.registerClass(c$);u$=(()=>{class n extends xh{constructor(e){super(e)}mergeFunction(e){return de(()=>{let r=e[0];for(let o=1;o<e.length;++o)r=$o(r,e[o]);return r})}}return n.className="Maximum",n})();He.registerClass(u$);l$=(()=>{class n extends xh{constructor(e){super(e)}mergeFunction(e){return de(()=>{let r=e[0];for(let o=1;o<e.length;++o)r=_i(r,e[o]);return r})}}return n.className="Minimum",n})();He.registerClass(l$);p$=(()=>{class n extends xh{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new he("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let r=!0;for(let s of e)if(s!=null){r=!1;break}if(r)return;let o=[];for(let s=0;s<e.length;++s){let i=e[s].slice();i.splice(this.axis,1);let a=!1;for(let c of o)if(N.arraysEqual(c,i)){a=!0;break}a||o.push(i)}if(o.length>1)throw new he("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return de(()=>Ov(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new he("A `Concatenate` layer should be called on a list of inputs.");let r=e,o=r[0].slice(),s=this.axis<0?o.length+this.axis:this.axis;for(let i of r.slice(1)){if(o[s]==null||i[s]==null){o[s]=null;break}o[s]+=i[s]}return o}computeMask(e,r){if(r==null)return null;if(!Array.isArray(r))throw new he("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new he("`inputs` should be an array for Concatenate");if(r.length!==e.length)throw new he(`Mismatch in the length of mask (${r.length}) and the legnth of inputs (${e.length})`);return de(()=>{let o=!0;if(r.forEach(a=>{if(a!=null){o=!1;return}}),o)return null;let s=[];for(let a=0;a<e.length;++a)r[a]==null?s.push(Yr(e[a]).asType("bool")):r[a].rank<e[a].rank?s.push(Io(r[a],-1)):s.push(r[a]);let i=gn(s,this.axis);return vf(i,-1,!1)})}getConfig(){let e={axis:this.axis},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Concatenate",n})();He.registerClass(p$);h$=(()=>{class n extends xh{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){N.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let r=e[0],o=e[1];if(r.length>3||o.length>3)throw new At("Dot layer does not support tensors of 4D or higher rank yet.");let s=this.interpretAxes(r,o);if(r[s[0]]!==o[s[1]])throw new he(`Dimension incompatibility: ${r[s[0]]} !== ${o[s[1]]}`)}mergeFunction(e){if(e.length!==2)throw new he(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let r=e[0],o=e[1],s;return Array.isArray(this.axes)?s=this.axes.map((i,a)=>dS(i,e[a].shape.length)):s=[dS(this.axes,r.shape.length),dS(this.axes,o.shape.length)],this.normalize&&(r=Z0(r,s[0]),o=Z0(o,s[1])),kMe(r,o,s)}interpretAxes(e,r){let o;return Array.isArray(this.axes)?o=this.axes:o=[dS(this.axes,e.length),dS(this.axes,r.length)],o}computeOutputShape(e){N.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let r=e[0].slice(),o=e[1].slice();if(r.length>3||o.length>3)throw new At("Dot layer does not support tensors of 4D or higher rank yet.");let s=this.interpretAxes(r,o);r.splice(s[0],1),o.splice(s[1],1),o.splice(0,1);let i=r.concat(o);return i.length===1&&i.push(1),i}computeMask(e,r){return null}getConfig(){let e={axes:this.axes,normalize:this.normalize},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Dot",n})();He.registerClass(h$)});var f$,d$,m$,hee=b(()=>{"use strict";$();qo();bo();Cs();f$=(()=>{class n extends Wt{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),r={stddev:this.stddev};return Object.assign(r,e),r}call(e,r){return de(()=>{this.invokeCallHook(e,r);let o=jt(e);return Uf(()=>Mv(o.shape,0,this.stddev).add(o),()=>o,r.training||!1)})}}return n.className="GaussianNoise",n})();He.registerClass(f$);d$=(()=>{class n extends Wt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),r={rate:this.rate};return Object.assign(r,e),r}call(e,r){return de(()=>{this.invokeCallHook(e,r);let o=jt(e);return this.rate>0&&this.rate<1?Uf(()=>{let i=Math.sqrt(this.rate/(1-this.rate));return o.mul(Mv(o.shape,1,i))},()=>o,r.training||!1):o})}}return n.className="GaussianDropout",n})();He.registerClass(d$);m$=(()=>{class n extends Wt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||jt(e).shape}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),r={rate:this.rate};return Object.assign(r,e),r}call(e,r){return de(()=>{if(this.rate<1&&this.rate>0){let o=this._getNoiseShape(e);return Uf(()=>{let i=jt(e),l=-1.6732632423543772*1.0507009873554805,p=Yo(Sa(o),this.rate);p=hh(p,"float32");let f=((1-this.rate)*(1+this.rate*l**2))**-.5,y=-f*l*this.rate;return i.mul(p).add(p.add(-1).mul(l)).mul(f).add(y)},()=>jt(e),r.training||!1)}return e})}}return n.className="AlphaDropout",n})();He.registerClass(m$)});function mS(n,t,e,r,o,s=.001){let i;if(n.rank===2)i=VI(n,t,e,r,o,s);else if(n.rank===3)i=qI(n,t,e,r,o,s);else if(n.rank===4)i=UI(n,t,e,r,o,s);else throw new At(`batchNormalization is not implemented for array of rank ${n.rank} yet`);return i}function AMe(n,t,e,r,o=.001){return de(()=>{let s=Zm(n,r),i=s.mean,a=s.variance;return[mS(n,i,a,e,t,o),i,a]})}function OMe(n,t,e,r,o=.001){return de(()=>{let s=Zm(n,r),i=s.mean,a=s.variance,c=[];for(let h of Ss(0,n.rank))r.indexOf(h)!==-1?c.push(1):c.push(n.shape[h]);let l=i.reshape(c),p=a.reshape(c),f=t==null?null:t.reshape(c),y=e==null?null:e.reshape(c);return[mS(n,l,p,y,f,o),i,a]})}function MMe(n,t,e,r,o=.001){return N.arraysEqual(r.slice().sort(),Ss(0,n.rank-1))?AMe(n,t,e,r,o):OMe(n,t,e,r,o)}var g$,y$,fee=b(()=>{"use strict";$();$();lh();bo();Gn();_c();Tl();Dr();wl();Cs();g$=(()=>{class n extends Wt{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Wn(e.betaInitializer||"zeros"),this.gammaInitializer=Wn(e.gammaInitializer||"ones"),this.movingMeanInitializer=Wn(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Wn(e.movingVarianceInitializer||"ones"),this.betaConstraint=Cr(e.betaConstraint),this.gammaConstraint=Cr(e.gammaConstraint),this.betaRegularizer=Xn(e.betaRegularizer),this.gammaRegularizer=Xn(e.gammaRegularizer)}build(e){e=bn(e);let r=this.axis>=0?this.axis:this.axis+e.length,o=e[r];if(o==null)throw new he(`Axis ${r} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new nr({ndim:e.length,axes:{[r]:o}})];let s=[o];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,r){return de(()=>{let o=r.training==null?!1:r.training,s=jt(e),i=s.shape,a=i.length,c=Ss(0,a),l=this.axis>=0?this.axis:this.axis+a;c.splice(l,1);let p=Ia(1,a);p[l]=i[l];let f=c.slice();f.sort();let y=!N.arraysEqual(f,Ss(0,a).slice(0,a-1)),d=()=>{if(y){let I=this.movingMean.read().reshape(p),T=this.movingVariance.read().reshape(p),D=this.center?this.beta.read().reshape(p):null,O=this.scale?this.gamma.read().reshape(p):null;return mS(s,I,T,D,O,this.epsilon)}else return mS(s,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!o)return d();let[h,m,x]=MMe(s,this.gamma.read(),this.beta.read(),c,this.epsilon),w=(I,T,D)=>{de(()=>{let O=1-D,R=I.read(),P=R.sub(T).mul(O);I.write(R.sub(P))})};return(()=>{w(this.movingMean,m,this.momentum),w(this.movingVariance,x,this.momentum)})(),h})}getConfig(){let e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:tr(this.betaInitializer),gammaInitializer:tr(this.gammaInitializer),movingMeanInitializer:tr(this.movingMeanInitializer),movingVarianceInitializer:tr(this.movingVarianceInitializer),betaRegularizer:On(this.betaRegularizer),gammaRegularizer:On(this.gammaRegularizer),betaConstraint:Sr(this.betaConstraint),gammaConstraint:Sr(this.gammaConstraint)},r=super.getConfig();return Object.assign(e,r),e}}return n.className="BatchNormalization",n})();He.registerClass(g$);y$=(()=>{class n extends Wt{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(let r of this.axis)if(!Number.isInteger(r))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Wn(e.betaInitializer||"zeros"),this.gammaInitializer=Wn(e.gammaInitializer||"ones"),this.betaRegularizer=Xn(e.betaRegularizer),this.gammaRegularizer=Xn(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=bn(e);let r=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=r);for(let i of this.axis)if(i<0||i>=r)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==Na(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);let o=this.axis.map(i=>e[i]),s=!0;this.scale?this.gamma=this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,s):this.gamma=null,this.center?this.beta=this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,s):this.beta=null,this.built=!0}call(e,r){let o=jt(e),s=o.shape,i=s.length;return de(()=>{let{mean:c,variance:l}=Zm(o,this.axis,!0),p=Ia(1,i);for(let x of this.axis)p[x]=s[x];let f=x=>x!=null&&x.shape.length!==i&&this.axis!==[i-1]?x.reshape(p):x,y=f(this.gamma.read()),d=f(this.beta.read()),h=[],m=[];for(let x=0;x<i;++x)this.axis.indexOf(x)!==-1?(h.push(s[x]),m.push(1)):(h.push(1),m.push(s[x]));return c=c.tile(h),l=l.tile(h),y=y.tile(m),d=d.tile(m),mS(o,c,l,d,y,this.epsilon)})}getConfig(){let e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:tr(this.betaInitializer),gammaInitializer:tr(this.gammaInitializer),betaRegularizer:On(this.betaRegularizer),gammaRegularizer:On(this.gammaRegularizer)},r=super.getConfig();return Object.assign(e,r),e}}return n.className="LayerNormalization",n})();He.registerClass(y$)});function RMe(n,t,e){return de(()=>{if(n.rank!==4)throw new he(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new he("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(e==null&&(e=Ps()),e!=="channelsLast"&&e!=="channelsFirst")throw new he(`Unknown data format: ${e}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return e==="channelsFirst"?r=[[0,0],[0,0],t[0],t[1]]:r=[[0,0],t[0],t[1],[0,0]],Jo(n,r)})}var x$,dee=b(()=>{"use strict";$();$();ch();bo();Gn();Cs();x$=(()=>{class n extends Wt{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Ps():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new he(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let r,o;if(typeof e.padding[0]=="number")r=[e.padding[0],e.padding[0]],o=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new he(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(r=e.padding[0],e.padding[1].length!==2)throw new he(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);o=e.padding[1]}this.padding=[r,o]}this.inputSpec=[new nr({ndim:4})]}computeOutputShape(e){e=bn(e);let r,o;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?r=e[2]+this.padding[0][0]+this.padding[0][1]:r=null,e[3]!=null&&e[3]>=0?o=e[3]+this.padding[1][0]+this.padding[1][1]:o=null,[e[0],e[1],r,o]):(e[1]!=null&&e[1]>=0?r=e[1]+this.padding[0][0]+this.padding[0][1]:r=null,e[2]!=null&&e[2]>=0?o=e[2]+this.padding[1][0]+this.padding[1][1]:o=null,[e[0],r,o,e[3]])}call(e,r){return de(()=>RMe(jt(e),this.padding,this.dataFormat))}getConfig(){let e={padding:this.padding,dataFormat:this.dataFormat},r=super.getConfig();return Object.assign(e,r),e}}return n.className="ZeroPadding2D",n})();He.registerClass(x$)});function QE(n,t,e,r,o,s){return de(()=>{yr(o),tF(s),$s(r),e==null&&(e=[1,1]),r==null&&(r="valid"),o==null&&(o=Ps()),s==null&&(s="max"),n=hS(n,o);let i,a=r==="same"?"same":"valid";return s==="max"?i=ll(n,t,e,a):i=tl(n,t,e,a),o==="channelsFirst"&&(i=pn(i,[0,3,1,2])),i})}function mee(n,t,e,r,o,s){return de(()=>{yr(o),tF(s),$s(r),e==null&&(e=[1,1,1]),r==null&&(r="valid"),o==null&&(o=Ps()),s==null&&(s="max"),n=$F(n,o);let i,a=r==="same"?"same":"valid";return s==="max"?i=av(n,t,e,a):i=Gx(n,t,e,a),o==="channelsFirst"&&(i=pn(i,[0,4,1,2,3])),i})}var GE,v$,b$,WE,w$,S$,HE,C$,_$,KE,T$,I$,XE,E$,N$,gee=b(()=>{"use strict";$();$();ch();qo();Da();bo();bo();Gn();lS();Dr();Cs();zE();GE=class extends Wt{constructor(t){if(t.poolSize==null&&(t.poolSize=2),super(t),typeof t.poolSize=="number")this.poolSize=[t.poolSize];else if(Array.isArray(t.poolSize)&&t.poolSize.length===1&&typeof t.poolSize[0]=="number")this.poolSize=t.poolSize;else throw new he(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);if(zr(this.poolSize,"poolSize"),t.strides==null)this.strides=this.poolSize;else if(typeof t.strides=="number")this.strides=[t.strides];else if(Array.isArray(t.strides)&&t.strides.length===1&&typeof t.strides[0]=="number")this.strides=t.strides;else throw new he(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);zr(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,$s(this.padding),this.inputSpec=[new nr({ndim:3})]}computeOutputShape(t){t=bn(t);let e=ni(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return de(()=>{this.invokeCallHook(t,e),t=fh(jt(t),2);let r=this.poolingFunction(jt(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Js(r,[2])})}getConfig(){let t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}},v$=(()=>{class n extends GE{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return yr(i),$s(s),QE(e,r,o,s,i,"max")}}return n.className="MaxPooling1D",n})();He.registerClass(v$);b$=(()=>{class n extends GE{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return yr(i),$s(s),QE(e,r,o,s,i,"avg")}}return n.className="AveragePooling1D",n})();He.registerClass(b$);WE=class extends Wt{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new he(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];zr(this.poolSize,"poolSize"),zr(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,yr(this.dataFormat),$s(this.padding),this.inputSpec=[new nr({ndim:4})]}computeOutputShape(t){t=bn(t);let e=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2];return e=ni(e,this.poolSize[0],this.padding,this.strides[0]),r=ni(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],e,r]:[t[0],e,r,t[3]]}call(t,e){return de(()=>(this.invokeCallHook(t,e),this.poolingFunction(jt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}},w$=(()=>{class n extends WE{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return yr(i),$s(s),QE(e,r,o,s,i,"max")}}return n.className="MaxPooling2D",n})();He.registerClass(w$);S$=(()=>{class n extends WE{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return yr(i),$s(s),QE(e,r,o,s,i,"avg")}}return n.className="AveragePooling2D",n})();He.registerClass(S$);HE=class extends Wt{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new he(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];zr(this.poolSize,"poolSize"),zr(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,yr(this.dataFormat),$s(this.padding),this.inputSpec=[new nr({ndim:5})]}computeOutputShape(t){t=bn(t);let e=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2],o=this.dataFormat==="channelsFirst"?t[4]:t[3];return e=ni(e,this.poolSize[0],this.padding,this.strides[0]),r=ni(r,this.poolSize[1],this.padding,this.strides[1]),o=ni(o,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],e,r,o]:[t[0],e,r,o,t[4]]}call(t,e){return de(()=>(this.invokeCallHook(t,e),this.poolingFunction(jt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}},C$=(()=>{class n extends HE{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return yr(i),$s(s),mee(e,r,o,s,i,"max")}}return n.className="MaxPooling3D",n})();He.registerClass(C$);_$=(()=>{class n extends HE{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return yr(i),$s(s),mee(e,r,o,s,i,"avg")}}return n.className="AveragePooling3D",n})();He.registerClass(_$);KE=class extends Wt{constructor(t){super(t),this.inputSpec=[new nr({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new At}},T$=(()=>{class n extends KE{constructor(e){super(e||{})}call(e,r){return de(()=>{let o=jt(e);return Un(o,1)})}}return n.className="GlobalAveragePooling1D",n})();He.registerClass(T$);I$=(()=>{class n extends KE{constructor(e){super(e||{})}call(e,r){return de(()=>{let o=jt(e);return io(o,1)})}}return n.className="GlobalMaxPooling1D",n})();He.registerClass(I$);XE=class extends Wt{constructor(t){super(t),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,yr(this.dataFormat),this.inputSpec=[new nr({ndim:4})]}computeOutputShape(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new At}getConfig(){let t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}},E$=(()=>{class n extends XE{call(e,r){return de(()=>{let o=jt(e);return this.dataFormat==="channelsLast"?Un(o,[1,2]):Un(o,[2,3])})}}return n.className="GlobalAveragePooling2D",n})();He.registerClass(E$);N$=(()=>{class n extends XE{call(e,r){return de(()=>{let o=jt(e);return this.dataFormat==="channelsLast"?io(o,[1,2]):io(o,[2,3])})}}return n.className="GlobalMaxPooling2D",n})();He.registerClass(N$)});function PMe(n){bl(rJ,"BidirectionalMergeMode",n)}var YE,D$,FMe,k$,yee=b(()=>{"use strict";$();$();qo();Da();bo();Gn();eF();Dr();Cs();fS();Vv();YE=class extends Wt{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(t){this.layer!=null&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){let t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e,r={}){let o=e.layer,s=Bs(o,r);delete e.layer;let i={layer:s};return Object.assign(i,e),new t(i)}},D$=(()=>{class n extends YE{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=bn(e),e.length<3)throw new he(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];let r=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(r),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=bn(e);let r=[e[0]].concat(e.slice(2)),o=this.layer.computeOutputShape(r),s=e[1];return[o[0],s].concat(o.slice(1))}call(e,r){return de(()=>(e=jt(e),WF((a,c)=>[jt(this.layer.call(a,r)),[]],e,[],!1,null,null,!1,!0)[1]))}}return n.className="TimeDistributed",n})();He.registerClass(D$);FMe="concat",k$=(()=>{class n extends YE{constructor(e){super(e);let r=e.layer.getConfig(),o={};o.className=e.layer.getClassName(),o.config=r,this.forwardLayer=Bs(o),r.goBackwards=r.goBackwards!==!0;let s={};if(s.className=e.layer.getClassName(),s.config=r,this.backwardLayer=Bs(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?FMe:e.mergeMode,PMe(this.mergeMode),e.weights)throw new At("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){let r=e.length,o=Math.floor(r/2);this.forwardLayer.setWeights(e.slice(0,o)),this.backwardLayer.setWeights(e.slice(o))}computeOutputShape(e){let r=this.forwardLayer.computeOutputShape(e);Array.isArray(r)&&Array.isArray(r[0])||(r=[r]),r=r;let o,s,i;return this.returnState&&(i=r.slice(1)),o=r[0],o=o,this.mergeMode==="concat"?(o[o.length-1]*=2,s=[o]):this.mergeMode==null?s=[o,o.slice()]:s=[o],this.returnState?this.mergeMode==null?s.concat(i).concat(i.slice()):[o].concat(i).concat(i.slice()):No(s)}apply(e,r){let o=r==null?null:r.initialState,s=r==null?null:r.constants;r==null&&(r={});let i=GF(e,o,s,this.numConstants);if(e=i.inputs,o=i.initialState,s=i.constants,Array.isArray(e)&&(o=e.slice(1),e=e[0]),(o==null||o.length===0)&&s==null)return super.apply(e,r);let a=[],c=[];if(o!=null){let p=o.length;if(p%2>0)throw new he("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");r.initialState=o,a.push(...o);let f=o.map(y=>new nr({shape:y.shape}));this.forwardLayer.stateSpec=f.slice(0,p/2),this.backwardLayer.stateSpec=f.slice(p/2),c.push(...f)}if(s!=null)throw new At("Support for constants in Bidirectional layers is not implemented yet.");let l=a[0]instanceof ts;for(let p of a)if(p instanceof ts!==l)throw new he("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){let p=[e].concat(a),f=this.inputSpec.concat(c),y=this.inputSpec;this.inputSpec=f;let d=super.apply(p,r);return this.inputSpec=y,d}else return super.apply(e,r)}call(e,r){return de(()=>{let o=r.initialState,s,i;if(o==null)s=this.forwardLayer.call(e,r),i=this.backwardLayer.call(e,r);else{let l=o.slice(0,o.length/2),p=o.slice(o.length/2);s=this.forwardLayer.call(e,Object.assign(r,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(r,{initialState:p}))}let a;this.returnState&&(Array.isArray(s)&&(a=s.slice(1).concat(i.slice(1))),s=s[0],i=i[0]),this.returnSequences&&(i=$r(i,1));let c;return this.mergeMode==="concat"?c=Ov([s,i]):this.mergeMode==="sum"?c=je(s,i):this.mergeMode==="ave"?c=oe(.5,je(s,i)):this.mergeMode==="mul"?c=oe(s,i):this.mergeMode==null&&(c=[s,i]),this.returnState?this.mergeMode==null?c.concat(a):[c].concat(a):c})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Sc(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Sc(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,r){Array.isArray(r)&&(r=r[0]);let o;if(this.returnSequences?this.mergeMode==null?o=[r,r]:o=r:this.mergeMode==null?o=[null,null]:o=null,this.returnState){let i=this.forwardLayer.states.map(a=>null);return Array.isArray(o)?o.concat(i).concat(i):[o].concat(i).concat(i)}else return o}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){let e={mergeMode:this.mergeMode},r=super.getConfig();return Object.assign(e,r),e}static fromConfig(e,r){let o=Bs(r.layer);if(delete r.layer,r.numConstants!=null)throw new At("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");let s=r;return s.layer=o,new e(s)}}return n.className="Bidirectional",n})();He.registerClass(k$)});var R$={};xn(R$,{Layer:()=>Wt,RNN:()=>Ec,RNNCell:()=>gh,activation:()=>ZMe,add:()=>aRe,alphaDropout:()=>jRe,average:()=>cRe,averagePooling1d:()=>A$,averagePooling2d:()=>O$,averagePooling3d:()=>M$,avgPool1d:()=>yRe,avgPool2d:()=>vRe,avgPool3d:()=>wRe,avgPooling1d:()=>xRe,avgPooling2d:()=>bRe,avgPooling3d:()=>SRe,batchNormalization:()=>dRe,bidirectional:()=>FRe,concatenate:()=>uRe,conv1d:()=>jMe,conv2d:()=>GMe,conv2dTranspose:()=>WMe,conv3d:()=>HMe,convLstm2d:()=>ORe,convLstm2dCell:()=>MRe,cropping2D:()=>XMe,dense:()=>JMe,depthwiseConv2d:()=>YMe,dot:()=>fRe,dropout:()=>eRe,elu:()=>LMe,embedding:()=>iRe,flatten:()=>nRe,gaussianDropout:()=>URe,gaussianNoise:()=>qRe,globalAveragePooling1d:()=>CRe,globalAveragePooling2d:()=>_Re,globalMaxPool1d:()=>LRe,globalMaxPool2d:()=>zRe,globalMaxPooling1d:()=>xee,globalMaxPooling2d:()=>vee,gru:()=>IRe,gruCell:()=>ERe,input:()=>FE,inputLayer:()=>$Me,layerNormalization:()=>mRe,leakyReLU:()=>BMe,lstm:()=>NRe,lstmCell:()=>DRe,masking:()=>GRe,maxPool1d:()=>BRe,maxPool2d:()=>VRe,maxPooling1d:()=>bee,maxPooling2d:()=>wee,maxPooling3d:()=>TRe,maximum:()=>lRe,minimum:()=>pRe,multiply:()=>hRe,permute:()=>sRe,prelu:()=>VMe,reLU:()=>zMe,repeatVector:()=>rRe,reshape:()=>oRe,rnn:()=>RRe,separableConv2d:()=>KMe,simpleRNN:()=>kRe,simpleRNNCell:()=>ARe,softmax:()=>qMe,spatialDropout1d:()=>tRe,stackedRNNCells:()=>PRe,thresholdedReLU:()=>UMe,timeDistributed:()=>$Re,upSampling2d:()=>QMe,zeroPadding2d:()=>gRe});function $Me(n){return new Gf(n)}function LMe(n){return new RF(n)}function zMe(n){return new AF(n)}function BMe(n){return new OF(n)}function VMe(n){return new MF(n)}function qMe(n){return new FF(n)}function UMe(n){return new PF(n)}function jMe(n){return new VF(n)}function GMe(n){return new LE(n)}function WMe(n){return new zF(n)}function HMe(n){return new LF(n)}function KMe(n){return new BF(n)}function XMe(n){return new qF(n)}function QMe(n){return new UF(n)}function YMe(n){return new jF(n)}function ZMe(n){return new e$(n)}function JMe(n){return new ZF(n)}function eRe(n){return new jE(n)}function tRe(n){return new YF(n)}function nRe(n){return new JF(n)}function rRe(n){return new t$(n)}function oRe(n){return new n$(n)}function sRe(n){return new r$(n)}function iRe(n){return new s$(n)}function aRe(n){return new i$(n)}function cRe(n){return new c$(n)}function uRe(n){return new p$(n)}function lRe(n){return new u$(n)}function pRe(n){return new l$(n)}function hRe(n){return new a$(n)}function fRe(n){return new h$(n)}function dRe(n){return new g$(n)}function mRe(n){return new y$(n)}function gRe(n){return new x$(n)}function A$(n){return new b$(n)}function yRe(n){return A$(n)}function xRe(n){return A$(n)}function O$(n){return new S$(n)}function vRe(n){return O$(n)}function bRe(n){return O$(n)}function M$(n){return new _$(n)}function wRe(n){return M$(n)}function SRe(n){return M$(n)}function CRe(n){return new T$(n)}function _Re(n){return new E$(n)}function xee(n){return new I$(n)}function vee(n){return new N$(n)}function bee(n){return new v$(n)}function wee(n){return new w$(n)}function TRe(n){return new C$(n)}function IRe(n){return new KF(n)}function ERe(n){return new VE(n)}function NRe(n){return new XF(n)}function DRe(n){return new Hv(n)}function kRe(n){return new HF(n)}function ARe(n){return new BE(n)}function ORe(n){return new QF(n)}function MRe(n){return new UE(n)}function RRe(n){return new Ec(n)}function PRe(n){return new qE(n)}function FRe(n){return new k$(n)}function $Re(n){return new D$(n)}function qRe(n){return new f$(n)}function URe(n){return new d$(n)}function jRe(n){return new m$(n)}function GRe(n){return new o$(n)}var LRe,zRe,BRe,VRe,See=b(()=>{"use strict";zv();bo();EF();see();zE();aee();cee();uee();lee();pee();hee();fee();dee();gee();fS();yee();LRe=xee,zRe=vee,BRe=bee,VRe=wee});var P$={};xn(P$,{MAPE:()=>n2e,MSE:()=>s2e,binaryAccuracy:()=>WRe,binaryCrossentropy:()=>HRe,categoricalAccuracy:()=>XRe,categoricalCrossentropy:()=>QRe,cosineProximity:()=>JRe,mape:()=>r2e,meanAbsoluteError:()=>e2e,meanAbsolutePercentageError:()=>t2e,meanSquaredError:()=>o2e,mse:()=>i2e,precision:()=>YRe,recall:()=>ZRe,sparseCategoricalAccuracy:()=>KRe});function WRe(n,t){return tS(n,t)}function HRe(n,t){return CE(n,t)}function KRe(n,t){return _E(n,t)}function XRe(n,t){return nS(n,t)}function QRe(n,t){return rS(n,t)}function YRe(n,t){return yF(n,t)}function ZRe(n,t){return TJ(n,t)}function JRe(n,t){return eS(n,t)}function e2e(n,t){return qv(n,t)}function t2e(n,t){return Wf(n,t)}function n2e(n,t){return Wf(n,t)}function r2e(n,t){return Wf(n,t)}function o2e(n,t){return Cl(n,t)}function s2e(n,t){return Cl(n,t)}function i2e(n,t){return Cl(n,t)}var Cee=b(()=>{"use strict";yg();vF()});var F$={};xn(F$,{modelFromJSON:()=>XJ});var _ee=b(()=>{"use strict";PE();});var $$={};xn($$,{l1:()=>c2e,l1l2:()=>a2e,l2:()=>u2e});function a2e(n){return new cS(n)}function c2e(n){return ree(n)}function u2e(n){return oee(n)}var Tee=b(()=>{"use strict";Tl();Tl();});function ZE(n,t){return n<t}function Iee(n,t){return n>t}function l2e(n){return new yS(n)}var gS,yS,Eee,Nee=b(()=>{"use strict";Bv();sS();Gn();K0();gS=class extends mh{constructor(){super(...arguments),this.model=null}setModel(t){if(!(t instanceof Oa))throw new Error("model must be a LayersModel, not some other Container");this.model=t}};yS=class extends gS{constructor(t){if(super(),t==null&&(t={}),t.restoreBestWeights)throw new At("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=t.monitor||"val_loss",this.minDelta=Math.abs(t.minDelta||0),this.patience=t.patience||0,this.verbose=t.verbose||0,this.mode=t.mode||"auto",this.baseline=t.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.mode==="min"?this.monitorFunc=ZE:this.mode==="max"?this.monitorFunc=Iee:this.monitor.indexOf("acc")!==-1?this.monitorFunc=Iee:this.monitorFunc=ZE,this.monitorFunc===ZE&&(this.minDelta*=-1)}onTrainBegin(t){return Y(this,null,function*(){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===ZE?1/0:-1/0})}onEpochEnd(t,e){return Y(this,null,function*(){yield Sl(e);let r=this.getMonitorValue(e);r!=null&&(this.monitorFunc(r-this.minDelta,this.best)?(this.best=r,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0)))})}onTrainEnd(t){return Y(this,null,function*(){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)})}getMonitorValue(t){t==null&&(t={});let e=t[this.monitor];return e==null&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(t)}`),e}};Eee={earlyStopping:l2e}});var L$=b(()=>{"use strict";ZZ();bJ();See();Cee();_ee();Tee();Bv();Nee();bo();sS();EF();fS();PE();H0();NE();});var Nc,Dee,kee=b(()=>{"use strict";Nc=function(n){return n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n}(Nc||{});(function(n){let t;(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t=n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(Dee||(Dee={}))});function Aee(n,t){let e={tfOpName:n,category:"custom",inputs:[],attrs:[],customExecutor:t};z$[n]=e}function JE(n){return z$[n]}function Oee(n){delete z$[n]}var z$,eN=b(()=>{"use strict";z$={}});function F(n,t,e,r,o){let s=t.inputParams[n];if(s&&s.inputIndexStart!==void 0){let a=s.inputIndexStart,c=s.inputIndexEnd===0?void 0:s.inputIndexEnd===void 0?a+1:s.inputIndexEnd;if(s.type==="tensor")return Do(t.inputNames[s.inputIndexStart],e,r,o);if(s.type==="tensors")return t.inputNames.slice(a,c).map(y=>Do(y,e,r,o));let l=Do(t.inputNames.slice(a)[0],e,r,o),p=l.dataSync();return s.type==="number"?p[0]:N.toNestedArray(l.shape,p)}let i=t.attrParams[n];return i&&i.value}function Do(n,t,e,r){let[o,s]=qs(n);if(r!=null){let a=r.getHashTableHandleByName(o);if(a!=null)return a}let i=e.currentContextIds.find(a=>!!t[tN(o,a)]);return i!==void 0?t[tN(o,i)][s]:void 0}function Mee(n,t,e){return t[tN(n,e.currentContextId)]}function Dc(n,t){let[e,r]=qs(n);return[tN(e,t&&t.currentContextId),r]}function tN(n,t){return t?`${n}-${t}`:n}function qs(n){let t=n.split(":");return t.length===1?[n,0]:[t[0],Number(t[t.length-1])]}function xS(n,t,e){let r=F("pad",n,t,e);if(r==="explicit"){r=F("explicitPaddings",n,t,e);let o=[[0,0],[0,0],[0,0],[0,0]];for(let s=0;s<4;s++)o[s][0]=r[s*2],o[s][1]=r[s*2+1];return o}return r}function kc(n){return n.kept?n:bi(n)}var lo=b(()=>{"use strict";$();});var B$={};xn(B$,{json:()=>h2e});var h2e,Ree=b(()=>{"use strict";h2e=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]});var V$={};xn(V$,{json:()=>f2e});var f2e,Pee=b(()=>{"use strict";f2e=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]});var q$={};xn(q$,{json:()=>d2e});var d2e,Fee=b(()=>{"use strict";d2e=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}]});var U$={};xn(U$,{json:()=>m2e});var m2e,$ee=b(()=>{"use strict";m2e=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}]});var j$={};xn(j$,{json:()=>g2e});var g2e,Lee=b(()=>{"use strict";g2e=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]});var G$={};xn(G$,{json:()=>y2e});var y2e,zee=b(()=>{"use strict";y2e=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]});var W$={};xn(W$,{json:()=>x2e});var x2e,Bee=b(()=>{"use strict";x2e=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}]});var H$={};xn(H$,{json:()=>v2e});var v2e,Vee=b(()=>{"use strict";v2e=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]});var K$={};xn(K$,{json:()=>b2e});var b2e,qee=b(()=>{"use strict";b2e=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]}]});var X$={};xn(X$,{json:()=>w2e});var w2e,Uee=b(()=>{"use strict";w2e=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]});var Q$={};xn(Q$,{json:()=>S2e});var S2e,jee=b(()=>{"use strict";S2e=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]});var Y$={};xn(Y$,{json:()=>C2e});var C2e,Gee=b(()=>{"use strict";C2e=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]});var Z$={};xn(Z$,{json:()=>_2e});var _2e,Wee=b(()=>{"use strict";_2e=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]});var J$={};xn(J$,{json:()=>T2e});var T2e,Hee=b(()=>{"use strict";T2e=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}]});var eL={};xn(eL,{json:()=>I2e});var I2e,Kee=b(()=>{"use strict";I2e=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]});var tL={};xn(tL,{json:()=>E2e});var E2e,Xee=b(()=>{"use strict";E2e=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]});var nL={};xn(nL,{json:()=>N2e});var N2e,Qee=b(()=>{"use strict";N2e=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}]});function D2e(n){let t=Te().global;if(typeof t.atob<"u")return t.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function Zee(n,t){let e=Array.isArray(n)?String.fromCharCode.apply(null,n):D2e(n);return t?e:e.toLowerCase()}function nN(n,t,e,r=!1){let o=n[t];return o!=null?Zee(o.s,r):e}function rN(n,t,e){let r=n[t];return r?r.b:e}function oN(n,t,e){let r=n[t]||{},o=r.i!=null?r.i:r.f!=null?r.f:e;return typeof o=="number"?o:parseInt(o,10)}function rL(n){switch(typeof n=="string"&&(n=Nc[n]),n){case Nc.DT_FLOAT:return"float32";case Nc.DT_INT32:case Nc.DT_INT64:case Nc.DT_INT8:case Nc.DT_UINT8:return"int32";case Nc.DT_BOOL:return"bool";case Nc.DT_DOUBLE:return"float32";case Nc.DT_STRING:return"string";default:return null}}function Yee(n,t,e){let r=n[t];return r&&r.func?r.func.name:e}function sN(n,t,e){let r=n[t];return r&&r.type?rL(r.type):e}function iN(n,t,e){let r=n[t];return r&&r.list&&r.list.type?r.list.type.map(o=>rL(o)):e}function Jee(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(t=>typeof t.size=="number"?t.size:parseInt(t.size,10)):[]}function aN(n,t,e){let r=n[t];return r&&r.shape?Jee(r.shape):e}function cN(n,t,e){let r=n[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(o=>typeof o=="number"?o:parseInt(o,10)):e}function uN(n,t,e,r=!1){let o=n[t];return o&&o.list&&o.list.s?o.list.s.map(s=>Zee(s,r)):e}function lN(n,t,e){let r=n[t];return r&&r.list&&r.list.shape?r.list.shape.map(o=>Jee(o)):e}function pN(n,t,e){let r=n[t];return r&&r.list&&r.list.b?r.list.b:e}var vS,oL=b(()=>{"use strict";$();kee();eN();lo();Ree();Pee();Fee();$ee();Lee();zee();Bee();Vee();qee();Uee();jee();Gee();Wee();Hee();Kee();Xee();Qee();vS=class{static get Instance(){return this._instance||(this._instance=new this)}constructor(){let t=[B$,V$,q$,U$,j$,G$,W$,Q$,X$,H$,Y$,Z$,J$,eL,tL,nL,K$],e=[].concat(...t.map(r=>r.json));this.opMappers=e.reduce((r,o)=>(r[o.tfOpName]=o,r),{})}transformGraph(t,e={}){let r=t.node,o=[],s=[],i=[],a=r.reduce((m,x)=>(m[x.name]=this.mapNode(x),x.op.startsWith("Placeholder")?o.push(m[x.name]):x.op==="Const"?s.push(m[x.name]):(x.input==null||x.input.length===0)&&i.push(m[x.name]),m),{}),c=[],l=[],p={},f={};e!=null&&(p=this.mapSignatureEntries(e.inputs),f=this.mapSignatureEntries(e.outputs));let y=Object.keys(a);y.forEach(m=>{let x=a[m];x.inputNames.forEach(w=>{let[_]=Dc(w);x.inputs.push(a[_]),a[_].children.push(x)})}),Object.keys(f).length===0?y.forEach(m=>{let x=a[m];x.children.length===0&&l.push(x)}):Object.keys(f).forEach(m=>{let[x]=Dc(m),w=a[x];w!=null&&(w.signatureKey=f[m],l.push(w))}),Object.keys(p).length>0?Object.keys(p).forEach(m=>{let[x]=Dc(m),w=a[x];w&&(w.signatureKey=p[m],c.push(w))}):c=o;let d={};t.library!=null&&t.library.function!=null&&(d=t.library.function.reduce((m,x)=>(m[x.signature.name]=this.mapFunction(x),m),{}));let h={nodes:a,inputs:c,outputs:l,weights:s,placeholders:o,signature:e,functions:d};return i.length>0&&(h.initNodes=i),h}mapSignatureEntries(t){return Object.keys(t||{}).reduce((e,r)=>(e[t[r].name]=r,e),{})}mapNode(t){let e=JE(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});let r={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map(o=>o.startsWith("^")?o.substr(1):o),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return e.inputs!=null&&(r.inputParams=e.inputs.reduce((o,s)=>(o[s.name]={type:s.type,inputIndexStart:s.start,inputIndexEnd:s.end},o),{})),e.attrs!=null&&(r.attrParams=e.attrs.reduce((o,s)=>{let i=s.type,a;switch(s.type){case"string":a=nN(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=nN(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"string[]":a=uN(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=uN(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"number":a=oN(t.attr,s.tfName,s.defaultValue||0),a===void 0&&s.tfDeprecatedName&&(a=oN(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"number[]":a=cN(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=cN(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"bool":a=rN(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=rN(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"bool[]":a=pN(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=pN(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"shape":a=aN(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=aN(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"shape[]":a=lN(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=lN(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"dtype":a=sN(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=sN(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"dtype[]":a=iN(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=iN(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"func":a=Yee(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=Yee(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${s.type} for op: ${t.op}`)}return o[s.name]={value:a,type:i},o},{})),r}mapFunction(t){let e=t.nodeDef,r=[],o=[],s={};e!=null&&(s=e.reduce((f,y)=>(f[y.name]=this.mapNode(y),y.op==="Const"&&o.push(f[y.name]),f),{}));let i=[],a=[];t.signature.inputArg.forEach(f=>{let[y]=Dc(f.name),d={name:y,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:rL(f.type),type:"dtype"}},children:[]};d.signatureKey=f.name,i.push(d),s[y]=d}),Object.keys(s).forEach(f=>{let y=s[f];y.inputNames.forEach(d=>{let[h]=Dc(d);y.inputs.push(s[h]),s[h].children.push(y)})});let l=t.ret;t.signature.outputArg.forEach(f=>{let[y,d]=Dc(l[f.name]),h=s[y];h!=null&&(h.defaultOutput=d,a.push(h))});let p=this.mapArgsToSignature(t);return{nodes:s,inputs:i,outputs:a,weights:o,placeholders:r,signature:p}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((e,r)=>(e[r.name]=this.mapArgToTensorInfo(r),e),{}),outputs:t.signature.outputArg.reduce((e,r)=>(e[r.name]=this.mapArgToTensorInfo(r,t.ret),e),{})}}mapArgToTensorInfo(t,e){let r=t.name;return e!=null&&(r=e[r]),{name:r,dtype:t.type}}}});var hN,ete=b(()=>{"use strict";lo();oL();hN=class{constructor(t,e,r){this.node=t,this.tensorMap=e,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(o=>this.getInput(o)),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce((o,s)=>(o[s]=this.getAttr(s),o),{}))}getInput(t){return Do(t,this.tensorMap,this.context)}getAttr(t,e){let r=this.node.rawAttrs[t];if(r.tensor!=null)return Do(t,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return oN(this.node.rawAttrs,t,e);if(r.s!=null)return nN(this.node.rawAttrs,t,e);if(r.b!=null)return rN(this.node.rawAttrs,t,e);if(r.shape!=null)return aN(this.node.rawAttrs,t,e);if(r.type!=null)return sN(this.node.rawAttrs,t,e);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return cN(this.node.rawAttrs,t,e);if(r.list.s!=null)return uN(this.node.rawAttrs,t,e);if(r.list.shape!=null)return lN(this.node.rawAttrs,t,e);if(r.list.b!=null)return pN(this.node.rawAttrs,t,e);if(r.list.type!=null)return iN(this.node.rawAttrs,t,e)}return e}}});var Us=b(()=>{"use strict";Ct();});var tte,nte=b(()=>{"use strict";Us();lo();tte=(n,t,e)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[je(F("a",n,t,e),F("b",n,t,e))];case"AddN":return[LI(F("tensors",n,t,e))];case"FloorMod":case"Mod":return[Af(F("a",n,t,e),F("b",n,t,e))];case"Mul":return[oe(F("a",n,t,e),F("b",n,t,e))];case"RealDiv":case"Div":return[ct(F("a",n,t,e),F("b",n,t,e))];case"DivNoNan":return[ev(F("a",n,t,e),F("b",n,t,e))];case"FloorDiv":return[xf(F("a",n,t,e),F("b",n,t,e))];case"Sub":return[at(F("a",n,t,e),F("b",n,t,e))];case"Minimum":return[_i(F("a",n,t,e),F("b",n,t,e))];case"Maximum":return[$o(F("a",n,t,e),F("b",n,t,e))];case"Pow":return[Eo(F("a",n,t,e),F("b",n,t,e))];case"SquaredDifference":return[gl(F("a",n,t,e),F("b",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}}});var rte,ote=b(()=>{"use strict";Us();lo();rte=(n,t,e)=>{switch(n.op){case"Abs":case"ComplexAbs":return[Jn(F("x",n,t,e))];case"Acos":return[Fx(F("x",n,t,e))];case"Acosh":return[$x(F("x",n,t,e))];case"Asin":return[zx(F("x",n,t,e))];case"Asinh":return[Bx(F("x",n,t,e))];case"Atan":return[Vx(F("x",n,t,e))];case"Atan2":return[qx(F("x",n,t,e),F("y",n,t,e))];case"Atanh":return[Ux(F("x",n,t,e))];case"Ceil":return[Hx(F("x",n,t,e))];case"Complex":return[Xs(F("real",n,t,e),F("imag",n,t,e))];case"Cos":return[rl(F("x",n,t,e))];case"Cosh":return[Sf(F("x",n,t,e))];case"Elu":return[xa(F("x",n,t,e))];case"Erf":return[tv(F("x",n,t,e))];case"Exp":return[Wr(F("x",n,t,e))];case"Expm1":return[nv(F("x",n,t,e))];case"Floor":return[va(F("x",n,t,e))];case"Log":return[so(F("x",n,t,e))];case"Log1p":return[Nf(F("x",n,t,e))];case"Imag":return[If(F("x",n,t,e))];case"Neg":return[un(F("x",n,t,e))];case"Reciprocal":return[pv(F("x",n,t,e))];case"Real":return[ih(F("x",n,t,e))];case"Relu":return[zo(F("x",n,t,e))];case"Round":return[fv(F("x",n,t,e))];case"Selu":return[Ff(F("x",n,t,e))];case"Sigmoid":return[xs(F("x",n,t,e))];case"Sin":return[$f(F("x",n,t,e))];case"Sign":return[mv(F("x",n,t,e))];case"Sinh":return[Lf(F("x",n,t,e))];case"Softplus":return[ba(F("x",n,t,e))];case"Sqrt":return[jn(F("x",n,t,e))];case"Square":return[Gt(F("x",n,t,e))];case"Tanh":return[fc(F("x",n,t,e))];case"Tan":return[wv(F("x",n,t,e))];case"ClipByValue":return[oo(F("x",n,t,e),F("clipValueMin",n,t,e),F("clipValueMax",n,t,e))];case"Relu6":return[Rf(F("x",n,t,e))];case"Rsqrt":return[Pf(Do(n.inputNames[0],t,e))];case"Prod":return[Mf(F("x",n,t,e),F("axes",n,t,e))];case"LeakyRelu":return[al(F("x",n,t,e),F("alpha",n,t,e))];case"Prelu":return[hl(F("x",n,t,e),F("alpha",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}}});function Ti(n,t,e=""){N.assert(O2e(n,t),()=>e+` Shapes ${n} and ${t} must match`)}function O2e(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==-1&&t[e]!==-1&&n[e]!==t[e])return!1;return!0}var sL=b(()=>{"use strict";$();});var fN,ste=b(()=>{"use strict";$();sL();fN=class{constructor(t,e,r,o,s,i,a){this.name=t,this.dtype=e,this.maxSize=r,this.elementShape=o,this.identicalElementShapes=s,this.dynamicSize=i,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=it(0),ur(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(e=>{(t==null||!t.has(e.tensor.id))&&e.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);let e=this.tensors[t];if(e.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}readMany(t){return t.map(e=>this.read(e))}write(t,e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);let r=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},
          because the value dtype is ${e.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=e.shape),Ti(this.elementShape,e.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);r.tensor=e,ur(e),r.written=!0,this.tensors[t]=r}writeMany(t,e){if(t.length!==e.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${e.length}.`);t.forEach((r,o)=>this.write(r,e[o]))}gather(t,e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${e}`);if(t)t=t.slice(0,this.size());else{t=[];for(let o=0;o<this.size();o++)t.push(o)}if(t.length===0)return Qo([],[0].concat(this.elementShape));let r=this.readMany(t);return Ti(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Ir(r,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(this.size()===0)return Qo([],[0].concat(this.elementShape));let e=[];for(let o=0;o<this.size();o++)e.push(o);let r=this.readMany(e);return Ti(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),gn(r,0)}scatter(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);let r=Math.max(...t);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(t,uo(e,0))}split(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);let r=0,o=t.map(c=>(r+=c,r));if(r!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${e.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);let s=r===0?0:e.size/r,i=[];de(()=>{e=ue(e,[1,r,s]);for(let c=0;c<t.length;++c){let p=[0,c===0?0:o[c-1],0],f=[1,t[c],s];i[c]=ue(Bt(e,p,f),this.elementShape)}return i});let a=[];for(let c=0;c<t.length;c++)a[c]=c;this.writeMany(a,i)}}});function ite(n,t,e){let r=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==e)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${e}`);let o=n.shape.slice(1);Ti(o,t,"TensorList shape mismatch: ");let s=uo(n);return new Kv(s,t,r)}function ate(n,t,e){return new Kv([],n,t,e)}function cte(n,t,e,r){if(t.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${n.shape[0]}`);let o=Math.max(...t);if(r!=null&&r!==-1&&o>=r)throw new Error(`Max index must be < array size (${o}  vs. ${r})`);let s=new Kv([],e,n.dtype,r),i=uo(n,0);return t.forEach((a,c)=>{s.setItem(a,i[c])}),s}function ute(n,t,e){let r=0,o=t.map(c=>(r+=c,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);let s=r===0?0:n.size/r,i=de(()=>{let c=[];n=ue(n,[1,r,s]);for(let l=0;l<t.length;++l){let f=[0,l===0?0:o[l-1],0],y=[1,t[l],s];c[l]=ue(Bt(n,f,y),e)}return n.dispose(),c}),a=new Kv([],e,n.dtype,t.length);for(let c=0;c<i.length;c++)a.setItem(c,i[c]);return a}var Kv,lte=b(()=>{"use strict";$();sL();Kv=class n{constructor(t,e,r,o=-1){this.tensors=t,this.elementShape=e,this.elementDtype=r,t?.forEach(s=>{if(r!==s.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${s.dtype}`);Ti(e,s.shape,"TensorList shape mismatch: "),ur(s)}),this.idTensor=it(0),this.maxNumElements=o,ur(this.idTensor)}get id(){return this.idTensor.id}copy(){return new n([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(e=>{(t==null||!t.has(e.id))&&e.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,e,r=-1){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);return Ti(t,this.elementShape,"TensorList shape mismatch: "),de(()=>{let o=this.tensors.map(s=>ue(s,t));return Ir(o,0)})}popBack(t,e){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");let r=this.tensors.pop();return Ti(r.shape,t,"TensorList shape mismatch: "),ue(r,t)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(Ti(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");ur(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${t}`);if(this.maxNumElements!==-1&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);this.tensors.length=t}getItem(t,e,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(this.tensors[t]==null)throw new Error(`element at index ${t} is null.`);return Ti(this.tensors[t].shape,e,"TensorList shape mismatch: "),this.tensors[t]}setItem(t,e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(t<0||this.maxNumElements!==-1&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);Ti(this.elementShape,e.shape,"TensorList shape mismatch: "),ur(e),this.tensors[t]=e}gather(t,e,r){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);return Ti(this.elementShape,r,"TensorList shape mismatch: "),t=t.slice(0,this.size()),t.length===0?Qo([],[0].concat(this.elementShape)):de(()=>{let o=t.map(s=>ue(this.tensors[s],r));return Ir(o,0)})}concat(t,e){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);return Ti(this.elementShape,e,"TensorList shape mismatch: "),this.size()===0?Qo([],[0].concat(this.elementShape)):de(()=>{let r=this.tensors.map(o=>ue(o,e));return gn(r,0)})}}});var pte,hte=b(()=>{"use strict";$();ste();lte();lo();pte=(n,t,e)=>Y(null,null,function*(){switch(n.op){case"If":case"StatelessIf":{let r=F("thenBranch",n,t,e),o=F("elseBranch",n,t,e),s=F("cond",n,t,e),i=F("args",n,t,e);return(yield s.data())[0]?e.functionMap[r].executeFunctionAsync(i,e.tensorArrayMap,e.tensorListMap):e.functionMap[o].executeFunctionAsync(i,e.tensorArrayMap,e.tensorListMap)}case"While":case"StatelessWhile":{let r=F("body",n,t,e),o=F("cond",n,t,e),s=F("args",n,t,e),i=yield e.functionMap[o].executeFunctionAsync(s,e.tensorArrayMap,e.tensorListMap),a=s.map(p=>p.id),c=yield i[0].data();i.forEach(p=>{!p.kept&&a.indexOf(p.id)===-1&&p.dispose()});let l=s;for(;c[0];){let p=l;l=yield e.functionMap[r].executeFunctionAsync(l,e.tensorArrayMap,e.tensorListMap);let f=l.map(d=>d.id);p.forEach(d=>{!d.kept&&a.indexOf(d.id)===-1&&f.indexOf(d.id)===-1&&d.dispose()});let y=yield e.functionMap[o].executeFunctionAsync(l,e.tensorArrayMap,e.tensorListMap);c=yield y[0].data(),y.forEach(d=>{!d.kept&&a.indexOf(d.id)===-1&&f.indexOf(d.id)===-1&&d.dispose()})}return l}case"LoopCond":{let r=F("pred",n,t,e);return[kc(r)]}case"Switch":{let r=F("pred",n,t,e),o=F("data",n,t,e);return o.kept||(o=kc(o)),(yield r.data())[0]?[void 0,o]:[o,void 0]}case"Merge":{let r=n.inputNames.find(o=>Do(o,t,e)!==void 0);if(r){let o=Do(r,t,e);return[kc(o)]}return}case"Enter":{let r=F("frameName",n,t,e),o=F("tensor",n,t,e);return e.enterFrame(r),[kc(o)]}case"Exit":{let r=F("tensor",n,t,e);return e.exitFrame(),[kc(r)]}case"NextIteration":{let r=F("tensor",n,t,e);return e.nextIteration(),[kc(r)]}case"TensorArrayV3":{let r=F("size",n,t,e),o=F("dtype",n,t,e),s=F("elementShape",n,t,e),i=F("dynamicSize",n,t,e),a=F("clearAfterRead",n,t,e),c=F("identicalElementShapes",n,t,e),l=F("name",n,t,e),p=new fN(l,o,r,s,c,i,a);return e.addTensorArray(p),[p.idTensor,it(1)]}case"TensorArrayWriteV3":{let r=F("tensorArrayId",n,t,e),o=F("index",n,t,e),s=F("tensor",n,t,e),i=e.getTensorArray(r.id);return i.write(o,s),[i.idTensor]}case"TensorArrayReadV3":{let r=F("tensorArrayId",n,t,e),o=F("index",n,t,e);return[e.getTensorArray(r.id).read(o)]}case"TensorArrayGatherV3":{let r=F("tensorArrayId",n,t,e),o=F("indices",n,t,e),s=F("dtype",n,t,e);return[e.getTensorArray(r.id).gather(o,s)]}case"TensorArrayScatterV3":{let r=F("tensorArrayId",n,t,e),o=F("indices",n,t,e),s=F("tensor",n,t,e),i=e.getTensorArray(r.id);return i.scatter(o,s),[i.idTensor]}case"TensorArrayConcatV3":{let r=F("tensorArrayId",n,t,e),o=e.getTensorArray(r.id),s=F("dtype",n,t,e);return[o.concat(s)]}case"TensorArraySplitV3":{let r=F("tensorArrayId",n,t,e),o=F("tensor",n,t,e),s=F("lengths",n,t,e),i=e.getTensorArray(r.id);return i.split(s,o),[i.idTensor]}case"TensorArraySizeV3":{let r=F("tensorArrayId",n,t,e),o=e.getTensorArray(r.id);return[it(o.size(),"int32")]}case"TensorArrayCloseV3":{let r=F("tensorArrayId",n,t,e),o=e.getTensorArray(r.id);return o.clearAndClose(),[o.idTensor]}case"TensorListSetItem":{let r=F("tensorListId",n,t,e),o=F("index",n,t,e),s=F("tensor",n,t,e),i=e.getTensorList(r.id);return i.setItem(o,s),[i.idTensor]}case"TensorListGetItem":{let r=F("tensorListId",n,t,e),o=F("index",n,t,e),s=F("elementShape",n,t,e),i=F("elementDType",n,t,e);return[e.getTensorList(r.id).getItem(o,s,i)]}case"TensorListScatterV2":case"TensorListScatter":{let r=F("indices",n,t,e),o=F("tensor",n,t,e),s=F("elementShape",n,t,e),i=F("numElements",n,t,e),a=cte(o,r,s,i);return e.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{let r=F("elementShape",n,t,e),o=F("elementDType",n,t,e),s;n.op==="TensorListReserve"?s="numElements":s="maxNumElements";let i=F(s,n,t,e),a=ate(r,o,i);return e.addTensorList(a),[a.idTensor]}case"TensorListGather":{let r=F("tensorListId",n,t,e),o=F("indices",n,t,e),s=F("elementShape",n,t,e),i=F("elementDType",n,t,e);return[e.getTensorList(r.id).gather(o,i,s)]}case"TensorListStack":{let r=F("tensorListId",n,t,e),o=F("elementShape",n,t,e),s=F("elementDType",n,t,e),i=F("numElements",n,t,e);return[e.getTensorList(r.id).stack(o,s,i)]}case"TensorListFromTensor":{let r=F("tensor",n,t,e),o=F("elementShape",n,t,e),s=F("elementDType",n,t,e),i=ite(r,o,s);return e.addTensorList(i),[i.idTensor]}case"TensorListConcat":{let r=F("tensorListId",n,t,e),o=e.getTensorList(r.id),s=F("dtype",n,t,e),i=F("elementShape",n,t,e);return[o.concat(s,i)]}case"TensorListPushBack":{let r=F("tensorListId",n,t,e),o=F("tensor",n,t,e),s=e.getTensorList(r.id);return s.pushBack(o),[s.idTensor]}case"TensorListPopBack":{let r=F("tensorListId",n,t,e),o=F("elementShape",n,t,e),s=F("elementDType",n,t,e);return[e.getTensorList(r.id).popBack(o,s)]}case"TensorListSplit":{let r=F("tensor",n,t,e),o=F("elementShape",n,t,e),s=F("lengths",n,t,e),i=ute(r,s,o);return e.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${n.op} is not implemented`)}})});function fte(n,t,e){let[r,o]=F("fusedOps",n,t,e),s=r==="biasadd",i=o==="prelu",a=r==="fusedbatchnorm",c=F("numArgs",n,t,e);if(s){if(i&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(a)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");let l=F("strides",n,t,e),p=xS(n,t,e),f=F("dataFormat",n,t,e).toUpperCase(),y=F("dilations",n,t,e),[d,h]=F("args",n,t,e),m=F("leakyreluAlpha",n,t,e);return{stride:l,pad:p,dataFormat:f,dilations:y,biasArg:d,preluArg:h,activationFunc:o,leakyreluAlpha:m}}var dte,mte=b(()=>{"use strict";Us();lo();dte=(n,t,e)=>{switch(n.op){case"Conv1D":{let r=F("stride",n,t,e),o=F("pad",n,t,e),s=F("dataFormat",n,t,e).toUpperCase(),i=F("dilation",n,t,e);return[bf(F("x",n,t,e),F("filter",n,t,e),r,o,s,i)]}case"Conv2D":{let r=F("strides",n,t,e),o=xS(n,t,e),s=F("dataFormat",n,t,e).toUpperCase(),i=F("dilations",n,t,e);return[vs(F("x",n,t,e),F("filter",n,t,e),[r[1],r[2]],o,s,[i[1],i[2]])]}case"_FusedConv2D":{let{stride:r,pad:o,dataFormat:s,dilations:i,biasArg:a,preluArg:c,activationFunc:l,leakyreluAlpha:p}=fte(n,t,e);return[Gi.conv2d({x:F("x",n,t,e),filter:F("filter",n,t,e),strides:[r[1],r[2]],pad:o,dataFormat:s,dilations:[i[1],i[2]],bias:a,activation:l,preluActivationWeights:c,leakyreluAlpha:p})]}case"FusedDepthwiseConv2dNative":{let{stride:r,pad:o,dataFormat:s,dilations:i,biasArg:a,preluArg:c,activationFunc:l,leakyreluAlpha:p}=fte(n,t,e);return[Gi.depthwiseConv2d({x:F("x",n,t,e),filter:F("filter",n,t,e),strides:[r[1],r[2]],pad:o,dataFormat:s,dilations:[i[1],i[2]],bias:a,activation:l,preluActivationWeights:c,leakyreluAlpha:p})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{let r=F("outputShape",n,t,e),o=F("strides",n,t,e),s=xS(n,t,e);return[wf(F("x",n,t,e),F("filter",n,t,e),r,[o[1],o[2]],s)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{let r=F("strides",n,t,e),o=xS(n,t,e),s=F("dilations",n,t,e),i=F("dataFormat",n,t,e).toUpperCase();return[Si(F("input",n,t,e),F("filter",n,t,e),[r[1],r[2]],o,i,[s[1],s[2]])]}case"Conv3D":{let r=F("strides",n,t,e),o=F("pad",n,t,e),s=F("dataFormat",n,t,e).toUpperCase(),i=F("dilations",n,t,e);return[Xx(F("x",n,t,e),F("filter",n,t,e),[r[1],r[2],r[3]],o,s,[i[1],i[2],i[3]])]}case"AvgPool":{let r=F("strides",n,t,e),o=F("pad",n,t,e),s=F("kernelSize",n,t,e);return[tl(F("x",n,t,e),[s[1],s[2]],[r[1],r[2]],o)]}case"MaxPool":{let r=F("strides",n,t,e),o=F("pad",n,t,e),s=F("kernelSize",n,t,e);return[ll(F("x",n,t,e),[s[1],s[2]],[r[1],r[2]],o)]}case"MaxPoolWithArgmax":{let r=F("strides",n,t,e),o=F("pad",n,t,e),s=F("kernelSize",n,t,e),i=F("includeBatchInIndex",n,t,e),{result:a,indexes:c}=y1(F("x",n,t,e),[s[1],s[2]],[r[1],r[2]],o,i);return[a,c]}case"AvgPool3D":{let r=F("strides",n,t,e),o=F("pad",n,t,e),s=F("kernelSize",n,t,e);return[Gx(F("x",n,t,e),[s[1],s[2],s[3]],[r[1],r[2],r[3]],o)]}case"MaxPool3D":{let r=F("strides",n,t,e),o=F("pad",n,t,e),s=F("kernelSize",n,t,e);return[av(F("x",n,t,e),[s[1],s[2],s[3]],[r[1],r[2],r[3]],o)]}case"Dilation2D":{let r=F("strides",n,t,e),o=F("pad",n,t,e),s=F("dilations",n,t,e),i=r[1],a=r[2],c=s[1],l=s[2];return[Zx(F("x",n,t,e),F("filter",n,t,e),[i,a],o,[c,l],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}}});var gte,yte=b(()=>{"use strict";Us();lo();gte=(n,t,e)=>{switch(n.op){case"Fill":{let r=F("shape",n,t,e),o=F("dtype",n,t,e),s=F("value",n,t,e);return[sl(r,s,o)]}case"LinSpace":{let r=F("start",n,t,e),o=F("stop",n,t,e),s=F("num",n,t,e);return[l1(r,o,s)]}case"Multinomial":{let r=F("logits",n,t,e),o=F("numSamples",n,t,e),s=F("seed",n,t,e);return[b1(r,o,s)]}case"OneHot":{let r=F("indices",n,t,e),o=F("depth",n,t,e),s=F("onValue",n,t,e),i=F("offValue",n,t,e);return[ga(r,o,s,i)]}case"Ones":return[Lo(F("shape",n,t,e),F("dtype",n,t,e))];case"OnesLike":return[Yr(F("x",n,t,e))];case"RandomUniform":return[Sa(F("shape",n,t,e),F("minval",n,t,e),F("maxval",n,t,e),F("dtype",n,t,e))];case"Range":{let r=F("start",n,t,e),o=F("stop",n,t,e),s=F("step",n,t,e);return[ng(r,o,s,F("dtype",n,t,e))]}case"TruncatedNormal":{let r=F("shape",n,t,e),o=F("mean",n,t,e),s=F("stdDev",n,t,e),i=F("seed",n,t,e);return[Bf(r,o,s,F("dtype",n,t,e),i)]}case"Zeros":return[An(F("shape",n,t,e),F("dtype",n,t,e))];case"ZerosLike":return[Et(F("x",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}}});function iL(n,t,e){let r=F("boxes",n,t,e),o=F("scores",n,t,e),s=F("maxOutputSize",n,t,e),i=F("iouThreshold",n,t,e),a=F("scoreThreshold",n,t,e),c=F("softNmsSigma",n,t,e);return{boxes:r,scores:o,maxOutputSize:s,iouThreshold:i,scoreThreshold:a,softNmsSigma:c}}var xte,vte=b(()=>{"use strict";Us();lo();xte=(n,t,e)=>Y(null,null,function*(){switch(n.op){case"NonMaxSuppressionV5":{let{boxes:r,scores:o,maxOutputSize:s,iouThreshold:i,scoreThreshold:a,softNmsSigma:c}=iL(n,t,e),l=yield bc.nonMaxSuppressionWithScoreAsync(r,o,s,i,a,c);return[l.selectedIndices,l.selectedScores]}case"NonMaxSuppressionV4":{let{boxes:r,scores:o,maxOutputSize:s,iouThreshold:i,scoreThreshold:a}=iL(n,t,e),c=F("padToMaxOutputSize",n,t,e),l=yield bc.nonMaxSuppressionPaddedAsync(r,o,s,i,a,c);return[l.selectedIndices,l.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{let{boxes:r,scores:o,maxOutputSize:s,iouThreshold:i,scoreThreshold:a}=iL(n,t,e);return[yield bc.nonMaxSuppressionAsync(r,o,s,i,a)]}case"Where":{let r=Ye(F("condition",n,t,e),"bool"),o=[yield Iv(r)];return r.dispose(),o}case"ListDiff":return k1(F("x",n,t,e),F("y",n,t,e));default:throw TypeError(`Node type ${n.op} is not implemented`)}})});var bte,wte=b(()=>{"use strict";Us();lo();bte=(n,t,e)=>{switch(n.op){case"TopKV2":{let r=F("x",n,t,e),o=F("k",n,t,e),s=F("sorted",n,t,e),i=Cv(r,o,s);return[i.values,i.indices]}case"Unique":{let r=F("x",n,t,e),o=sg(r);return[o.values,o.indices]}case"UniqueV2":{let r=F("x",n,t,e),o=F("axis",n,t,e),s=sg(r,o);return[s.values,s.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}}});var Ste,Cte=b(()=>{"use strict";Us();lo();Ste=(n,t,e)=>{switch(n.op){case"Const":return t[n.name];case"PlaceholderWithDefault":let r=F("default",n,t,e);return[Do(n.name,t,e)||r];case"Placeholder":return[Do(n.name,t,e)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{let l=F("x",n,t,e);return[kc(l)]}case"IdentityN":return F("x",n,t,e).map(l=>kc(l));case"Snapshot":let o=F("x",n,t,e);return[kc(o)];case"Shape":return[Er(F("x",n,t,e).shape,"int32")];case"ShapeN":return F("x",n,t,e).map(l=>Er(l.shape));case"Size":return[it(F("x",n,t,e).size,"int32")];case"Rank":return[it(F("x",n,t,e).rank,"int32")];case"NoOp":return[it(1)];case"Print":let s=F("x",n,t,e),i=F("data",n,t,e),a=F("message",n,t,e),c=F("summarize",n,t,e);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(a);for(let l=0;l<i.length;l++)console.log(Array.prototype.slice.call(i[l].dataSync()).slice(0,c));return[s];default:throw TypeError(`Node type ${n.op} is not implemented`)}}});var dN,_te=b(()=>{"use strict";$();dN=class{constructor(t,e){this.keyDType=t,this.valueDType=e,this.handle=it(0),this.tensorMap=new Map,ur(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}import(t,e){return Y(this,null,function*(){this.checkKeyAndValueTensor(t,e);let r=yield t.data();return this.tensorMap.forEach(o=>o.dispose()),this.tensorMap.clear(),de(()=>{let o=uo(e),s=r.length,i=o.length;N.assert(s===i,()=>`The number of elements doesn't match, keys has ${s} elements, the values has ${i} elements.`);for(let a=0;a<s;a++){let c=r[a],l=o[a];ur(l),this.tensorMap.set(c,l)}return this.handle})})}find(t,e){return Y(this,null,function*(){this.checkKeyAndValueTensor(t,e);let r=yield t.data();return de(()=>{let o=[];for(let s=0;s<r.length;s++){let i=r[s],a=this.findWithDefault(i,e);o.push(a)}return Ir(o)})})}findWithDefault(t,e){let r=this.tensorMap.get(t);return r??e}checkKeyAndValueTensor(t,e){if(t.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${t.dtype}`);if(e.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${e.dtype}`)}}});var Tte,Ite=b(()=>{"use strict";_te();lo();Tte=(n,t,e,r)=>Y(null,null,function*(){switch(n.op){case"HashTable":case"HashTableV2":{let o=F("keyDType",n,t,e),s=F("valueDType",n,t,e),i=new dN(o,s);return r.addHashTable(n.name,i),[i.handle]}case"LookupTableImport":case"LookupTableImportV2":{let o=F("tableHandle",n,t,e,r),s=F("keys",n,t,e),i=F("values",n,t,e);return[yield r.getHashTableById(o.id).import(s,i)]}case"LookupTableFind":case"LookupTableFindV2":{let o=F("tableHandle",n,t,e,r),s=F("keys",n,t,e),i=F("defaultValue",n,t,e);return[yield r.getHashTableById(o.id).find(s,i)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}})});var Ete,Nte=b(()=>{"use strict";Us();lo();Ete=(n,t,e)=>{switch(n.op){case"ResizeBilinear":{let r=F("images",n,t,e),o=F("size",n,t,e),s=F("alignCorners",n,t,e),i=F("halfPixelCenters",n,t,e);return[bc.resizeBilinear(r,[o[0],o[1]],s,i)]}case"ResizeNearestNeighbor":{let r=F("images",n,t,e),o=F("size",n,t,e),s=F("alignCorners",n,t,e),i=F("halfPixelCenters",n,t,e);return[bc.resizeNearestNeighbor(r,[o[0],o[1]],s,i)]}case"CropAndResize":{let r=F("image",n,t,e),o=F("boxes",n,t,e),s=F("boxInd",n,t,e),i=F("cropSize",n,t,e),a=F("method",n,t,e),c=F("extrapolationValue",n,t,e);return[bc.cropAndResize(r,o,s,i,a,c)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}}});var Dte,kte=b(()=>{"use strict";Us();lo();Dte=(n,t,e)=>{switch(n.op){case"Equal":return[bs(F("a",n,t,e),F("b",n,t,e))];case"NotEqual":return[Zs(F("a",n,t,e),F("b",n,t,e))];case"Greater":return[Fr(F("a",n,t,e),F("b",n,t,e))];case"GreaterEqual":return[Yo(F("a",n,t,e),F("b",n,t,e))];case"Less":return[cl(F("a",n,t,e),F("b",n,t,e))];case"LessEqual":return[Rs(F("a",n,t,e),F("b",n,t,e))];case"LogicalAnd":return[vo(F("a",n,t,e),F("b",n,t,e))];case"LogicalNot":return[ul(F("a",n,t,e))];case"LogicalOr":return[kf(F("a",n,t,e),F("b",n,t,e))];case"Select":case"SelectV2":return[pr(F("condition",n,t,e),F("a",n,t,e),F("b",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}}});var Ate,Ote=b(()=>{"use strict";Us();lo();Ate=(n,t,e)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[an(F("a",n,t,e),F("b",n,t,e),F("transposeA",n,t,e),F("transposeB",n,t,e))];case"Transpose":return[pn(F("x",n,t,e),F("perm",n,t,e))];case"_FusedMatMul":let[r,o]=F("fusedOps",n,t,e),s=r==="biasadd",i=o==="prelu",a=F("numArgs",n,t,e),c=F("leakyreluAlpha",n,t,e);if(s){if(i&&a!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&a!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}let[l,p]=F("args",n,t,e);return[Gi.matMul({a:F("a",n,t,e),b:F("b",n,t,e),transposeA:F("transposeA",n,t,e),transposeB:F("transposeB",n,t,e),bias:l,activation:o,preluActivationWeights:p,leakyreluAlpha:c})];default:throw TypeError(`Node type ${n.op} is not implemented`)}}});var Mte,Rte=b(()=>{"use strict";Us();lo();Mte=(n,t,e)=>{switch(n.op){case"FusedBatchNorm":case"FusedBatchNormV2":return[Ui(F("x",n,t,e),F("mean",n,t,e),F("variance",n,t,e),F("offset",n,t,e),F("scale",n,t,e),F("epsilon",n,t,e))];case"FusedBatchNormV3":return[Ui(F("x",n,t,e),F("mean",n,t,e),F("variance",n,t,e),F("offset",n,t,e),F("scale",n,t,e),F("epsilon",n,t,e))];case"LRN":return[rv(F("x",n,t,e),F("radius",n,t,e),F("bias",n,t,e),F("alpha",n,t,e),F("beta",n,t,e))];case"Softmax":return[fl(F("x",n,t,e))];case"LogSoftmax":return[Df(F("x",n,t,e))];case"SparseToDense":return[O0(F("sparseIndices",n,t,e),F("outputShape",n,t,e),F("sparseValues",n,t,e),F("defaultValue",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}}});var Pte,Fte=b(()=>{"use strict";Us();lo();Pte=(n,t,e)=>{switch(n.op){case"Max":{let i=F("axis",n,t,e),a=F("keepDims",n,t,e);return[io(F("x",n,t,e),i,a)]}case"Mean":{let i=F("axis",n,t,e),a=F("keepDims",n,t,e);return[Un(F("x",n,t,e),i,a)]}case"Min":{let i=F("axis",n,t,e),a=F("keepDims",n,t,e);return[mc(F("x",n,t,e),i,a)]}case"Sum":{let i=F("axis",n,t,e),a=F("keepDims",n,t,e);return[gt(F("x",n,t,e),i,a)]}case"All":{let i=F("axis",n,t,e),a=F("keepDims",n,t,e);return[vf(F("x",n,t,e),i,a)]}case"Any":{let i=F("axis",n,t,e),a=F("keepDims",n,t,e);return[th(F("x",n,t,e),i,a)]}case"ArgMax":{let i=F("axis",n,t,e);return[nh(F("x",n,t,e),i)]}case"ArgMin":{let i=F("axis",n,t,e);return[Lx(F("x",n,t,e),i)]}case"Prod":{let i=F("axis",n,t,e),a=F("keepDims",n,t,e);return[Mf(F("x",n,t,e),i,a)]}case"Cumsum":{let i=F("axis",n,t,e),a=F("exclusive",n,t,e),c=F("reverse",n,t,e);return[Cf(F("x",n,t,e),i,a,c)]}case"Bincount":let r=F("x",n,t,e),o=F("weights",n,t,e),s=F("size",n,t,e);return[jI(r,o,s)];case"DenseBincount":{let i=F("x",n,t,e),a=F("weights",n,t,e),c=F("size",n,t,e),l=F("binaryOutput",n,t,e);return[e1(i,a,c,l)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}}});var $te,Lte=b(()=>{"use strict";$();Us();lo();$te=(n,t,e)=>{switch(n.op){case"ConcatV2":case"Concat":{let r=F("n",n,t,e),o=F("axis",n,t,e),s=F("tensors",n,t,e);return s=s.slice(0,r),[gn(s,o)]}case"Gather":{let r=F("x",n,t,e),o=F("indices",n,t,e);return[ji(r,Ye(o,"int32"),0)]}case"GatherV2":{let r=F("axis",n,t,e),o=F("batchDims",n,t,e),s=F("x",n,t,e),i=F("indices",n,t,e);return[ji(s,Ye(i,"int32"),r,o)]}case"Reverse":{let r=F("dims",n,t,e),o=[];for(let i=0;i<r.length;i++)r[i]&&o.push(i);let s=F("x",n,t,e);return[$r(s,o)]}case"ReverseV2":{let r=F("axis",n,t,e),o=F("x",n,t,e);return[$r(o,r)]}case"Slice":{let r=F("begin",n,t,e),o=F("size",n,t,e);return[Bt(F("x",n,t,e),r,o)]}case"StridedSlice":{let r=F("begin",n,t,e),o=F("end",n,t,e),s=F("strides",n,t,e),i=F("beginMask",n,t,e),a=F("endMask",n,t,e),c=F("ellipsisMask",n,t,e),l=F("newAxisMask",n,t,e),p=F("shrinkAxisMask",n,t,e),f=F("x",n,t,e);return[bv(f,r,o,s,i,a,c,l,p)]}case"Pack":return de(()=>{let r=F("axis",n,t,e),o=F("tensors",n,t,e),s=o[0].shape,i=Js(o[0]).shape,a=o.map(c=>{let l=N.arraysEqual(c.shape,s);if(!l&&!N.arraysEqual(Js(c).shape,i))throw new Error("the input tensors shape does not match");return l?c:ue(c,s)});return[Ir(a,r)]});case"Unpack":{let r=F("axis",n,t,e),o=F("tensor",n,t,e);return uo(o,r)}case"Tile":{let r=F("reps",n,t,e);return[Ci(F("x",n,t,e),r)]}case"Split":case"SplitV":{let r=F("axis",n,t,e),o=F("numOrSizeSplits",n,t,e),s=F("x",n,t,e);return co(s,o,r)}case"ScatterNd":{let r=F("indices",n,t,e),o=F("values",n,t,e),s=F("shape",n,t,e);return[gP(r,o,s)]}case"GatherNd":{let r=F("x",n,t,e),o=F("indices",n,t,e);return[yP(r,o)]}case"SparseToDense":{let r=F("sparseIndices",n,t,e),o=F("outputShape",n,t,e),s=F("sparseValues",n,t,e),i=F("defaultValue",n,t,e);return[O0(r,s,o,s.dtype===i.dtype?i:Ye(i,s.dtype))]}default:throw TypeError(`Node type ${n.op} is not implemented`)}}});var zte,Bte=b(()=>{"use strict";Us();lo();zte=(n,t,e)=>{switch(n.op){case"FFT":return[dl(F("x",n,t,e))];case"IFFT":return[gc(F("x",n,t,e))];case"RFFT":return[ml(F("x",n,t,e))];case"IRFFT":return[zf(F("x",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}}});var Vte,qte=b(()=>{"use strict";Us();lo();Vte=(n,t,e)=>{switch(n.op){case"Cast":return[Ye(F("x",n,t,e),F("dtype",n,t,e))];case"ExpandDims":{let r=F("axis",n,t,e);return[Io(F("x",n,t,e),r)]}case"Squeeze":{let r=F("axis",n,t,e);return[Js(F("x",n,t,e),r)]}case"Reshape":return[ue(F("x",n,t,e),F("shape",n,t,e))];case"MirrorPad":return[uv(F("x",n,t,e),F("padding",n,t,e),F("mode",n,t,e))];case"PadV2":case"Pad":return[Jo(F("x",n,t,e),F("padding",n,t,e),F("constantValue",n,t,e))];case"SpaceToBatchND":{let r=F("blockShape",n,t,e),o=F("paddings",n,t,e);return[pl(F("x",n,t,e),r,o)]}case"BatchToSpaceND":{let r=F("blockShape",n,t,e),o=F("crops",n,t,e);return[nl(F("x",n,t,e),r,o)]}case"DepthToSpace":{let r=F("blockSize",n,t,e),o=F("dataFormat",n,t,e).toUpperCase();return[Qx(F("x",n,t,e),r,o)]}case"BroadcastTo":return[rh(F("x",n,t,e),F("shape",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}}});function aL(n,t,e,r){let o=((s,i,a)=>{switch(s.category){case"arithmetic":return de(()=>tte(s,i,a));case"basic_math":return de(()=>rte(s,i,a));case"control":return pte(s,i,a);case"convolution":return de(()=>dte(s,i,a));case"creation":return de(()=>gte(s,i,a));case"dynamic":return xte(s,i,a);case"evaluation":return de(()=>bte(s,i,a));case"image":return de(()=>Ete(s,i,a));case"graph":return de(()=>Ste(s,i,a));case"logical":return de(()=>Dte(s,i,a));case"matrices":return de(()=>Ate(s,i,a));case"normalization":return de(()=>Mte(s,i,a));case"reduction":return de(()=>Pte(s,i,a));case"slice_join":return de(()=>$te(s,i,a));case"spectral":return de(()=>zte(s,i,a));case"transformation":return de(()=>Vte(s,i,a));case"hash_table":return Tte(s,i,a,r);case"custom":let c=JE(s.op);if(c&&c.customExecutor)return c.customExecutor(new hN(s,i,a));throw TypeError(`Custom op ${s.op} is not registered.`);default:throw TypeError(`Unknown op '${s.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,t,e);return N.isPromise(o)?o.then(s=>[].concat(s)):[].concat(o)}var Ute=b(()=>{"use strict";$();ete();eN();nte();ote();hte();mte();yte();vte();wte();Cte();Ite();Nte();kte();Ote();Rte();Fte();Lte();Bte();qte();});var bS,jte=b(()=>{"use strict";bS=class{constructor(t={},e={},r={},o={}){this.weightMap=t,this.tensorArrayMap=e,this.tensorListMap=r,this.functionMap=o,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,e){return{id:t,frameName:e,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){let t=[];for(let e=0;e<this.contexts.length-1;e++){let r=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(r))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(e=>e.id===0&&e.iterationId===0?"":`${e.frameName}-${e.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;let t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(let e in this.tensorArrayMap)this.tensorArrayMap[e].clearAndClose(t);for(let e in this.tensorListMap)this.tensorListMap[e].clearAndClose(t)}}});function cL(n,t,e,r){let o=new Set,s=[],i=null,a=null,c=new Set,l=Object.keys(n).map(y=>qs(y)[0]),p=[];r!=null&&(p=r.map(y=>qs(y.name)[0]));let f=[...t];for(;f.length>0;){let y=f.pop();if((uL(y)||Y2e(y)||Z2e(y))&&i==null&&(i=y,a=i.children.map(d=>d.name).filter(d=>o.has(d))),o.add(y.name),e[y.name]==null&&l.indexOf(y.name)===-1&&p.indexOf(y.name)===-1){if(y.inputs.length===0){s.push(y.name);continue}y.inputs.forEach(d=>{c.has(d.name)||(c.add(d.name),f.push(d))})}}return{inputs:n,outputs:t,usedNodes:o,missingInputs:s,dynamicNode:i,syncInputs:a}}function Gte(n,t,e){let{usedNodes:r,inputs:o}=e,s=[],i=Object.keys(o).map(p=>qs(p)[0]).map(p=>n.nodes[p]),a=n.initNodes;i.forEach(p=>{r.has(p.name)&&s.push(p)}),n.weights.forEach(p=>{r.has(p.name)&&s.push(p)}),a?.forEach(p=>{r.has(p.name)&&s.push(p)});let c=new Set,l=[];for(;s.length>0;){let p=s.pop();c.add(p.name),t[p.name]||l.push(p),p.children.forEach(f=>{!c.has(f.name)&&r.has(f.name)&&f.inputs.every(y=>c.has(y.name))&&s.push(f)})}return l}function uL(n){return K2e.indexOf(n.op)>=0}function Y2e(n){return X2e.indexOf(n.op)>=0}function Z2e(n){return Q2e.indexOf(n.op)>=0}var K2e,X2e,Q2e,Wte=b(()=>{"use strict";lo();K2e=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],X2e=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],Q2e=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2"]});var wS,Hte=b(()=>{"use strict";$();lo();Ute();jte();Wte();wS=class n{constructor(t,e){this.graph=t,this.parent=e,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,t.functions!=null&&Object.keys(t.functions).forEach(r=>{this._functionExecutorMap[r]=new n(t.functions[r],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){let e=Object.keys(t).map(r=>t[r].map(o=>o.id));this._weightIds=[].concat(...e),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{let e=t.signatureKey||t.name;return t.defaultOutput?`${e}:${t.defaultOutput}`:e})}get functions(){return Object.keys(this._functions).reduce((t,e)=>(t[e]=this._functions[e].signature,t),{})}getCompilationKey(t,e){let r=t.map(s=>s.name).sort(),o=e.map(s=>s.name).sort();return r.join(this.SEPERATOR)+"--"+o.join(this.SEPERATOR)}compile(t,e){let r=cL(t,e,this.weightMap,this._initNodes),{missingInputs:o,dynamicNode:s,syncInputs:i}=r;if(s!=null)throw new Error(`This execution contains the node '${s.name}', which has the dynamic op '${s.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(o.length>0){let a=e.map(l=>l.name),c=Object.keys(t);throw new Error(`Cannot compute the outputs [${a}] from the provided inputs [${c}]. Missing the following inputs: [${o}]`)}return Gte(this.graph,this.weightMap,r)}execute(t,e){t=this.mapInputs(t);let r=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);let o=r.map(f=>this.graph.nodes[qs(f)[0]]),s=e.map(f=>qs(f)[0]),i=s.map(f=>this.graph.nodes[f]);i.length===0&&(i=this._outputs);let a=this.getCompilationKey(o,i),c=this.compiledMap.get(a);c==null&&(c=this.compile(t,i),this.compiledMap.set(a,c));let l={},p={};return de(()=>{let f=new bS(this.weightMap,l,p,this.functionExecutorMap),y=Object.assign({},this.weightMap);Object.keys(t).forEach(m=>{let[x,w]=qs(m),_=[];_[w]=t[m],y[x]=_});let d=this.getFrozenTensorIds(y),h={};for(let m=0;m<c.length;m++){let x=c[m];if(!y[x.name]){let w=aL(x,y,f,this._resourceManager);if(N.isPromise(w))throw new Error(`The execution of the op '${x.op}' returned a promise. Please use model.executeAsync() instead.`);y[x.name]=w,this.checkTensorForDisposal(x.name,x,y,f,d,s,h)}}return this.parent==null&&f.dispose(d),e.map(m=>Do(m,y,f))})}getFrozenTensorIds(t){let e=[].concat.apply([],Object.keys(t).map(r=>t[r]).map(r=>r.map(o=>o.id)));return new Set(e)}checkTensorForDisposal(t,e,r,o,s,i,a){e.category==="control"||i.indexOf(t)!==-1||(r[t].forEach(c=>{c!=null&&(a[c.id]=(a[c.id]||0)+e.children.length)}),e.inputs.forEach(c=>{if(c.category!=="control"){let l=Mee(c.name,r,o);l?.forEach(p=>{if(p&&!s.has(p.id)){let f=a[p.id];f===1?(p.dispose(),delete a[p.id]):f!=null&&a[p.id]--}})}}))}executeAsync(t,e){return Y(this,null,function*(){return this._executeAsync(t,e)})}_executeAsync(i,a){return Y(this,arguments,function*(t,e,r=!1,o={},s={}){r||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e));let c=new bS(this.weightMap,o,s,this.functionExecutorMap),l=yield this.executeWithControlFlow(t,c,e,r),p=e.map(h=>Do(h,l,c)),f=p.map(h=>h.id),y=Object.keys(t).map(h=>t[h].id),d=new Set([...f,...y,...this.weightIds]);return Object.keys(l).forEach(h=>{l[h].forEach(x=>{x&&!x.isDisposed&&!d.has(x.id)&&x.dispose()})}),this.parent==null&&c.dispose(d),p})}executeFunctionAsync(t,e,r){return Y(this,null,function*(){let o=t.reduce((s,i,a)=>(s[this.inputs[a].name]=i,s),{});return this._executeAsync(o,this.outputNodes,!0,e,r)})}executeWithControlFlow(t,e,r,o){return Y(this,null,function*(){let s=Object.keys(t),i=s.map(I=>this.graph.nodes[qs(I)[0]]),a=r.map(I=>qs(I)[0]),c=a.map(I=>this.graph.nodes[I]);c.length===0&&(c=this._outputs);let{usedNodes:l,missingInputs:p,dynamicNode:f,syncInputs:y}=cL(t,c,this.weightMap,this._initNodes),d=[...i,...this.graph.weights,...this._initNodes||[]].map(I=>({node:I,contexts:e.currentContext})),h=Object.assign({},this.weightMap);Object.keys(t).forEach(I=>{let[T,D]=qs(I),O=[];O[D]=t[I],h[T]=O});let m={},x=this.getFrozenTensorIds(h),w={};for(;d.length>0;){let I=this.processStack(i,d,e,h,w,x,a,m,l);yield Promise.all(I)}f==null&&!o&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");let _=c.filter(I=>!uL(I)&&!Do(I.name,h,e)).map(I=>I.name);if(_.length>0){let I="";throw f!=null&&(I=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${y}]`),new Error(`Cannot compute the outputs [${_}] from the provided inputs [${s}]. Consider providing the following inputs: [${p}]. ${I}`)}return h})}processStack(t,e,r,o,s,i,a,c,l){let p=[];for(;e.length>0;){let f=e.pop();r.currentContext=f.contexts;let y="";if(f.node.op==="Enter"&&F("isConstant",f.node,o,r)&&([y]=Dc(f.node.name,r)),o[f.node.name]==null){let d=aL(f.node,o,r,this._resourceManager);y||([y]=Dc(f.node.name,r));let h=r.currentContext;N.isPromise(d)?p.push(d.then(m=>(o[y]=m,r.currentContext=h,this.checkTensorForDisposal(y,f.node,o,r,i,a,c),this.processChildNodes(f.node,e,r,o,s,l),m))):(o[y]=d,this.checkTensorForDisposal(y,f.node,o,r,i,a,c),this.processChildNodes(f.node,e,r,o,s,l))}else this.processChildNodes(f.node,e,r,o,s,l)}return p}processChildNodes(t,e,r,o,s,i){t.children.forEach(a=>{let[c]=Dc(a.name,r);s[c]||!i.has(a.name)||(a.op==="Merge"?a.inputNames.some(l=>!!Do(l,o,r))&&(s[c]=!0,e.push({contexts:r.currentContext,node:a})):a.inputNames.every(l=>!!Do(l,o,r))&&(s[c]=!0,e.push({contexts:r.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(e=>e.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(e=>{let r=t[e],[o]=qs(e),s=this.graph.nodes[o];if(s.attrParams.shape&&s.attrParams.shape.value){let i=s.attrParams.shape.value,a=i.length===r.shape.length&&r.shape.every((c,l)=>i[l]===-1||i[l]===c);N.assert(a,()=>`The shape of dict['${s.name}'] provided in model.execute(dict) must be [${i}], but was [${r.shape}]`)}s.attrParams.dtype&&s.attrParams.dtype.value&&N.assert(r.dtype===s.attrParams.dtype.value,()=>`The dtype of dict['${s.name}'] provided in model.execute(dict) must be ${s.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(t){let e={};for(let r in t)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[r]!=null){let o=this._signature.inputs[r];e[o.name]=t[r]}else e[r]=t[r];return e}checkInputs(t){let e=Object.keys(t).filter(r=>{let[o]=qs(r);return this.graph.nodes[o]==null});if(e.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${e}] that are not part of graph`)}mapOutputs(t){return t.map(e=>this._signature!=null&&this._signature.outputs!=null&&this._signature.outputs[e]!=null?this._signature.outputs[e].name:e,{})}checkOutputs(t){t.forEach(e=>{let[r]=qs(e);if(!this.graph.nodes[r])throw new Error(`The output '${e}' is not found in the graph`)})}}});var mN,Kte=b(()=>{"use strict";mN=class{constructor(t={},e={}){this.hashTableNameToHandle=t,this.hashTableMap=e}addHashTable(t,e){this.hashTableNameToHandle[t]=e.handle,this.hashTableMap[e.id]=e}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(let t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(let t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}});function Xte(e){return Y(this,arguments,function*(n,t={}){if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");t==null&&(t={}),t.fromTFHub&&n.load==null&&(n.endsWith("/")||(n=n+"/"),n=`${n}${ePe}${J2e}`);let r=new SS(n,t);return yield r.load(),r})}var J2e,ePe,SS,Qte=b(()=>{"use strict";$();oL();Hte();Kte();J2e="?tfjs-format=file",ePe="model.json",SS=class{constructor(t,e={}){this.modelUrl=t,this.loadOptions=e,this.version="n/a",e==null&&(this.loadOptions={}),this.resourceManager=new mN}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}findIOHandler(){let t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=Po.browserHTTPRequest(t,this.loadOptions);else{let e=Po.getLoadHandlers(t,this.loadOptions);if(e.length===0)e.push(Po.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error(`Found more than one (${e.length}) load handlers for URL '${[t]}'`);this.handler=e[0]}}load(){return Y(this,null,function*(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let t=yield this.handler.load();return this.loadSync(t)})}loadSync(t){this.artifacts=t;let e=this.artifacts.modelTopology,r;this.artifacts.userDefinedMetadata!=null&&this.artifacts.userDefinedMetadata.signature!=null?r=this.artifacts.userDefinedMetadata.signature:r=this.artifacts.signature,this.signature=r,this.version=`${e.versions.producer}.${e.versions.minConsumer}`;let o=Po.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new wS(vS.Instance.transformGraph(e,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(o),this.executor.resourceManager=this.resourceManager,t.modelInitializer!=null&&t.modelInitializer.node!=null){let s=vS.Instance.transformGraph(t.modelInitializer);this.initializer=new wS(s),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}save(t,e){return Y(this,null,function*(){if(typeof t=="string"){let r=Po.getSaveHandlers(t);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${t}'`);t=r[0]}if(t.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)})}predict(t,e){return this.execute(t,this.outputNodes)}normalizeInputs(t){if(!(t instanceof K)&&!Array.isArray(t))return t;if(t=Array.isArray(t)?t:[t],t.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${t.length} input tensors.`);return this.inputNodes.reduce((e,r,o)=>(e[r]=t[o],e),{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}execute(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);let r=this.executor.execute(t,e);return r.length>1?r:r[0]}executeAsync(t,e){return Y(this,null,function*(){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);let r=yield this.executor.executeAsync(t,e);return r.length>1?r:r[0]})}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((e,r)=>(e[r]=[t[r]],e),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}});var gN,Yte=b(()=>{"use strict";gN="2.8.6"});var lL=b(()=>{"use strict";Qte();eN();Yte();});var Jte=Pn((Zte,pL)=>{"use strict";(function(n,t,e){function r(a){var c=this,l=i();c.next=function(){var p=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=p-(c.c=p|0)},c.c=1,c.s0=l(" "),c.s1=l(" "),c.s2=l(" "),c.s0-=l(a),c.s0<0&&(c.s0+=1),c.s1-=l(a),c.s1<0&&(c.s1+=1),c.s2-=l(a),c.s2<0&&(c.s2+=1),l=null}function o(a,c){return c.c=a.c,c.s0=a.s0,c.s1=a.s1,c.s2=a.s2,c}function s(a,c){var l=new r(a),p=c&&c.state,f=l.next;return f.int32=function(){return l.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,p&&(typeof p=="object"&&o(p,l),f.state=function(){return o(l,{})}),f}function i(){var a=4022871197,c=function(l){l=l.toString();for(var p=0;p<l.length;p++){a+=l.charCodeAt(p);var f=.02519603282416938*a;a=f>>>0,f-=a,f*=a,a=f>>>0,f-=a,a+=f*4294967296}return(a>>>0)*23283064365386963e-26};return c}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.alea=s})(Zte,typeof pL=="object"&&pL,typeof define=="function"&&define)});var tne=Pn((ene,hL)=>{"use strict";(function(n,t,e){function r(i){var a=this,c="";a.x=0,a.y=0,a.z=0,a.w=0,a.next=function(){var p=a.x^a.x<<11;return a.x=a.y,a.y=a.z,a.z=a.w,a.w^=a.w>>>19^p^p>>>8},i===(i|0)?a.x=i:c+=i;for(var l=0;l<c.length+64;l++)a.x^=c.charCodeAt(l)|0,a.next()}function o(i,a){return a.x=i.x,a.y=i.y,a.z=i.z,a.w=i.w,a}function s(i,a){var c=new r(i),l=a&&a.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,y=(c.next()>>>0)/4294967296,d=(f+y)/(1<<21);while(d===0);return d},p.int32=c.next,p.quick=p,l&&(typeof l=="object"&&o(l,c),p.state=function(){return o(c,{})}),p}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.xor128=s})(ene,typeof hL=="object"&&hL,typeof define=="function"&&define)});var rne=Pn((nne,fL)=>{"use strict";(function(n,t,e){function r(i){var a=this,c="";a.next=function(){var p=a.x^a.x>>>2;return a.x=a.y,a.y=a.z,a.z=a.w,a.w=a.v,(a.d=a.d+362437|0)+(a.v=a.v^a.v<<4^(p^p<<1))|0},a.x=0,a.y=0,a.z=0,a.w=0,a.v=0,i===(i|0)?a.x=i:c+=i;for(var l=0;l<c.length+64;l++)a.x^=c.charCodeAt(l)|0,l==c.length&&(a.d=a.x<<10^a.x>>>4),a.next()}function o(i,a){return a.x=i.x,a.y=i.y,a.z=i.z,a.w=i.w,a.v=i.v,a.d=i.d,a}function s(i,a){var c=new r(i),l=a&&a.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,y=(c.next()>>>0)/4294967296,d=(f+y)/(1<<21);while(d===0);return d},p.int32=c.next,p.quick=p,l&&(typeof l=="object"&&o(l,c),p.state=function(){return o(c,{})}),p}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.xorwow=s})(nne,typeof fL=="object"&&fL,typeof define=="function"&&define)});var sne=Pn((one,dL)=>{"use strict";(function(n,t,e){function r(i){var a=this;a.next=function(){var l=a.x,p=a.i,f,y,d;return f=l[p],f^=f>>>7,y=f^f<<24,f=l[p+1&7],y^=f^f>>>10,f=l[p+3&7],y^=f^f>>>3,f=l[p+4&7],y^=f^f<<7,f=l[p+7&7],f=f^f<<13,y^=f^f<<9,l[p]=y,a.i=p+1&7,y};function c(l,p){var f,y,d=[];if(p===(p|0))y=d[0]=p;else for(p=""+p,f=0;f<p.length;++f)d[f&7]=d[f&7]<<15^p.charCodeAt(f)+d[f+1&7]<<13;for(;d.length<8;)d.push(0);for(f=0;f<8&&d[f]===0;++f);for(f==8?y=d[7]=-1:y=d[f],l.x=d,l.i=0,f=256;f>0;--f)l.next()}c(a,i)}function o(i,a){return a.x=i.x.slice(),a.i=i.i,a}function s(i,a){i==null&&(i=+new Date);var c=new r(i),l=a&&a.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,y=(c.next()>>>0)/4294967296,d=(f+y)/(1<<21);while(d===0);return d},p.int32=c.next,p.quick=p,l&&(l.x&&o(l,c),p.state=function(){return o(c,{})}),p}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.xorshift7=s})(one,typeof dL=="object"&&dL,typeof define=="function"&&define)});var ane=Pn((ine,mL)=>{"use strict";(function(n,t,e){function r(i){var a=this;a.next=function(){var l=a.w,p=a.X,f=a.i,y,d;return a.w=l=l+1640531527|0,d=p[f+34&127],y=p[f=f+1&127],d^=d<<13,y^=y<<17,d^=d>>>15,y^=y>>>12,d=p[f]=d^y,a.i=f,d+(l^l>>>16)|0};function c(l,p){var f,y,d,h,m,x=[],w=128;for(p===(p|0)?(y=p,p=null):(p=p+"\0",y=0,w=Math.max(w,p.length)),d=0,h=-32;h<w;++h)p&&(y^=p.charCodeAt((h+32)%p.length)),h===0&&(m=y),y^=y<<10,y^=y>>>15,y^=y<<4,y^=y>>>13,h>=0&&(m=m+1640531527|0,f=x[h&127]^=y+m,d=f==0?d+1:0);for(d>=128&&(x[(p&&p.length||0)&127]=-1),d=127,h=4*128;h>0;--h)y=x[d+34&127],f=x[d=d+1&127],y^=y<<13,f^=f<<17,y^=y>>>15,f^=f>>>12,x[d]=y^f;l.w=m,l.X=x,l.i=d}c(a,i)}function o(i,a){return a.i=i.i,a.w=i.w,a.X=i.X.slice(),a}function s(i,a){i==null&&(i=+new Date);var c=new r(i),l=a&&a.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,y=(c.next()>>>0)/4294967296,d=(f+y)/(1<<21);while(d===0);return d},p.int32=c.next,p.quick=p,l&&(l.X&&o(l,c),p.state=function(){return o(c,{})}),p}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.xor4096=s})(ine,typeof mL=="object"&&mL,typeof define=="function"&&define)});var une=Pn((cne,gL)=>{"use strict";(function(n,t,e){function r(i){var a=this,c="";a.next=function(){var p=a.b,f=a.c,y=a.d,d=a.a;return p=p<<25^p>>>7^f,f=f-y|0,y=y<<24^y>>>8^d,d=d-p|0,a.b=p=p<<20^p>>>12^f,a.c=f=f-y|0,a.d=y<<16^f>>>16^d,a.a=d-p|0},a.a=0,a.b=0,a.c=-1640531527,a.d=1367130551,i===Math.floor(i)?(a.a=i/4294967296|0,a.b=i|0):c+=i;for(var l=0;l<c.length+20;l++)a.b^=c.charCodeAt(l)|0,a.next()}function o(i,a){return a.a=i.a,a.b=i.b,a.c=i.c,a.d=i.d,a}function s(i,a){var c=new r(i),l=a&&a.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,y=(c.next()>>>0)/4294967296,d=(f+y)/(1<<21);while(d===0);return d},p.int32=c.next,p.quick=p,l&&(typeof l=="object"&&o(l,c),p.state=function(){return o(c,{})}),p}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.tychei=s})(cne,typeof gL=="object"&&gL,typeof define=="function"&&define)});var lne=Pn((F8t,yN)=>{"use strict";(function(n,t){var e=(0,eval)("this"),r=256,o=6,s=52,i="random",a=t.pow(r,o),c=t.pow(2,s),l=c*2,p=r-1,f;function y(I,T,D){var O=[];T=T==!0?{entropy:!0}:T||{};var R=x(m(T.entropy?[I,_(n)]:I??w(),3),O),P=new d(O),j=function(){for(var G=P.g(o),Q=a,ie=0;G<c;)G=(G+ie)*r,Q*=r,ie=P.g(1);for(;G>=l;)G/=2,Q/=2,ie>>>=1;return(G+ie)/Q};return j.int32=function(){return P.g(4)|0},j.quick=function(){return P.g(4)/4294967296},j.double=j,x(_(P.S),n),(T.pass||D||function(G,Q,ie,pe){return pe&&(pe.S&&h(pe,P),G.state=function(){return h(P,{})}),ie?(t[i]=G,Q):G})(j,R,"global"in T?T.global:this==t,T.state)}t["seed"+i]=y;function d(I){var T,D=I.length,O=this,R=0,P=O.i=O.j=0,j=O.S=[];for(D||(I=[D++]);R<r;)j[R]=R++;for(R=0;R<r;R++)j[R]=j[P=p&P+I[R%D]+(T=j[R])],j[P]=T;(O.g=function(G){for(var Q,ie=0,pe=O.i,xe=O.j,ne=O.S;G--;)Q=ne[pe=p&pe+1],ie=ie*r+ne[p&(ne[pe]=ne[xe=p&xe+Q])+(ne[xe]=Q)];return O.i=pe,O.j=xe,ie})(r)}function h(I,T){return T.i=I.i,T.j=I.j,T.S=I.S.slice(),T}function m(I,T){var D=[],O=typeof I,R;if(T&&O=="object")for(R in I)try{D.push(m(I[R],T-1))}catch{}return D.length?D:O=="string"?I:I+"\0"}function x(I,T){for(var D=I+"",O,R=0;R<D.length;)T[p&R]=p&(O^=T[p&R]*19)+D.charCodeAt(R++);return _(T)}function w(){try{var I;return f&&(I=f.randomBytes)?I=I(r):(I=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(I)),_(I)}catch{var T=e.navigator,D=T&&T.plugins;return[+new Date,e,D,e.screen,_(n)]}}function _(I){return String.fromCharCode.apply(0,I)}if(x(t.random(),n),typeof yN=="object"&&yN.exports){yN.exports=y;try{f=C1()}catch{}}else typeof define=="function"&&define.amd&&define(function(){return y})})([],Math)});var yL=Pn(($8t,pne)=>{"use strict";var tPe=Jte(),nPe=tne(),rPe=rne(),oPe=sne(),sPe=ane(),iPe=une(),bg=lne();bg.alea=tPe;bg.xor128=nPe;bg.xorwow=rPe;bg.xorshift7=oPe;bg.xor4096=sPe;bg.tychei=iPe;pne.exports=bg});function hne(n,t){return xN(n,t)}function xN(n,t,e=new Map,r=new Set){if(n==null)return null;if(r.has(n))throw new Error("Circular references are not supported.");if(e.has(n))return e.get(n);let o=t(n);if(o.recurse&&o.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(o.recurse)if(Qf(n)){let s=Array.isArray(n)?[]:{};r.add(n);for(let i in n){let a=n[i],c=xN(a,t,e,r);s[i]=c}return r.delete(n),s}else throw new Error(`Can't recurse into non-iterable type: ${n}`);else return e.set(n,o.value),o.value}function fne(n,t=xL){return dne(n,t)}function dne(n,t,e=new Set){let r=n[0];if(e.has(r))throw new Error("Circular references are not supported.");let o=t(n);if(o.recurse&&o.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(o.recurse)if(Qf(r)){let s=Array.isArray(r)?[]:{};e.add(r);for(let i in r){let a=n.map(l=>l[i]),c=dne(a,t,e);s[i]=c}return e.delete(r),s}else throw new Error(`Can't recurse into non-iterable type: ${r}`);else return o.value}function xL(n){return n===null?null:Qf(n[0])?{value:null,recurse:!0}:{value:n,recurse:!1}}function vN(n,t){return Y(this,null,function*(){let e=new Map;xN(n,t,e);for(let o of Array.from(e.keys())){let s=e.get(o);if(N.isPromise(s)){let i=yield s;e.set(o,i)}}return xN(n,t,e)})}function Qf(n){return n!=null&&!ArrayBuffer.isView(n)&&(Array.isArray(n)||typeof n=="object"&&!(n instanceof K))}function mne(n){return n==null||aPe(n)||Array.isArray(n)||typeof n=="object"&&n instanceof K||N.isTypedArray(n)}function aPe(n){return n===null||typeof n!="object"&&typeof n!="function"}var bN=b(()=>{"use strict";$();});function gne(n){return hne(n,cPe)}function cPe(n){return n instanceof K?{value:n.clone(),recurse:!1}:Qf(n)?{value:null,recurse:!0}:{value:n,recurse:!1}}var yne=b(()=>{"use strict";$();bN();});var Xv,vL=b(()=>{"use strict";Xv=class{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,t==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(let e of t)this.push(e)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);let t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let e=this.wrap(this.begin+t),r=this.get(e);return this.set(e,this.pop()),r}}});var xne,vne=b(()=>{"use strict";vL();xne=(()=>{class n extends Xv{constructor(){super(n.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){let e=this.capacity*2,r=new Array(e),o=this.length();for(let s=0;s<o;s++)r[s]=this.get(this.wrap(this.begin+s));this.data=r,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=o}}return n.INITIAL_CAPACITY=32,n})()});function OL(n){return new bL(n)}function CS(n){return new wL(n)}function wne(n,t){return new SN(n,t)}function Sne(n,t=Yf.FAIL){return new kL(n,t)}var bne,Br,bL,wL,SL,CL,_L,TL,IL,EL,NL,wN,wg,DL,SN,Yf,kL,CN,AL,Sg=b(()=>{"use strict";$();bne=Jb(yL());yne();bN();vne();vL();Br=class{toArray(){return Y(this,null,function*(){let t=[],e=yield this.next();for(;!e.done;)t.push(e.value),e=yield this.next();return t})}toArrayForTest(){return Y(this,null,function*(){let t=this.prefetch(100),e=[],r=yield t.next();for(;!r.done;)e.push(r.value),r=yield t.next();return e})}resolveFully(){return Y(this,null,function*(){let t=yield this.next();for(;!t.done;)t=yield this.next()})}resolveWhile(t){return Y(this,null,function*(){let e=yield this.next(),r=t(e.value);for(;!e.done&&r;)e=yield this.next(),r=t(e.value)})}handleErrors(t){return new NL(this,t)}filter(t){return new IL(this,t)}map(t){return new EL(this,t)}mapAsync(t){return new wN(this,t)}serialMapAsync(t){return new wN(this,t).serial()}flatmap(t){return new DL(this,t)}forEachAsync(t){return Y(this,null,function*(){return this.map(t).resolveFully()})}serialForEach(t){return Y(this,null,function*(){return this.serialMapAsync(t).resolveWhile(e=>e===!0)})}rowMajorBatch(t,e=!0){return new TL(this,t,e)}columnMajorBatch(t,e=!0,r=xL){return this.rowMajorBatch(t,e).map(s=>fne(s,r))}concatenate(t,e){return new SN(OL([this,t]),e)}take(t){return t<0||t==null?this:new _L(this,t)}skip(t){return t<0||t==null?this:new CL(this,t)}prefetch(t){return new CN(this,t)}shuffle(t,e){return new AL(this,t,e)}serial(){return new SL(this)}},bL=class extends Br{constructor(t){super(),this.items=t,this.trav=0}summary(){return`Array of ${this.items.length} items`}next(){return Y(this,null,function*(){if(this.trav>=this.items.length)return{value:null,done:!0};let t=this.items[this.trav];return this.trav++,{value:gne(t),done:!1}})}},wL=class extends Br{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}next(){return Y(this,null,function*(){try{return this.nextFn()}catch(t){throw t.message=`Error thrown while iterating through a dataset: ${t.message}`,t}})}},SL=class extends Br{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}next(){return Y(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return Y(this,null,function*(){return this.upstream.next()})}},CL=class extends Br{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}next(){return Y(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return Y(this,null,function*(){for(;this.count++<this.maxCount;){let t=yield this.upstream.next();if(t.done)return t;Mt(t.value)}return this.upstream.next()})}},_L=class extends Br{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}next(){return Y(this,null,function*(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()})}},TL=class extends Br{constructor(t,e,r=!0){super(),this.upstream=t,this.batchSize=e,this.enableSmallLastBatch=r,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}next(){return Y(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return Y(this,null,function*(){let t=[];for(;t.length<this.batchSize;){let e=yield this.upstream.next();if(e.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(e.value)}return{value:t,done:!1}})}},IL=class extends Br{constructor(t,e){super(),this.upstream=t,this.predicate=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}next(){return Y(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return Y(this,null,function*(){for(;;){let t=yield this.upstream.next();if(t.done||this.predicate(t.value))return t;Mt(t.value)}})}},EL=class extends Br{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return`${this.upstream.summary()} -> Map`}next(){return Y(this,null,function*(){let t=yield this.upstream.next();if(t.done)return{value:null,done:!0};let e=Bi.getTensorsInContainer(t.value),r=this.transform(t.value),o=Bi.getTensorsInContainer(r);for(let s of e)Bi.isTensorInList(s,o)||s.dispose();return{value:r,done:!1}})}},NL=class extends Br{constructor(t,e){super(),this.upstream=t,this.handler=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}next(){return Y(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return Y(this,null,function*(){for(;;)try{return yield this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}})}},wN=class extends Br{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return`${this.upstream.summary()} -> AsyncMap`}next(){return Y(this,null,function*(){let t=yield this.upstream.next();if(t.done)return{value:null,done:!0};let e=Bi.getTensorsInContainer(t.value),r=yield this.transform(t.value),o=Bi.getTensorsInContainer(r);for(let s of e)Bi.isTensorInList(s,o)||s.dispose();return{value:r,done:!1}})}},wg=class extends Br{constructor(){super(),this.outputQueue=new xne,this.lastRead=Promise.resolve({value:null,done:!1})}next(){return Y(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return Y(this,null,function*(){for(;this.outputQueue.length()===0;)if(!(yield this.pump()))return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}})}},DL=class extends wg{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return`${this.upstream.summary()} -> Flatmap`}pump(){return Y(this,null,function*(){let t=yield this.upstream.next();if(t.done)return!1;let e=Bi.getTensorsInContainer(t.value),r=this.transform(t.value),o=Bi.getTensorsInContainer(r);this.outputQueue.pushAll(r);for(let s of e)Bi.isTensorInList(s,o)||s.dispose();return!0})}},SN=class extends Br{constructor(t,e){super(),this.baseErrorHandler=e,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}next(){return Y(this,null,function*(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead})}readFromChain(t){return Y(this,null,function*(){if(yield t,this.iterator==null){let r=yield this.moreIterators.next();if(r.done)return{value:null,done:!0};this.iterator=r.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}let e=yield this.iterator.next();return e.done?(this.iterator=null,this.readFromChain(t)):e})}},Yf=function(n){return n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST",n}(Yf||{}),kL=class extends Br{constructor(t,e=Yf.FAIL){super(),this.iterators=t,this.mismatchMode=e,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}nextState(t){return Y(this,null,function*(){yield t;let e=0,r=0;function o(i){return i instanceof Br?{value:i.next().then(c=>(e++,c.done&&r++,c.value)),recurse:!1}:{value:null,recurse:!0}}let s=yield vN(this.iterators,o);if(e===r)return{value:null,done:!0};if(r>0)switch(this.mismatchMode){case Yf.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case Yf.SHORTEST:return{value:null,done:!0};case Yf.LONGEST:default:}return this.count++,{value:s,done:!1}})}next(){return Y(this,null,function*(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise})}},CN=class extends Br{constructor(t,e){super(),this.upstream=t,this.bufferSize=e,this.buffer=new Xv(e)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){let t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}},AL=class extends CN{constructor(t,e,r){super(t,e),this.upstream=t,this.windowSize=e,this.upstreamExhausted=!1,this.random=bne.alea(r||N.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}next(){return Y(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}serialNext(){return Y(this,null,function*(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){let t=this.chooseIndex(),e=yield this.buffer.shuffleExcise(t);if(e.done)this.upstreamExhausted=!0;else return this.refill(),e}return{value:null,done:!0}})}}});function oi(n,t=null){return new class extends Zf{constructor(){super(...arguments),this.size=t}iterator(){return Y(this,null,function*(){return n()})}}}function _ne(n){return oi(()=>Y(null,null,function*(){return OL(n)}),n.length)}function Tne(n){if(!Qf(n))throw new Error("The argument to zip() must be an object or array.");let t;if(Array.isArray(n))for(let e=0;e<n.length;e++)t=t==null?n[e].size:Math.min(t,n[e].size);else if(n instanceof Object)for(let e in n)t=t==null?n[e].size:Math.min(t,n[e].size);return oi(()=>Y(null,null,function*(){let e=yield vN(n,r=>{if(r instanceof Zf)return{value:r.iterator(),recurse:!1};if(Qf(r))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return Sne(e,Yf.SHORTEST)}),t)}function uPe(n){if(n===null)return null;let t=n[0];return mne(t)?{value:lPe(n),recurse:!1}:{value:null,recurse:!0}}function lPe(n){if(n.length===0)throw new Error("Can't make a batch of zero elements.");return n[0]instanceof K?Ir(n):Qo(n)}var Cne,Zf,_S=b(()=>{"use strict";$();Cne=Jb(yL());Sg();bN();Zf=(()=>{class n{constructor(){this.size=null}batch(e,r=!0){let o=this;N.assert(e>0,()=>`batchSize needs to be positive, but it is
      ${e}`);let s;return this.size===1/0||this.size==null?s=this.size:r?s=Math.ceil(this.size/e):s=Math.floor(this.size/e),oi(()=>Y(this,null,function*(){return(yield o.iterator()).columnMajorBatch(e,r,uPe)}),s)}concatenate(e){let r=this,o;return this.size===1/0||e.size===1/0?o=1/0:this.size!=null&&e.size!=null?o=this.size+e.size:o=null,oi(()=>Y(this,null,function*(){return(yield r.iterator()).concatenate(yield e.iterator())}),o)}filter(e){let r=this,o;return this.size===1/0?o=1/0:o=null,oi(()=>Y(this,null,function*(){return(yield r.iterator()).filter(s=>de(()=>e(s)))}),o)}forEachAsync(e){return Y(this,null,function*(){return(yield this.iterator()).forEachAsync(e)})}map(e){let r=this;return oi(()=>Y(this,null,function*(){return(yield r.iterator()).map(o=>de(()=>e(o)))}),this.size)}mapAsync(e){let r=this;return oi(()=>Y(this,null,function*(){return(yield r.iterator()).mapAsync(e)}),this.size)}prefetch(e){if(e==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");let r=this;return oi(()=>Y(this,null,function*(){return(yield r.iterator()).prefetch(e)}),this.size)}repeat(e){let r=this,o;return this.size!=null&&e>0?o=this.size*e:e===0?o=0:this.size!=null&&(e===void 0||e<0)?o=1/0:o=null,oi(()=>Y(this,null,function*(){let s=CS(()=>Y(this,null,function*(){return{value:yield r.iterator(),done:!1}}));return wne(s.take(e))}),o)}skip(e){let r=this,o;return this.size!=null&&e>=0&&this.size>=e?o=this.size-e:this.size!=null&&(this.size<e||e===void 0||e<0)?o=0:o=null,oi(()=>Y(this,null,function*(){return(yield r.iterator()).skip(e)}),o)}shuffle(e,r,o=!0){if(e==null||e<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);let s=this,i=Cne.alea(r||N.now().toString());return oi(()=>Y(this,null,function*(){let a=i.int32();return o&&(a+=i.int32()),(yield s.iterator()).shuffle(e,a.toString())}),this.size)}take(e){let r=this,o;return this.size!=null&&this.size>e?o=e:this.size!=null&&this.size<=e?o=this.size:o=null,oi(()=>Y(this,null,function*(){return(yield r.iterator()).take(e)}),o)}toArray(){return Y(this,null,function*(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(yield this.iterator()).toArray()})}toArrayForTest(){return Y(this,null,function*(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(yield this.iterator()).toArrayForTest()})}}return n.MAX_BUFFER_SIZE=1e4,n})()});var Qv,ML=b(()=>{"use strict";_S();Qv=class extends Zf{constructor(t){super(),this.input=t}iterator(){return Y(this,null,function*(){return(yield this.input.iterator()).decodeUTF8().split(`
`).map(o=>(o.endsWith("\r")&&(o=o.slice(0,-1)),o))})}}});var _N,TS,Ine,TN,RL,Ene,Yv,PL=b(()=>{"use strict";$();_S();ML();_N='"',TS=Symbol("out"),Ine=Symbol("field"),TN=Symbol("quote"),RL=Symbol("quoteafterquote"),Ene=Symbol("quoteinquote"),Yv=class extends Zf{constructor(t,e){super(),this.input=t,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new Qv(t),e||(e={}),this.hasHeader=e.hasHeader!==!1,this.fullColumnNames=e.columnNames,this.columnConfigs=e.columnConfigs,this.configuredColumnsOnly=e.configuredColumnsOnly,e.delimWhitespace?(N.assert(e.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=e.delimiter?e.delimiter:","}columnNames(){return Y(this,null,function*(){return this.columnNamesValidated||(yield this.setColumnNames()),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames})}setColumnNames(){return Y(this,null,function*(){let t=yield this.maybeReadHeaderLine();if(!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&t&&N.assert(t.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=t);let e=this.fullColumnNames.reduce((o,s)=>(o[s]=o[s]+1||1,o),{}),r=Object.keys(e).filter(o=>e[o]>1);if(N.assert(r.length===0,()=>"Duplicate column names found: "+r.toString()),this.columnConfigs){for(let o of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(o)===-1)throw new Error('The key "'+o+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0})}maybeReadHeaderLine(){return Y(this,null,function*(){if(this.hasHeader){let e=yield(yield this.base.iterator()).next();if(e.done)throw new Error("No data was found for CSV parsing.");let r=e.value;return this.parseRow(r,!1)}else return null})}iterator(){return Y(this,null,function*(){this.columnNamesValidated||(yield this.setColumnNames());let t=yield this.base.iterator();return this.hasHeader&&(t=t.skip(1)),t.map(e=>this.makeDataElement(e))})}makeDataElement(t){let e=this.parseRow(t),r={},o={};for(let s=0;s<this.fullColumnNames.length;s++){let i=this.fullColumnNames[s],a=this.columnConfigs?this.columnConfigs[i]:null;if(!(this.configuredColumnsOnly&&!a)){let c=e[s],l=null;if(c==="")if(a&&a.default!==void 0)l=a.default;else{if(a&&(a.required||a.isLabel))throw new Error(`Required column ${i} is empty in this line: ${t}`);l=void 0}else{let p=Number(c);if(isNaN(p))a&&a.dtype==="bool"?l=this.getBoolean(c):l=c;else if(!a||!a.dtype)l=p;else switch(a.dtype){case"float32":l=p;break;case"int32":l=Math.floor(p);break;case"bool":l=this.getBoolean(c);break;default:l=p}}a&&a.isLabel?o[i]=l:r[i]=l}}return Object.keys(o).length===0?r:{xs:r,ys:o}}getBoolean(t){return t==="1"||t.toLowerCase()==="true"?1:0}parseRow(t,e=!0){let r=[],o=0,s=t.length,i=TS;for(let a=0;a<s;a++)switch(i){case TS:switch(t.charAt(a)){case _N:o=a+1,i=TN;break;case this.delimiter:if(o=a+1,this.delimiter===" "&&this.delimWhitespace)break;r.push(""),i=TS;break;default:i=Ine,o=a;break}break;case Ine:switch(t.charAt(a)){case this.delimiter:r.push(t.substring(o,a)),i=TS,o=a+1;break;default:}break;case TN:switch(t.charAt(a)){case _N:i=RL;break;default:}break;case RL:switch(t.charAt(a)){case this.delimiter:r.push(t.substring(o,a-1)),i=TS,o=a+1;break;case _N:i=TN;break;default:i=Ene;break}break;case Ene:switch(t.charAt(a)){case _N:i=TN;break;default:}break;default:}if(i===RL?r.push(t.substring(o,s-1)):r.push(t.substring(o)),e&&r.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${r}`);return r}}});var IN,Nne=b(()=>{"use strict";$();Sg();IN=class n extends Br{constructor(t){super(),this.microphoneConfig=t,this.isClosed=!1,this.fftSize=t.fftSize||1024;let e=Math.log2(this.fftSize);if(this.fftSize<0||e<4||e>14||!Number.isInteger(e))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=t.numFramesPerSpectrogram||43,this.sampleRateHz=t.sampleRateHz,this.columnTruncateLength=t.columnTruncateLength||this.fftSize,this.audioTrackConstraints=t.audioTrackConstraints,this.smoothingTimeConstant=t.smoothingTimeConstant||0,this.includeSpectrogram=t.includeSpectrogram!==!1,this.includeWaveform=t.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static create(){return Y(this,arguments,function*(t={}){if(Te().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");let e=new n(t);return yield e.start(),e})}start(){return Y(this,null,function*(){try{this.stream=yield navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null?!0:this.audioTrackConstraints,video:!1})}catch(r){throw new Error(`Error thrown while initializing video stream: ${r.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");let t=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new t,!this.sampleRateHz)this.sampleRateHz=this.audioContext.sampleRate;else if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`);let e=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=this.fftSize*2,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,e.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)})}next(){return Y(this,null,function*(){if(this.isClosed)return{value:null,done:!0};let t,e,r=yield this.getAudioData();if(this.includeSpectrogram){let o=this.flattenQueue(r.freqDataQueue);t=this.getTensorFromAudioDataArray(o,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){let o=this.flattenQueue(r.timeDataQueue);e=this.getTensorFromAudioDataArray(o,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:t,waveform:e},done:!1}})}capture(){return Y(this,null,function*(){return(yield this.next()).value})}getAudioData(){return Y(this,null,function*(){let t=[],e=[],r=0;return new Promise(o=>{let s=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&o({freqDataQueue:t,timeDataQueue:e}),t.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),e.push(this.timeData.slice())),++r===this.numFrames&&(clearInterval(s),o({freqDataQueue:t,timeDataQueue:e}))},this.fftSize/this.sampleRateHz*1e3)})})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(t){let e=t[0].length,r=new Float32Array(t.length*e);return t.forEach((o,s)=>r.set(o,s*e)),r}getTensorFromAudioDataArray(t,e){let r=new Float32Array(N.sizeFromShape(e));return r.set(t,r.length-t.length),Qo(r,e)}}});var EN,Dne=b(()=>{"use strict";$();Sg();EN=class n extends Br{constructor(t,e){if(super(),this.webcamVideoElement=t,this.webcamConfig=e,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=Er([0],"int32"),this.webcamConfig.centerCrop){let r=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,o=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,s=(1-r)/2,i=(1-o)/2,a=s+r,c=o+i;this.cropBox=xc([i,s,c,a],[1,4])}else this.cropBox=xc([0,0,1,1],[1,4])}summary(){return"webcam"}static create(r){return Y(this,arguments,function*(t,e={}){if(Te().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!e.resizeWidth||!e.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=e.resizeWidth,t.height=e.resizeHeight}let o=new n(t,e);return yield o.start(),o})}start(){return Y(this,null,function*(){this.webcamConfig.facingMode&&N.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=yield navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(t){throw t.message=`Error thrown while initializing video stream: ${t.message}`,t}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(t=>{this.webcamVideoElement.onloadedmetadata=()=>{t()}})})}next(){return Y(this,null,function*(){if(this.isClosed)return{value:null,done:!0};let t;try{t=p0.fromPixels(this.webcamVideoElement)}catch(e){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(e)}`)}if(this.resize)try{return{value:this.cropAndResizeFrame(t),done:!1}}catch(e){throw new Error(`Error thrown cropping the video: ${e.message}`)}finally{t.dispose()}else return{value:t,done:!1}})}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(t){return de(()=>{let e=t.toFloat().expandDims(0),r;r=bc.cropAndResize(e,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");let o=r.shape;return r.reshape(o.slice(1))})}capture(){return Y(this,null,function*(){return(yield this.next()).value})}stop(){this.stream.getTracks().forEach(e=>e.stop());try{this.webcamVideoElement.srcObject=null}catch(e){console.log(e),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}});var Zv,FL=b(()=>{"use strict";Zv=class{}});var IS,$L,LL,kne=b(()=>{"use strict";Sg();IS=class extends Br{split(t){return new $L(this,t)}},$L=class extends IS{constructor(t,e){super(),this.upstream=t,this.impl=new LL(t,e)}summary(){return this.impl.summary()}next(){return Y(this,null,function*(){return this.impl.next()})}},LL=class extends wg{constructor(t,e){super(),this.upstream=t,this.separator=e,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}pump(){return Y(this,null,function*(){let t=yield this.upstream.next();if(t.done)return this.carryover===""?!1:(this.outputQueue.push(this.carryover),this.carryover="",!0);let e=t.value.split(this.separator);e[0]=this.carryover+e[0];for(let r of e.slice(0,-1))this.outputQueue.push(r);return this.carryover=e[e.length-1],!0})}}});var Mne=Pn(NN=>{"use strict";NN.byteLength=hPe;NN.toByteArray=dPe;NN.fromByteArray=yPe;var Il=[],Ma=[],pPe=typeof Uint8Array<"u"?Uint8Array:Array,zL="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Cg=0,Ane=zL.length;Cg<Ane;++Cg)Il[Cg]=zL[Cg],Ma[zL.charCodeAt(Cg)]=Cg;var Cg,Ane;Ma[45]=62;Ma[95]=63;function One(n){var t=n.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=n.indexOf("=");e===-1&&(e=t);var r=e===t?0:4-e%4;return[e,r]}function hPe(n){var t=One(n),e=t[0],r=t[1];return(e+r)*3/4-r}function fPe(n,t,e){return(t+e)*3/4-e}function dPe(n){var t,e=One(n),r=e[0],o=e[1],s=new pPe(fPe(n,r,o)),i=0,a=o>0?r-4:r,c;for(c=0;c<a;c+=4)t=Ma[n.charCodeAt(c)]<<18|Ma[n.charCodeAt(c+1)]<<12|Ma[n.charCodeAt(c+2)]<<6|Ma[n.charCodeAt(c+3)],s[i++]=t>>16&255,s[i++]=t>>8&255,s[i++]=t&255;return o===2&&(t=Ma[n.charCodeAt(c)]<<2|Ma[n.charCodeAt(c+1)]>>4,s[i++]=t&255),o===1&&(t=Ma[n.charCodeAt(c)]<<10|Ma[n.charCodeAt(c+1)]<<4|Ma[n.charCodeAt(c+2)]>>2,s[i++]=t>>8&255,s[i++]=t&255),s}function mPe(n){return Il[n>>18&63]+Il[n>>12&63]+Il[n>>6&63]+Il[n&63]}function gPe(n,t,e){for(var r,o=[],s=t;s<e;s+=3)r=(n[s]<<16&16711680)+(n[s+1]<<8&65280)+(n[s+2]&255),o.push(mPe(r));return o.join("")}function yPe(n){for(var t,e=n.length,r=e%3,o=[],s=16383,i=0,a=e-r;i<a;i+=s)o.push(gPe(n,i,i+s>a?a:i+s));return r===1?(t=n[e-1],o.push(Il[t>>2]+Il[t<<4&63]+"==")):r===2&&(t=(n[e-2]<<8)+n[e-1],o.push(Il[t>>10]+Il[t>>4&63]+Il[t<<2&63]+"=")),o.join("")}});var Rne=Pn(BL=>{"use strict";BL.read=function(n,t,e,r,o){var s,i,a=o*8-r-1,c=(1<<a)-1,l=c>>1,p=-7,f=e?o-1:0,y=e?-1:1,d=n[t+f];for(f+=y,s=d&(1<<-p)-1,d>>=-p,p+=a;p>0;s=s*256+n[t+f],f+=y,p-=8);for(i=s&(1<<-p)-1,s>>=-p,p+=r;p>0;i=i*256+n[t+f],f+=y,p-=8);if(s===0)s=1-l;else{if(s===c)return i?NaN:(d?-1:1)*(1/0);i=i+Math.pow(2,r),s=s-l}return(d?-1:1)*i*Math.pow(2,s-r)};BL.write=function(n,t,e,r,o,s){var i,a,c,l=s*8-o-1,p=(1<<l)-1,f=p>>1,y=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:s-1,h=r?1:-1,m=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,i=p):(i=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-i))<1&&(i--,c*=2),i+f>=1?t+=y/c:t+=y*Math.pow(2,1-f),t*c>=2&&(i++,c/=2),i+f>=p?(a=0,i=p):i+f>=1?(a=(t*c-1)*Math.pow(2,o),i=i+f):(a=t*Math.pow(2,f-1)*Math.pow(2,o),i=0));o>=8;n[e+d]=a&255,d+=h,a/=256,o-=8);for(i=i<<o|a,l+=o;l>0;n[e+d]=i&255,d+=h,i/=256,l-=8);n[e+d-h]|=m*128}});var Hne=Pn(eb=>{"use strict";var VL=Mne(),Jv=Rne(),Pne=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;eb.Buffer=Ze;eb.SlowBuffer=CPe;eb.INSPECT_MAX_BYTES=50;var DN=2147483647;eb.kMaxLength=DN;Ze.TYPED_ARRAY_SUPPORT=xPe();!Ze.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function xPe(){try{var n=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(n,t),n.foo()===42}catch{return!1}}Object.defineProperty(Ze.prototype,"parent",{enumerable:!0,get:function(){if(Ze.isBuffer(this))return this.buffer}});Object.defineProperty(Ze.prototype,"offset",{enumerable:!0,get:function(){if(Ze.isBuffer(this))return this.byteOffset}});function vh(n){if(n>DN)throw new RangeError('The value "'+n+'" is invalid for option "size"');var t=new Uint8Array(n);return Object.setPrototypeOf(t,Ze.prototype),t}function Ze(n,t,e){if(typeof n=="number"){if(typeof t=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return GL(n)}return Lne(n,t,e)}Ze.poolSize=8192;function Lne(n,t,e){if(typeof n=="string")return bPe(n,t);if(ArrayBuffer.isView(n))return wPe(n);if(n==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n);if(El(n,ArrayBuffer)||n&&El(n.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(El(n,SharedArrayBuffer)||n&&El(n.buffer,SharedArrayBuffer)))return UL(n,t,e);if(typeof n=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var r=n.valueOf&&n.valueOf();if(r!=null&&r!==n)return Ze.from(r,t,e);var o=SPe(n);if(o)return o;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof n[Symbol.toPrimitive]=="function")return Ze.from(n[Symbol.toPrimitive]("string"),t,e);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n)}Ze.from=function(n,t,e){return Lne(n,t,e)};Object.setPrototypeOf(Ze.prototype,Uint8Array.prototype);Object.setPrototypeOf(Ze,Uint8Array);function zne(n){if(typeof n!="number")throw new TypeError('"size" argument must be of type number');if(n<0)throw new RangeError('The value "'+n+'" is invalid for option "size"')}function vPe(n,t,e){return zne(n),n<=0?vh(n):t!==void 0?typeof e=="string"?vh(n).fill(t,e):vh(n).fill(t):vh(n)}Ze.alloc=function(n,t,e){return vPe(n,t,e)};function GL(n){return zne(n),vh(n<0?0:WL(n)|0)}Ze.allocUnsafe=function(n){return GL(n)};Ze.allocUnsafeSlow=function(n){return GL(n)};function bPe(n,t){if((typeof t!="string"||t==="")&&(t="utf8"),!Ze.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var e=Bne(n,t)|0,r=vh(e),o=r.write(n,t);return o!==e&&(r=r.slice(0,o)),r}function qL(n){for(var t=n.length<0?0:WL(n.length)|0,e=vh(t),r=0;r<t;r+=1)e[r]=n[r]&255;return e}function wPe(n){if(El(n,Uint8Array)){var t=new Uint8Array(n);return UL(t.buffer,t.byteOffset,t.byteLength)}return qL(n)}function UL(n,t,e){if(t<0||n.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(n.byteLength<t+(e||0))throw new RangeError('"length" is outside of buffer bounds');var r;return t===void 0&&e===void 0?r=new Uint8Array(n):e===void 0?r=new Uint8Array(n,t):r=new Uint8Array(n,t,e),Object.setPrototypeOf(r,Ze.prototype),r}function SPe(n){if(Ze.isBuffer(n)){var t=WL(n.length)|0,e=vh(t);return e.length===0||n.copy(e,0,0,t),e}if(n.length!==void 0)return typeof n.length!="number"||HL(n.length)?vh(0):qL(n);if(n.type==="Buffer"&&Array.isArray(n.data))return qL(n.data)}function WL(n){if(n>=DN)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+DN.toString(16)+" bytes");return n|0}function CPe(n){return+n!=n&&(n=0),Ze.alloc(+n)}Ze.isBuffer=function(t){return t!=null&&t._isBuffer===!0&&t!==Ze.prototype};Ze.compare=function(t,e){if(El(t,Uint8Array)&&(t=Ze.from(t,t.offset,t.byteLength)),El(e,Uint8Array)&&(e=Ze.from(e,e.offset,e.byteLength)),!Ze.isBuffer(t)||!Ze.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,o=e.length,s=0,i=Math.min(r,o);s<i;++s)if(t[s]!==e[s]){r=t[s],o=e[s];break}return r<o?-1:o<r?1:0};Ze.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};Ze.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return Ze.alloc(0);var r;if(e===void 0)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var o=Ze.allocUnsafe(e),s=0;for(r=0;r<t.length;++r){var i=t[r];if(El(i,Uint8Array))s+i.length>o.length?Ze.from(i).copy(o,s):Uint8Array.prototype.set.call(o,i,s);else if(Ze.isBuffer(i))i.copy(o,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=i.length}return o};function Bne(n,t){if(Ze.isBuffer(n))return n.length;if(ArrayBuffer.isView(n)||El(n,ArrayBuffer))return n.byteLength;if(typeof n!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof n);var e=n.length,r=arguments.length>2&&arguments[2]===!0;if(!r&&e===0)return 0;for(var o=!1;;)switch(t){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":return jL(n).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return e*2;case"hex":return e>>>1;case"base64":return Wne(n).length;default:if(o)return r?-1:jL(n).length;t=(""+t).toLowerCase(),o=!0}}Ze.byteLength=Bne;function _Pe(n,t,e){var r=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((e===void 0||e>this.length)&&(e=this.length),e<=0)||(e>>>=0,t>>>=0,e<=t))return"";for(n||(n="utf8");;)switch(n){case"hex":return RPe(this,t,e);case"utf8":case"utf-8":return qne(this,t,e);case"ascii":return OPe(this,t,e);case"latin1":case"binary":return MPe(this,t,e);case"base64":return kPe(this,t,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return PPe(this,t,e);default:if(r)throw new TypeError("Unknown encoding: "+n);n=(n+"").toLowerCase(),r=!0}}Ze.prototype._isBuffer=!0;function _g(n,t,e){var r=n[t];n[t]=n[e],n[e]=r}Ze.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)_g(this,e,e+1);return this};Ze.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)_g(this,e,e+3),_g(this,e+1,e+2);return this};Ze.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)_g(this,e,e+7),_g(this,e+1,e+6),_g(this,e+2,e+5),_g(this,e+3,e+4);return this};Ze.prototype.toString=function(){var t=this.length;return t===0?"":arguments.length===0?qne(this,0,t):_Pe.apply(this,arguments)};Ze.prototype.toLocaleString=Ze.prototype.toString;Ze.prototype.equals=function(t){if(!Ze.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:Ze.compare(this,t)===0};Ze.prototype.inspect=function(){var t="",e=eb.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"};Pne&&(Ze.prototype[Pne]=Ze.prototype.inspect);Ze.prototype.compare=function(t,e,r,o,s){if(El(t,Uint8Array)&&(t=Ze.from(t,t.offset,t.byteLength)),!Ze.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(e===void 0&&(e=0),r===void 0&&(r=t?t.length:0),o===void 0&&(o=0),s===void 0&&(s=this.length),e<0||r>t.length||o<0||s>this.length)throw new RangeError("out of range index");if(o>=s&&e>=r)return 0;if(o>=s)return-1;if(e>=r)return 1;if(e>>>=0,r>>>=0,o>>>=0,s>>>=0,this===t)return 0;for(var i=s-o,a=r-e,c=Math.min(i,a),l=this.slice(o,s),p=t.slice(e,r),f=0;f<c;++f)if(l[f]!==p[f]){i=l[f],a=p[f];break}return i<a?-1:a<i?1:0};function Vne(n,t,e,r,o){if(n.length===0)return-1;if(typeof e=="string"?(r=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,HL(e)&&(e=o?0:n.length-1),e<0&&(e=n.length+e),e>=n.length){if(o)return-1;e=n.length-1}else if(e<0)if(o)e=0;else return-1;if(typeof t=="string"&&(t=Ze.from(t,r)),Ze.isBuffer(t))return t.length===0?-1:Fne(n,t,e,r,o);if(typeof t=="number")return t=t&255,typeof Uint8Array.prototype.indexOf=="function"?o?Uint8Array.prototype.indexOf.call(n,t,e):Uint8Array.prototype.lastIndexOf.call(n,t,e):Fne(n,[t],e,r,o);throw new TypeError("val must be string, number or Buffer")}function Fne(n,t,e,r,o){var s=1,i=n.length,a=t.length;if(r!==void 0&&(r=String(r).toLowerCase(),r==="ucs2"||r==="ucs-2"||r==="utf16le"||r==="utf-16le")){if(n.length<2||t.length<2)return-1;s=2,i/=2,a/=2,e/=2}function c(d,h){return s===1?d[h]:d.readUInt16BE(h*s)}var l;if(o){var p=-1;for(l=e;l<i;l++)if(c(n,l)===c(t,p===-1?0:l-p)){if(p===-1&&(p=l),l-p+1===a)return p*s}else p!==-1&&(l-=l-p),p=-1}else for(e+a>i&&(e=i-a),l=e;l>=0;l--){for(var f=!0,y=0;y<a;y++)if(c(n,l+y)!==c(t,y)){f=!1;break}if(f)return l}return-1}Ze.prototype.includes=function(t,e,r){return this.indexOf(t,e,r)!==-1};Ze.prototype.indexOf=function(t,e,r){return Vne(this,t,e,r,!0)};Ze.prototype.lastIndexOf=function(t,e,r){return Vne(this,t,e,r,!1)};function TPe(n,t,e,r){e=Number(e)||0;var o=n.length-e;r?(r=Number(r),r>o&&(r=o)):r=o;var s=t.length;r>s/2&&(r=s/2);for(var i=0;i<r;++i){var a=parseInt(t.substr(i*2,2),16);if(HL(a))return i;n[e+i]=a}return i}function IPe(n,t,e,r){return kN(jL(t,n.length-e),n,e,r)}function EPe(n,t,e,r){return kN(LPe(t),n,e,r)}function NPe(n,t,e,r){return kN(Wne(t),n,e,r)}function DPe(n,t,e,r){return kN(zPe(t,n.length-e),n,e,r)}Ze.prototype.write=function(t,e,r,o){if(e===void 0)o="utf8",r=this.length,e=0;else if(r===void 0&&typeof e=="string")o=e,r=this.length,e=0;else if(isFinite(e))e=e>>>0,isFinite(r)?(r=r>>>0,o===void 0&&(o="utf8")):(o=r,r=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var s=this.length-e;if((r===void 0||r>s)&&(r=s),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var i=!1;;)switch(o){case"hex":return TPe(this,t,e,r);case"utf8":case"utf-8":return IPe(this,t,e,r);case"ascii":case"latin1":case"binary":return EPe(this,t,e,r);case"base64":return NPe(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return DPe(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),i=!0}};Ze.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function kPe(n,t,e){return t===0&&e===n.length?VL.fromByteArray(n):VL.fromByteArray(n.slice(t,e))}function qne(n,t,e){e=Math.min(n.length,e);for(var r=[],o=t;o<e;){var s=n[o],i=null,a=s>239?4:s>223?3:s>191?2:1;if(o+a<=e){var c,l,p,f;switch(a){case 1:s<128&&(i=s);break;case 2:c=n[o+1],(c&192)===128&&(f=(s&31)<<6|c&63,f>127&&(i=f));break;case 3:c=n[o+1],l=n[o+2],(c&192)===128&&(l&192)===128&&(f=(s&15)<<12|(c&63)<<6|l&63,f>2047&&(f<55296||f>57343)&&(i=f));break;case 4:c=n[o+1],l=n[o+2],p=n[o+3],(c&192)===128&&(l&192)===128&&(p&192)===128&&(f=(s&15)<<18|(c&63)<<12|(l&63)<<6|p&63,f>65535&&f<1114112&&(i=f))}}i===null?(i=65533,a=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|i&1023),r.push(i),o+=a}return APe(r)}var $ne=4096;function APe(n){var t=n.length;if(t<=$ne)return String.fromCharCode.apply(String,n);for(var e="",r=0;r<t;)e+=String.fromCharCode.apply(String,n.slice(r,r+=$ne));return e}function OPe(n,t,e){var r="";e=Math.min(n.length,e);for(var o=t;o<e;++o)r+=String.fromCharCode(n[o]&127);return r}function MPe(n,t,e){var r="";e=Math.min(n.length,e);for(var o=t;o<e;++o)r+=String.fromCharCode(n[o]);return r}function RPe(n,t,e){var r=n.length;(!t||t<0)&&(t=0),(!e||e<0||e>r)&&(e=r);for(var o="",s=t;s<e;++s)o+=BPe[n[s]];return o}function PPe(n,t,e){for(var r=n.slice(t,e),o="",s=0;s<r.length-1;s+=2)o+=String.fromCharCode(r[s]+r[s+1]*256);return o}Ze.prototype.slice=function(t,e){var r=this.length;t=~~t,e=e===void 0?r:~~e,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),e<t&&(e=t);var o=this.subarray(t,e);return Object.setPrototypeOf(o,Ze.prototype),o};function ns(n,t,e){if(n%1!==0||n<0)throw new RangeError("offset is not uint");if(n+t>e)throw new RangeError("Trying to access beyond buffer length")}Ze.prototype.readUintLE=Ze.prototype.readUIntLE=function(t,e,r){t=t>>>0,e=e>>>0,r||ns(t,e,this.length);for(var o=this[t],s=1,i=0;++i<e&&(s*=256);)o+=this[t+i]*s;return o};Ze.prototype.readUintBE=Ze.prototype.readUIntBE=function(t,e,r){t=t>>>0,e=e>>>0,r||ns(t,e,this.length);for(var o=this[t+--e],s=1;e>0&&(s*=256);)o+=this[t+--e]*s;return o};Ze.prototype.readUint8=Ze.prototype.readUInt8=function(t,e){return t=t>>>0,e||ns(t,1,this.length),this[t]};Ze.prototype.readUint16LE=Ze.prototype.readUInt16LE=function(t,e){return t=t>>>0,e||ns(t,2,this.length),this[t]|this[t+1]<<8};Ze.prototype.readUint16BE=Ze.prototype.readUInt16BE=function(t,e){return t=t>>>0,e||ns(t,2,this.length),this[t]<<8|this[t+1]};Ze.prototype.readUint32LE=Ze.prototype.readUInt32LE=function(t,e){return t=t>>>0,e||ns(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};Ze.prototype.readUint32BE=Ze.prototype.readUInt32BE=function(t,e){return t=t>>>0,e||ns(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};Ze.prototype.readIntLE=function(t,e,r){t=t>>>0,e=e>>>0,r||ns(t,e,this.length);for(var o=this[t],s=1,i=0;++i<e&&(s*=256);)o+=this[t+i]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*e)),o};Ze.prototype.readIntBE=function(t,e,r){t=t>>>0,e=e>>>0,r||ns(t,e,this.length);for(var o=e,s=1,i=this[t+--o];o>0&&(s*=256);)i+=this[t+--o]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*e)),i};Ze.prototype.readInt8=function(t,e){return t=t>>>0,e||ns(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]};Ze.prototype.readInt16LE=function(t,e){t=t>>>0,e||ns(t,2,this.length);var r=this[t]|this[t+1]<<8;return r&32768?r|4294901760:r};Ze.prototype.readInt16BE=function(t,e){t=t>>>0,e||ns(t,2,this.length);var r=this[t+1]|this[t]<<8;return r&32768?r|4294901760:r};Ze.prototype.readInt32LE=function(t,e){return t=t>>>0,e||ns(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};Ze.prototype.readInt32BE=function(t,e){return t=t>>>0,e||ns(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};Ze.prototype.readFloatLE=function(t,e){return t=t>>>0,e||ns(t,4,this.length),Jv.read(this,t,!0,23,4)};Ze.prototype.readFloatBE=function(t,e){return t=t>>>0,e||ns(t,4,this.length),Jv.read(this,t,!1,23,4)};Ze.prototype.readDoubleLE=function(t,e){return t=t>>>0,e||ns(t,8,this.length),Jv.read(this,t,!0,52,8)};Ze.prototype.readDoubleBE=function(t,e){return t=t>>>0,e||ns(t,8,this.length),Jv.read(this,t,!1,52,8)};function Ii(n,t,e,r,o,s){if(!Ze.isBuffer(n))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<s)throw new RangeError('"value" argument is out of bounds');if(e+r>n.length)throw new RangeError("Index out of range")}Ze.prototype.writeUintLE=Ze.prototype.writeUIntLE=function(t,e,r,o){if(t=+t,e=e>>>0,r=r>>>0,!o){var s=Math.pow(2,8*r)-1;Ii(this,t,e,r,s,0)}var i=1,a=0;for(this[e]=t&255;++a<r&&(i*=256);)this[e+a]=t/i&255;return e+r};Ze.prototype.writeUintBE=Ze.prototype.writeUIntBE=function(t,e,r,o){if(t=+t,e=e>>>0,r=r>>>0,!o){var s=Math.pow(2,8*r)-1;Ii(this,t,e,r,s,0)}var i=r-1,a=1;for(this[e+i]=t&255;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+r};Ze.prototype.writeUint8=Ze.prototype.writeUInt8=function(t,e,r){return t=+t,e=e>>>0,r||Ii(this,t,e,1,255,0),this[e]=t&255,e+1};Ze.prototype.writeUint16LE=Ze.prototype.writeUInt16LE=function(t,e,r){return t=+t,e=e>>>0,r||Ii(this,t,e,2,65535,0),this[e]=t&255,this[e+1]=t>>>8,e+2};Ze.prototype.writeUint16BE=Ze.prototype.writeUInt16BE=function(t,e,r){return t=+t,e=e>>>0,r||Ii(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=t&255,e+2};Ze.prototype.writeUint32LE=Ze.prototype.writeUInt32LE=function(t,e,r){return t=+t,e=e>>>0,r||Ii(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t&255,e+4};Ze.prototype.writeUint32BE=Ze.prototype.writeUInt32BE=function(t,e,r){return t=+t,e=e>>>0,r||Ii(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4};Ze.prototype.writeIntLE=function(t,e,r,o){if(t=+t,e=e>>>0,!o){var s=Math.pow(2,8*r-1);Ii(this,t,e,r,s-1,-s)}var i=0,a=1,c=0;for(this[e]=t&255;++i<r&&(a*=256);)t<0&&c===0&&this[e+i-1]!==0&&(c=1),this[e+i]=(t/a>>0)-c&255;return e+r};Ze.prototype.writeIntBE=function(t,e,r,o){if(t=+t,e=e>>>0,!o){var s=Math.pow(2,8*r-1);Ii(this,t,e,r,s-1,-s)}var i=r-1,a=1,c=0;for(this[e+i]=t&255;--i>=0&&(a*=256);)t<0&&c===0&&this[e+i+1]!==0&&(c=1),this[e+i]=(t/a>>0)-c&255;return e+r};Ze.prototype.writeInt8=function(t,e,r){return t=+t,e=e>>>0,r||Ii(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=t&255,e+1};Ze.prototype.writeInt16LE=function(t,e,r){return t=+t,e=e>>>0,r||Ii(this,t,e,2,32767,-32768),this[e]=t&255,this[e+1]=t>>>8,e+2};Ze.prototype.writeInt16BE=function(t,e,r){return t=+t,e=e>>>0,r||Ii(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=t&255,e+2};Ze.prototype.writeInt32LE=function(t,e,r){return t=+t,e=e>>>0,r||Ii(this,t,e,4,2147483647,-2147483648),this[e]=t&255,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4};Ze.prototype.writeInt32BE=function(t,e,r){return t=+t,e=e>>>0,r||Ii(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4};function Une(n,t,e,r,o,s){if(e+r>n.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function jne(n,t,e,r,o){return t=+t,e=e>>>0,o||Une(n,t,e,4,34028234663852886e22,-34028234663852886e22),Jv.write(n,t,e,r,23,4),e+4}Ze.prototype.writeFloatLE=function(t,e,r){return jne(this,t,e,!0,r)};Ze.prototype.writeFloatBE=function(t,e,r){return jne(this,t,e,!1,r)};function Gne(n,t,e,r,o){return t=+t,e=e>>>0,o||Une(n,t,e,8,17976931348623157e292,-17976931348623157e292),Jv.write(n,t,e,r,52,8),e+8}Ze.prototype.writeDoubleLE=function(t,e,r){return Gne(this,t,e,!0,r)};Ze.prototype.writeDoubleBE=function(t,e,r){return Gne(this,t,e,!1,r)};Ze.prototype.copy=function(t,e,r,o){if(!Ze.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),!o&&o!==0&&(o=this.length),e>=t.length&&(e=t.length),e||(e=0),o>0&&o<r&&(o=r),o===r||t.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-e<o-r&&(o=t.length-e+r);var s=o-r;return this===t&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(e,r,o):Uint8Array.prototype.set.call(t,this.subarray(r,o),e),s};Ze.prototype.fill=function(t,e,r,o){if(typeof t=="string"){if(typeof e=="string"?(o=e,e=0,r=this.length):typeof r=="string"&&(o=r,r=this.length),o!==void 0&&typeof o!="string")throw new TypeError("encoding must be a string");if(typeof o=="string"&&!Ze.isEncoding(o))throw new TypeError("Unknown encoding: "+o);if(t.length===1){var s=t.charCodeAt(0);(o==="utf8"&&s<128||o==="latin1")&&(t=s)}}else typeof t=="number"?t=t&255:typeof t=="boolean"&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;e=e>>>0,r=r===void 0?this.length:r>>>0,t||(t=0);var i;if(typeof t=="number")for(i=e;i<r;++i)this[i]=t;else{var a=Ze.isBuffer(t)?t:Ze.from(t,o),c=a.length;if(c===0)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<r-e;++i)this[i+e]=a[i%c]}return this};var FPe=/[^+/0-9A-Za-z-_]/g;function $Pe(n){if(n=n.split("=")[0],n=n.trim().replace(FPe,""),n.length<2)return"";for(;n.length%4!==0;)n=n+"=";return n}function jL(n,t){t=t||1/0;for(var e,r=n.length,o=null,s=[],i=0;i<r;++i){if(e=n.charCodeAt(i),e>55295&&e<57344){if(!o){if(e>56319){(t-=3)>-1&&s.push(239,191,189);continue}else if(i+1===r){(t-=3)>-1&&s.push(239,191,189);continue}o=e;continue}if(e<56320){(t-=3)>-1&&s.push(239,191,189),o=e;continue}e=(o-55296<<10|e-56320)+65536}else o&&(t-=3)>-1&&s.push(239,191,189);if(o=null,e<128){if((t-=1)<0)break;s.push(e)}else if(e<2048){if((t-=2)<0)break;s.push(e>>6|192,e&63|128)}else if(e<65536){if((t-=3)<0)break;s.push(e>>12|224,e>>6&63|128,e&63|128)}else if(e<1114112){if((t-=4)<0)break;s.push(e>>18|240,e>>12&63|128,e>>6&63|128,e&63|128)}else throw new Error("Invalid code point")}return s}function LPe(n){for(var t=[],e=0;e<n.length;++e)t.push(n.charCodeAt(e)&255);return t}function zPe(n,t){for(var e,r,o,s=[],i=0;i<n.length&&!((t-=2)<0);++i)e=n.charCodeAt(i),r=e>>8,o=e%256,s.push(o),s.push(r);return s}function Wne(n){return VL.toByteArray($Pe(n))}function kN(n,t,e,r){for(var o=0;o<r&&!(o+e>=t.length||o>=n.length);++o)t[o+e]=n[o];return o}function El(n,t){return n instanceof t||n!=null&&n.constructor!=null&&n.constructor.name!=null&&n.constructor.name===t.name}function HL(n){return n!==n}var BPe=function(){for(var n="0123456789abcdef",t=new Array(256),e=0;e<16;++e)for(var r=e*16,o=0;o<16;++o)t[r+o]=n[e]+n[o];return t}()});var Qne=Pn((KL,Xne)=>{"use strict";var AN=Hne(),Nl=AN.Buffer;function Kne(n,t){for(var e in n)t[e]=n[e]}Nl.from&&Nl.alloc&&Nl.allocUnsafe&&Nl.allocUnsafeSlow?Xne.exports=AN:(Kne(AN,KL),KL.Buffer=Tg);function Tg(n,t,e){return Nl(n,t,e)}Tg.prototype=Object.create(Nl.prototype);Kne(Nl,Tg);Tg.from=function(n,t,e){if(typeof n=="number")throw new TypeError("Argument must not be a number");return Nl(n,t,e)};Tg.alloc=function(n,t,e){if(typeof n!="number")throw new TypeError("Argument must be a number");var r=Nl(n);return t!==void 0?typeof e=="string"?r.fill(t,e):r.fill(t):r.fill(0),r};Tg.allocUnsafe=function(n){if(typeof n!="number")throw new TypeError("Argument must be a number");return Nl(n)};Tg.allocUnsafeSlow=function(n){if(typeof n!="number")throw new TypeError("Argument must be a number");return AN.SlowBuffer(n)}});var Jne=Pn(Zne=>{"use strict";var QL=Qne().Buffer,Yne=QL.isEncoding||function(n){switch(n=""+n,n&&n.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function VPe(n){if(!n)return"utf8";for(var t;;)switch(n){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return n;default:if(t)return;n=(""+n).toLowerCase(),t=!0}}function qPe(n){var t=VPe(n);if(typeof t!="string"&&(QL.isEncoding===Yne||!Yne(n)))throw new Error("Unknown encoding: "+n);return t||n}Zne.StringDecoder=ES;function ES(n){this.encoding=qPe(n);var t;switch(this.encoding){case"utf16le":this.text=KPe,this.end=XPe,t=4;break;case"utf8":this.fillLast=GPe,t=4;break;case"base64":this.text=QPe,this.end=YPe,t=3;break;default:this.write=ZPe,this.end=JPe;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=QL.allocUnsafe(t)}ES.prototype.write=function(n){if(n.length===0)return"";var t,e;if(this.lastNeed){if(t=this.fillLast(n),t===void 0)return"";e=this.lastNeed,this.lastNeed=0}else e=0;return e<n.length?t?t+this.text(n,e):this.text(n,e):t||""};ES.prototype.end=HPe;ES.prototype.text=WPe;ES.prototype.fillLast=function(n){if(this.lastNeed<=n.length)return n.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);n.copy(this.lastChar,this.lastTotal-this.lastNeed,0,n.length),this.lastNeed-=n.length};function XL(n){return n<=127?0:n>>5===6?2:n>>4===14?3:n>>3===30?4:n>>6===2?-1:-2}function UPe(n,t,e){var r=t.length-1;if(r<e)return 0;var o=XL(t[r]);return o>=0?(o>0&&(n.lastNeed=o-1),o):--r<e||o===-2?0:(o=XL(t[r]),o>=0?(o>0&&(n.lastNeed=o-2),o):--r<e||o===-2?0:(o=XL(t[r]),o>=0?(o>0&&(o===2?o=0:n.lastNeed=o-3),o):0))}function jPe(n,t,e){if((t[0]&192)!==128)return n.lastNeed=0,"\uFFFD";if(n.lastNeed>1&&t.length>1){if((t[1]&192)!==128)return n.lastNeed=1,"\uFFFD";if(n.lastNeed>2&&t.length>2&&(t[2]&192)!==128)return n.lastNeed=2,"\uFFFD"}}function GPe(n){var t=this.lastTotal-this.lastNeed,e=jPe(this,n,t);if(e!==void 0)return e;if(this.lastNeed<=n.length)return n.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);n.copy(this.lastChar,t,0,n.length),this.lastNeed-=n.length}function WPe(n,t){var e=UPe(this,n,t);if(!this.lastNeed)return n.toString("utf8",t);this.lastTotal=e;var r=n.length-(e-this.lastNeed);return n.copy(this.lastChar,0,r),n.toString("utf8",t,r)}function HPe(n){var t=n&&n.length?this.write(n):"";return this.lastNeed?t+"\uFFFD":t}function KPe(n,t){if((n.length-t)%2===0){var e=n.toString("utf16le",t);if(e){var r=e.charCodeAt(e.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=n[n.length-2],this.lastChar[1]=n[n.length-1],e.slice(0,-1)}return e}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=n[n.length-1],n.toString("utf16le",t,n.length-1)}function XPe(n){var t=n&&n.length?this.write(n):"";if(this.lastNeed){var e=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,e)}return t}function QPe(n,t){var e=(n.length-t)%3;return e===0?n.toString("base64",t):(this.lastNeed=3-e,this.lastTotal=3,e===1?this.lastChar[0]=n[n.length-1]:(this.lastChar[0]=n[n.length-2],this.lastChar[1]=n[n.length-1]),n.toString("base64",t,n.length-e))}function YPe(n){var t=n&&n.length?this.write(n):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function ZPe(n){return n.toString(this.encoding)}function JPe(n){return n&&n.length?this.write(n):""}});var ON,YL,ZL,ere=b(()=>{"use strict";$();Sg();kne();ON=class extends Br{decodeUTF8(){return new YL(this)}},YL=class extends IS{constructor(t){super(),this.upstream=t,this.impl=new ZL(t)}summary(){return this.impl.summary()}next(){return Y(this,null,function*(){return this.impl.next()})}},ZL=class extends wg{constructor(t){if(super(),this.upstream=t,Te().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{let{StringDecoder:e}=Jne();this.decoder=new e("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}pump(){return Y(this,null,function*(){let t=yield this.upstream.next(),e;if(t.done)return!1;e=t.value;let r;return Te().get("IS_BROWSER")?r=this.decoder.decode(e,{stream:!0}):r=this.decoder.write(Buffer.from(e.buffer)),this.outputQueue.push(r),!0})}}});var tb,JL=b(()=>{"use strict";$();ere();tb=class extends ON{constructor(t,e={}){super(),this.file=t,this.options=e,N.assert(t instanceof Uint8Array||(Te().get("IS_BROWSER")?t instanceof File||t instanceof Blob:!1),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=e.offset||0,this.chunkSize=e.chunkSize||1024*1024}summary(){return`FileChunks ${this.file}`}next(){return Y(this,null,function*(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:yield new Promise((e,r)=>{let o=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)e(new Uint8Array(this.file.slice(this.offset,o)));else{let s=new FileReader;s.onload=a=>{let c=s.result;if(c instanceof ArrayBuffer&&(c=new Uint8Array(c)),!(c instanceof Uint8Array))return r(new TypeError("FileReader returned unknown type."));e(c)},s.onabort=a=>r(new Error("Aborted")),s.onerror=a=>r(new Error(a.type));let i=this.file.slice(this.offset,o);s.readAsArrayBuffer(i)}this.offset=o}),done:!1}})}}});function tre(e){return Y(this,arguments,function*(n,t={}){let r,o;typeof n=="string"?r=n:(r=n.url,o=eFe(n));let s=yield N.fetch(r,o);if(s.ok){let i=new Uint8Array(yield s.arrayBuffer());return new tb(i,t)}else throw new Error(s.statusText)})}var eFe,nre=b(()=>{"use strict";$();JL();eFe=n=>({method:n.method,headers:n.headers,body:n.body,mode:n.mode,credentials:n.credentials,cache:n.cache,redirect:n.redirect,referrer:n.referrer,integrity:n.integrity})});function MN(n){return typeof n=="string"&&n.substr(0,7)==="file://"}var e3=b(()=>{"use strict";});var rre=Pn(()=>{"use strict"});var nb,t3=b(()=>{"use strict";$();FL();JL();e3();nb=class extends Zv{constructor(t,e={}){super(),this.input=t,this.options=e}iterator(){return Y(this,null,function*(){if(MN(this.input)&&Te().get("IS_NODE")){let t=rre();this.input=t.readFileSync(this.input.substr(7))}return new tb(this.input,this.options)})}}});var rb,n3=b(()=>{"use strict";FL();nre();e3();t3();rb=class extends Zv{constructor(t,e={}){super(),this.url=t,this.fileOptions=e}iterator(){return Y(this,null,function*(){return MN(this.url)?new nb(this.url,this.fileOptions).iterator():tre(this.url,this.fileOptions)})}}});function ore(n,t={}){return new Yv(new rb(n),t)}function sre(n){let t=CS(n);return oi(()=>Y(null,null,function*(){return t}))}function ire(n){return oi(()=>Y(null,null,function*(){let t=yield n();return CS(()=>t.next())}))}function are(n,t){return Y(this,null,function*(){return EN.create(n,t)})}function cre(n){return Y(this,null,function*(){return IN.create(n)})}var ure=b(()=>{"use strict";_S();PL();Sg();Nne();Dne();n3();});var RN,lre=b(()=>{"use strict";RN="2.8.6"});var r3={};xn(r3,{CSVDataset:()=>Yv,Dataset:()=>Zf,FileDataSource:()=>nb,TextLineDataset:()=>Qv,URLDataSource:()=>rb,array:()=>_ne,csv:()=>ore,func:()=>sre,generator:()=>ire,microphone:()=>cre,version_data:()=>RN,webcam:()=>are,zip:()=>Tne});var o3=b(()=>{"use strict";_S();PL();ML();ure();t3();n3();lre();});function Ke(n,t){Array.isArray(n)||(n=[n]),n.forEach(e=>{e!=null&&N.assert(e.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}var kt=b(()=>{"use strict";$();});var tFe,PN,pre=b(()=>{"use strict";$();kt();tFe=Vo.whereImpl,PN=class extends eu{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new ef(this,eh())}write(t,e,r){this.firstUse&&(this.firstUse=!1,Te().get("IS_NODE")&&H.warn(`
============================
Hi there \u{1F44B}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));let o={};return this.data.set(o,{values:t,dtype:r,refCount:1}),o}makeTensorInfo(t,e,r){let o;if(e==="string"&&r!=null&&r.length>0&&N.isString(r[0])){let s=r.map(i=>N.encodeString(i));o=this.write(s,t,e)}else o=this.write(r,t,e);return{dataId:o,shape:t,dtype:e}}incRef(t){let e=this.data.get(t);e.refCount++}decRef(t){if(this.data.has(t)){let e=this.data.get(t);e.refCount--}}move(t,e,r,o){this.data.set(t,{values:e,dtype:o,refCount:1})}numDataIds(){return this.data.numDataIds()}read(t){return Y(this,null,function*(){return this.readSync(t)})}readSync(t){let{dtype:e,complexTensorInfos:r}=this.data.get(t);if(e==="complex64"){let o=this.readSync(r.real.dataId),s=this.readSync(r.imag.dataId);return H.mergeRealAndImagArrays(o,s)}return this.data.get(t).values}bufferSync(t){let e=this.readSync(t.dataId),r=e;if(t.dtype==="string")try{r=e.map(o=>N.decodeString(o))}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return It(t.shape,t.dtype,r)}makeOutput(t,e,r){let o=this.write(t,e,r);return eh().makeTensorFromDataId(o,e,r,this)}disposeData(t){if(this.data.has(t)){let{complexTensorInfos:e}=this.data.get(t);e!=null&&(this.disposeData(e.real.dataId),this.disposeData(e.imag.dataId)),this.data.delete(t)}}disposeIntermediateTensorInfo(t){let e=t.dataId;if(this.data.has(e)){let r=this.data.get(e);r.refCount--,r.refCount<1&&this.disposeData(e)}}time(t){return Y(this,null,function*(){let e=N.now();return t(),{kernelMs:N.now()-e}})}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){Ke([t],"where");let e=this.readSync(t.dataId);return tFe(t.shape,e)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}});function s3(n){let t=new Float32Array(n.length);for(let e=0;e<n.length;++e)t[e]=Math.abs(n[e]);return t}var nFe,hre,i3=b(()=>{"use strict";$();kt();nFe=n=>{let{x:t}=n.inputs,e=n.backend;Ke(t,"abs");let r=new Float32Array(N.sizeFromShape(t.shape)),o=e.data.get(t.dataId).values;return r=s3(o),e.makeOutput(r,t.shape,"float32")},hre={kernelName:np,backendName:"cpu",kernelFunc:nFe}});function yn(n){return(t,e,r,o,s)=>{let i=H.assertAndGetBroadcastShape(t,e),a=i.length,c=N.computeStrides(i),l=N.sizeFromShape(i),p=N.getTypedArrayFromDType(s,l),f=t.length,y=e.length,d=N.computeStrides(t),h=N.computeStrides(e),m=H.getBroadcastDims(t,i),x=H.getBroadcastDims(e,i);if(m.length+x.length===0)for(let w=0;w<p.length;++w)p[w]=n(r[w%r.length],o[w%o.length]);else for(let w=0;w<p.length;++w){let _=N.indexToLoc(w,a,c),I=_.slice(-f);m.forEach(R=>I[R]=0);let T=N.locToIndex(I,f,d),D=_.slice(-y);x.forEach(R=>D[R]=0);let O=N.locToIndex(D,y,h);p[w]=n(r[T],o[O])}return[p,i]}}var po=b(()=>{"use strict";$();});function wo(n){let{inputs:t,backend:e}=n,{real:r,imag:o}=t,s=e.data.get(r.dataId).values,i=e.data.get(o.dataId).values,a=e.makeTensorInfo(r.shape,"complex64"),c=e.data.get(a.dataId);return c.complexTensorInfos={real:e.makeTensorInfo(r.shape,"float32",s),imag:e.makeTensorInfo(o.shape,"float32",i)},a}var fre,bh=b(()=>{"use strict";$();fre={kernelName:tm,backendName:"cpu",kernelFunc:wo}});function ob(n,t,e="float32"){if(e==="complex64"){let o=ob(n,t,"float32"),s=ob(n,t,"float32");return wo({inputs:{real:o,imag:s},backend:n})}let r=N.makeZerosTypedArray(N.sizeFromShape(t),e);return n.makeTensorInfo(t,e,r)}var a3=b(()=>{"use strict";$();bh();});function rs(n){let{inputs:t,backend:e}=n,{x:r}=t;return e.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var dre,Dl=b(()=>{"use strict";$();dre={kernelName:wp,backendName:"cpu",kernelFunc:rs}});function Ra(n){let{inputs:t,backend:e}=n,{input:r}=t,o=e.data.get(r.dataId).complexTensorInfos.real,s=e.data.get(o.dataId).values;return e.makeTensorInfo(o.shape,o.dtype,s)}var mre,Ig=b(()=>{"use strict";$();mre={kernelName:Dm,backendName:"cpu",kernelFunc:Ra}});function Pa(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{dtype:s}=r;if(s==="complex64"){if(o.dtype==="complex64")return rs({inputs:{x:o},backend:e});let i=ob(e,o.shape,o.dtype),a=Pa({inputs:{x:o},backend:e,attrs:{dtype:"float32"}}),c=wo({inputs:{real:a,imag:i},backend:e});return e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(a),c}if(o.dtype==="complex64"){let i=Ra({inputs:{input:o},backend:e}),a=Pa({inputs:{x:i},backend:e,attrs:{dtype:s}});return e.disposeIntermediateTensorInfo(i),a}if(!N.hasEncodingLoss(o.dtype,s)){let i=rs({inputs:{x:o},backend:e});return{dataId:i.dataId,shape:i.shape,dtype:s}}if(s==="int32"){let i=e.data.get(o.dataId).values,a=Int32Array.from(i);return e.makeTensorInfo(o.shape,"int32",a)}if(s==="bool"){let i=e.data.get(o.dataId).values,a=N.toTypedArray([0],o.dtype),[c,l]=yn((p,f)=>p!==f?1:0)(o.shape,[],i,a,"bool");return e.makeTensorInfo(l,"bool",c)}throw new Error(`Error in Cast: failed to cast ${o.dtype} to ${s}`)}var gre,sb=b(()=>{"use strict";$();po();a3();bh();Dl();Ig();gre={kernelName:lc,backendName:"cpu",kernelFunc:Pa}});function _n(n,t,e,r){return e==null?({inputs:o,backend:s})=>{let{a:i,b:a}=o,c=s;Ke([i,a],n);let l=c.data.get(i.dataId).values,p=c.data.get(a.dataId).values,f=r||i.dtype,[y,d]=t(i.shape,a.shape,l,p,f);return c.makeTensorInfo(d,f,y)}:({inputs:o,backend:s})=>{let{a:i,b:a}=o,c=s;if(i.dtype==="complex64"||a.dtype==="complex64"){let l=Pa({inputs:{x:i},backend:c,attrs:{dtype:"complex64"}}),p=c.data.get(l.dataId),f=p.complexTensorInfos.real,y=p.complexTensorInfos.imag,d=c.data.get(f.dataId).values,h=c.data.get(y.dataId).values,m=Pa({inputs:{x:a},backend:c,attrs:{dtype:"complex64"}}),x=c.data.get(m.dataId),w=x.complexTensorInfos.real,_=x.complexTensorInfos.imag,I=c.data.get(w.dataId).values,T=c.data.get(_.dataId).values,[D,O,R]=e(i.shape,a.shape,d,h,I,T),P=c.makeTensorInfo(R,"float32",D),j=c.makeTensorInfo(R,"float32",O),G=wo({inputs:{real:P,imag:j},backend:c});return c.disposeIntermediateTensorInfo(l),c.disposeIntermediateTensorInfo(m),c.disposeIntermediateTensorInfo(P),c.disposeIntermediateTensorInfo(j),G}else{let l=c.data.get(i.dataId).values,p=c.data.get(a.dataId).values,f=r||i.dtype,[y,d]=t(i.shape,a.shape,l,p,f);return c.makeTensorInfo(d,f,y)}}}function ib(n){return(t,e,r,o,s,i)=>{let a=H.assertAndGetBroadcastShape(t,e),c=N.sizeFromShape(a),l=a.length,p=N.computeStrides(a),f=N.getTypedArrayFromDType("float32",c),y=N.getTypedArrayFromDType("float32",c),d=H.getBroadcastDims(t,a),h=H.getBroadcastDims(e,a),m=H.mergeRealAndImagArrays(r,o),x=H.mergeRealAndImagArrays(s,i),w=t.length,_=N.computeStrides(t),I=e.length,T=N.computeStrides(e);if(d.length+h.length===0)for(let D=0;D<f.length;D++){let O=D%m.length,R=D%x.length,P=n(m[O*2],m[O*2+1],x[R*2],x[R*2+1]);f[D]=P.real,y[D]=P.imag}else for(let D=0;D<f.length;D++){let O=N.indexToLoc(D,l,p),R=O.slice(-w);d.forEach(ie=>R[ie]=0);let P=N.locToIndex(R,w,_),j=O.slice(-I);h.forEach(ie=>j[ie]=0);let G=N.locToIndex(j,I,T),Q=n(m[P*2],m[P*2+1],x[G*2],x[G*2+1]);f[D]=Q.real,y[D]=Q.imag}return[f,y,a]}}var ko=b(()=>{"use strict";$();kt();sb();bh();});var c3,rFe,wh,yre,Eg=b(()=>{"use strict";$();po();ko();c3=yn((n,t)=>n+t),rFe=ib((n,t,e,r)=>({real:n+e,imag:t+r})),wh=_n(ma,c3,rFe),yre={kernelName:ma,backendName:"cpu",kernelFunc:wh}});function ab(n,t,e,r,o){let s=N.sizeFromShape(r),i=N.makeZerosTypedArray(o,e);for(let a=0;a<n.length;a++){let c=n[a];if(c<0)throw new Error("Input x must be non-negative!");c>=o||(s>0?i[c]+=t[a]:i[c]+=1)}return i}function FN(n,t,e,r=!1){let o=n.shape[0],s=n.shape[1],i=It([o,e],t.dtype);for(let a=0;a<o;a++)for(let c=0;c<s;c++){let l=n.get(a,c);if(l<0)throw new Error("Input x must be non-negative!");l>=e||(r?i.set(1,a,l):t.size>0?i.set(i.get(a,l)+t.get(a,c),a,l):i.set(i.get(a,l)+1,a,l))}return i}var $N=b(()=>{"use strict";$();});function Fa(n){return(t,e,r)=>{let o=N.getTypedArrayFromDType(e,t.length);for(let s=0;s<t.length;++s)o[s]=n(t[s],r);return o}}var Ng=b(()=>{"use strict";$();});function Ft(n,t,e){return({inputs:r,attrs:o,backend:s})=>{let{x:i}=r;if(Ke(i,n),i.dtype==="string"||e==="string")throw new Error("unaryKernelFunc does not support string input/output");let a=s,c=a.data.get(i.dataId).values,l=N.sizeFromShape(i.shape),p=e||i.dtype,f=N.getArrayFromDType(p,l);for(let y=0;y<l;++y)f[y]=t(c[y],o);return a.makeTensorInfo(i.shape,p,f)}}function $a(n,t,e){return({inputs:r,attrs:o,backend:s})=>{let{x:i}=r;if(Ke(i,n),i.dtype==="string"||e==="string")throw new Error("unaryKernelFunc does not support string input/output");let a=s,c=a.data.get(i.dataId).values,l=e||i.dtype,p=t(c,l,o);return a.makeTensorInfo(i.shape,l,p)}}var In=b(()=>{"use strict";$();kt();});var u3,oFe,xre,l3=b(()=>{"use strict";$();Ng();In();u3=Fa(n=>Math.ceil(n)),oFe=$a(lu,u3),xre={kernelName:lu,backendName:"cpu",kernelFunc:oFe}});function LN(n,t,e,r){let o=N.getArrayFromDType(e,N.sizeFromShape(t));if(r&&e!=="string"){let s=0;n.forEach(i=>{let a=N.sizeFromShape(i.shape);o.set(i.vals,s),s+=a})}else{let s=0;n.forEach(i=>{let a=e==="string"?H.fromUint8ToStringArray(i.vals):i.vals,c=0;for(let l=0;l<i.shape[0];++l){let p=l*t[1]+s;for(let f=0;f<i.shape[1];++f)o[p+f]=a[c++]}s+=i.shape[1]})}return o}var p3=b(()=>{"use strict";$();});var h3,f3,vre,zN=b(()=>{"use strict";$();Ng();In();h3=Fa(n=>Math.exp(n)),f3=$a(yu,h3),vre={kernelName:yu,backendName:"cpu",kernelFunc:f3}});var d3,sFe,bre,m3=b(()=>{"use strict";$();Ng();In();d3=Fa(n=>Math.expm1(n)),sFe=$a(xu,d3),bre={kernelName:xu,backendName:"cpu",kernelFunc:sFe}});var g3,iFe,wre,y3=b(()=>{"use strict";$();Ng();In();g3=Fa(n=>Math.floor(n)),iFe=$a(vu,g3),wre={kernelName:vu,backendName:"cpu",kernelFunc:iFe}});function BN(n,t,e){let r=It(e,n.dtype);for(let o=0;o<r.size;++o){let i=r.indexToLoc(o).slice(),a=i[0],c=i[2],l=t.locToIndex([a,c]);i[2]=t.values[l];let p=n.locToIndex(i);r.values[o]=n.values[p]}return r}var x3=b(()=>{"use strict";$();});var v3,aFe,Sre,b3=b(()=>{"use strict";$();po();ko();v3=yn((n,t)=>n>t?1:0),aFe=_n(nf,v3,null,"bool"),Sre={kernelName:nf,backendName:"cpu",kernelFunc:aFe}});var w3,cFe,Cre,S3=b(()=>{"use strict";$();po();ko();w3=yn((n,t)=>n<t?1:0),cFe=_n(rf,w3,null,"bool"),Cre={kernelName:rf,backendName:"cpu",kernelFunc:cFe}});function VN(n,t,e){let r=(t-n)/(e-1),o=N.makeZerosTypedArray(e,"float32");o[0]=n;for(let s=1;s<o.length;s++)o[s]=o[s-1]+r;return o}var C3=b(()=>{"use strict";$();});var _3,uFe,_re,T3=b(()=>{"use strict";$();Ng();In();_3=Fa(n=>Math.log(n)),uFe=$a(Tu,_3),_re={kernelName:Tu,backendName:"cpu",kernelFunc:uFe}});function qN(n,t,e,r){let o=N.getTypedArrayFromDType(r,N.sizeFromShape(e));for(let s=0;s<o.length;++s){let i=s*t,a=n[i];for(let c=0;c<t;++c){let l=n[i+c];l>a&&(a=l)}o[s]=a}return o}var I3=b(()=>{"use strict";$();});var E3,lFe,Tre,N3=b(()=>{"use strict";$();po();ko();E3=yn((n,t)=>Math.max(n,t)),lFe=_n(Eu,E3),Tre={kernelName:Eu,backendName:"cpu",kernelFunc:lFe}});var D3,pFe,Ire,k3=b(()=>{"use strict";$();po();ko();D3=yn((n,t)=>Math.min(n,t)),pFe=_n(Nu,D3),Ire={kernelName:Nu,backendName:"cpu",kernelFunc:pFe}});var NS,hFe,DS,Ere,cb=b(()=>{"use strict";$();po();ko();NS=yn((n,t)=>n*t),hFe=ib((n,t,e,r)=>({real:n*e-t*r,imag:n*r+t*e})),DS=_n(ku,NS,hFe),Ere={kernelName:ku,backendName:"cpu",kernelFunc:DS}});function A3(n,t,e){let r=N.createScalarValue(-1,e);return NS([],t,r,n,e)}function fFe(n){let{inputs:t,backend:e}=n,{x:r}=t;Ke(r,"neg");let o=e.data.get(r.dataId).values,[s,i]=A3(o,r.shape,r.dtype);return e.makeTensorInfo(i,r.dtype,s)}var Nre,O3=b(()=>{"use strict";$();kt();cb();Nre={kernelName:kp,backendName:"cpu",kernelFunc:fFe}});var M3,dFe,Dre,R3=b(()=>{"use strict";$();po();ko();M3=yn((n,t)=>n!==t?1:0),dFe=_n(uf,M3,null,"bool"),Dre={kernelName:uf,backendName:"cpu",kernelFunc:dFe}});function ub(n,t,e,r,o){let s=t.length,i=N.sizeFromShape(t),a=N.computeStrides(t),c=N.computeStrides(o),l=N.getTypedArrayFromDType(e,N.sizeFromShape(o));for(let p=0;p<i;++p){let f=N.indexToLoc(p,s,a),y=new Array(f.length);for(let h=0;h<y.length;h++)y[h]=f[r[h]];let d=N.locToIndex(y,s,c);l[d]=n[p]}return l}var UN=b(()=>{"use strict";$();});function ho(n){let{inputs:t,attrs:e,backend:r}=n,{x:o}=t,{perm:s}=e;Ke(o,"transpose");let i=o.shape.length,a=new Array(i);for(let f=0;f<a.length;f++)a[f]=o.shape[s[f]];let c=r.data.get(o.dataId).values,l=ub(c,o.shape,o.dtype,s,a);return{dataId:r.write(l,a,o.dtype),shape:a,dtype:o.dtype}}var kre,La=b(()=>{"use strict";$();kt();UN();kre={kernelName:Wp,backendName:"cpu",kernelFunc:ho}});function P3(n,t,e,r){let[o,s]=H.computeOutAndReduceShapes(n,r),i=ro(t,"int32"),a=N.makeZerosTypedArray(N.sizeFromShape(o),i),c=N.sizeFromShape(s);for(let l=0;l<a.length;++l){let p=l*c,f=1;for(let y=0;y<c;++y)f*=e[p+y];a[l]=f}return{outVals:a,outShape:o,outDtype:i}}function mFe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s,keepDims:i}=r;Ke(o,"prod");let a=o.shape.length,c=N.parseAxisParam(s,o.shape),l=H.getAxesPermutation(c,a),p=c,f=o,y=[];l!=null&&(f=ho({inputs:{x:o},backend:e,attrs:{perm:l}}),y.push(f),p=H.getInnerMostAxes(p.length,a));let d=e.data.get(f.dataId).values,{outVals:h,outShape:m,outDtype:x}=P3(f.shape,f.dtype,d,p),w=m;return i&&(w=H.expandShapeToKeepDim(m,c)),y.forEach(_=>e.disposeIntermediateTensorInfo(_)),e.makeTensorInfo(w,x,h)}var Are,F3=b(()=>{"use strict";$();kt();La();Are={kernelName:Em,backendName:"cpu",kernelFunc:mFe}});function jN(n,t,e,r){let o=n===t,s=n<t&&e<0,i=t<n&&e>1;if(o||s||i)return N.makeZerosTypedArray(0,r);let a=Math.abs(Math.ceil((t-n)/e)),c=N.makeZerosTypedArray(a,r);t<n&&e===1&&(e=-1),c[0]=n;for(let l=1;l<c.length;l++)c[l]=c[l-1]+e;return c}var $3=b(()=>{"use strict";$();});var L3,gFe,Ore,z3=b(()=>{"use strict";$();Ng();In();L3=Fa(n=>1/Math.sqrt(n)),gFe=$a(Fu,L3),Ore={kernelName:Fu,backendName:"cpu",kernelFunc:gFe}});function B3(n,t,e,r,o){let s=Fo.isSliceContinous(r,t,e),i=N.sizeFromShape(e),a=N.computeStrides(r);if(s){let f=Fo.computeFlatOffset(t,a);return o==="string"?n.slice(f,f+i):n.subarray(f,f+i)}let c=o==="string"?H.fromUint8ToStringArray(n):n,l=It(r,o,c),p=It(e,o);for(let f=0;f<p.size;++f){let y=p.indexToLoc(f),d=y.map((h,m)=>h+t[m]);p.set(l.get(...d),...y)}return o==="string"?H.fromStringArrayToUint8(p.values):p.values}function za(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{begin:s,size:i}=r;Ke(o,"slice");let[a,c]=Fo.parseSliceParams(o,s,i);Fo.assertParamsValid(o,a,c);let l=e.data.get(o.dataId).values,p=B3(l,a,c,o.shape,o.dtype);return e.makeTensorInfo(c,o.dtype,p)}var Mre,Jf=b(()=>{"use strict";$();kt();Mre={kernelName:Vp,backendName:"cpu",kernelFunc:za}});var V3,yFe,Rre,q3=b(()=>{"use strict";$();po();ko();V3=yn((n,t)=>{let e=n-t;return e*e}),yFe=_n(ju,V3),Rre={kernelName:ju,backendName:"cpu",kernelFunc:yFe}});function GN(n,t,e,r){let o=It(n,t.dtype);for(let s=0;s<o.size;s++){let i=o.indexToLoc(s),a=new Array(i.length);for(let c=0;c<a.length;c++)a[c]=i[c]*e[c]+r[c];o.set(t.get(...a),...i)}return o}var U3=b(()=>{"use strict";$();});var j3,xFe,kS,Pre,AS=b(()=>{"use strict";$();po();ko();j3=yn((n,t)=>n-t),xFe=ib((n,t,e,r)=>({real:n-e,imag:t-r})),kS=_n(Gu,j3,xFe),Pre={kernelName:Gu,backendName:"cpu",kernelFunc:kS}});function WN(n,t){let e=new Array(n.rank);for(let o=0;o<e.length;o++)e[o]=n.shape[o]*t[o];let r=It(e,n.dtype);for(let o=0;o<r.values.length;++o){let s=r.indexToLoc(o),i=new Array(n.rank);for(let c=0;c<i.length;c++)i[c]=s[c]%n.shape[c];let a=n.locToIndex(i);r.values[o]=n.values[a]}return r}var G3=b(()=>{"use strict";$();});function HN(n,t,e,r,o){let s=t[t.length-1],[i,a]=[n.length/s,s],c=N.getTypedArrayFromDType(e,i*r),l=N.getTypedArrayFromDType("int32",i*r);for(let f=0;f<i;f++){let y=f*a,d=n.subarray(y,y+a),h=[];for(let _=0;_<d.length;_++)h.push({value:d[_],index:_});h.sort((_,I)=>I.value-_.value);let m=f*r,x=c.subarray(m,m+r),w=l.subarray(m,m+r);for(let _=0;_<r;_++)x[_]=h[_].value,w[_]=h[_].index}let p=t.slice();return p[p.length-1]=r,[It(p,e,c),It(p,"int32",l)]}var W3=b(()=>{"use strict";$();});function KN(n,t,e,r){let o=N.parseAxisParam(t,e)[0],s=[1,e[0],1];for(let h=0;h<o;h++)s[0]*=e[h];s[1]=e[o];for(let h=o+1;h<e.length;h++)s[2]*=e[h];let i={},a=new Int32Array(e[o]),c=new Dn(s,r,n),l=[],p=s[0]===1&&s[2]===1;for(let h=0;h<e[o];h++){let m;if(p)m=n[h].toString();else{let x=[];for(let w=0;w<s[0];w++)for(let _=0;_<s[2];_++)x.push(c.get(w,h,_));m=x.join(",")}if(i[m]!==void 0)a[h]=i[m];else{let x=Object.keys(i).length;i[m]=x,a[h]=x,l.push(h)}}let f=s.slice();f[1]=Object.keys(i).length;let y=new Dn(f,r);l.forEach((h,m)=>{for(let x=0;x<s[0];x++)for(let w=0;w<s[2];w++)y.set(c.get(x,h,w),x,m,w)});let d=e.slice();return d[o]=f[1],{outputValues:y.values,outputShape:d,indices:a}}var H3=b(()=>{"use strict";$();});var K3={};xn(K3,{addImpl:()=>c3,bincountImpl:()=>ab,bincountReduceImpl:()=>FN,ceilImpl:()=>u3,concatImpl:()=>LN,expImpl:()=>h3,expm1Impl:()=>d3,floorImpl:()=>g3,gatherV2Impl:()=>BN,greaterImpl:()=>v3,lessImpl:()=>w3,linSpaceImpl:()=>VN,logImpl:()=>_3,maxImpl:()=>qN,maximumImpl:()=>E3,minimumImpl:()=>D3,multiplyImpl:()=>NS,negImpl:()=>A3,notEqualImpl:()=>M3,prodImpl:()=>P3,rangeImpl:()=>jN,rsqrtImpl:()=>L3,simpleAbsImpl:()=>s3,sliceImpl:()=>B3,squaredDifferenceImpl:()=>V3,stridedSliceImpl:()=>GN,subImpl:()=>j3,tileImpl:()=>WN,topKImpl:()=>HN,transposeImpl:()=>ub,uniqueImpl:()=>KN});var Fre=b(()=>{"use strict";i3();Eg();$N();l3();p3();zN();m3();y3();x3();b3();S3();C3();T3();I3();N3();k3();cb();O3();R3();F3();$3();z3();Jf();q3();U3();AS();G3();W3();UN();H3();});var X3,$re=b(()=>{"use strict";X3="2.8.6"});var Lre=b(()=>{"use strict";$();pre();$re();f0("cpu",()=>new PN,1)});var Q3,zre,Y3=b(()=>{"use strict";$();In();Q3=Ft(mu,n=>n>=0?n:Math.exp(n)-1),zre={kernelName:mu,backendName:"cpu",kernelFunc:Q3}});function Z3(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{alpha:s}=r;Ke([o],"leakyRelu");let i=N.sizeFromShape(o.shape),a=e.data.get(o.dataId).values,c=N.getTypedArrayFromDType("float32",i);for(let l=0;l<a.length;l++)c[l]=a[l]<0?s*a[l]:a[l];return e.makeTensorInfo(o.shape,"float32",c)}var Bre,J3=b(()=>{"use strict";$();kt();Bre={kernelName:Sp,backendName:"cpu",kernelFunc:Z3}});function ez(n){let{inputs:t,backend:e}=n,{x:r,alpha:o}=t;Ke([r,o],"prelu");let s=e.data.get(r.dataId).values,i=e.data.get(o.dataId).values,[a,c]=vFe(r.shape,o.shape,s,i,r.dtype);return e.makeTensorInfo(c,r.dtype,a)}var vFe,Vre,tz=b(()=>{"use strict";$();kt();po();vFe=yn((n,t)=>n<0?t*n:n);Vre={kernelName:Pp,backendName:"cpu",kernelFunc:ez}});var nz,qre,rz=b(()=>{"use strict";$();In();nz=Ft(Mu,n=>Math.max(0,n)),qre={kernelName:Mu,backendName:"cpu",kernelFunc:nz}});var oz,Ure,sz=b(()=>{"use strict";$();In();oz=Ft(Ru,n=>Math.min(Math.max(0,n),6)),Ure={kernelName:Ru,backendName:"cpu",kernelFunc:oz}});function lb(n,t,e,r,o){if(e==="linear")return rs({inputs:{x:t},backend:n});if(e==="relu")return nz({inputs:{x:t},backend:n});if(e==="elu")return Q3({inputs:{x:t},backend:n});if(e==="relu6")return oz({inputs:{x:t},backend:n});if(e==="prelu")return ez({inputs:{x:t,alpha:r},backend:n});if(e==="leakyrelu")return Z3({inputs:{x:t},backend:n,attrs:{alpha:o}});throw new Error(`Activation ${e} has not been implemented for the CPU backend.`)}var XN=b(()=>{"use strict";Y3();Dl();J3();tz();rz();sz();});function Sn(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{shape:s}=r,i=N.sizeFromShape(o.shape),a=N.inferFromImplicitShape(s,i),c=N.sizeFromShape(a);N.assert(i===c,()=>`The new shape (${a}) has ${c} elements and the old shape (${o.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),e.incRef(o.dataId);let l=e.data.get(o.dataId);if(l.complexTensorInfos!=null){let p=l.complexTensorInfos.real,f=l.complexTensorInfos.imag;p.shape=a,f.shape=a}return{dataId:o.dataId,shape:a,dtype:o.dtype}}var jre,_s=b(()=>{"use strict";$();jre={kernelName:Fp,backendName:"cpu",kernelFunc:Sn}});function iz(n){let{inputs:t,backend:e,attrs:r}=n,{a:o,b:s}=t,{transposeA:i,transposeB:a}=r;Ke([o,s],"matMul");let c=o.shape.length,l=s.shape.length,p=i?o.shape[c-2]:o.shape[c-1],f=a?s.shape[l-1]:s.shape[l-2],y=i?o.shape[c-1]:o.shape[c-2],d=a?s.shape[l-2]:s.shape[l-1],h=o.shape.slice(0,-2),m=s.shape.slice(0,-2),x=N.sizeFromShape(h),w=N.sizeFromShape(m),_=x===w||x===1||w===1;N.assert(c>=2&&l>=2&&_,()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${h}) and (${m}).`);let T=(x>w?o.shape.slice(0,-2):s.shape.slice(0,-2)).concat([y,d]);N.assert(p===f,()=>`Error in matMul: inner shapes (${p}) and (${f}) of Tensors with shapes ${o.shape} and ${s.shape} and transposeA=${i} and transposeB=${a} must match.`);let D=i?[x,p,y]:[x,y,p],O=a?[w,d,f]:[w,f,d],R=Sn({inputs:{x:o},backend:e,attrs:{shape:D}}),P=Sn({inputs:{x:s},backend:e,attrs:{shape:O}}),j=i?R.shape[1]:R.shape[2],G=i?R.shape[2]:R.shape[1],Q=a?P.shape[1]:P.shape[2],ie=Math.max(x,w),pe=e.data.get(R.dataId).values,xe=e.data.get(P.dataId).values,ne=N.computeStrides(R.shape),fe=N.computeStrides(P.shape),[te,se,ee]=i?[ne[0],1,ne[1]]:[ne[0],ne[1],1],[we,be,ke]=a?[1,fe[1],fe[0]]:[fe[1],1,fe[0]],De=G*Q,Re=It([ie,G,Q],R.dtype),Ce=Re.values,Je=e.blockSize;for(let rt=0;rt<ie;rt++)for(let qe=0;qe<G;qe+=Je)for(let B=0;B<Q;B+=Je)for(let J=0;J<j;J+=Je){let Z=Math.min(qe+Je,G),le=Math.min(B+Je,Q),Ge=Math.min(J+Je,j);for(let Qe=qe;Qe<Z;Qe++)for(let dt=B;dt<le;dt++){let yt=0;for(let Vt=J;Vt<Ge;Vt++){let En=Math.min(rt,x-1)*te,ss=Math.min(rt,w-1)*ke,tn=pe[En+Qe*se+Vt*ee],So=xe[Vt*we+dt*be+ss];yt+=tn*So}Ce[rt*De+(Qe*Q+dt)]+=yt}}return e.disposeIntermediateTensorInfo(R),e.disposeIntermediateTensorInfo(P),e.makeTensorInfo(T,Re.dtype,Re.values)}var Gre,az=b(()=>{"use strict";$();kt();_s();Gre={kernelName:cp,backendName:"cpu",kernelFunc:iz}});function bFe(n){let{inputs:t,backend:e,attrs:r}=n,{a:o,b:s,bias:i,preluActivationWeights:a}=t,{transposeA:c,transposeB:l,activation:p,leakyreluAlpha:f}=r,y,d,h,m=[];y=iz({inputs:{a:o,b:s},attrs:{transposeA:c,transposeB:l},backend:e}),i&&(d=wh({inputs:{a:y,b:i},backend:e}),m.push(y),y=d),p&&(h=lb(e,y,p,a,f),m.push(y),y=h);for(let w of m)e.disposeIntermediateTensorInfo(w);return y}var Wre,Hre=b(()=>{"use strict";$();XN();Eg();az();Wre={kernelName:lf,backendName:"cpu",kernelFunc:bFe}});var wFe,Kre,Xre=b(()=>{"use strict";$();In();wFe=Ft(ru,n=>Math.acos(n)),Kre={kernelName:ru,backendName:"cpu",kernelFunc:wFe}});var SFe,Qre,Yre=b(()=>{"use strict";$();In();SFe=Ft(ou,n=>Math.acosh(n)),Qre={kernelName:ou,backendName:"cpu",kernelFunc:SFe}});function CFe(n){let{inputs:t,backend:e}=n,r=t;Ke(t,"addN");let o=r.map(a=>e.data.get(a.dataId).values),s=It(r[0].shape,r[0].dtype),i=s.values;for(let a=0;a<r.length;a++){let c=o[a];for(let l=0;l<i.length;l++)i[l]+=c[l]}return e.makeTensorInfo(s.shape,s.dtype,s.values)}var Zre,Jre=b(()=>{"use strict";$();kt();Zre={kernelName:rp,backendName:"cpu",kernelFunc:CFe}});function _Fe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s,keepDims:i}=r;Ke(o,"all");let a=N.parseAxisParam(s,o.shape),c=a,l=H.getAxesPermutation(c,o.shape.length),p=o;l!=null&&(p=ho({inputs:{x:o},backend:e,attrs:{perm:l}}),c=H.getInnerMostAxes(c.length,o.shape.length)),H.assertAxesAreInnerMostDims("all",c,p.shape.length);let[f,y]=H.computeOutAndReduceShapes(p.shape,c),d=N.sizeFromShape(y),h=N.makeZerosTypedArray(N.sizeFromShape(f),p.dtype),m=e.data.get(p.dataId).values;for(let w=0;w<h.length;++w){let _=w*d,I=m[_];for(let T=0;T<d;++T){let D=m[_+T];I=I&&D}h[w]=I}l!=null&&e.disposeIntermediateTensorInfo(p);let x=e.makeTensorInfo(f,p.dtype,h);if(i){let w=H.expandShapeToKeepDim(f,a),_=Sn({inputs:{x},backend:e,attrs:{shape:w}});return e.disposeIntermediateTensorInfo(x),_}return x}var eoe,toe=b(()=>{"use strict";$();kt();_s();La();eoe={kernelName:Qd,backendName:"cpu",kernelFunc:_Fe}});function TFe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s,keepDims:i}=r;Ke(o,"any");let a=N.parseAxisParam(s,o.shape),c=a,l=H.getAxesPermutation(c,o.shape.length),p=o;l!=null&&(p=ho({inputs:{x:o},backend:e,attrs:{perm:l}}),c=H.getInnerMostAxes(c.length,o.shape.length)),H.assertAxesAreInnerMostDims("any",c,p.shape.length);let[f,y]=H.computeOutAndReduceShapes(p.shape,c),d=N.sizeFromShape(y),h=N.makeZerosTypedArray(N.sizeFromShape(f),p.dtype),m=e.data.get(p.dataId).values;for(let w=0;w<h.length;++w){let _=w*d,I=m[_];for(let T=0;T<d;++T){let D=m[_+T];I=I||D}h[w]=I}l!=null&&e.disposeIntermediateTensorInfo(p);let x=e.makeTensorInfo(f,p.dtype,h);if(i){let w=H.expandShapeToKeepDim(f,a),_=Sn({inputs:{x},backend:e,attrs:{shape:w}});return e.disposeIntermediateTensorInfo(x),_}return x}var noe,roe=b(()=>{"use strict";$();kt();_s();La();noe={kernelName:Yd,backendName:"cpu",kernelFunc:TFe}});function IFe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s}=r;Ke(o,"argMax");let i=N.parseAxisParam(s,o.shape),a=H.getAxesPermutation(i,o.shape.length),c=o,l=[];a!=null&&(c=ho({inputs:{x:o},backend:e,attrs:{perm:a}}),l.push(c),i=H.getInnerMostAxes(i.length,c.shape.length)),i=[i[0]],H.assertAxesAreInnerMostDims("argMax",i,c.shape.length);let[p,f]=H.computeOutAndReduceShapes(c.shape,i),y=N.sizeFromShape(p),d=N.makeZerosTypedArray(y,"int32"),h=N.sizeFromShape(f),m=e.data.get(c.dataId).values;for(let x=0;x<d.length;++x){let w=x*h,_=m[w],I=0;for(let T=0;T<h;++T){let D=m[w+T];D>_&&(_=D,I=T)}d[x]=I}return l.forEach(x=>e.disposeIntermediateTensorInfo(x)),e.makeTensorInfo(p,"int32",d)}var ooe,soe=b(()=>{"use strict";$();kt();La();ooe={kernelName:op,backendName:"cpu",kernelFunc:IFe}});function EFe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s}=r;Ke(o,"argMin");let i=N.parseAxisParam(s,o.shape),a=H.getAxesPermutation(i,o.shape.length),c=o,l=[];a!=null&&(c=ho({inputs:{x:o},backend:e,attrs:{perm:a}}),l.push(c),i=H.getInnerMostAxes(i.length,c.shape.length)),i=[i[0]],H.assertAxesAreInnerMostDims("argMin",i,c.shape.length);let[p,f]=H.computeOutAndReduceShapes(c.shape,i),y=N.sizeFromShape(p),d=N.makeZerosTypedArray(y,"int32"),h=N.sizeFromShape(f),m=e.data.get(c.dataId).values;for(let x=0;x<d.length;++x){let w=x*h,_=m[w],I=0;for(let T=0;T<h;++T){let D=m[w+T];D<_&&(_=D,I=T)}d[x]=I}return l.forEach(x=>e.disposeIntermediateTensorInfo(x)),e.makeTensorInfo(p,"int32",d)}var ioe,aoe=b(()=>{"use strict";$();kt();La();ioe={kernelName:sp,backendName:"cpu",kernelFunc:EFe}});var NFe,coe,uoe=b(()=>{"use strict";$();In();NFe=Ft(su,n=>Math.asin(n)),coe={kernelName:su,backendName:"cpu",kernelFunc:NFe}});var DFe,loe,poe=b(()=>{"use strict";$();In();DFe=Ft(iu,n=>Math.asinh(n)),loe={kernelName:iu,backendName:"cpu",kernelFunc:DFe}});var kFe,hoe,foe=b(()=>{"use strict";$();In();kFe=Ft(au,n=>Math.atan(n)),hoe={kernelName:au,backendName:"cpu",kernelFunc:kFe}});var AFe,OFe,doe,moe=b(()=>{"use strict";$();po();ko();AFe=yn((n,t)=>Math.atan2(n,t)),OFe=_n(uu,AFe),doe={kernelName:uu,backendName:"cpu",kernelFunc:OFe}});var MFe,goe,yoe=b(()=>{"use strict";$();In();MFe=Ft(cu,n=>Math.atanh(n)),goe={kernelName:cu,backendName:"cpu",kernelFunc:MFe}});function pb(n,t,e,r,o,s){let i=o.strideHeight,a=o.strideWidth,c=o.dilationHeight,l=o.dilationWidth,p=o.effectiveFilterHeight,f=o.effectiveFilterWidth,y=o.padInfo.top,d=o.padInfo.left,h=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=It(o.outShape,e),x=m.values,w=o.outShape[1]*o.outShape[2]*o.outShape[3],_=o.outShape[2]*o.outShape[3],I=o.outShape[3];for(let T=0;T<o.batchSize;++T){let D=T*w,O=T*r[0];for(let R=0;R<o.inChannels;++R)for(let P=0;P<o.outHeight;++P){let j=P*i-y,G=Math.max(0,j),Q=Math.min(o.inHeight,p+j),ie=D+P*_;for(let pe=0;pe<o.outWidth;++pe){let xe=pe*a-d,ne=Math.max(0,xe),fe=Math.min(o.inWidth,f+xe),te=h,se=0,ee=0;for(let be=G;be<Q;be+=c){let ke=O+be*r[1];for(let De=ne;De<fe;De+=l){let Re=ke+De*r[2],Ce=n[Re+R];s==="max"&&Ce>te?te=Ce:s==="avg"&&(se+=Ce,ee++)}if(isNaN(te))break}let we=ie+pe*I+R;x[we]=s==="avg"?se/ee:te}}}return m}function QN(n,t,e,r,o=!1,s=!1){let i=It(r.outShape,"int32"),a=r.strideHeight,c=r.strideWidth,l=r.dilationHeight,p=r.dilationWidth,f=r.effectiveFilterHeight,y=r.effectiveFilterWidth,d=r.padInfo.top,h=r.padInfo.left,m=It(t,e,n);for(let x=0;x<r.batchSize;++x)for(let w=0;w<r.inChannels;++w)for(let _=0;_<r.outHeight;++_){let I=_*a-d,T=I;for(;T<0;)T+=l;let D=Math.min(r.inHeight,f+I);for(let O=0;O<r.outWidth;++O){let R=O*c-h,P=R;for(;P<0;)P+=p;let j=Math.min(r.inWidth,y+R),G=Number.NEGATIVE_INFINITY,Q=-1;for(let ie=T;ie<D;ie+=l){let pe=ie-I;for(let xe=P;xe<j;xe+=p){let ne=xe-R,fe=m.get(x,ie,xe,w);fe>G&&(G=fe,o?Q=s?((x*r.inHeight+ie)*r.inWidth+xe)*r.inChannels+w:(ie*r.inWidth+xe)*r.inChannels+w:Q=pe*y+ne)}}i.set(Q,x,_,O,w)}}return i}function YN(n,t,e,r,o,s){let i=o.strideDepth,a=o.strideHeight,c=o.strideWidth,l=o.dilationDepth,p=o.dilationHeight,f=o.dilationWidth,y=o.effectiveFilterDepth,d=o.effectiveFilterHeight,h=o.effectiveFilterWidth,m=o.padInfo.front,x=o.padInfo.top,w=o.padInfo.left,_=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,I=It(o.outShape,e),T=I.values,D=o.outShape[1]*o.outShape[2]*o.outShape[3]*o.outShape[4],O=o.outShape[2]*o.outShape[3]*o.outShape[4],R=o.outShape[3]*o.outShape[4],P=o.outShape[4];for(let j=0;j<o.batchSize;++j){let G=j*D,Q=j*r[0];for(let ie=0;ie<o.inChannels;++ie)for(let pe=0;pe<o.outDepth;++pe){let xe=pe*i-m,ne=xe;for(;ne<0;)ne+=l;let fe=Math.min(o.inDepth,y+xe),te=G+pe*O;for(let se=0;se<o.outHeight;++se){let ee=se*a-x,we=ee;for(;we<0;)we+=p;let be=Math.min(o.inHeight,d+ee),ke=te+se*R;for(let De=0;De<o.outWidth;++De){let Re=De*c-w,Ce=Re;for(;Ce<0;)Ce+=f;let Je=Math.min(o.inWidth,h+Re),rt=ke+De*P,qe=_,B=0,J=0;for(let le=ne;le<fe;le+=l){let Ge=Q+le*r[1];for(let Qe=we;Qe<be;Qe+=p){let dt=Ge+Qe*r[2];for(let yt=Ce;yt<Je;yt+=f){let Vt=dt+yt*r[3],En=n[Vt+ie];if(s==="max"&&En>qe?qe=En:s==="avg"&&(B+=En,J++),isNaN(qe))break}if(isNaN(qe))break}if(isNaN(qe))break}let Z=rt+ie;T[Z]=s==="avg"?B/J:qe}}}}return I}function xoe(n,t){let e=It(t.outShape,"int32"),r=t.strideDepth,o=t.strideHeight,s=t.strideWidth,i=t.dilationDepth,a=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,p=t.effectiveFilterHeight,f=t.effectiveFilterWidth,y=t.padInfo.front,d=t.padInfo.top,h=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let x=0;x<t.inChannels;++x)for(let w=0;w<t.outDepth;++w){let _=w*r-y,I=_;for(;I<0;)I+=i;let T=Math.min(t.inDepth,l+_);for(let D=0;D<t.outHeight;++D){let O=D*o-d,R=O;for(;R<0;)R+=a;let P=Math.min(t.inHeight,p+O);for(let j=0;j<t.outWidth;++j){let G=j*s-h,Q=G;for(;Q<0;)Q+=c;let ie=Math.min(t.inWidth,f+G),pe=Number.NEGATIVE_INFINITY,xe=-1;for(let ne=I;ne<T;ne+=i){let fe=ne-_;for(let te=R;te<P;te+=a){let se=te-O;for(let ee=Q;ee<ie;ee+=c){let we=ee-G,be=n.get(m,ne,te,ee,x);be>=pe&&(pe=be,xe=fe*p*f+se*p+we)}}}e.set(xe,m,w,D,j,x)}}}return e}var ed=b(()=>{"use strict";$();});function RFe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t;Ke(o,"avgPool");let{filterSize:s,strides:i,pad:a,dimRoundingMode:c}=r,l=1;N.assert(H.eitherStridesOrDilationsAreOne(i,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${l}'`);let p=H.computePool2DInfo(o.shape,s,i,l,a,c),f;if(p.filterWidth===1&&p.filterHeight===1&&N.arraysEqual(p.inShape,p.outShape))f=rs({inputs:{x:o},backend:e});else{let y=e.data.get(o.dataId).values,d=N.computeStrides(o.shape),h=pb(y,o.shape,o.dtype,d,p,"avg");f=e.makeTensorInfo(p.outShape,o.dtype,h.values)}return f}var voe,boe=b(()=>{"use strict";$();kt();ed();Dl();voe={kernelName:ip,backendName:"cpu",kernelFunc:RFe}});function PFe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{filterSize:s,strides:i,pad:a,dimRoundingMode:c,dataFormat:l,dilations:p}=r;Ke(o,"avgPool3d");let f=p;f==null&&(f=[1,1,1]);let y=H.computePool3DInfo(o.shape,s,i,f,a,c,l),d=e.data.get(o.dataId).values,h=YN(d,o.shape,o.dtype,N.computeStrides(o.shape),y,"avg");return e.makeTensorInfo(h.shape,"float32",h.values)}var woe,Soe=b(()=>{"use strict";$();kt();ed();woe={kernelName:ap,backendName:"cpu",kernelFunc:PFe}});function FFe(n){let{inputs:t,backend:e,attrs:r}=n,{dy:o,input:s}=t,{filterSize:i,strides:a,pad:c,dilations:l,dimRoundingMode:p}=r;Ke([o,s],"avgPool3DGrad");let f=H.computePool3DInfo(s.shape,i,a,l,c,p),y=f.strideDepth,d=f.strideHeight,h=f.strideWidth,m=f.filterDepth,x=f.filterHeight,w=f.filterWidth,_=f.dilationDepth,I=f.dilationHeight,T=f.dilationWidth,D=f.effectiveFilterDepth,O=f.effectiveFilterHeight,R=f.effectiveFilterWidth,P=D-1-f.padInfo.front,j=R-1-f.padInfo.left,G=O-1-f.padInfo.top,Q=It(s.shape,"float32"),ie=1/(m*x*w),pe=e.bufferSync(o);for(let xe=0;xe<f.batchSize;++xe)for(let ne=0;ne<f.inChannels;++ne)for(let fe=0;fe<f.inDepth;++fe)for(let te=0;te<f.inHeight;++te)for(let se=0;se<f.inWidth;++se){let ee=fe-P,we=te-G,be=se-j,ke=0;for(let De=0;De<D;De+=_){let Re=(ee+De)/y;if(!(Re<0||Re>=f.outDepth||Math.floor(Re)!==Re))for(let Ce=0;Ce<O;Ce+=I){let Je=(we+Ce)/d;if(!(Je<0||Je>=f.outHeight||Math.floor(Je)!==Je))for(let rt=0;rt<R;rt+=T){let qe=(be+rt)/h;if(qe<0||qe>=f.outWidth||Math.floor(qe)!==qe)continue;let B=pe.get(xe,Re,Je,qe,ne);ke+=B}}}Q.set(ke*ie,xe,fe,te,se,ne)}return e.makeTensorInfo(Q.shape,Q.dtype,Q.values)}var Coe,_oe=b(()=>{"use strict";$();kt();Coe={kernelName:Jd,backendName:"cpu",kernelFunc:FFe}});function $Fe(n){let{inputs:t,backend:e,attrs:r}=n,{dy:o,input:s}=t,i=s;Ke([o,s],"avgPoolGrad");let{filterSize:a,strides:c,pad:l}=r,p=H.computePool2DInfo(i.shape,a,c,1,l),f=p.strideHeight,y=p.strideWidth,d=p.filterHeight,h=p.filterWidth,m=p.dilationHeight,x=p.dilationWidth,w=p.effectiveFilterHeight,_=p.effectiveFilterWidth,I=_-1-p.padInfo.left,T=w-1-p.padInfo.top,D=It(i.shape,"float32"),O=1/(d*h),R=e.data.get(o.dataId).values,P=It(o.shape,"float32",R);for(let j=0;j<p.batchSize;++j)for(let G=0;G<p.inChannels;++G)for(let Q=0;Q<p.inHeight;++Q)for(let ie=0;ie<p.inWidth;++ie){let pe=Q-T,xe=ie-I,ne=0;for(let fe=0;fe<w;fe+=m){let te=(pe+fe)/f;if(!(te<0||te>=p.outHeight||Math.floor(te)!==te))for(let se=0;se<_;se+=x){let ee=(xe+se)/y;if(ee<0||ee>=p.outWidth||Math.floor(ee)!==ee)continue;let we=P.get(j,te,ee,G);ne+=we}}D.set(ne*O,j,Q,ie,G)}return e.makeTensorInfo(D.shape,D.dtype,D.values)}var Toe,Ioe=b(()=>{"use strict";$();kt();Toe={kernelName:Zd,backendName:"cpu",kernelFunc:$Fe}});function LFe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,scale:s,offset:i,mean:a,variance:c}=t;N.assert(a.shape.length===c.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),N.assert(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),N.assert(s==null||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ke([o,a,c,s,i],"batchNorm");let{varianceEpsilon:l}=r;l==null&&(l=.001);let p=e.data.get(o.dataId).values,f=e.data.get(a.dataId).values,y=e.data.get(c.dataId).values,d=s?e.data.get(s.dataId).values:new Float32Array([1]),h=i?e.data.get(i.dataId).values:new Float32Array([0]),m=new Float32Array(p.length),x=h.length,w=d.length,_=y.length,I=f.length,T=0,D=0,O=0,R=0;for(let P=0;P<p.length;++P)m[P]=h[T++]+(p[P]-f[D++])*d[O++]/Math.sqrt(y[R++]+l),T>=x&&(T=0),D>=I&&(D=0),O>=w&&(O=0),R>=_&&(R=0);return e.makeTensorInfo(o.shape,o.dtype,m)}var Eoe,Noe=b(()=>{"use strict";$();kt();Eoe={kernelName:vp,backendName:"cpu",kernelFunc:LFe}});function zFe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{blockShape:s,crops:i}=r;Ke([o],"batchToSpaceND");let a=s.reduce((w,_)=>w*_),c=H.getReshaped(o.shape,s,a),l=H.getPermuted(c.length,s.length),p=H.getReshapedPermuted(o.shape,s,a),f=H.getSliceBeginCoords(i,s.length),y=H.getSliceSize(p,i,s.length),d=Sn({inputs:{x:o},backend:e,attrs:{shape:c}}),h=ho({inputs:{x:d},backend:e,attrs:{perm:l}}),m=Sn({inputs:{x:h},backend:e,attrs:{shape:p}}),x=za({inputs:{x:m},backend:e,attrs:{begin:f,size:y}});return e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(m),x}var Doe,koe=b(()=>{"use strict";$();kt();_s();Jf();La();Doe={kernelName:up,backendName:"cpu",kernelFunc:zFe}});function BFe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,weights:s}=t,{size:i}=r,a=e.data.get(o.dataId).values,c=e.data.get(s.dataId).values,l=ab(a,c,s.dtype,s.shape,i);return e.makeTensorInfo([i],s.dtype,l)}var Aoe,Ooe=b(()=>{"use strict";$();$N();Aoe={kernelName:em,backendName:"cpu",kernelFunc:BFe}});var VFe,Moe,Roe=b(()=>{"use strict";$();In();VFe=Ft(pu,(n,t)=>{let e=t;return n>e.clipValueMax?e.clipValueMax:n<e.clipValueMin?e.clipValueMin:n}),Moe={kernelName:pu,backendName:"cpu",kernelFunc:VFe}});var qFe,Poe,Foe=b(()=>{"use strict";$();qFe=n=>{let{x:t}=n.inputs,e=n.backend,r=new Float32Array(N.sizeFromShape(t.shape)),o=e.data.get(t.dataId),s=o.complexTensorInfos.real,i=o.complexTensorInfos.imag,a=e.data.get(s.dataId).values,c=e.data.get(i.dataId).values;for(let l=0;l<a.length;l++){let p=a[l],f=c[l];r[l]=Math.hypot(p,f)}return e.makeOutput(r,t.shape,"float32")},Poe={kernelName:lp,backendName:"cpu",kernelFunc:qFe}});function kl(n){let{inputs:t,backend:e}=n,{input:r}=t,o=e.data.get(r.dataId).complexTensorInfos.imag,s=e.data.get(o.dataId).values;return e.makeTensorInfo(o.shape,o.dtype,s)}var $oe,hb=b(()=>{"use strict";$();$oe={kernelName:ym,backendName:"cpu",kernelFunc:kl}});function td(n){let{inputs:t,backend:e,attrs:r}=n,{axis:o}=r,s=N.parseAxisParam(o,t[0].shape)[0],i=H.computeOutShape(t.map(m=>m.shape),s);if(N.sizeFromShape(i)===0)return e.makeTensorInfo(i,t[0].dtype,[]);let a=t.filter(m=>N.sizeFromShape(m.shape)>0);if(a.length===1)return rs({inputs:{x:a[0]},backend:e});let c=a.map(m=>m.shape);if(H.assertParamsConsistent(c,s),a[0].dtype==="complex64"){let m=a.map(T=>Ra({inputs:{input:T},backend:e})),x=a.map(T=>kl({inputs:{input:T},backend:e})),w=td({inputs:m,backend:e,attrs:{axis:s}}),_=td({inputs:x,backend:e,attrs:{axis:s}}),I=wo({inputs:{real:w,imag:_},backend:e});return m.forEach(T=>e.disposeIntermediateTensorInfo(T)),x.forEach(T=>e.disposeIntermediateTensorInfo(T)),e.disposeIntermediateTensorInfo(w),e.disposeIntermediateTensorInfo(_),I}let l=a.map(m=>{let w=[-1,N.sizeFromShape(m.shape.slice(s))];return Sn({inputs:{x:m},backend:e,attrs:{shape:w}})}),p=l.map(m=>({vals:e.data.get(m.dataId).values,shape:m.shape}));i=H.computeOutShape(l.map(m=>m.shape),1);let f=l[0].shape[0]===1,y=LN(p,i,t[0].dtype,f),d=H.computeOutShape(a.map(m=>m.shape),s),h=e.makeTensorInfo(d,t[0].dtype,y);return l.forEach(m=>e.disposeIntermediateTensorInfo(m)),h}var Loe,ZN=b(()=>{"use strict";$();bh();p3();Dl();hb();Ig();_s();Loe={kernelName:pp,backendName:"cpu",kernelFunc:td}});function cz(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,filter:s}=t,{strides:i,pad:a,dataFormat:c,dilations:l,dimRoundingMode:p}=r;Ke([o,s],"conv2d");let f=H.convertConv2DDataFormat(c),y=H.computeConv2DInfo(o.shape,s.shape,i,l,a,p,!1,f),d=y.filterHeight,h=y.filterWidth,m=y.dilationHeight,x=y.dilationWidth,w=y.padInfo.left,_=y.padInfo.top,I=y.dataFormat==="channelsLast",T=new Dn(y.outShape,o.dtype),D=N.computeStrides(o.shape),O=N.computeStrides(s.shape),R=D[0],P=I?D[1]:D[2],j=I?D[2]:1,G=I?1:D[1],Q=T.strides[0],ie=I?T.strides[1]:T.strides[2],pe=I?T.strides[2]:1,xe=I?1:T.strides[1],ne=e.data.get(o.dataId).values,fe=e.data.get(s.dataId).values,te=T.values;for(let se=0;se<y.batchSize;++se){let ee=se*R,we=se*Q;for(let be=0;be<y.outHeight;++be){let ke=we+be*ie,De=be*y.strideHeight-_;for(let Re=0;Re<d;++Re){let Ce=De+Re*m;if(Ce<0||Ce>=y.inHeight)continue;let Je=Re*O[0],rt=ee+Ce*P;for(let qe=0;qe<y.outWidth;++qe){let B=ke+qe*pe,J=qe*y.strideWidth-w;for(let Z=0;Z<h;++Z){let le=J+Z*x;if(le<0||le>=y.inWidth)continue;let Ge=Je+Z*O[1],Qe=rt+le*j,dt=Ge;for(let yt=0;yt<y.inChannels;++yt){let Vt=ne[Qe+yt*G];for(let En=0;En<y.outChannels;++En)te[B+En*xe]+=Vt*fe[dt+En];dt+=y.outChannels}}}}}}return e.makeTensorInfo(T.shape,T.dtype,te)}var zoe,uz=b(()=>{"use strict";$();kt();zoe={kernelName:hp,backendName:"cpu",kernelFunc:cz}});function UFe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,dy:s}=t,{strides:i,pad:a,dataFormat:c,dimRoundingMode:l,filterShape:p}=r;Ke([o,s],"conv2dBackpropFilter");let f=H.convertConv2DDataFormat(c),y=H.computeConv2DInfo(o.shape,p,i,1,a,l,!1,f),{strideHeight:d,strideWidth:h,filterHeight:m,filterWidth:x}=y,w=y.dataFormat==="channelsLast",_=new Dn(y.filterShape,"float32"),I=y.padInfo.left,T=y.padInfo.top,D=e.data.get(o.dataId).values,O=e.data.get(s.dataId).values,R=new Dn(o.shape,o.dtype,D),P=new Dn(s.shape,s.dtype,O);for(let j=0;j<m;++j){let G=Math.max(0,Math.ceil((T-j)/d)),Q=Math.min(y.outHeight,(y.inHeight+T-j)/d);for(let ie=0;ie<x;++ie){let pe=Math.max(0,Math.ceil((I-ie)/h)),xe=Math.min(y.outWidth,(y.inWidth+I-ie)/h);for(let ne=0;ne<y.inChannels;++ne)for(let fe=0;fe<y.outChannels;++fe){let te=0;for(let se=0;se<y.batchSize;++se)for(let ee=G;ee<Q;++ee){let we=j+ee*d-T;for(let be=pe;be<xe;++be){let ke=ie+be*h-I;w?te+=R.get(se,we,ke,ne)*P.get(se,ee,be,fe):te+=R.get(se,ne,we,ke)*P.get(se,fe,ee,be)}}_.set(te,j,ie,ne,fe)}}}return e.makeTensorInfo(_.shape,_.dtype,_.values)}var Boe,Voe=b(()=>{"use strict";$();kt();Boe={kernelName:nm,backendName:"cpu",kernelFunc:UFe}});function jFe(n){let{inputs:t,backend:e,attrs:r}=n,{dy:o,filter:s}=t,{inputShape:i,strides:a,pad:c,dataFormat:l,dimRoundingMode:p}=r;Ke([o,s],"conv2dBackpropInput");let f=N.computeStrides(s.shape),y=N.computeStrides(o.shape),d=H.convertConv2DDataFormat(l),h=H.computeConv2DInfo(i,s.shape,a,1,c,p,!1,d),m=new Dn(h.inShape,"float32"),x=m.values,w=e.data.get(o.dataId).values,_=e.data.get(s.dataId).values,[I,T,D]=f,{batchSize:O,filterHeight:R,filterWidth:P,inChannels:j,inHeight:G,inWidth:Q,outChannels:ie,outHeight:pe,outWidth:xe,strideHeight:ne,strideWidth:fe}=h;d=h.dataFormat;let te=R-1-h.padInfo.top,se=P-1-h.padInfo.left,ee=d==="channelsLast",we=m.strides[0],be=ee?m.strides[1]:m.strides[2],ke=ee?m.strides[2]:1,De=ee?1:m.strides[1],Re=y[0],Ce=ee?y[1]:y[2],Je=ee?y[2]:1,rt=ee?1:y[1];for(let qe=0;qe<O;++qe)for(let B=0;B<j;++B)for(let J=0;J<G;++J){let Z=J-te,le=Math.max(0,Math.ceil(Z/ne)),Ge=Math.min(pe,(R+Z)/ne);for(let Qe=0;Qe<Q;++Qe){let dt=Qe-se,yt=Math.max(0,Math.ceil(dt/fe)),Vt=Math.min(xe,(P+dt)/fe),En=0;for(let tn=le;tn<Ge;++tn){let So=tn*ne-Z;for(let Ar=yt;Ar<Vt;++Ar){let ii=Ar*fe-dt,is=Re*qe+Ce*tn+Je*Ar,Es=I*(R-1-So)+T*(P-1-ii)+D*B;for(let Xr=0;Xr<ie;++Xr){let ja=w[is+rt*Xr],ai=_[Es+Xr];En+=ja*ai}}}let ss=we*qe+be*J+ke*Qe+De*B;x[ss]=En}}return e.makeTensorInfo(m.shape,m.dtype,m.values)}var qoe,Uoe=b(()=>{"use strict";$();kt();qoe={kernelName:fp,backendName:"cpu",kernelFunc:jFe}});function GFe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,filter:s}=t,{strides:i,pad:a,dilations:c}=r;Ke([o,s],"conv3d");let l=H.computeConv3DInfo(o.shape,s.shape,i,c,a),{filterDepth:p,filterHeight:f,filterWidth:y,dilationDepth:d,dilationHeight:h,dilationWidth:m,padInfo:x}=l,w=x.front,_=x.left,I=x.top,T=new Dn(l.outShape,o.dtype),D=e.data.get(o.dataId).values,O=e.data.get(s.dataId).values,R=T.values,P=N.computeStrides(o.shape),j=N.computeStrides(s.shape);for(let G=0;G<l.batchSize;++G){let Q=G*P[0],ie=G*T.strides[0];for(let pe=0;pe<l.outDepth;++pe){let xe=ie+pe*T.strides[1],ne=pe*l.strideDepth-w;for(let fe=0;fe<p;++fe){let te=ne+fe*d;if(te<0||te>=l.inDepth)continue;let se=fe*j[0],ee=Q+te*P[1];for(let we=0;we<l.outHeight;++we){let be=xe+we*T.strides[2],ke=we*l.strideHeight-I;for(let De=0;De<f;++De){let Re=ke+De*h;if(Re<0||Re>=l.inHeight)continue;let Ce=se+De*j[1],Je=ee+Re*P[2];for(let rt=0;rt<l.outWidth;++rt){let qe=be+rt*l.outChannels,B=rt*l.strideWidth-_;for(let J=0;J<y;++J){let Z=B+J*m;if(Z<0||Z>=l.inWidth)continue;let le=Ce+J*j[2],Ge=Je+Z*l.inChannels,Qe=le;for(let dt=0;dt<l.inChannels;++dt){let yt=D[Ge+dt];for(let Vt=0;Vt<l.outChannels;++Vt)R[qe+Vt]+=yt*O[Qe+Vt];Qe+=l.outChannels}}}}}}}}return e.makeTensorInfo(T.shape,T.dtype,T.values)}var joe,Goe=b(()=>{"use strict";$();kt();joe={kernelName:dp,backendName:"cpu",kernelFunc:GFe}});function WFe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,dy:s}=t,{strides:i,pad:a,filterShape:c}=r;Ke([o,s],"conv3dBackpropFilterV2");let l=N.computeStrides(o.shape),p=N.computeStrides(s.shape),f=H.computeConv3DInfo(o.shape,c,i,1,a),y=f.strideDepth,d=f.strideHeight,h=f.strideWidth,m=f.filterDepth,x=f.filterHeight,w=f.filterWidth,_=new Dn(f.filterShape,"float32"),I=_.values,[T,D,O,R]=_.strides,P=e.data.get(s.dataId).values,[j,G,Q,ie]=p,pe=e.data.get(o.dataId).values,[xe,ne,fe,te]=l,se=f.padInfo.front,ee=f.padInfo.left,we=f.padInfo.top;for(let be=0;be<m;++be){let ke=Math.max(0,Math.ceil((se-be)/y)),De=Math.min(f.outDepth,(f.inDepth+se-be)/y),Re=be*T;for(let Ce=0;Ce<x;++Ce){let Je=Math.max(0,Math.ceil((we-Ce)/d)),rt=Math.min(f.outHeight,(f.inHeight+we-Ce)/d),qe=Ce*D+Re;for(let B=0;B<w;++B){let J=Math.max(0,Math.ceil((ee-B)/h)),Z=Math.min(f.outWidth,(f.inWidth+ee-B)/h),le=B*O+qe;for(let Ge=0;Ge<f.inChannels;++Ge){let Qe=Ge*R+le;for(let dt=0;dt<f.outChannels;++dt){let yt=0;for(let Vt=0;Vt<f.batchSize;++Vt){let En=Vt*xe,ss=Vt*j;for(let tn=ke;tn<De;++tn){let Ar=(be+tn*y-se)*ne+En,ii=tn*G+ss;for(let is=Je;is<rt;++is){let Xr=(Ce+is*d-we)*fe+Ar,ja=is*Q+ii;for(let ai=J;ai<Z;++ai){let Wa=(B+ai*h-ee)*te+Xr,Rc=ai*ie+ja;yt+=pe[Wa+Ge]*P[Rc+dt]}}}}I[Qe+dt]=yt}}}}}return e.makeTensorInfo(_.shape,_.dtype,_.values)}var Woe,Hoe=b(()=>{"use strict";$();kt();Woe={kernelName:rm,backendName:"cpu",kernelFunc:WFe}});function HFe(n){let{inputs:t,backend:e,attrs:r}=n,{dy:o,filter:s}=t,{pad:i,strides:a,inputShape:c}=r;Ke([o],"conv3dBackpropInputV2");let l=N.computeStrides(o.shape),p=N.computeStrides(s.shape),f=H.computeConv3DInfo(c,s.shape,a,1,i),y=new Dn(f.inShape,"float32"),d=y.values,[h,m,x,w]=y.strides,_=e.data.get(o.dataId).values,[I,T,D,O]=l,R=e.data.get(s.dataId).values,[P,j,G,Q]=p,{batchSize:ie,filterDepth:pe,filterHeight:xe,filterWidth:ne,inChannels:fe,inDepth:te,inHeight:se,inWidth:ee,outChannels:we,outDepth:be,outHeight:ke,outWidth:De,strideDepth:Re,strideHeight:Ce,strideWidth:Je}=f,rt=pe-1-f.padInfo.front,qe=xe-1-f.padInfo.top,B=ne-1-f.padInfo.left;for(let J=0;J<ie;++J)for(let Z=0;Z<fe;++Z)for(let le=0;le<te;++le){let Ge=le-rt,Qe=Math.max(0,Math.ceil(Ge/Re)),dt=Math.min(be,(pe+Ge)/Re);for(let yt=0;yt<se;++yt){let Vt=yt-qe,En=Math.max(0,Math.ceil(Vt/Ce)),ss=Math.min(ke,(xe+Vt)/Ce);for(let tn=0;tn<ee;++tn){let So=tn-B,Ar=Math.max(0,Math.ceil(So/Je)),ii=Math.min(De,(ne+So)/Je),is=0;for(let Es=Qe;Es<dt;++Es){let Xr=Es*Re-Ge;for(let ja=En;ja<ss;++ja){let ai=ja*Ce-Vt;for(let Ga=Ar;Ga<ii;++Ga){let Wa=Ga*Je-So,Rc=I*J+T*Es+D*ja+O*Ga,Eh=P*(pe-1-Xr)+j*(xe-1-ai)+G*(ne-1-Wa)+Q*Z;for(let Rl=0;Rl<we;++Rl){let Nh=_[Rc+Rl],Ab=R[Eh+Rl];is+=Nh*Ab}}}}d[h*J+m*le+x*yt+w*tn+Z]=is}}}return e.makeTensorInfo(y.shape,y.dtype,y.values)}var Koe,Xoe=b(()=>{"use strict";$();kt();Koe={kernelName:om,backendName:"cpu",kernelFunc:HFe}});var KFe,Qoe,Yoe=b(()=>{"use strict";$();In();KFe=Ft(hu,n=>Math.cos(n)),Qoe={kernelName:hu,backendName:"cpu",kernelFunc:KFe}});var XFe,Zoe,Joe=b(()=>{"use strict";$();In();XFe=Ft(fu,n=>Math.cosh(n)),Zoe={kernelName:fu,backendName:"cpu",kernelFunc:XFe}});function QFe(n){let{inputs:t,backend:e,attrs:r}=n,{image:o,boxes:s,boxInd:i}=t,{cropSize:a,method:c,extrapolationValue:l}=r,[p,f,y,d]=o.shape,h=s.shape[0],[m,x]=a,w=It([h,m,x,d],"float32"),_=e.data.get(s.dataId).values,I=e.data.get(i.dataId).values,T=e.data.get(o.dataId).values,D=N.computeStrides(o.shape),O=N.computeStrides(w.shape);for(let R=0;R<h;R++){let P=R*4,j=_[P],G=_[P+1],Q=_[P+2],ie=_[P+3],pe=I[R];if(pe>=p)continue;let xe=m>1?(Q-j)*(f-1)/(m-1):0,ne=x>1?(ie-G)*(y-1)/(x-1):0;for(let fe=0;fe<m;fe++){let te=m>1?j*(f-1)+fe*xe:.5*(j+Q)*(f-1);if(te<0||te>f-1){for(let se=0;se<x;se++)for(let ee=0;ee<d;ee++){let we=ee+se*O[2]+fe*O[1]+R*O[0];w.values[we]=l}continue}if(c==="bilinear"){let se=Math.floor(te),ee=Math.ceil(te),we=te-se;for(let be=0;be<x;be++){let ke=x>1?G*(y-1)+be*ne:.5*(G+ie)*(y-1);if(ke<0||ke>y-1){for(let Je=0;Je<d;Je++){let rt=Je+be*O[2]+fe*O[1]+R*O[0];w.values[rt]=l}continue}let De=Math.floor(ke),Re=Math.ceil(ke),Ce=ke-De;for(let Je=0;Je<d;Je++){let rt=Je+De*D[2]+se*D[1]+pe*D[0],qe=T[rt];rt=Je+Re*D[2]+se*D[1]+pe*D[0];let B=T[rt];rt=Je+De*D[2]+ee*D[1]+pe*D[0];let J=T[rt];rt=Je+Re*D[2]+ee*D[1]+pe*D[0];let Z=T[rt],le=qe+(B-qe)*Ce,Ge=J+(Z-J)*Ce;rt=Je+be*O[2]+fe*O[1]+R*O[0],w.values[rt]=le+(Ge-le)*we}}}else for(let se=0;se<x;++se){let ee=x>1?G*(y-1)+se*ne:.5*(G+ie)*(y-1);if(ee<0||ee>y-1){for(let ke=0;ke<d;ke++){let De=ke+se*O[2]+fe*O[1]+R*O[0];w.values[De]=l}continue}let we=Math.round(ee),be=Math.round(te);for(let ke=0;ke<d;ke++){let De=ke+we*D[2]+be*D[1]+pe*D[0],Re=ke+se*O[2]+fe*O[1]+R*O[0];w.values[Re]=T[De]}}}}return e.makeTensorInfo(w.shape,w.dtype,w.values)}var ese,tse=b(()=>{"use strict";$();ese={kernelName:sm,backendName:"cpu",kernelFunc:QFe}});function YFe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s,exclusive:i,reverse:a}=r;Ke(o,"cumsum");let c=H.getAxesPermutation([s],o.shape.length),l=o;c!=null&&(l=ho({inputs:{x:o},backend:e,attrs:{perm:c}}));let p=H.getInnerMostAxes(1,o.shape.length)[0];if(p!==l.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${p}`);let f=ro(l.dtype,"int32"),y=N.makeZerosTypedArray(N.sizeFromShape(l.shape),f),d=e.data.get(l.dataId).values,h=l.shape[l.shape.length-1],m=a?(w,_)=>w+h-_-1:(w,_)=>w+_;for(let w=0;w<d.length;w+=h)for(let _=0;_<h;_++){let I=m(w,_);if(_===0)y[I]=i?0:d[I];else{let T=m(w,_-1);y[I]=i?d[T]+y[T]:d[I]+y[T]}}let x=e.makeTensorInfo(l.shape,f,y);if(c!=null){let w=H.getUndoAxesPermutation(c),_=ho({inputs:{x},backend:e,attrs:{perm:w}});return e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(l),_}return x}var nse,rse=b(()=>{"use strict";$();kt();La();nse={kernelName:mp,backendName:"cpu",kernelFunc:YFe}});function ZFe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,weights:s}=t,{size:i,binaryOutput:a}=r;if(o.shape.length===1){let c=e.data.get(o.dataId).values,l=e.data.get(s.dataId).values,p=ab(c,l,s.dtype,s.shape,i);return e.makeTensorInfo([i],s.dtype,p)}else if(o.shape.length===2){let c=e.bufferSync(o),l=e.bufferSync(s),p=FN(c,l,i,a);return e.makeTensorInfo(p.shape,s.dtype,p.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}var ose,sse=b(()=>{"use strict";$();$N();ose={kernelName:im,backendName:"cpu",kernelFunc:ZFe}});function JFe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{blockSize:s,dataFormat:i}=r;N.assert(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`),N.assert(s>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${s}`);let a=o.shape[0],c=o.shape[1],l=o.shape[2],p=o.shape[3],f=c*s,y=l*s,d=p/(s*s),h=e.data.get(o.dataId).values,m=new Float32Array(a*f*y*d),x=0;for(let w=0;w<a;++w)for(let _=0;_<f;++_){let I=Math.floor(_/s),T=_%s;for(let D=0;D<y;++D){let O=Math.floor(D/s),R=D%s,P=(T*s+R)*d;for(let j=0;j<d;++j){let Q=j+P+p*(O+l*(I+c*w));m[x++]=h[Q]}}}return e.makeTensorInfo([a,f,y,d],o.dtype,m)}var ise,ase=b(()=>{"use strict";$();ise={kernelName:am,backendName:"cpu",kernelFunc:JFe}});function lz(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,filter:s}=t,{strides:i,pad:a,dilations:c,dimRoundingMode:l}=r;Ke([o,s],"depthwiseConv2DNative");let p=N.computeStrides(o.shape),f=N.computeStrides(s.shape),y=c;y==null&&(y=[1,1]),N.assert(H.eitherStridesOrDilationsAreOne(i,y),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${y}'`);let d=H.computeConv2DInfo(o.shape,s.shape,i,y,a,l,!0),{filterHeight:h,filterWidth:m,dilationHeight:x,dilationWidth:w,padInfo:_}=d,I=_.left,T=_.top,D=d.outChannels/d.inChannels,O=new Dn(d.outShape,o.dtype),R=e.data.get(o.dataId).values,P=e.data.get(s.dataId).values,j=O.values;for(let G=0;G<d.batchSize;++G){let Q=G*p[0],ie=G*O.strides[0];for(let pe=0;pe<d.outHeight;++pe){let xe=ie+pe*O.strides[1],ne=pe*d.strideHeight-I;for(let fe=0;fe<h;++fe){let te=ne+fe*x;if(te<0||te>=d.inHeight)continue;let se=fe*f[0],ee=Q+te*p[1];for(let we=0;we<d.outWidth;++we){let be=xe+we*O.strides[2],ke=we*d.strideWidth-T;for(let De=0;De<m;++De){let Re=ke+De*w;if(Re<0||Re>=d.inWidth)continue;let Ce=se+De*f[1],Je=ee+Re*d.inChannels,rt=be,qe=Ce;for(let B=0;B<d.inChannels;++B){let J=R[Je+B];for(let Z=0;Z<D;++Z)j[rt+Z]+=J*P[qe+Z];rt+=D,qe+=D}}}}}}return e.makeTensorInfo(O.shape,O.dtype,O.values)}var cse,pz=b(()=>{"use strict";$();kt();cse={kernelName:gp,backendName:"cpu",kernelFunc:lz}});function e$e(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,dy:s}=t,{strides:i,dilations:a,pad:c,dimRoundingMode:l,filterShape:p}=r;Ke([o,s],"depthwiseConv2dNativeBackpropFilter");let f=H.computeConv2DInfo(o.shape,p,i,a,c,l,!0),{strideHeight:y,strideWidth:d,filterHeight:h,filterWidth:m}=f,x=new Dn(f.filterShape,"float32"),w=f.padInfo.left,_=f.padInfo.top,I=f.outChannels/f.inChannels,T=e.data.get(o.dataId).values,D=new Dn(o.shape,o.dtype,T),O=e.data.get(s.dataId).values,R=new Dn(s.shape,s.dtype,O);for(let P=0;P<h;++P){let j=Math.max(0,Math.ceil((_-P)/y)),G=Math.min(f.outHeight,(f.inHeight+_-P)/y);for(let Q=0;Q<m;++Q){let ie=Math.max(0,Math.ceil((w-Q)/d)),pe=Math.min(f.outWidth,(f.inWidth+w-Q)/d);for(let xe=0;xe<f.outChannels;++xe){let ne=Math.trunc(xe/I),fe=xe%I,te=0;for(let se=0;se<f.batchSize;++se)for(let ee=j;ee<G;++ee){let we=P+ee*y-_;for(let be=ie;be<pe;++be){let ke=Q+be*d-w;te+=D.get(se,we,ke,ne)*R.get(se,ee,be,xe)}}x.set(te,P,Q,ne,fe)}}}return e.makeTensorInfo(x.shape,x.dtype,x.values)}var use,lse=b(()=>{"use strict";$();kt();use={kernelName:cm,backendName:"cpu",kernelFunc:e$e}});function t$e(n){let{inputs:t,backend:e,attrs:r}=n,{dy:o,filter:s}=t,{strides:i,dilations:a,pad:c,dimRoundingMode:l,inputShape:p}=r;Ke([o,s],"depthwiseConv2DNativeBackpropInput");let f=N.computeStrides(o.shape),y=N.computeStrides(s.shape),d=H.computeConv2DInfo(p,s.shape,i,a,c,l,!0),h=new Dn(d.inShape,"float32"),m=h.values,[x,w,_]=h.strides,I=e.data.get(o.dataId).values,[T,D,O]=f,R=e.data.get(s.dataId).values,[P,j,G]=y,{batchSize:Q,filterHeight:ie,filterWidth:pe,inChannels:xe,inHeight:ne,inWidth:fe,outChannels:te,outHeight:se,outWidth:ee,strideHeight:we,strideWidth:be}=d,ke=ie-1-d.padInfo.top,De=pe-1-d.padInfo.left,Re=te/xe;for(let Ce=0;Ce<Q;++Ce)for(let Je=0;Je<xe;++Je)for(let rt=0;rt<ne;++rt){let qe=rt-ke,B=Math.max(0,Math.ceil(qe/we)),J=Math.min(se,(ie+qe)/we);for(let Z=0;Z<fe;++Z){let le=Z-De,Ge=Math.max(0,Math.ceil(le/be)),Qe=Math.min(ee,(pe+le)/be),dt=0;for(let yt=B;yt<J;++yt){let Vt=yt*we-qe;for(let En=Ge;En<Qe;++En){let ss=En*be-le,tn=T*Ce+D*yt+O*En,So=P*(ie-1-Vt)+j*(pe-1-ss)+G*Je;for(let Ar=0;Ar<Re;++Ar){let ii=Je*Re+Ar,is=I[tn+ii],Es=R[So+Ar];dt+=is*Es}}}m[x*Ce+w*rt+_*Z+Je]=dt}}return e.makeTensorInfo(h.shape,h.dtype,h.values)}var pse,hse=b(()=>{"use strict";$();kt();pse={kernelName:um,backendName:"cpu",kernelFunc:t$e}});function n$e(n){let{inputs:t,backend:e}=n,{x:r}=t,o=N.sizeFromShape(r.shape),s=e.data.get(r.dataId).values,i=It([o,o],r.dtype),a=i.values;for(let l=0;l<s.length;l++)a[l*o+l]=s[l];let c=[...r.shape,...r.shape];return e.makeTensorInfo(c,i.dtype,i.values)}var fse,dse=b(()=>{"use strict";$();fse={kernelName:lm,backendName:"cpu",kernelFunc:n$e}});var mse,gse=b(()=>{"use strict";$();mse={kernelName:yp,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{let{x:r,filter:o}=n,{strides:s,pad:i,dilations:a}=e,c=t,l=c.data.get(r.dataId).values,p=r.shape.length,f=c.data.get(o.dataId).values,y=o.shape.length,{batchSize:d,inHeight:h,inWidth:m,inChannels:x,outHeight:w,outWidth:_,padInfo:I,strideHeight:T,strideWidth:D,filterHeight:O,filterWidth:R,dilationHeight:P,dilationWidth:j,outShape:G}=H.computeDilation2DInfo(r.shape,o.shape,s,i,"NHWC",a),Q=N.sizeFromShape(G),ie=G.length,pe=N.getArrayFromDType(r.dtype,Q);for(let ne=0;ne<d;++ne)for(let fe=0;fe<w;++fe){let te=fe*T-I.top;for(let se=0;se<_;++se){let ee=se*D-I.left;for(let we=0;we<x;++we){let be=Number.MIN_SAFE_INTEGER;for(let De=0;De<O;++De){let Re=te+De*P;if(Re>=0&&Re<h)for(let Ce=0;Ce<R;++Ce){let Je=ee+Ce*j;if(Je>=0&&Je<m){let rt=N.locToIndex([ne,Re,Je,we],p,N.computeStrides(r.shape)),qe=N.locToIndex([De,Ce,we],y,N.computeStrides(o.shape)),B=l[rt]+f[qe];B>be&&(be=B)}}}let ke=N.locToIndex([ne,fe,se,we],ie,N.computeStrides(G));pe[ke]=be}}}return{dataId:c.write(N.toTypedArray(pe,r.dtype),G,r.dtype),shape:G,dtype:r.dtype}}}});var yse,xse=b(()=>{"use strict";$();yse={kernelName:wx,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{let{x:r,filter:o,dy:s}=n,{strides:i,pad:a,dilations:c}=e,l=t,p=N.toNestedArray(r.shape,l.data.get(r.dataId).values),f=N.toNestedArray(o.shape,l.data.get(o.dataId).values),{batchSize:y,inHeight:d,inWidth:h,inChannels:m,outHeight:x,outWidth:w,padInfo:_,strideHeight:I,strideWidth:T,filterHeight:D,filterWidth:O,dilationHeight:R,dilationWidth:P,outShape:j}=H.computeDilation2DInfo(r.shape,o.shape,i,a,"NHWC",c);N.assert(s.rank===j.length,()=>`Error in ${wx}, dy must have the same rank as output ${j.length}, but got ${s.rank}`);let G=N.toNestedArray(j,l.data.get(s.dataId).values),Q=N.makeZerosNestedTypedArray(o.shape,o.dtype);for(let pe=0;pe<y;++pe)for(let xe=0;xe<x;++xe){let ne=xe*I-_.top;for(let fe=0;fe<w;++fe){let te=fe*T-_.left;for(let se=0;se<m;++se){let ee=Number.MIN_SAFE_INTEGER,we=0,be=0;for(let ke=0;ke<D;++ke){let De=ne+ke*R;if(De>=0&&De<d)for(let Re=0;Re<O;++Re){let Ce=te+Re*P;if(Ce>=0&&Ce<h){let Je=p[pe][De][Ce][se]+f[ke][Re][se];Je>ee&&(ee=Je,we=ke,be=Re)}}}Q[we][be][se]+=G[pe][xe][fe][se]}}}return{dataId:l.write(N.toTypedArray(Q,r.dtype),o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}}});var vse,bse=b(()=>{"use strict";$();vse={kernelName:bx,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{let{x:r,filter:o,dy:s}=n,{strides:i,pad:a,dilations:c}=e,l=t,p=N.toNestedArray(r.shape,l.data.get(r.dataId).values),f=N.toNestedArray(o.shape,l.data.get(o.dataId).values),{batchSize:y,inHeight:d,inWidth:h,inChannels:m,outHeight:x,outWidth:w,padInfo:_,strideHeight:I,strideWidth:T,filterHeight:D,filterWidth:O,dilationHeight:R,dilationWidth:P,outShape:j}=H.computeDilation2DInfo(r.shape,o.shape,i,a,"NHWC",c);N.assert(s.rank===j.length,()=>`Error in ${bx}, dy must have the same rank as output ${j.length}, but got ${s.rank}`);let G=N.toNestedArray(j,l.data.get(s.dataId).values),Q=N.makeZerosNestedTypedArray(r.shape,r.dtype);for(let pe=0;pe<y;++pe)for(let xe=0;xe<x;++xe){let ne=xe*I-_.top;for(let fe=0;fe<w;++fe){let te=fe*T-_.left;for(let se=0;se<m;++se){let ee=Number.MIN_SAFE_INTEGER,we=ne<0?0:ne,be=te<0?0:te;for(let ke=0;ke<D;++ke){let De=ne+ke*R;if(De>=0&&De<d)for(let Re=0;Re<O;++Re){let Ce=te+Re*P;if(Ce>=0&&Ce<h){let Je=p[pe][De][Ce][se]+f[ke][Re][se];Je>ee&&(ee=Je,we=De,be=Ce)}}}Q[pe][we][be][se]+=G[pe][xe][fe][se]}}}return{dataId:l.write(N.toTypedArray(Q,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}}});function r$e(n){let{inputs:t,backend:e}=n,{dy:r,y:o}=t;Ke([r,o],"eluGrad");let s=new Float32Array(N.sizeFromShape(o.shape)),i=e.data.get(o.dataId).values,a=e.data.get(r.dataId).values;for(let c=0;c<i.length;++c){let l=i[c];l>=1?s[c]=a[c]:s[c]=a[c]*(l+1)}return e.makeTensorInfo(o.shape,"float32",s)}var wse,Sse=b(()=>{"use strict";$();kt();wse={kernelName:pm,backendName:"cpu",kernelFunc:r$e}});var o$e,hz,Cse,fz=b(()=>{"use strict";$();po();ko();o$e=yn((n,t)=>n===t?1:0),hz=_n(tf,o$e,null,"bool"),Cse={kernelName:tf,backendName:"cpu",kernelFunc:hz}});var s$e,i$e,a$e,c$e,u$e,l$e,p$e,_se,Tse=b(()=>{"use strict";$();In();s$e=H.ERF_P,i$e=H.ERF_A1,a$e=H.ERF_A2,c$e=H.ERF_A3,u$e=H.ERF_A4,l$e=H.ERF_A5,p$e=Ft(gu,n=>{let t=Math.sign(n),e=Math.abs(n),r=1/(1+s$e*e);return t*(1-((((l$e*r+u$e)*r+c$e)*r+a$e)*r+i$e)*r*Math.exp(-e*e))}),_se={kernelName:gu,backendName:"cpu",kernelFunc:p$e}});function fb(n){let{inputs:t,backend:e,attrs:r}=n,{input:o}=t,{dim:s}=r,i=o.shape.length,a=o.shape.slice(),c=s;return s<0&&(N.assert(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),c=i+s+1),a.splice(c,0,1),Sn({inputs:{x:o},backend:e,attrs:{shape:a}})}var Ise,JN=b(()=>{"use strict";$();_s();Ise={kernelName:xp,backendName:"cpu",kernelFunc:fb}});var h$e,OS,MS,RS=b(()=>{"use strict";$();po();ko();h$e=yn((n,t)=>n/t),OS=_n(du,h$e),MS={kernelName:du,backendName:"cpu",kernelFunc:OS}});function eD(n,t,e){let r=n.shape,o=r[0],s=r[1],i=e.data.get(n.dataId),a=i.complexTensorInfos.real,c=i.complexTensorInfos.imag,l=[o,s],p=N.sizeFromShape(l),f=N.getTypedArrayFromDType("float32",p),y=N.getTypedArrayFromDType("float32",p);for(let x=0;x<o;x++){let w=za({inputs:{x:a},backend:e,attrs:{begin:[x,0],size:[1,s]}}),_=za({inputs:{x:c},backend:e,attrs:{begin:[x,0],size:[1,s]}}),I=wo({inputs:{real:w,imag:_},backend:e}),{real:T,imag:D}=f$e(I,t,e),O=H.mergeRealAndImagArrays(T,D);for(let R=0;R<s;R++){let P=H.getComplexWithIndex(O,R);f[x*s+R]=P.real,y[x*s+R]=P.imag}e.disposeIntermediateTensorInfo(w),e.disposeIntermediateTensorInfo(_),e.disposeIntermediateTensorInfo(I)}let d=e.makeTensorInfo(l,"float32",f),h=e.makeTensorInfo(l,"float32",y),m=wo({inputs:{real:d,imag:h},backend:e});return e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(h),m}function f$e(n,t,e){let r=N.sizeFromShape(n.shape),o=e.data.get(n.dataId),s=e.data.get(o.complexTensorInfos.real.dataId).values,i=e.data.get(o.complexTensorInfos.imag.dataId).values;if(d$e(r)){let a=dz(s,i,r,t,e),c=[n.shape[0],n.shape[1]];if(t){let l=e.makeTensorInfo(c,"float32",a.real),p=e.makeTensorInfo(c,"float32",a.imag),f=e.makeTensorInfo([],"float32",N.createScalarValue(r,"float32")),y=rs({inputs:{x:f},backend:e}),d=MS.kernelFunc({inputs:{a:l,b:f},backend:e}),h=MS.kernelFunc({inputs:{a:p,b:y},backend:e}),m=e.data.get(d.dataId).values,x=e.data.get(h.dataId).values;return e.disposeIntermediateTensorInfo(l),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(h),{real:m,imag:x}}return a}else{let a=H.mergeRealAndImagArrays(s,i),c=m$e(a,r,t);return H.splitRealAndImagArrays(c)}}function d$e(n){return(n&n-1)===0}function dz(n,t,e,r,o){if(e===1)return{real:n,imag:t};let s=H.mergeRealAndImagArrays(n,t),i=e/2,a=H.complexWithEvenIndex(s),c=a.real,l=a.imag,p=[c.length],f=o.makeTensorInfo(p,"float32",c),y=o.makeTensorInfo(p,"float32",l),d=wo({inputs:{real:f,imag:y},backend:o}),h=H.complexWithOddIndex(s),m=h.real,x=h.imag,w=[m.length],_=o.makeTensorInfo(w,"float32",m),I=o.makeTensorInfo(w,"float32",x),T=wo({inputs:{real:_,imag:I},backend:o}),D=dz(c,l,i,r,o),O=D.real,R=D.imag,P=[O.length],j=o.makeTensorInfo(P,"float32",O),G=o.makeTensorInfo(P,"float32",R),Q=wo({inputs:{real:j,imag:G},backend:o}),ie=dz(m,x,i,r,o),pe=ie.real,xe=ie.imag,ne=[pe.length],fe=o.makeTensorInfo(ne,"float32",pe),te=o.makeTensorInfo(ne,"float32",xe),se=wo({inputs:{real:fe,imag:te},backend:o}),ee=H.exponents(e,r),we=[ee.real.length],be=o.makeTensorInfo(we,"float32",ee.real),ke=o.makeTensorInfo(we,"float32",ee.imag),De=wo({inputs:{real:be,imag:ke},backend:o}),Re=DS({inputs:{a:De,b:se},backend:o}),Ce=wh({inputs:{a:Q,b:Re},backend:o}),Je=kS({inputs:{a:Q,b:Re},backend:o}),rt=Ra({inputs:{input:Ce},backend:o}),qe=Ra({inputs:{input:Je},backend:o}),B=kl({inputs:{input:Ce},backend:o}),J=kl({inputs:{input:Je},backend:o}),Z=td({inputs:[rt,qe],backend:o,attrs:{axis:0}}),le=td({inputs:[B,J],backend:o,attrs:{axis:0}}),Ge=o.data.get(Z.dataId).values,Qe=o.data.get(le.dataId).values;return o.disposeIntermediateTensorInfo(f),o.disposeIntermediateTensorInfo(y),o.disposeIntermediateTensorInfo(d),o.disposeIntermediateTensorInfo(_),o.disposeIntermediateTensorInfo(I),o.disposeIntermediateTensorInfo(T),o.disposeIntermediateTensorInfo(j),o.disposeIntermediateTensorInfo(G),o.disposeIntermediateTensorInfo(Q),o.disposeIntermediateTensorInfo(fe),o.disposeIntermediateTensorInfo(te),o.disposeIntermediateTensorInfo(se),o.disposeIntermediateTensorInfo(be),o.disposeIntermediateTensorInfo(ke),o.disposeIntermediateTensorInfo(De),o.disposeIntermediateTensorInfo(Re),o.disposeIntermediateTensorInfo(Ce),o.disposeIntermediateTensorInfo(Je),o.disposeIntermediateTensorInfo(rt),o.disposeIntermediateTensorInfo(B),o.disposeIntermediateTensorInfo(qe),o.disposeIntermediateTensorInfo(J),o.disposeIntermediateTensorInfo(Z),o.disposeIntermediateTensorInfo(le),{real:Ge,imag:Qe}}function m$e(n,t,e){let r=new Float32Array(t*2);for(let o=0;o<t;o++){let s=0,i=0;for(let a=0;a<t;a++){let c=H.exponent(o*a,t,e),l=H.getComplexWithIndex(n,a);s+=l.real*c.real-l.imag*c.imag,i+=l.real*c.imag+l.imag*c.real}e&&(s/=t,i/=t),H.assignToTypedArray(r,s,i,o)}return r}var mz=b(()=>{"use strict";$();Eg();bh();ZN();Dl();hb();cb();Ig();RS();Jf();AS();});function g$e(n){let{inputs:t,backend:e}=n,{input:r}=t,o=N.sizeFromShape(r.shape),s=r.shape[r.shape.length-1],i=o/s,a=Sn({inputs:{x:r},backend:e,attrs:{shape:[i,s]}}),c=eD(a,!1,e),l=Sn({inputs:{x:c},backend:e,attrs:{shape:r.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(c),l}var Ese,Nse=b(()=>{"use strict";$();mz();_s();Ese={kernelName:hm,backendName:"cpu",kernelFunc:g$e}});function PS(n){let{backend:t,attrs:e}=n,{shape:r,value:o,dtype:s}=e,i=s||N.inferDtype(o),a=N.getArrayFromDType(i,N.sizeFromShape(r));return y$e(a,o,i),t.makeTensorInfo(r,i,a)}function y$e(n,t,e){n.fill(t)}var Dse,tD=b(()=>{"use strict";$();Dse={kernelName:fm,backendName:"cpu",kernelFunc:PS}});var kse,Ase=b(()=>{"use strict";$();kse={kernelName:dm,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:e})=>{let{image:r}=n,o=e,s=N.getTypedArrayFromDType(r.dtype,N.sizeFromShape(r.shape)),[i,a,c,l]=r.shape,p=o.data.get(r.dataId).values;for(let y=0;y<i;y++){let d=y*c*a*l;for(let h=0;h<a;h++){let m=h*(c*l);for(let x=0;x<c;x++){let w=x*l;for(let _=0;_<l;_++){let T=[i,h,x,_][2],D=Math.round(c-T),O=d+m+w+_,R=p[O];if(D>=0&&D<c){let P=D*l,j=d+m+P+_;R=p[j]}s[O]=R}}}}return{dataId:o.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}}});var x$e,v$e,Ose,Mse=b(()=>{"use strict";$();po();ko();x$e=yn((n,t)=>Math.floor(n/t)),v$e=_n(bu,x$e,null,"int32"),Ose={kernelName:bu,backendName:"cpu",kernelFunc:v$e}});function b$e(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,filter:s,bias:i,preluActivationWeights:a}=t,{strides:c,pad:l,dataFormat:p,dilations:f,dimRoundingMode:y,activation:d,leakyreluAlpha:h}=r,m=cz({inputs:{x:o,filter:s},backend:e,attrs:{strides:c,pad:l,dataFormat:p,dilations:f,dimRoundingMode:y}});if(i){let x=m;m=wh({inputs:{a:m,b:i},backend:e}),e.disposeIntermediateTensorInfo(x)}if(d){let x=m;m=lb(e,m,d,a,h),e.disposeIntermediateTensorInfo(x)}return m}var Rse,Pse=b(()=>{"use strict";$();XN();Eg();uz();Rse={kernelName:pf,backendName:"cpu",kernelFunc:b$e}});function w$e(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,filter:s,bias:i,preluActivationWeights:a}=t,{strides:c,pad:l,dataFormat:p,dilations:f,dimRoundingMode:y,activation:d,leakyreluAlpha:h}=r,m=lz({inputs:{x:o,filter:s},backend:e,attrs:{strides:c,pad:l,dataFormat:p,dilations:f,dimRoundingMode:y}});if(i){let x=m;m=wh({inputs:{a:m,b:i},backend:e}),e.disposeIntermediateTensorInfo(x)}if(d){let x=m;m=lb(e,m,d,a,h),e.disposeIntermediateTensorInfo(x)}return m}var Fse,$se=b(()=>{"use strict";$();XN();Eg();pz();Fse={kernelName:hf,backendName:"cpu",kernelFunc:w$e}});function S$e(n){let{inputs:t,backend:e}=n,{params:r,indices:o}=t,s=N.sizeFromShape(r.shape),i=o.shape,a=i[i.length-1],[c,l,p,f]=H.prepareAndValidate(r,o);if(l===0)return e.makeTensorInfo(c,r.dtype,[]);let y=It([l,p],r.dtype),d=e.data.get(o.dataId).values,h=e.data.get(r.dataId).values;for(let m=0;m<l;m++){let x=[],w=0;for(let _=0;_<a;_++){let I=d[m*a+_];w+=I*f[_],x.push(I)}if(w<0||w>=s/p)throw new Error(`Invalid indices: ${x} does not index into ${r.shape}`);for(let _=0;_<p;_++)y.values[m*p+_]=h[w*p+_]}return e.makeTensorInfo(c,y.dtype,y.values)}var Lse,zse=b(()=>{"use strict";$();Lse={kernelName:mm,backendName:"cpu",kernelFunc:S$e}});function C$e(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,indices:s}=t,{axis:i,batchDims:a}=r;Ke([o,s],"gatherV2");let c=a;a==null&&(c=0);let l=N.sizeFromShape(s.shape),p=N.parseAxisParam(i,o.shape)[0],f=H.segment_util.collectGatherOpShapeInfo(o,s,p,c),y=Sn({inputs:{x:o},backend:e,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),d=Sn({inputs:{x:s},backend:e,attrs:{shape:[f.batchSize,l/f.batchSize]}}),h=[f.batchSize,f.outerSize,l/f.batchSize,f.sliceSize],m=e.bufferSync(d),x=e.bufferSync(y),w=BN(x,m,h);return e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(d),e.makeTensorInfo(f.outputShape,w.dtype,w.values)}var Bse,Vse=b(()=>{"use strict";$();kt();x3();_s();Bse={kernelName:bp,backendName:"cpu",kernelFunc:C$e}});var _$e,T$e,qse,Use=b(()=>{"use strict";$();po();ko();_$e=yn((n,t)=>n>=t?1:0),T$e=_n(wu,_$e,null,"bool"),qse={kernelName:wu,backendName:"cpu",kernelFunc:T$e}});function I$e(n){let{inputs:t,backend:e}=n,{input:r}=t,o=N.sizeFromShape(r.shape),s=r.shape[r.shape.length-1],i=o/s,a=Sn({inputs:{x:r},backend:e,attrs:{shape:[i,s]}}),c=eD(a,!0,e),l=Sn({inputs:{x:c},backend:e,attrs:{shape:r.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(c),l}var jse,Gse=b(()=>{"use strict";$();mz();_s();jse={kernelName:gm,backendName:"cpu",kernelFunc:I$e}});var E$e,Wse,Hse=b(()=>{"use strict";$();In();E$e=Ft(Su,n=>Number.isFinite(n)?1:0,"bool"),Wse={kernelName:Su,backendName:"cpu",kernelFunc:E$e}});var N$e,Kse,Xse=b(()=>{"use strict";$();In();N$e=Ft(Cu,n=>Math.abs(n)===1/0?1:0,"bool"),Kse={kernelName:Cu,backendName:"cpu",kernelFunc:N$e}});var D$e,Qse,Yse=b(()=>{"use strict";$();In();D$e=Ft(_u,n=>Number.isNaN(n)?1:0,"bool"),Qse={kernelName:_u,backendName:"cpu",kernelFunc:D$e}});var k$e,A$e,Zse,Jse=b(()=>{"use strict";$();po();ko();k$e=yn((n,t)=>n<=t?1:0),A$e=_n(of,k$e,null,"bool"),Zse={kernelName:of,backendName:"cpu",kernelFunc:A$e}});function O$e(n){let{backend:t,attrs:e}=n,{start:r,stop:o,num:s}=e,i=VN(r,o,s);return t.makeTensorInfo([i.length],"float32",i)}var eie,tie=b(()=>{"use strict";$();C3();eie={kernelName:xm,backendName:"cpu",kernelFunc:O$e}});var M$e,nie,rie=b(()=>{"use strict";$();In();M$e=Ft(Iu,n=>Math.log1p(n)),nie={kernelName:Iu,backendName:"cpu",kernelFunc:M$e}});var R$e,P$e,oie,sie=b(()=>{"use strict";$();po();ko();R$e=yn((n,t)=>n&&t),P$e=_n(sf,R$e,null,"bool"),oie={kernelName:sf,backendName:"cpu",kernelFunc:P$e}});var F$e,iie,aie=b(()=>{"use strict";$();In();F$e=Ft(af,n=>n?0:1,"bool"),iie={kernelName:af,backendName:"cpu",kernelFunc:F$e}});var $$e,L$e,cie,uie=b(()=>{"use strict";$();po();ko();$$e=yn((n,t)=>n||t),L$e=_n(cf,$$e,null,"bool"),cie={kernelName:cf,backendName:"cpu",kernelFunc:L$e}});function z$e(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{depthRadius:s,bias:i,alpha:a,beta:c}=r;Ke(o,"LRN");let l=o.shape[3],p=l-1,f=e.data.get(o.dataId).values,y=N.sizeFromShape(o.shape),d=new Float32Array(y);function h(m){let x=m%l,w=m-x+Math.max(0,x-s),_=m-x+Math.min(x+s,p),I=0;for(;w<=_;w++){let T=f[w];I+=T*T}return I}for(let m=0;m<y;m++){let x=h(m),w=f[m]*Math.pow(i+a*x,-c);d[m]=w}return e.makeTensorInfo(o.shape,o.dtype,d)}var lie,pie=b(()=>{"use strict";$();kt();lie={kernelName:Cp,backendName:"cpu",kernelFunc:z$e}});function B$e(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,y:s,dy:i}=t,{depthRadius:a,bias:c,alpha:l,beta:p}=r;Ke(i,"LRNGrad");let f=N.sizeFromShape(i.shape),y=i.shape[3],d=e.data.get(i.dataId).values,h=e.data.get(o.dataId).values,m=e.data.get(s.dataId).values,x=new Float32Array(f),w=f;for(let _=0;_<w;_++){let I=_%y,T=_-I+Math.max(0,I-a),D=_-I+Math.min(y,I+a+1),O=0;for(let R=T;R<D;R++)O+=Math.pow(h[R],2);O=l*O+c;for(let R=T;R<D;R++){let P=-2*l*p*h[R]*m[_]/O;_===R&&(P+=Math.pow(O,-p)),P*=d[_],x[R]+=P}}return e.makeTensorInfo(i.shape,o.dtype,x)}var hie,fie=b(()=>{"use strict";$();kt();hie={kernelName:vm,backendName:"cpu",kernelFunc:B$e}});function gz(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{reductionIndices:s,keepDims:i}=r,a=e,c=o.shape,l=c.length,p=N.parseAxisParam(s,c),f=p,y=H.getAxesPermutation(f,l),d=a.data.get(o.dataId).values;if(y!=null){let T=new Array(l);for(let D=0;D<T.length;D++)T[D]=c[y[D]];d=ub(d,c,o.dtype,y,T),f=H.getInnerMostAxes(f.length,l),c=T}Ke(o,"max"),H.assertAxesAreInnerMostDims("max",f,l);let[h,m]=H.computeOutAndReduceShapes(c,f),x=N.sizeFromShape(m),w=qN(d,x,h,o.dtype),_=a.write(w,h,o.dtype),I=h;return i&&(I=H.expandShapeToKeepDim(h,p)),{dataId:_,shape:I,dtype:o.dtype}}var die,yz=b(()=>{"use strict";$();$();$();kt();I3();UN();die={kernelName:_p,backendName:"cpu",kernelFunc:gz}});function V$e(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t;Ke(o,"maxPool");let{filterSize:s,strides:i,pad:a,dimRoundingMode:c}=r,l=1;N.assert(H.eitherStridesOrDilationsAreOne(i,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${l}'`);let p=H.computePool2DInfo(o.shape,s,i,l,a,c),f;if(p.filterWidth===1&&p.filterHeight===1&&N.arraysEqual(p.inShape,p.outShape))f=rs({inputs:{x:o},backend:e});else{let y=e.data.get(o.dataId).values,d=N.computeStrides(o.shape),h=pb(y,o.shape,o.dtype,d,p,"max");f=e.makeTensorInfo(p.outShape,o.dtype,h.values)}return f}var mie,gie=b(()=>{"use strict";$();kt();ed();Dl();mie={kernelName:Tp,backendName:"cpu",kernelFunc:V$e}});function q$e(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{filterSize:s,strides:i,pad:a,dimRoundingMode:c,dataFormat:l,dilations:p}=r;Ke(o,"maxPool3d");let f=p;f==null&&(f=[1,1,1]);let y=H.computePool3DInfo(o.shape,s,i,f,a,c,l),d=e.data.get(o.dataId).values,h=YN(d,o.shape,o.dtype,N.computeStrides(o.shape),y,"max");return e.makeTensorInfo(h.shape,"float32",h.values)}var yie,xie=b(()=>{"use strict";$();kt();ed();yie={kernelName:Ip,backendName:"cpu",kernelFunc:q$e}});function U$e(n){let{inputs:t,backend:e,attrs:r}=n,{dy:o,input:s}=t,{filterSize:i,strides:a,pad:c,dilations:l,dimRoundingMode:p}=r;Ke([o,s],"maxPool3DGrad");let f=H.computePool3DInfo(s.shape,i,a,l,c,p),y=e.bufferSync(s),d=xoe(y,f),h=f.strideDepth,m=f.strideHeight,x=f.strideWidth,w=f.dilationDepth,_=f.dilationHeight,I=f.dilationWidth,T=f.effectiveFilterDepth,D=f.effectiveFilterHeight,O=f.effectiveFilterWidth,R=T-1-f.padInfo.front,P=O-1-f.padInfo.left,j=D-1-f.padInfo.top,G=It(s.shape,"float32"),Q=e.bufferSync(o);for(let ie=0;ie<f.batchSize;++ie)for(let pe=0;pe<f.inChannels;++pe)for(let xe=0;xe<f.inDepth;++xe)for(let ne=0;ne<f.inHeight;++ne)for(let fe=0;fe<f.inWidth;++fe){let te=xe-R,se=ne-j,ee=fe-P,we=0;for(let be=0;be<T;be+=w){let ke=(te+be)/h;if(!(ke<0||ke>=f.outDepth||Math.floor(ke)!==ke))for(let De=0;De<D;De+=_){let Re=(se+De)/m;if(!(Re<0||Re>=f.outHeight||Math.floor(Re)!==Re))for(let Ce=0;Ce<O;Ce+=I){let Je=(ee+Ce)/x;if(Je<0||Je>=f.outWidth||Math.floor(Je)!==Je)continue;let rt=T*D*O-1-d.get(ie,ke,Re,Je,pe),qe=be*D*O+De*O+Ce,B=rt===qe?1:0;if(B===0)continue;let J=Q.get(ie,ke,Re,Je,pe);we+=J*B}}}G.set(we,ie,xe,ne,fe,pe)}return e.makeTensorInfo(G.shape,G.dtype,G.values)}var vie,bie=b(()=>{"use strict";$();kt();ed();vie={kernelName:wm,backendName:"cpu",kernelFunc:U$e}});function j$e(n){let{inputs:t,backend:e,attrs:r}=n,{dy:o,input:s,output:i}=t,a=s;Ke([s,i],"maxPoolGrad");let{filterSize:c,strides:l,pad:p,dimRoundingMode:f}=r,y=H.computePool2DInfo(a.shape,c,l,1,p,f),d=e.data.get(a.dataId).values,h=It(y.outShape,a.dtype,QN(d,a.shape,a.dtype,y).values),m=y.strideHeight,x=y.strideWidth,w=y.dilationHeight,_=y.dilationWidth,I=y.effectiveFilterHeight,T=y.effectiveFilterWidth,D=T-1-y.padInfo.left,O=I-1-y.padInfo.top,R=It(a.shape,"float32"),P=e.data.get(o.dataId).values,j=It(o.shape,"float32",P);for(let G=0;G<y.batchSize;++G)for(let Q=0;Q<y.inChannels;++Q)for(let ie=0;ie<y.inHeight;++ie)for(let pe=0;pe<y.inWidth;++pe){let xe=ie-O,ne=pe-D,fe=0;for(let te=0;te<I;te+=w){let se=(xe+te)/m;if(!(se<0||se>=y.outHeight||Math.floor(se)!==se))for(let ee=0;ee<T;ee+=_){let we=(ne+ee)/x;if(we<0||we>=y.outWidth||Math.floor(we)!==we)continue;let be=I*T-1-h.get(G,se,we,Q),ke=te*T+ee,De=be===ke?1:0;if(De===0)continue;let Re=j.get(G,se,we,Q);fe+=Re*De}}R.set(fe,G,ie,pe,Q)}return e.makeTensorInfo(R.shape,R.dtype,R.values)}var wie,Sie=b(()=>{"use strict";$();kt();ed();wie={kernelName:bm,backendName:"cpu",kernelFunc:j$e}});function Cie(n,t,e,r,o){let s=N.computeStrides(t),i=pb(n,t,e,s,o,"max"),a=QN(n,t,e,o,!0,r);return[i.values,a.values]}var _ie=b(()=>{"use strict";$();ed();});var Tie,Iie=b(()=>{"use strict";$();$();kt();_ie();Tie={kernelName:Sm,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:e})=>{let{x:r}=n,{filterSize:o,strides:s,pad:i,includeBatchInIndex:a}=t,c=e;Ke(r,"MaxPoolWithArgmax");let l=c.data.get(r.dataId).values,p=H.computePool2DInfo(r.shape,o,s,[1,1],i),[f,y]=Cie(l,r.shape,r.dtype,a,p),d=c.write(f,p.outShape,r.dtype),h=c.write(y,p.outShape,r.dtype);return[{dataId:d,shape:p.outShape,dtype:r.dtype},{dataId:h,shape:p.outShape,dtype:"int32"}]}}});function Dg(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s,keepDims:i}=r;Ke(o,"sum");let a;o.dtype==="bool"?a=Pa({inputs:{x:o},backend:e,attrs:{dtype:"int32"}}):a=rs({inputs:{x:o},backend:e});let c=a.shape.length,l=N.parseAxisParam(s,a.shape),p=H.getAxesPermutation(l,c),f=l,y=a;p!=null&&(y=ho({inputs:{x:a},backend:e,attrs:{perm:p}}),f=H.getInnerMostAxes(f.length,c)),H.assertAxesAreInnerMostDims("sum",f,y.shape.length);let[d,h]=H.computeOutAndReduceShapes(y.shape,f),m=H.upcastType(y.dtype,"int32"),x=ob(e,d,m),w=N.sizeFromShape(h),_=e.data.get(x.dataId).values,I=e.data.get(y.dataId).values;for(let T=0;T<_.length;++T){let D=T*w,O=0;for(let R=0;R<w;++R)O+=I[D+R];_[T]=O}if(i){let T=H.expandShapeToKeepDim(x.shape,l),D=x;x=Sn({inputs:{x},backend:e,attrs:{shape:T}}),e.disposeIntermediateTensorInfo(D)}return e.disposeIntermediateTensorInfo(a),p!=null&&e.disposeIntermediateTensorInfo(y),x}var Eie,FS=b(()=>{"use strict";$();kt();a3();sb();Dl();_s();La();Eie={kernelName:qp,backendName:"cpu",kernelFunc:Dg}});function G$e(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s,keepDims:i}=r,a=N.parseAxisParam(s,o.shape),l=H.computeOutAndReduceShapes(o.shape,a)[1],p=N.sizeFromShape(l),f=[],y=e.makeTensorInfo([],"float32",new Float32Array([p]));f.push(y);let d=Pa({inputs:{x:o},backend:e,attrs:{dtype:"float32"}});f.push(d);let h=OS({inputs:{a:d,b:y},backend:e});f.push(h);let m=Dg({inputs:{x:h},backend:e,attrs:{axis:s,keepDims:i}});return f.forEach(x=>e.disposeIntermediateTensorInfo(x)),m}var Nie,Die=b(()=>{"use strict";$();sb();RS();FS();Nie={kernelName:Ep,backendName:"cpu",kernelFunc:G$e}});function W$e(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s,keepDims:i}=r;Ke(o,"min");let a=N.parseAxisParam(s,o.shape),c=a,l=H.getAxesPermutation(c,o.shape.length),p=o;l!=null&&(p=ho({inputs:{x:o},backend:e,attrs:{perm:l}}),c=H.getInnerMostAxes(c.length,o.shape.length)),H.assertAxesAreInnerMostDims("min",c,p.shape.length);let[f,y]=H.computeOutAndReduceShapes(p.shape,c),d=N.sizeFromShape(y),h=N.makeZerosTypedArray(N.sizeFromShape(f),p.dtype),m=e.data.get(p.dataId).values;for(let w=0;w<h.length;++w){let _=w*d,I=m[_];for(let T=0;T<d;++T){let D=m[_+T];D<I&&(I=D)}h[w]=I}l!=null&&e.disposeIntermediateTensorInfo(p);let x=e.makeTensorInfo(f,p.dtype,h);if(i){let w=H.expandShapeToKeepDim(f,a),_=Sn({inputs:{x},backend:e,attrs:{shape:w}});return e.disposeIntermediateTensorInfo(x),_}return x}var kie,Aie=b(()=>{"use strict";$();kt();_s();La();kie={kernelName:Np,backendName:"cpu",kernelFunc:W$e}});function H$e(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{paddings:s,mode:i}=r;Ke(o,"mirrorPad");let a=s.map((I,T)=>I[0]+o.shape[T]+I[1]),c=s.map(I=>I[0]),l=s.map((I,T)=>I[0]+o.shape[T]),p=i==="reflect"?0:1,f=e.data.get(o.dataId).values,y=o.shape.length,d=N.computeStrides(o.shape),h=N.sizeFromShape(a),m=a.length,x=N.computeStrides(a),w=N.getTypedArrayFromDType(o.dtype,h);for(let I=0;I<h;I++){let T=N.indexToLoc(I,m,x);for(let O=0;O<m;O++)T[O]<c[O]?T[O]=c[O]*2-T[O]-p:T[O]>=l[O]&&(T[O]=(l[O]-1)*2-T[O]+p);T=T.map((O,R)=>O-c[R]);let D=N.locToIndex(T,y,d);w[I]=f[D]}return{dataId:e.write(w,a,o.dtype),shape:a,dtype:o.dtype}}var Oie,Mie=b(()=>{"use strict";$();kt();Oie={kernelName:Dp,backendName:"cpu",kernelFunc:H$e}});var K$e,X$e,Rie,Pie=b(()=>{"use strict";$();po();ko();K$e=yn((n,t)=>{let e=n%t;return n<0&&t<0||n>=0&&t>=0?e:(e+t)%t}),X$e=_n(Du,K$e),Rie={kernelName:Du,backendName:"cpu",kernelFunc:X$e}});var $ie=Pn((Fie,xz)=>{"use strict";(function(n,t,e){function r(a){var c=this,l=i();c.next=function(){var p=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=p-(c.c=p|0)},c.c=1,c.s0=l(" "),c.s1=l(" "),c.s2=l(" "),c.s0-=l(a),c.s0<0&&(c.s0+=1),c.s1-=l(a),c.s1<0&&(c.s1+=1),c.s2-=l(a),c.s2<0&&(c.s2+=1),l=null}function o(a,c){return c.c=a.c,c.s0=a.s0,c.s1=a.s1,c.s2=a.s2,c}function s(a,c){var l=new r(a),p=c&&c.state,f=l.next;return f.int32=function(){return l.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,p&&(typeof p=="object"&&o(p,l),f.state=function(){return o(l,{})}),f}function i(){var a=4022871197,c=function(l){l=l.toString();for(var p=0;p<l.length;p++){a+=l.charCodeAt(p);var f=.02519603282416938*a;a=f>>>0,f-=a,f*=a,a=f>>>0,f-=a,a+=f*4294967296}return(a>>>0)*23283064365386963e-26};return c}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.alea=s})(Fie,typeof xz=="object"&&xz,typeof define=="function"&&define)});var zie=Pn((Lie,vz)=>{"use strict";(function(n,t,e){function r(i){var a=this,c="";a.x=0,a.y=0,a.z=0,a.w=0,a.next=function(){var p=a.x^a.x<<11;return a.x=a.y,a.y=a.z,a.z=a.w,a.w^=a.w>>>19^p^p>>>8},i===(i|0)?a.x=i:c+=i;for(var l=0;l<c.length+64;l++)a.x^=c.charCodeAt(l)|0,a.next()}function o(i,a){return a.x=i.x,a.y=i.y,a.z=i.z,a.w=i.w,a}function s(i,a){var c=new r(i),l=a&&a.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,y=(c.next()>>>0)/4294967296,d=(f+y)/(1<<21);while(d===0);return d},p.int32=c.next,p.quick=p,l&&(typeof l=="object"&&o(l,c),p.state=function(){return o(c,{})}),p}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.xor128=s})(Lie,typeof vz=="object"&&vz,typeof define=="function"&&define)});var Vie=Pn((Bie,bz)=>{"use strict";(function(n,t,e){function r(i){var a=this,c="";a.next=function(){var p=a.x^a.x>>>2;return a.x=a.y,a.y=a.z,a.z=a.w,a.w=a.v,(a.d=a.d+362437|0)+(a.v=a.v^a.v<<4^(p^p<<1))|0},a.x=0,a.y=0,a.z=0,a.w=0,a.v=0,i===(i|0)?a.x=i:c+=i;for(var l=0;l<c.length+64;l++)a.x^=c.charCodeAt(l)|0,l==c.length&&(a.d=a.x<<10^a.x>>>4),a.next()}function o(i,a){return a.x=i.x,a.y=i.y,a.z=i.z,a.w=i.w,a.v=i.v,a.d=i.d,a}function s(i,a){var c=new r(i),l=a&&a.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,y=(c.next()>>>0)/4294967296,d=(f+y)/(1<<21);while(d===0);return d},p.int32=c.next,p.quick=p,l&&(typeof l=="object"&&o(l,c),p.state=function(){return o(c,{})}),p}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.xorwow=s})(Bie,typeof bz=="object"&&bz,typeof define=="function"&&define)});var Uie=Pn((qie,wz)=>{"use strict";(function(n,t,e){function r(i){var a=this;a.next=function(){var l=a.x,p=a.i,f,y,d;return f=l[p],f^=f>>>7,y=f^f<<24,f=l[p+1&7],y^=f^f>>>10,f=l[p+3&7],y^=f^f>>>3,f=l[p+4&7],y^=f^f<<7,f=l[p+7&7],f=f^f<<13,y^=f^f<<9,l[p]=y,a.i=p+1&7,y};function c(l,p){var f,y,d=[];if(p===(p|0))y=d[0]=p;else for(p=""+p,f=0;f<p.length;++f)d[f&7]=d[f&7]<<15^p.charCodeAt(f)+d[f+1&7]<<13;for(;d.length<8;)d.push(0);for(f=0;f<8&&d[f]===0;++f);for(f==8?y=d[7]=-1:y=d[f],l.x=d,l.i=0,f=256;f>0;--f)l.next()}c(a,i)}function o(i,a){return a.x=i.x.slice(),a.i=i.i,a}function s(i,a){i==null&&(i=+new Date);var c=new r(i),l=a&&a.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,y=(c.next()>>>0)/4294967296,d=(f+y)/(1<<21);while(d===0);return d},p.int32=c.next,p.quick=p,l&&(l.x&&o(l,c),p.state=function(){return o(c,{})}),p}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.xorshift7=s})(qie,typeof wz=="object"&&wz,typeof define=="function"&&define)});var Gie=Pn((jie,Sz)=>{"use strict";(function(n,t,e){function r(i){var a=this;a.next=function(){var l=a.w,p=a.X,f=a.i,y,d;return a.w=l=l+1640531527|0,d=p[f+34&127],y=p[f=f+1&127],d^=d<<13,y^=y<<17,d^=d>>>15,y^=y>>>12,d=p[f]=d^y,a.i=f,d+(l^l>>>16)|0};function c(l,p){var f,y,d,h,m,x=[],w=128;for(p===(p|0)?(y=p,p=null):(p=p+"\0",y=0,w=Math.max(w,p.length)),d=0,h=-32;h<w;++h)p&&(y^=p.charCodeAt((h+32)%p.length)),h===0&&(m=y),y^=y<<10,y^=y>>>15,y^=y<<4,y^=y>>>13,h>=0&&(m=m+1640531527|0,f=x[h&127]^=y+m,d=f==0?d+1:0);for(d>=128&&(x[(p&&p.length||0)&127]=-1),d=127,h=4*128;h>0;--h)y=x[d+34&127],f=x[d=d+1&127],y^=y<<13,f^=f<<17,y^=y>>>15,f^=f>>>12,x[d]=y^f;l.w=m,l.X=x,l.i=d}c(a,i)}function o(i,a){return a.i=i.i,a.w=i.w,a.X=i.X.slice(),a}function s(i,a){i==null&&(i=+new Date);var c=new r(i),l=a&&a.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,y=(c.next()>>>0)/4294967296,d=(f+y)/(1<<21);while(d===0);return d},p.int32=c.next,p.quick=p,l&&(l.X&&o(l,c),p.state=function(){return o(c,{})}),p}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.xor4096=s})(jie,typeof Sz=="object"&&Sz,typeof define=="function"&&define)});var Hie=Pn((Wie,Cz)=>{"use strict";(function(n,t,e){function r(i){var a=this,c="";a.next=function(){var p=a.b,f=a.c,y=a.d,d=a.a;return p=p<<25^p>>>7^f,f=f-y|0,y=y<<24^y>>>8^d,d=d-p|0,a.b=p=p<<20^p>>>12^f,a.c=f=f-y|0,a.d=y<<16^f>>>16^d,a.a=d-p|0},a.a=0,a.b=0,a.c=-1640531527,a.d=1367130551,i===Math.floor(i)?(a.a=i/4294967296|0,a.b=i|0):c+=i;for(var l=0;l<c.length+20;l++)a.b^=c.charCodeAt(l)|0,a.next()}function o(i,a){return a.a=i.a,a.b=i.b,a.c=i.c,a.d=i.d,a}function s(i,a){var c=new r(i),l=a&&a.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,y=(c.next()>>>0)/4294967296,d=(f+y)/(1<<21);while(d===0);return d},p.int32=c.next,p.quick=p,l&&(typeof l=="object"&&o(l,c),p.state=function(){return o(c,{})}),p}t&&t.exports?t.exports=s:e&&e.amd?e(function(){return s}):this.tychei=s})(Wie,typeof Cz=="object"&&Cz,typeof define=="function"&&define)});var Kie=Pn((Atn,nD)=>{"use strict";(function(n,t){var e=this,r=256,o=6,s=52,i="random",a=t.pow(r,o),c=t.pow(2,s),l=c*2,p=r-1,f;function y(I,T,D){var O=[];T=T==!0?{entropy:!0}:T||{};var R=x(m(T.entropy?[I,_(n)]:I??w(),3),O),P=new d(O),j=function(){for(var G=P.g(o),Q=a,ie=0;G<c;)G=(G+ie)*r,Q*=r,ie=P.g(1);for(;G>=l;)G/=2,Q/=2,ie>>>=1;return(G+ie)/Q};return j.int32=function(){return P.g(4)|0},j.quick=function(){return P.g(4)/4294967296},j.double=j,x(_(P.S),n),(T.pass||D||function(G,Q,ie,pe){return pe&&(pe.S&&h(pe,P),G.state=function(){return h(P,{})}),ie?(t[i]=G,Q):G})(j,R,"global"in T?T.global:this==t,T.state)}t["seed"+i]=y;function d(I){var T,D=I.length,O=this,R=0,P=O.i=O.j=0,j=O.S=[];for(D||(I=[D++]);R<r;)j[R]=R++;for(R=0;R<r;R++)j[R]=j[P=p&P+I[R%D]+(T=j[R])],j[P]=T;(O.g=function(G){for(var Q,ie=0,pe=O.i,xe=O.j,ne=O.S;G--;)Q=ne[pe=p&pe+1],ie=ie*r+ne[p&(ne[pe]=ne[xe=p&xe+Q])+(ne[xe]=Q)];return O.i=pe,O.j=xe,ie})(r)}function h(I,T){return T.i=I.i,T.j=I.j,T.S=I.S.slice(),T}function m(I,T){var D=[],O=typeof I,R;if(T&&O=="object")for(R in I)try{D.push(m(I[R],T-1))}catch{}return D.length?D:O=="string"?I:I+"\0"}function x(I,T){for(var D=I+"",O,R=0;R<D.length;)T[p&R]=p&(O^=T[p&R]*19)+D.charCodeAt(R++);return _(T)}function w(){try{var I;return f&&(I=f.randomBytes)?I=I(r):(I=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(I)),_(I)}catch{var T=e.navigator,D=T&&T.plugins;return[+new Date,e,D,e.screen,_(n)]}}function _(I){return String.fromCharCode.apply(0,I)}if(x(t.random(),n),typeof nD=="object"&&nD.exports){nD.exports=y;try{f=C1()}catch{}}else typeof define=="function"&&define.amd&&define(function(){return y})})([],Math)});var Qie=Pn((Otn,Xie)=>{"use strict";var Q$e=$ie(),Y$e=zie(),Z$e=Vie(),J$e=Uie(),eLe=Gie(),tLe=Hie(),kg=Kie();kg.alea=Q$e;kg.xor128=Y$e;kg.xorwow=Z$e;kg.xorshift7=J$e;kg.xor4096=eLe;kg.tychei=tLe;Xie.exports=kg});function _z(n){let{inputs:t,backend:e,attrs:r}=n,{logits:o}=t,{dim:s}=r,i=o.shape.length,a=s;if(a===-1&&(a=i-1),a!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${a}`);let c=N.parseAxisParam([a],o.shape),l=gz({inputs:{x:o},backend:e,attrs:{reductionIndices:c,keepDims:!1}}),p=H.expandShapeToKeepDim(l.shape,c),f=Sn({inputs:{x:l},backend:e,attrs:{shape:p}}),y=kS({inputs:{a:o,b:f},backend:e}),d=f3({inputs:{x:y},backend:e}),h=Dg({inputs:{x:d},backend:e,attrs:{axis:c,keepDims:!1}}),m=Sn({inputs:{x:h},backend:e,attrs:{shape:p}}),x=OS({inputs:{a:d,b:m},backend:e});return e.disposeIntermediateTensorInfo(l),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(m),x}var Yie,Tz=b(()=>{"use strict";$();zN();yz();RS();_s();AS();FS();Yie={kernelName:Gp,backendName:"cpu",kernelFunc:_z}});function nLe(n){let{inputs:t,backend:e,attrs:r}=n,{logits:o}=t,{numSamples:s,seed:i,normalized:a}=r;Ke(o,"multinomial");let c=a?o:_z({inputs:{logits:o},backend:e,attrs:{dim:-1}}),l=c.shape[0],p=c.shape[1],f=e.data.get(c.dataId).values,y=[l,s],d=N.makeZerosTypedArray(N.sizeFromShape(y),"int32");for(let h=0;h<l;++h){let m=h*p,x=new Float32Array(p-1);x[0]=f[m];for(let I=1;I<x.length;++I)x[I]=x[I-1]+f[m+I];let w=Zie.alea(i.toString()),_=h*s;for(let I=0;I<s;++I){let T=w();d[_+I]=x.length;for(let D=0;D<x.length;D++)if(T<x[D]){d[_+I]=D;break}}}return a||e.disposeIntermediateTensorInfo(c),e.makeTensorInfo(y,"int32",d)}var Zie,Jie,eae=b(()=>{"use strict";$();Zie=Jb(Qie());kt();Tz();Jie={kernelName:Cm,backendName:"cpu",kernelFunc:nLe}});function oLe(n){let{inputs:t,backend:e,attrs:r}=n,{boxes:o,scores:s}=t,{maxOutputSize:i,iouThreshold:a,scoreThreshold:c}=r;Ke(o,"NonMaxSuppression");let l=e.data.get(o.dataId).values,p=e.data.get(s.dataId).values,{selectedIndices:f}=rLe(l,p,i,a,c);return e.makeTensorInfo([f.length],"int32",new Int32Array(f))}var rLe,tae,nae=b(()=>{"use strict";$();kt();rLe=Vo.nonMaxSuppressionV3Impl;tae={kernelName:_m,backendName:"cpu",kernelFunc:oLe}});function iLe(n){let{inputs:t,backend:e,attrs:r}=n,{boxes:o,scores:s}=t,{maxOutputSize:i,iouThreshold:a,scoreThreshold:c,padToMaxOutputSize:l}=r;Ke(o,"NonMaxSuppressionPadded");let p=e.data.get(o.dataId).values,f=e.data.get(s.dataId).values,{selectedIndices:y,validOutputs:d}=sLe(p,f,i,a,c,l);return[e.makeTensorInfo([y.length],"int32",new Int32Array(y)),e.makeTensorInfo([],"int32",new Int32Array([d]))]}var sLe,rae,oae=b(()=>{"use strict";$();kt();sLe=Vo.nonMaxSuppressionV4Impl;rae={kernelName:Tm,backendName:"cpu",kernelFunc:iLe}});function cLe(n){let{inputs:t,backend:e,attrs:r}=n,{boxes:o,scores:s}=t,{maxOutputSize:i,iouThreshold:a,scoreThreshold:c,softNmsSigma:l}=r;Ke(o,"NonMaxSuppressionWithScore");let p=e.data.get(o.dataId).values,f=e.data.get(s.dataId).values,y=i,d=a,h=c,m=l,{selectedIndices:x,selectedScores:w}=aLe(p,f,y,d,h,m);return[e.makeTensorInfo([x.length],"int32",new Int32Array(x)),e.makeTensorInfo([w.length],"float32",new Float32Array(w))]}var aLe,sae,iae=b(()=>{"use strict";$();kt();aLe=Vo.nonMaxSuppressionV5Impl;sae={kernelName:Im,backendName:"cpu",kernelFunc:cLe}});function uLe(n){let{inputs:t,backend:e,attrs:r}=n,{indices:o}=t,{depth:s,onValue:i,offValue:a}=r;Ke(o,"oneHot");let c=N.sizeFromShape(o.shape),l=new Float32Array(c*s);l.fill(a);let p=e.data.get(o.dataId).values;for(let f=0;f<c;++f)p[f]>=0&&p[f]<s&&(l[f*s+p[f]]=i);return e.makeTensorInfo([...o.shape,s],"int32",l)}var aae,cae=b(()=>{"use strict";$();kt();aae={kernelName:Op,backendName:"cpu",kernelFunc:uLe}});function $S(n){let{inputs:t,backend:e}=n,{x:r}=t;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){let o=Ra({inputs:{input:r},backend:e}),s=$S({inputs:{x:o},backend:e}),i=kl({inputs:{input:r},backend:e}),a=$S({inputs:{x:i},backend:e}),c=wo({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(a),c}else return PS({backend:e,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var uae,Iz=b(()=>{"use strict";$();bh();tD();hb();Ig();uae={kernelName:Xp,backendName:"cpu",kernelFunc:$S}});function lae(n){let{inputs:t,backend:e}=n,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){let o=Ra({inputs:{input:r},backend:e}),s=lae({inputs:{x:o},backend:e}),i=kl({inputs:{input:r},backend:e}),a=$S({inputs:{x:i},backend:e}),c=wo({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(a),c}else return PS({backend:e,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}var pae,hae=b(()=>{"use strict";$();bh();tD();hb();Ig();Iz();pae={kernelName:Ap,backendName:"cpu",kernelFunc:lae}});function Ez(n){let{inputs:t,backend:e,attrs:r}=n,{axis:o}=r;if(t.length===1)return fb({inputs:{input:t[0]},backend:e,attrs:{dim:o}});let s=t[0].shape,i=t[0].dtype;t.forEach(p=>{N.assertShapesMatch(s,p.shape,"All tensors passed to stack must have matching shapes"),N.assert(i===p.dtype,()=>"All tensors passed to stack must have matching dtypes")});let a=[],c=t.map(p=>{let f=fb({inputs:{input:p},backend:e,attrs:{dim:o}});return a.push(f),f}),l=td({inputs:c,backend:e,attrs:{axis:o}});return a.forEach(p=>e.disposeIntermediateTensorInfo(p)),l}var fae,Nz=b(()=>{"use strict";$();ZN();JN();fae={kernelName:Mp,backendName:"cpu",kernelFunc:Ez}});function lLe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{paddings:s,constantValue:i}=r;Ke(o,"pad");let a=s.map((_,I)=>_[0]+o.shape[I]+_[1]),c=s.map(_=>_[0]),l=e.data.get(o.dataId).values,p=N.sizeFromShape(o.shape),f=o.shape.length,y=N.computeStrides(o.shape),d=N.sizeFromShape(a),h=a.length,m=N.computeStrides(a),x=N.getTypedArrayFromDType(o.dtype,d);i!==0&&x.fill(i);for(let _=0;_<p;_++){let T=N.indexToLoc(_,f,y).map((O,R)=>O+c[R]),D=N.locToIndex(T,h,m);x[D]=l[_]}return{dataId:e.write(x,a,o.dtype),shape:a,dtype:o.dtype}}var rD,Dz=b(()=>{"use strict";$();kt();rD={kernelName:Rp,backendName:"cpu",kernelFunc:lLe}});var pLe,hLe,dae,mae=b(()=>{"use strict";$();po();ko();pLe=yn((n,t)=>Math.pow(n,t)),hLe=_n(Au,pLe),dae={kernelName:Au,backendName:"cpu",kernelFunc:hLe}});function fLe(n){let{backend:t,attrs:e}=n,{start:r,stop:o,dtype:s,step:i}=e,a=jN(r,o,i,s);return t.makeTensorInfo([a.length],s,a)}var gae,yae=b(()=>{"use strict";$();$3();gae={kernelName:Nm,backendName:"cpu",kernelFunc:fLe}});var dLe,xae,vae=b(()=>{"use strict";$();In();dLe=Ft(Ou,n=>1/n),xae={kernelName:Ou,backendName:"cpu",kernelFunc:dLe}});function mLe(n){let{inputs:t,backend:e,attrs:r}=n,{images:o}=t,{alignCorners:s,halfPixelCenters:i,size:a}=r;Ke(o,"resizeBilinear");let c=N.computeStrides(o.shape),[l,p]=a,[f,y,d,h]=o.shape,m=e.data.get(o.dataId).values,x=new Float32Array(N.sizeFromShape([f,l,p,h])),w=[s&&l>1?y-1:y,s&&p>1?d-1:d],_=[s&&l>1?l-1:l,s&&p>1?p-1:p],I=0,T=w[0]/_[0],D=w[1]/_[1];for(let O=0;O<f;O++)for(let R=0;R<l;R++){let P;i?P=T*(R+.5)-.5:P=T*R;let j=Math.max(0,Math.floor(P)),G=P-j,Q=Math.min(y-1,Math.ceil(P)),ie=O*c[0]+j*c[1],pe=O*c[0]+Q*c[1];for(let xe=0;xe<p;xe++){let ne;i?ne=D*(xe+.5)-.5:ne=D*xe;let fe=Math.max(0,Math.floor(ne)),te=ne-fe,se=Math.min(d-1,Math.ceil(ne)),ee=ie+fe*c[2],we=pe+fe*c[2],be=ie+se*c[2],ke=pe+se*c[2];for(let De=0;De<h;De++){let Re=m[ee+De],Ce=m[we+De],Je=m[be+De],rt=m[ke+De],qe=Re+(Je-Re)*te,B=Ce+(rt-Ce)*te,J=qe+(B-qe)*G;x[I++]=J}}}return e.makeTensorInfo([f,l,p,h],"float32",x)}var bae,wae=b(()=>{"use strict";$();kt();bae={kernelName:Lp,backendName:"cpu",kernelFunc:mLe}});function gLe(n){let{inputs:t,backend:e,attrs:r}=n,{images:o,dy:s}=t,{alignCorners:i}=r;Ke([s,o],"resizeBilinearGrad");let a=N.computeStrides(o.shape),[c,l,p,f]=o.shape,[,y,d]=s.shape,h=new Float32Array(c*l*p*f),m=[i&&y>1?l-1:l,i&&d>1?p-1:p],x=[i&&y>1?y-1:y,i&&d>1?d-1:d],w=m[0]/x[0],_=m[1]/x[1],I=e.data.get(s.dataId).values,T=0;for(let D=0;D<c;D++){let O=D*a[0];for(let R=0;R<y;R++){let P=R*w,j=Math.floor(P),G=Math.min(Math.ceil(P),l-1),Q=O+j*a[1],ie=O+G*a[1],pe=P-j,xe=1-pe;for(let ne=0;ne<d;ne++){let fe=ne*_,te=Math.floor(fe),se=Math.min(Math.ceil(fe),p-1),ee=fe-te,we=1-ee,be=Q+te*a[2],ke=Q+se*a[2],De=ie+te*a[2],Re=ie+se*a[2],Ce=xe*we,Je=xe*ee,rt=pe*we,qe=pe*ee;for(let B=0;B<f;B++){let J=I[T++];h[be+B]+=J*Ce,h[ke+B]+=J*Je,h[De+B]+=J*rt,h[Re+B]+=J*qe}}}}return e.makeTensorInfo([c,p,l,f],"float32",h)}var Sae,Cae=b(()=>{"use strict";$();kt();Sae={kernelName:Am,backendName:"cpu",kernelFunc:gLe}});function yLe(n){let{inputs:t,backend:e,attrs:r}=n,{images:o}=t,{alignCorners:s,halfPixelCenters:i,size:a}=r;Ke(o,"resizeNearestNeighbor");let c=N.computeStrides(o.shape),[l,p]=a,[f,y,d,h]=o.shape,m=e.data.get(o.dataId).values,x=new Float32Array(f*l*p*h),w=[s&&l>1?y-1:y,s&&p>1?d-1:d],_=[s&&l>1?l-1:l,s&&p>1?p-1:p],I=w[0]/_[0],T=w[1]/_[1],D=0;for(let O=0;O<f;O++){let R=O*c[0];for(let P=0;P<l;P++){let j=i?I*(P+.5):I*P,G=Math.min(y-1,s?Math.round(j):Math.floor(j));i&&(G=Math.max(0,G));let Q=R+G*c[1];for(let ie=0;ie<p;ie++){let pe=i?T*(ie+.5):T*ie,xe=Math.min(d-1,s?Math.round(pe):Math.floor(pe));i&&(xe=Math.max(0,xe));let ne=Q+xe*c[2];for(let fe=0;fe<h;fe++){let te=m[ne+fe];x[D++]=te}}}}return e.makeTensorInfo([f,l,p,h],o.dtype,x)}var _ae,Tae=b(()=>{"use strict";$();kt();_ae={kernelName:$p,backendName:"cpu",kernelFunc:yLe}});function xLe(n){let{inputs:t,backend:e,attrs:r}=n,{images:o,dy:s}=t,{alignCorners:i}=r;Ke([s,o],"resizeNearestNeighborGrad");let a=N.computeStrides(o.shape),c=N.computeStrides(s.shape),[l,p,f,y]=o.shape,[,d,h]=s.shape,m=new Float32Array(l*p*f*y),x=e.data.get(s.dataId).values,w=[i&&d>1?p-1:p,i&&h>1?f-1:f],_=[i&&d>1?d-1:d,i&&h>1?h-1:h],I=w[0]/_[0],T=w[1]/_[1],D=1/I,O=1/T,R=Math.ceil(D)*2+2,P=Math.ceil(O)*2+2;for(let j=0;j<l;j++){let G=j*a[0];for(let Q=0;Q<p;Q++){let ie=G+Q*a[1],pe=Math.floor(Q*D),xe=Math.floor(pe-R/2);for(let ne=0;ne<f;ne++){let fe=ie+ne*a[2],te=Math.floor(ne*O),se=Math.floor(te-P/2);for(let ee=0;ee<y;ee++){let we=0;for(let be=0;be<R;be++){let ke=be+xe;if(ke<0||ke>=d)continue;let De=G+ke*c[1],Re=ke*I,Ce=Math.min(p-1,i?Math.round(Re):Math.floor(Re));if(Q===Ce)for(let Je=0;Je<P;Je++){let rt=Je+se;if(rt<0||rt>=h)continue;let qe=De+rt*c[2],B=rt*T,J=Math.min(f-1,i?Math.round(B):Math.floor(B));ne===J&&(we+=x[qe+ee])}}m[fe+ee]=we}}}}return e.makeTensorInfo(o.shape,o.dtype,m)}var Iae,Eae=b(()=>{"use strict";$();kt();Iae={kernelName:km,backendName:"cpu",kernelFunc:xLe}});function vLe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{dims:s}=r;Ke(o,"reverse");let i=o.shape.length,a=N.parseAxisParam(s,o.shape);if(i===0)return rs({inputs:{x:o},backend:e});let c=new Dn(o.shape,o.dtype),l=e.bufferSync(o);for(let p=0;p<c.size;p++){let f=c.indexToLoc(p),y=f.slice();a.forEach(d=>y[d]=o.shape[d]-1-y[d]),c.set(l.get(...y),...f)}return e.makeTensorInfo(c.shape,c.dtype,c.values)}var Nae,Dae=b(()=>{"use strict";$();kt();Dl();Nae={kernelName:zp,backendName:"cpu",kernelFunc:vLe}});var kae,Aae=b(()=>{"use strict";$();kae={kernelName:Lm,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:e})=>{let{image:r}=n,{radians:o,fillValue:s,center:i}=t,a=e,c=N.getTypedArrayFromDType(r.dtype,N.sizeFromShape(r.shape)),[l,p,f,y]=r.shape,[d,h]=H.getImageCenter(i,p,f),m=255,x=Math.sin(o),w=Math.cos(o),_=a.data.get(r.dataId).values;for(let T=0;T<l;T++){let D=T*f*p*y;for(let O=0;O<p;O++){let R=O*(f*y);for(let P=0;P<f;P++){let j=P*y;for(let G=0;G<y;G++){let Q=[l,O,P,G],ie=Q[2],pe=Q[1],xe=(ie-d)*w-(pe-h)*x,ne=(ie-d)*x+(pe-h)*w;xe=Math.round(xe+d),ne=Math.round(ne+h);let fe=s;if(typeof s!="number"&&(G===3?fe=m:fe=s[G]),xe>=0&&xe<f&&ne>=0&&ne<p){let se=ne*(f*y),ee=xe*y,we=D+se+ee+G;fe=_[we]}let te=D+R+j+G;c[te]=fe}}}}return{dataId:a.write(c,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}}});var bLe,Oae,Mae=b(()=>{"use strict";$();In();bLe=Ft(Pu,n=>{let t=Math.floor(n);return n-t<.5?Math.floor(n):n-t>.5?Math.ceil(n):t%2===0?t:t+1}),Oae={kernelName:Pu,backendName:"cpu",kernelFunc:bLe}});function oD(n,t,e,r,o,s,i,a,c,l){let p=[r/o,o],f=n.values,y=t.values;if(r===0)return It(e,t.dtype);let d=It(p,t.dtype);d.values.fill(c);for(let h=0;h<s;h++){let m=[],x=0;for(let w=0;w<i;w++){let _=f[h*i+w];m.push(_),x+=_*a[w]}if(x<0||x>=r/o)throw new Error(`Invalid indices: ${m} does not index into ${e}`);for(let w=0;w<o;w++)l?d.values[x*o+w]+=y[h*o+w]:d.values[x*o+w]=t.rank===0?y[0]:y[h*o+w]}return d}var kz=b(()=>{"use strict";$();});function wLe(n){let{inputs:t,backend:e,attrs:r}=n,{indices:o,updates:s}=t,{shape:i}=r,{sliceRank:a,numUpdates:c,sliceSize:l,strides:p,outputSize:f}=H.calculateShapes(s,o,i),y=!0,d=e.bufferSync(o),h=e.bufferSync(s),m=oD(d,h,i,f,l,c,a,p,0,y);return e.makeTensorInfo(i,m.dtype,m.values)}var Rae,Pae=b(()=>{"use strict";$();kz();Rae={kernelName:Om,backendName:"cpu",kernelFunc:wLe}});function SLe(n){let{inputs:t,backend:e}=n,{condition:r,t:o,e:s}=t;Ke([r,o,s],"select");let i=r.shape.length,a=e.data.get(r.dataId).values,c=e.data.get(o.dataId).values,l=e.data.get(s.dataId).values,p=ro(o.dtype,s.dtype),f=N.makeZerosTypedArray(N.sizeFromShape(o.shape),p),y=0,d=i===0||i>1||o.shape.length===1?1:N.sizeFromShape(o.shape.slice(1));for(let h=0;h<a.length;h++)for(let m=0;m<d;m++)a[h]===1?f[y++]=c[h]:f[y++]=l[h];return e.makeTensorInfo(o.shape,p,f)}var Fae,$ae=b(()=>{"use strict";$();kt();Fae={kernelName:Bp,backendName:"cpu",kernelFunc:SLe}});var CLe,_Le,TLe,Lae,zae=b(()=>{"use strict";$();In();CLe=H.SELU_SCALEALPHA,_Le=H.SELU_SCALE,TLe=Ft($u,n=>n>=0?_Le*n:CLe*(Math.exp(n)-1)),Lae={kernelName:$u,backendName:"cpu",kernelFunc:TLe}});var ILe,Bae,Vae=b(()=>{"use strict";$();In();ILe=Ft(Vu,n=>1/(1+Math.exp(-n))),Bae={kernelName:Vu,backendName:"cpu",kernelFunc:ILe}});var ELe,qae,Uae=b(()=>{"use strict";$();In();ELe=Ft(Bu,n=>n<0?-1:n>0?1:0),qae={kernelName:Bu,backendName:"cpu",kernelFunc:ELe}});var NLe,jae,Gae=b(()=>{"use strict";$();In();NLe=Ft(Lu,n=>Math.sin(n)),jae={kernelName:Lu,backendName:"cpu",kernelFunc:NLe}});var DLe,Wae,Hae=b(()=>{"use strict";$();In();DLe=Ft(zu,n=>Math.sinh(n)),Wae={kernelName:zu,backendName:"cpu",kernelFunc:DLe}});var kLe,Kae,ALe,Xae,Qae=b(()=>{"use strict";$();In();kLe=11920928955078125e-23,Kae=Math.log(kLe)+2,ALe=Ft(qu,n=>{let t=n>-Kae,e=n<Kae,r=Math.exp(n),o;return e?o=r:t?o=n:o=Math.log(1+r),o}),Xae={kernelName:qu,backendName:"cpu",kernelFunc:ALe}});function OLe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{blockShape:s,paddings:i}=r;Ke([o],"spaceToBatchND");let a=N.sizeFromShape(s),c=[[0,0]];c.push(...i);for(let O=1+s.length;O<o.shape.length;++O)c.push([0,0]);let l=rD.kernelFunc({inputs:{x:o},backend:e,attrs:{paddings:c,constantValue:0}}),p=H.getReshaped(l.shape,s,a,!1),f=H.getPermuted(p.length,s.length,!1),y=H.getReshapedPermuted(l.shape,s,a,!1),m=Sn({inputs:{x:l},backend:e,attrs:{shape:p}}),_=ho({inputs:{x:m},backend:e,attrs:{perm:f}}),D=Sn({inputs:{x:_},backend:e,attrs:{shape:y}});return e.disposeIntermediateTensorInfo(l),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(_),D}var Yae,Zae=b(()=>{"use strict";$();kt();Dz();_s();La();Yae={kernelName:Up,backendName:"cpu",kernelFunc:OLe}});function MLe(n){let{inputs:t,backend:e,attrs:r}=n,{sparseIndices:o,sparseValues:s,defaultValue:i}=t,{outputShape:a}=r,{sliceRank:c,numUpdates:l,sliceSize:p,strides:f,outputSize:y}=H.calculateShapes(s,o,a),d=!1,h=e.bufferSync(o),m=e.bufferSync(s),x=e.data.get(i.dataId).values[0],w=oD(h,m,a,y,p,l,c,f,x,d);return e.makeTensorInfo(a,w.dtype,w.values)}var Jae,ece=b(()=>{"use strict";$();kz();Jae={kernelName:Rm,backendName:"cpu",kernelFunc:MLe}});function RLe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{numOrSizeSplits:s,axis:i}=r,a=N.parseAxisParam(i,o.shape)[0],c=H.prepareSplitSize(o,s,a),l=new Array(o.shape.length).fill(0),p=o.shape.slice();return c.map(f=>{let y=[...p];y[a]=f;let d=za({inputs:{x:o},backend:e,attrs:{begin:l,size:y}});return l[a]+=f,d})}var tce,nce=b(()=>{"use strict";$();$();Jf();tce={kernelName:jp,backendName:"cpu",kernelFunc:RLe}});var PLe,rce,oce=b(()=>{"use strict";$();In();PLe=Ft(Uu,n=>Math.sqrt(n)),rce={kernelName:Uu,backendName:"cpu",kernelFunc:PLe}});var sce,ice=b(()=>{"use strict";$();kt();sce={kernelName:Mm,backendName:"cpu",kernelFunc:({inputs:n,backend:t})=>{let{x:e}=n,r=t;Ke(e,"square");let o=r.data.get(e.dataId).values,s=new Float32Array(o.length);for(let a=0;a<o.length;++a){let c=o[a];s[a]=c*c}return{dataId:r.write(s,e.shape,e.dtype),shape:e.shape,dtype:e.dtype}}}});var FLe,ace,cce=b(()=>{"use strict";$();In();FLe=Ft(Ku,(n,t)=>{let e=t;return isNaN(n)?NaN:n>0?1:e.alpha}),ace={kernelName:Ku,backendName:"cpu",kernelFunc:FLe}});function $Le(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{begin:s,end:i,strides:a,beginMask:c,endMask:l,ellipsisMask:p,newAxisMask:f,shrinkAxisMask:y}=r;Ke(o,"stridedSlice");let{nonStrided:d,$begin:h,$strides:m,size:x,newShape:w,outShape:_}=Fo.sliceInfo(o.shape,s,i,a,c,l,p,f,y),I=Sn({inputs:{x:o},backend:e,attrs:{shape:w}}),T;if(d){let O=za({inputs:{x:I},backend:e,attrs:{begin:h,size:x}});T=Sn({inputs:{x:O},backend:e,attrs:{shape:_}}),e.disposeIntermediateTensorInfo(O)}else if(_.some(O=>O===0))T=e.makeTensorInfo(_,o.dtype,[]);else{let O=e.bufferSync(I),R=GN(_,O,m,h);T=e.makeTensorInfo(R.shape,R.dtype,R.values)}let D=Sn({inputs:{x:T},backend:e,attrs:{shape:_}});return e.disposeIntermediateTensorInfo(I),e.disposeIntermediateTensorInfo(T),D}var uce,lce=b(()=>{"use strict";$();kt();_s();Jf();U3();uce={kernelName:Pm,backendName:"cpu",kernelFunc:$Le}});var LLe,pce,hce=b(()=>{"use strict";$();In();LLe=Ft(Wu,n=>Math.tan(n)),pce={kernelName:Wu,backendName:"cpu",kernelFunc:LLe}});var zLe,fce,dce=b(()=>{"use strict";$();In();zLe=Ft(Hu,n=>Math.tanh(n)),fce={kernelName:Hu,backendName:"cpu",kernelFunc:zLe}});function BLe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{reps:s}=r;Ke(o,"tile");let i=WN(e.bufferSync(o),s);return e.makeTensorInfo(i.shape,i.dtype,i.values)}var mce,gce=b(()=>{"use strict";$();kt();G3();mce={kernelName:pc,backendName:"cpu",kernelFunc:BLe}});function VLe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{k:s,sorted:i}=r;Ke(o,"topk");let a=e.data.get(o.dataId).values,[c,l]=HN(a,o.shape,o.dtype,s,i);return[e.makeTensorInfo(c.shape,c.dtype,c.values),e.makeTensorInfo(l.shape,l.dtype,l.values)]}var yce,xce=b(()=>{"use strict";$();kt();W3();yce={kernelName:Fm,backendName:"cpu",kernelFunc:VLe}});function qLe(n){let{inputs:t,attrs:e,backend:r}=n,{axis:o}=e,{x:s}=t;Ke(s,"unique");let i=r.data.get(s.dataId).values,{outputValues:a,outputShape:c,indices:l}=KN(i,o,s.shape,s.dtype);return[r.makeTensorInfo(c,s.dtype,a),r.makeTensorInfo([l.length],"int32",l)]}var vce,bce=b(()=>{"use strict";$();kt();H3();vce={kernelName:$m,backendName:"cpu",kernelFunc:qLe}});function ULe(n){let{inputs:t,backend:e,attrs:r}=n,{value:o}=t,{axis:s}=r;s<0&&(s+=o.shape.length);let i=o.shape.length,a=o.shape[s],c=new Array(i-1),l=0;for(let d=0;d<i;d++)d!==s&&(c[l++]=o.shape[d]);let p=new Array(i).fill(0),f=o.shape.slice();f[s]=1;let y=new Array(a);for(let d=0;d<y.length;d++){p[s]=d;let h=za({inputs:{x:o},backend:e,attrs:{begin:p,size:f}});y[d]=Sn({inputs:{x:h},backend:e,attrs:{shape:c}}),e.disposeIntermediateTensorInfo(h)}return y}var wce,Sce=b(()=>{"use strict";$();_s();Jf();wce={kernelName:Hp,backendName:"cpu",kernelFunc:ULe}});function jLe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,segmentIds:s}=t,{numSegments:i}=r;Ke(o,"unsortedSegmentSum");let a=o.shape.length,c=s.shape.length,l=[],p=[],f=a-c,y=s;for(let h=0;h<f;++h){let m=fb({inputs:{input:y},backend:e,attrs:{dim:h+1}});y=m,p.push(m)}for(let h=0;h<i;++h){let m=N.createScalarValue(h,"int32"),x=e.makeTensorInfo([],"int32",m),w=hz({inputs:{a:x,b:y},backend:e}),_=Pa({inputs:{x:w},backend:e,attrs:{dtype:"float32"}}),I=DS({inputs:{a:_,b:o},backend:e}),T=Dg({inputs:{x:I},backend:e,attrs:{axis:0,keepDims:!1}});l.push(T),p.push(x),p.push(w),p.push(_),p.push(I),p.push(T)}let d=Ez({inputs:l,backend:e,attrs:{axis:0}});return p.forEach(h=>e.disposeIntermediateTensorInfo(h)),d}var Cce,_ce=b(()=>{"use strict";$();kt();sb();fz();JN();cb();Nz();FS();Cce={kernelName:Kp,backendName:"cpu",kernelFunc:jLe}});var GLe,Tce=b(()=>{"use strict";$();Hre();i3();Xre();Yre();Eg();Jre();toe();roe();soe();aoe();uoe();poe();foe();moe();yoe();boe();Soe();_oe();Ioe();az();Noe();koe();Ooe();sb();l3();Roe();bh();Foe();ZN();uz();Voe();Uoe();Goe();Hoe();Xoe();Yoe();Joe();tse();rse();sse();ase();pz();lse();hse();dse();gse();xse();bse();Y3();Sse();fz();Tse();zN();JN();m3();Nse();tD();Ase();y3();Mse();Pse();$se();zse();Vse();b3();Use();Dl();Gse();hb();Hse();Xse();Yse();J3();S3();Jse();tie();T3();rie();sie();aie();uie();pie();fie();yz();N3();gie();xie();bie();Sie();Iie();Die();Aie();k3();Mie();Pie();eae();cb();O3();nae();oae();iae();R3();cae();hae();Nz();Dz();mae();tz();F3();yae();Ig();RS();vae();rz();sz();_s();wae();Cae();Tae();Eae();Dae();Aae();Mae();z3();Pae();$ae();zae();Vae();Uae();Gae();Hae();Jf();Tz();Qae();Zae();ece();nce();oce();ice();q3();cce();lce();AS();FS();hce();dce();gce();xce();La();bce();Sce();_ce();Iz();GLe=[Wre,hre,Kre,Qre,yre,Zre,eoe,noe,ooe,ioe,coe,loe,hoe,doe,goe,voe,woe,Coe,Toe,Gre,Eoe,Doe,Aoe,gre,xre,Moe,fre,Poe,Loe,Boe,qoe,zoe,Woe,Koe,joe,Qoe,Zoe,ese,nse,ose,ise,cse,use,pse,fse,mse,vse,yse,MS,zre,wse,Cse,_se,vre,Ise,bre,Ese,Dse,kse,wre,Ose,Rse,Fse,Lse,Bse,Sre,qse,dre,jse,$oe,Wse,Kse,Qse,Bre,Cre,Zse,eie,_re,nie,oie,iie,cie,lie,hie,Tre,mie,yie,vie,wie,Tie,die,Nie,kie,Ire,Oie,Rie,Jie,Ere,Nre,tae,rae,sae,Dre,aae,pae,fae,rD,dae,Vre,Are,gae,mre,xae,qre,Ure,jre,bae,Sae,_ae,Iae,Nae,kae,Oae,Ore,Rae,Fae,Lae,Bae,qae,jae,Wae,Mre,Yie,Xae,Yae,Jae,tce,rce,sce,Rre,ace,uce,Pre,Eie,pce,fce,mce,yce,kre,vce,wce,Cce,uae];for(let n of GLe)_x(n)});var Az=b(()=>{"use strict";Lre();Tce();});function Ice(n,t){Ag[n]=t}function Ki(n){if(!(n in Ag)){let e=HLe(n);if(e!==null)Ag[n]=e;else return console.log("Could not get context for WebGL version",n),null}let t=Ag[n];return t.isContextLost()?(delete Ag[n],Ki(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Ag[n])}function WLe(n){if(typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function HLe(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");let t=WLe(n);return t.addEventListener("webglcontextlost",e=>{e.preventDefault(),delete Ag[n]},!1),n===1?t.getContext("webgl",Oz)||t.getContext("experimental-webgl",Oz):t.getContext("webgl2",Oz)}var Ag,Oz,sD=b(()=>{"use strict";Ag={},Oz={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0}});function Mg(n,t){return[t,n]}function Ece(n,t){return n*t}function nd(n){let t=N.sizeFromShape(n),e=Math.ceil(t/4);return N.sizeToSquarishShape(e)}function Al(n,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(n/2))]}function Nce(n,t){let[e,r]=Al(n,t);return e*r*4}function LS(n,t){let e=n,r,o,s,i,a,c,l,p,f,y;return Te().getNumber("WEBGL_VERSION")===2?(r=e.R32F,o=e.R16F,s=e.RGBA16F,i=e.RGBA32F,a=e.RED,l=4,p=1,f=e.HALF_FLOAT,y=e.FLOAT):(r=n.RGBA,o=n.RGBA,s=n.RGBA,i=e.RGBA,a=n.RGBA,l=4,p=4,f=t!=null?t.HALF_FLOAT_OES:null,y=n.FLOAT),c=n.RGBA,{internalFormatFloat:r,internalFormatHalfFloat:o,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:c,downloadUnpackNumChannels:l,defaultNumChannels:p,textureTypeHalfFloat:f,textureTypeFloat:y}}var Og,Ts,os,Ba=b(()=>{"use strict";$();Og=function(n){return n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH",n}(Og||{}),Ts=function(n){return n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD",n}(Ts||{}),os=function(n){return n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16",n}(os||{})});function Pt(n,t){let e=t();return Te().getBool("DEBUG")&&KLe(n),e}function KLe(n){let t=n.getError();if(t!==n.NO_ERROR)throw new Error("WebGL Error: "+YLe(n,t))}function Dce(n){return!!(Te().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||XLe<Math.abs(n)&&Math.abs(n)<QLe)}function YLe(n,t){switch(t){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function zS(n,t){return Sh(n,()=>n.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function kce(n,t){let e=Sh(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Pt(n,()=>n.shaderSource(e,t)),Pt(n,()=>n.compileShader(e)),n.getShaderParameter(e,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(e)),new Error("Failed to compile vertex shader.");return e}function Ace(n,t){let e=Sh(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Pt(n,()=>n.shaderSource(e,t)),Pt(n,()=>n.compileShader(e)),n.getShaderParameter(e,n.COMPILE_STATUS)===!1)throw JLe(t,n.getShaderInfoLog(e)),new Error("Failed to compile fragment shader.");return e}function JLe(n,t){let e=ZLe.exec(t);if(e==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(n);return}let r=+e[1],o=n.split(`
`),s=o.length.toString().length+2,i=o.map((f,y)=>N.rightPad((y+1).toString(),s)+f),a=0;for(let f=0;f<i.length;f++)a=Math.max(i[f].length,a);let c=i.slice(0,r-1),l=i.slice(r-1,r),p=i.slice(r);console.log(c.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${N.rightPad(l[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(p.join(`
`))}function Oce(n){return Sh(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function Mce(n,t){if(Pt(n,()=>n.linkProgram(t)),n.getProgramParameter(t,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function aD(n,t){if(Pt(n,()=>n.validateProgram(t)),n.getProgramParameter(t,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function Rce(n,t){let e=Sh(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Pt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,e)),Pt(n,()=>n.bufferData(n.ARRAY_BUFFER,t,n.STATIC_DRAW)),e}function Pce(n,t){let e=Sh(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Pt(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e)),Pt(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,n.STATIC_DRAW)),e}function Fce(n){return Sh(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function $ce(n,t){let e=Te().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||t<=0){let r=`[${n}x${t}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(n>e||t>e){let r=`[${n}x${t}]`,o=`[${e}x${e}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+o+".")}}function Lce(n){return Sh(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function $z(n,t,e,r,o,s,i){let a=n.getAttribLocation(t,e);return a===-1?!1:(Pt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,r)),Pt(n,()=>n.vertexAttribPointer(a,o,n.FLOAT,!1,s,i)),Pt(n,()=>n.enableVertexAttribArray(a)),!0)}function e3e(n,t,e){n3e(n,e),Pt(n,()=>n.activeTexture(n.TEXTURE0+e)),Pt(n,()=>n.bindTexture(n.TEXTURE_2D,t))}function zce(n,t,e){return Sh(n,()=>n.getUniformLocation(t,e),'uniform "'+e+'" not present in program.')}function Bce(n,t,e){return n.getUniformLocation(t,e)}function Vce(n,t,e,r){Pt(n,()=>e3e(n,t,r)),Pt(n,()=>n.uniform1i(e,r))}function cD(n,t,e){Pt(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),Pt(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0))}function Lz(n,t){Pt(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),Pt(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function BS(n){let t=n.checkFramebufferStatus(n.FRAMEBUFFER);if(t!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+t3e(n,t))}function t3e(n,t){switch(t){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function Sh(n,t,e){let r=Pt(n,()=>t());if(r==null)throw new Error(e);return r}function n3e(n,t){let e=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+n.TEXTURE0;if(r<n.TEXTURE0||r>e){let o=`[gl.TEXTURE0, gl.TEXTURE${e}]`;throw new Error(`textureUnit must be in ${o}.`)}}function rd(n,t=2){return N.sizeFromShape(n.slice(0,n.length-t))}function od(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function uD(n){let t=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(t=[rd(n),...od(n)]),t}function qce(n,t=!1){let e=Te().getNumber("WEBGL_MAX_TEXTURE_SIZE");t&&(e=e*2,n=n.map((o,s)=>s>=n.length-2?N.nearestLargerEven(n[s]):n[s]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=N.squeezeShape(n).newShape);let r=N.sizeFromShape(n);if(n.length<=1&&r<=e)return[1,r];if(n.length===2&&n[0]<=e&&n[1]<=e)return n;if(n.length===3&&n[0]*n[1]<=e&&n[2]<=e)return[n[0]*n[1],n[2]];if(n.length===3&&n[0]<=e&&n[1]*n[2]<=e)return[n[0],n[1]*n[2]];if(n.length===4&&n[0]*n[1]*n[2]<=e&&n[3]<=e)return[n[0]*n[1]*n[2],n[3]];if(n.length===4&&n[0]<=e&&n[1]*n[2]*n[3]<=e)return[n[0],n[1]*n[2]*n[3]];if(t){let o=rd(n),s=2,i=2;return n.length&&([s,i]=od(n)),r=o*(s/2)*(i/2),N.sizeToSquarishShape(r).map(a=>a*2)}return N.sizeToSquarishShape(r)}function iD(n){return n%2===0}function Rg(n,t){if(n=n.slice(-2),t=t.slice(-2),N.arraysEqual(n,t)||!n.length||!t.length||n[0]===0||n[1]===0||t[0]===0||t[1]===0)return!0;if(n.length!==t.length){let e=n.slice(-1)[0],r=t.slice(-1)[0];if(e===r||iD(e)&&iD(r)&&(n[0]===1||t[0]===1))return!0}return n[1]===t[1]&&iD(n[0])&&iD(t[0])}function Uce(n){if(Rz==null){let t=Ki(n);Rz=t.getParameter(t.MAX_TEXTURE_SIZE)}return Rz}function jce(n){if(Pz==null){let t=Ki(n);Pz=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Pz)}function Gce(n){if(n===0)return 0;let t,e=Ki(n);return Xi(e,"EXT_disjoint_timer_query_webgl2")&&n===2?t=2:Xi(e,"EXT_disjoint_timer_query")?t=1:t=0,t}function Xi(n,t){return n.getExtension(t)!=null}function zz(n){try{if(Ki(n)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function Wce(n){if(n===0)return!1;let t=Ki(n);if(n===1){if(!Xi(t,"OES_texture_float"))return!1}else if(!Xi(t,"EXT_color_buffer_float"))return!1;return Fz(t)}function Hce(n){if(n===0)return!1;let t=Ki(n);if(n===1){if(!Xi(t,"OES_texture_float")||!Xi(t,"WEBGL_color_buffer_float"))return!1}else{if(Xi(t,"EXT_color_buffer_float"))return Fz(t);let r="EXT_color_buffer_half_float";if(Xi(t,r)){let o=t.getExtension(r);return r3e(t,o)}return!1}return Fz(t)}function Fz(n){let t=LS(n),e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);let s=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,s),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0);let i=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(e),n.deleteFramebuffer(s),i}function r3e(n,t){let e=LS(n,t),r=n.createTexture();n.bindTexture(n.TEXTURE_2D,r),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatHalfFloat,1,1,0,e.textureFormatFloat,e.textureTypeHalfFloat,null);let i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,r,0);let a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(r),n.deleteFramebuffer(i),a}function Kce(n){return n!==2?!1:Ki(n).fenceSync!=null}function Ol(n,t){Array.isArray(n)||(n=[n]),n.forEach(e=>{e!=null&&N.assert(e.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}var XLe,QLe,ZLe,Rz,Pz,Qi=b(()=>{"use strict";$();sD();Ba();XLe=596e-10,QLe=65504;ZLe=/ERROR: [0-9]+:([0-9]+):/g});var Jt,Xce=b(()=>{"use strict";$();Qi();Jt=Te();Jt.registerFlag("HAS_WEBGL",()=>Jt.getNumber("WEBGL_VERSION")>0);Jt.registerFlag("WEBGL_VERSION",()=>zz(2)?2:zz(1)?1:0);Jt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Jt.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Jt.get("WEBGL_VERSION")===2);Jt.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Jt.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Jt.registerFlag("WEBGL_PACK",()=>Jt.getBool("HAS_WEBGL"));Jt.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Jt.getBool("WEBGL_PACK"));Jt.registerFlag("WEBGL_PACK_CLIP",()=>Jt.getBool("WEBGL_PACK"));Jt.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>!1);Jt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Jt.getBool("WEBGL_PACK"));Jt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Jt.getBool("WEBGL_PACK"));Jt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Jt.getBool("WEBGL_PACK"));Jt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Jt.getBool("WEBGL_PACK"));Jt.registerFlag("WEBGL_PACK_REDUCE",()=>Jt.getBool("WEBGL_PACK"));Jt.registerFlag("WEBGL_LAZILY_UNPACK",()=>Jt.getBool("WEBGL_PACK"));Jt.registerFlag("WEBGL_CONV_IM2COL",()=>Jt.getBool("WEBGL_PACK"));Jt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Uce(Jt.getNumber("WEBGL_VERSION")));Jt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>jce(Jt.getNumber("WEBGL_VERSION")));Jt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let n=Jt.getNumber("WEBGL_VERSION");return n===0?0:Gce(n)});Jt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Jt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!mf.isMobile());Jt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Wce(Jt.getNumber("WEBGL_VERSION")));Jt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Jt.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Jt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Jt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Hce(Jt.getNumber("WEBGL_VERSION")));Jt.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Kce(Jt.getNumber("WEBGL_VERSION")));Jt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Jt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Jt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)})});function _r(){let n,t,e,r,o,s,i,a,c,l;return Te().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",t="in",e="out",r="in",o="texture",s="outputColor",i="out vec4 outputColor;",a=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,c="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",t="attribute",e="varying",r="varying",o="texture2D",s="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:t,varyingVs:e,varyingFs:r,texture2D:o,output:s,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:c,defineRound:l}}var Va=b(()=>{"use strict";$();});function Ac(n,t,e="index"){let r=N.computeStrides(t);return r.map((o,s)=>{let i=`int ${n[s]} = ${e} / ${o}`,a=s===r.length-1?`int ${n[s+1]} = ${e} - ${n[s]} * ${o}`:`index -= ${n[s]} * ${o}`;return`${i}; ${a};`}).join("")}function db(n){let t=N.computeStrides(n).map(e=>e.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}var pD,Ch=b(()=>{"use strict";$();pD=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`});var hD,Qce=b(()=>{"use strict";Va();Ch();Ba();hD=class{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Og.DENSE;let e=nd(t),r=_r();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${Ac(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(${e[0]}, ${e[1]}));
        int index = 4 * (resTexRC.x * ${e[1]} + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${r.output} = result;
      }
    `}}});var fD,Yce=b(()=>{"use strict";Va();Ch();Ba();fD=class{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Og.DENSE;let e=nd(t),r=_r();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${Ac(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(${e[0]}, ${e[1]}));
        int index = 4 * (resTexRC.x * ${e[1]} + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${r.output} = result;
      }
    `}}});var dD,Zce=b(()=>{"use strict";Va();Ch();Ba();dD=class{constructor(t){this.variableNames=["A"],this.outTexUsage=Ts.DOWNLOAD;let e=_r();this.outputShape=t,this.userCode=`
      ${pD}

      void main() {
        float x = getAAtOutCoords();
        ${e.output} = encode_float(x);
      }
    `}}});var mD,Jce=b(()=>{"use strict";Va();Ch();Ba();mD=class{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ts.DOWNLOAD;let e=_r();this.outputShape=t,this.userCode=`
      ${pD}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${e.output} = encode_float(x);
      }
    `}}});var gD,eue=b(()=>{"use strict";Va();Ch();gD=class{constructor(t,e,r=!1){this.variableNames=["A"];let o=_r(),[s,i]=e;this.outputShape=t;let a="result";r&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      ${db(t)}

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);

        int r = flatIndex / ${i};
        int c = imod(flatIndex, ${i});
        vec2 uv = (vec2(c, r) + halfCR) / vec2(${i}.0, ${s}.0);
        vec4 values = ${o.texture2D}(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        ${o.output} = vec4(${a}, 0., 0., 0.);
      }
    `}}});var yD,tue=b(()=>{"use strict";Va();Ch();yD=class{constructor(t,e,r=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let o=_r(),[s,i]=e;this.outputShape=t;let a="",c="result";r&&(c="floor(result * 255. + 0.5)");for(let l=0;l<=1;l++)for(let p=0;p<=1;p++){let f=l*2+p;a+=`
          localCoords = coords;
          if(localCoords[2] + ${p} < ${t[2]}) {
            localCoords[2] += ${p};
            if(localCoords[1] + ${l} < ${t[1]}) {
              localCoords[1] += ${l};

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / ${i};
              c = imod(flatIndex, ${i});
              uv = (vec2(c, r) + halfCR) / vec2(${i}.0, ${s}.0);
              values = ${o.texture2D}(A, uv);

              if(offset == 0) {
                result[${f}] = values[0];
              } else if(offset == 1) {
                result[${f}] = values[1];
              } else if(offset == 2) {
                result[${f}] = values[2];
              } else {
                result[${f}] = values[3];
              }
            }
          }
        `}this.userCode=`
      ${db(t)}

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        ${a}

        ${o.output} = ${c};
      }
    `}}});function nue(n){let t=_r(),e=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return kce(n,e)}function rue(n){let t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return Rce(n,t)}function oue(n){let t=new Uint16Array([0,1,2,2,1,3]);return Pce(n,t)}function VS(n,t,e,r,o,s){$ce(t,e);let i=Fce(n),a=n.TEXTURE_2D;return Pt(n,()=>n.bindTexture(a,i)),Pt(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),Pt(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),Pt(n,()=>n.texParameteri(a,n.TEXTURE_MIN_FILTER,n.NEAREST)),Pt(n,()=>n.texParameteri(a,n.TEXTURE_MAG_FILTER,n.NEAREST)),Pt(n,()=>n.texImage2D(a,0,r,t,e,0,o,s,null)),Pt(n,()=>n.bindTexture(n.TEXTURE_2D,null)),i}function Bz(n){return n.internalFormatFloat}function sue(n,t,e,r){let[o,s]=Mg(t,e);return VS(n,o,s,Bz(r),r.textureFormatFloat,n.FLOAT)}function Vz(n){return n.internalFormatHalfFloat}function iue(n,t,e,r){let[o,s]=Mg(t,e);return VS(n,o,s,Vz(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function qz(n){return n.downloadTextureFormat}function aue(n,t,e,r){let[o,s]=Mg(t,e);return VS(n,o,s,qz(r),n.RGBA,n.UNSIGNED_BYTE)}function Uz(n){return n.internalFormatPackedFloat}function cue(n,t,e,r){let[o,s]=Al(t,e);return VS(n,o,s,Uz(r),n.RGBA,n.FLOAT)}function jz(n){return n.internalFormatPackedHalfFloat}function uue(n,t,e,r){let[o,s]=Al(t,e);return VS(n,o,s,jz(r),n.RGBA,r.textureTypeHalfFloat)}function lue(n,t,e){return Pt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,e)),$z(n,t,"clipSpacePos",e,3,20,0)&&$z(n,t,"uv",e,2,20,12)}function pue(n,t,e,r,o,s){Pt(n,()=>n.bindTexture(n.TEXTURE_2D,t));let i,a,c;o instanceof Uint8Array?(i=new Uint8Array(e*r*4),a=n.UNSIGNED_BYTE,c=n.RGBA):(i=new Float32Array(e*r*4),a=n.FLOAT,c=s.internalFormatPackedFloat),i.set(o),Pt(n,()=>n.texImage2D(n.TEXTURE_2D,0,c,e,r,0,n.RGBA,a,i)),Pt(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function hue(n,t,e){Pt(n,()=>n.bindTexture(n.TEXTURE_2D,t)),e.data instanceof Uint8Array?Pt(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e.width,e.height,0,n.RGBA,n.UNSIGNED_BYTE,e.data)):Pt(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e)),Pt(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function fue(n,t,e,r){let o=n.createBuffer();Pt(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,o));let a=4*4*t*e;return Pt(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,a,n.STREAM_READ)),Pt(n,()=>n.readPixels(0,0,e,t,n.RGBA,n.FLOAT,0)),Pt(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),o}function due(n,t,e){let r=n,o=new Float32Array(e);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function mue(n,t,e,r){let[o,s]=Mg(t,e),i=4,a=new Uint8Array(Ece(t*e,i));return Pt(n,()=>n.readPixels(0,0,o,s,r.downloadTextureFormat,n.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function gue(n,t,e,r,o,s,i,a){let c=n,l=new Float32Array(Nce(s,i));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,l),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),l}function yue(n,t,e){let r=new Float32Array(t*e*4);return Pt(n,()=>n.readPixels(0,0,e,t,n.RGBA,n.FLOAT,r)),r}var Gz=b(()=>{"use strict";Va();Ba();Qi();});function s3e(n){let t=0;for(;t<n.length&&n[t]();++t);return t-1}var xD,xue=b(()=>{"use strict";$();sD();Gz();Ba();Qi();xD=class{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];let e=Te().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,Ice(e,t)):this.gl=Ki(e);let r="WEBGL_color_buffer_float",o="EXT_color_buffer_half_float";if(Te().getNumber("WEBGL_VERSION")===1){let s="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=zS(this.gl,s),Xi(this.gl,i))this.textureHalfFloatExtension=zS(this.gl,i);else if(Te().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Xi(this.gl,o))this.colorBufferHalfFloatExtension=zS(this.gl,o);else if(Te().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Xi(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Xi(this.gl,o))this.colorBufferHalfFloatExtension=this.gl.getExtension(o);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=rue(this.gl),this.indexBuffer=oue(this.gl),this.framebuffer=Lce(this.gl),this.textureConfig=LS(this.gl,this.textureHalfFloatExtension)}get debug(){return Te().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let t=this.gl;Pt(t,()=>t.finish()),Pt(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),Pt(t,()=>t.deleteFramebuffer(this.framebuffer)),Pt(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),Pt(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),Pt(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),sue(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),iue(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),aue(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),hue(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,r,o){this.throwIfDisposed(),pue(this.gl,t,e,r,o,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),uue(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),cue(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(Lz(this.gl,this.framebuffer),this.outputTexture=null),Pt(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,r){return this.downloadMatrixDriver(t,()=>mue(this.gl,e,r,this.textureConfig))}downloadPackedMatrixFromBuffer(t,e,r,o,s,i){return gue(this.gl,t,e,r,o,s,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,e){return due(this.gl,t,e)}createBufferFromTexture(t,e,r){this.bindTextureToFrameBuffer(t);let o=fue(this.gl,e,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o}createAndWaitForFence(){let t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,r;if(Te().getBool("WEBGL_FENCE_API_ENABLED")){let o=t,s=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=()=>{let i=o.clientWaitSync(s,0,0);return i===o.ALREADY_SIGNALED||i===o.CONDITION_SATISFIED},e=s}else Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(e,Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:e,isFencePassed:r}}downloadMatrixFromPackedTexture(t,e,r){return this.downloadMatrixDriver(t,()=>yue(this.gl,e,r))}createProgram(t){this.throwIfDisposed();let e=this.gl,r=Ace(e,t),o=nue(e),s=Oce(e);return Pt(e,()=>e.attachShader(s,o)),Pt(e,()=>e.attachShader(s,r)),Mce(e,s),this.debug&&aD(e,s),this.vertexAttrsAreBound||(this.setProgram(s),this.vertexAttrsAreBound=lue(e,this.program,this.vertexBuffer)),s}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&Pt(this.gl,()=>this.gl.deleteProgram(t))}setProgram(t){this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&aD(this.gl,this.program),Pt(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,e,r=!0){return this.throwIfDisposed(),r?zce(this.gl,t,e):Bce(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),Pt(this.gl,()=>this.gl.getAttribLocation(t,e))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,r){this.throwIfDisposed(),this.throwIfNoProgram(),Vce(this.gl,t,e,r)}setOutputMatrixTexture(t,e,r){this.setOutputMatrixTextureDriver(t,r,e)}setOutputPackedMatrixTexture(t,e,r){this.throwIfDisposed();let[o,s]=Al(e,r);this.setOutputMatrixTextureDriver(t,o,s)}setOutputMatrixWriteRegion(t,e,r,o){this.setOutputMatrixWriteRegionDriver(r,t,o,e)}setOutputPackedMatrixWriteRegion(t,e,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&aD(this.gl,this.program),BS(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let t=this.gl;this.debug&&this.debugValidate(),Pt(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Pt(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=zS(this.gl,Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let r=this.gl,o=this.getQueryTimerExtensionWebGL2(),s=r.createQuery();return r.beginQuery(o.TIME_ELAPSED_EXT,s),s}let t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let e=this.gl,r=this.getQueryTimerExtensionWebGL2();e.endQuery(r.TIME_ELAPSED_EXT);return}let t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}waitForQueryAndGetTime(t){return Y(this,null,function*(){return yield N.repeatedTry(()=>this.disposed||this.isQueryAvailable(t,Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})}getQueryTime(t,e){if(e===0)return null;if(e===2){let r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}else{let r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(e===0)return!0;if(e===2){let r=this.gl,o=this.getQueryTimerExtensionWebGL2(),s=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),s&&!this.disjoint}else{let r=this.getQueryTimerExtensionWebGL1(),o=r.getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}}pollFence(t){return new Promise(e=>{this.addItemToPoll(()=>t.isFencePassed(),()=>e())})}pollItems(){let t=s3e(this.itemsToPoll.map(e=>e.isDoneFn));for(let e=0;e<=t;++e){let{resolveFn:r}=this.itemsToPoll[e];r()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),!(this.itemsToPoll.length>1)&&N.repeatedTry(()=>(this.pollItems(),this.itemsToPoll.length===0))}bindTextureToFrameBuffer(t){this.throwIfDisposed(),cD(this.gl,t,this.framebuffer),this.debug&&BS(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(cD(this.gl,this.outputTexture,this.framebuffer),this.debug&&BS(this.gl)):Lz(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);let r=e();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(t,e,r){this.throwIfDisposed();let o=this.gl;cD(o,t,this.framebuffer),this.debug&&BS(o),this.outputTexture=t,Pt(o,()=>o.viewport(0,0,e,r)),Pt(o,()=>o.scissor(0,0,e,r))}setOutputMatrixWriteRegionDriver(t,e,r,o){this.throwIfDisposed(),Pt(this.gl,()=>this.gl.scissor(t,e,r,o))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}});function bue(n,t,e,r){let o=[];n.forEach(h=>{let m=N.sizeFromShape(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?o.push(`uniform float ${h.name}${m>1?`[${m}]`:""};`):(o.push(`uniform sampler2D ${h.name};`),o.push(`uniform int offset${h.name};`))});let s=o.join(`
`),i=n.map(h=>i3e(h,t,r)).join(`
`),a=t.texShape,c=_r(),l=u3e(c),p,f,y=h3e(c);return t.isPacked?(p=a3e(t.logicalShape,a),f=p3e(c)):(p=c3e(t.logicalShape,a),f=l3e(c)),r&&(y+=g3e),[y,l,f,s,p,i,e].join(`
`)}function gb(n){let t=n.shapeInfo.logicalShape;switch(t.length){case 0:return N3e(n);case 1:return k3e(n);case 2:return O3e(n);case 3:return R3e(n);case 4:return F3e(n);case 5:return $3e(n);case 6:return L3e(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function wue(n){switch(n.shapeInfo.logicalShape.length){case 0:return E3e(n);case 1:return D3e(n);case 2:return A3e(n);case 3:return M3e(n);default:return P3e(n)}}function i3e(n,t,e=!1){let r="";e?r+=wue(n):r+=gb(n);let o=n.shapeInfo.logicalShape,s=t.logicalShape;return o.length<=s.length&&(e?r+=z3e(n,t):r+=B3e(n,t)),r}function a3e(n,t){switch(n.length){case 0:return Sue();case 1:return y3e(n,t);case 2:return T3e(n,t);case 3:return v3e(n,t);default:return w3e(n,t)}}function c3e(n,t){switch(n.length){case 0:return Sue();case 1:return x3e(n,t);case 2:return I3e(n,t);case 3:return b3e(n,t);case 4:return S3e(n,t);case 5:return C3e(n,t);case 6:return _3e(n,t);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function u3e(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function l3e(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function p3e(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function h3e(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${f3e}
    ${d3e}
    ${m3e}
  `}function Sue(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function y3e(n,t){let e=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return e[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${e[0]}.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return 2 * (resTexRC.x * ${e[1]} + resTexRC.y);
    }
  `}function x3e(n,t){return t[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function v3e(n,t){let e=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(n[2]/2),o=r*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function b3e(n,t){let e=Ac(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${e}
      return ivec3(r, c, d);
    }
  `}function w3e(n,t){let e=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(n[n.length-1]/2),o=r*Math.ceil(n[n.length-2]/2),s=o,i="",a="b, r, c";for(let c=2;c<n.length-1;c++)s*=n[n.length-c-1],i=`
      int b${c} = index / ${s};
      index -= b${c} * ${s};
    `+i,a=`b${c}, `+a;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${i}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${n.length}(${a});
    }
  `}function S3e(n,t){let e=Ac(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${e}
      return ivec4(r, c, d, d2);
    }
  `}function C3e(n,t){let e=Ac(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${e}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function _3e(n,t){let e=Ac(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${e}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function T3e(n,t){let e=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(N.arraysEqual(n,t))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `;let r=Math.ceil(n[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function I3e(n,t){return N.arraysEqual(n,t)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:n[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function Pg(n){return`offset${n}`}function E3e(n){let t=n.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1),r=_r();return`
    vec4 ${e}() {
      return ${r.texture2D}(${t}, halfCR);
    }
  `}function N3e(n){let t=n.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${e}() {return ${t};}`;let[r,o]=n.shapeInfo.texShape;if(r===1&&o===1)return`
      float ${e}() {
        return sampleTexture(${t}, halfCR);
      }
    `;let[s,i]=n.shapeInfo.texShape,a=Pg(t);return`
    float ${e}() {
      vec2 uv = uvFromFlat(${s}, ${i}, ${a});
      return sampleTexture(${t}, uv);
    }
  `}function D3e(n){let t=n.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1),r=n.shapeInfo.texShape,o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],s=_r();return`
    vec4 ${e}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${s.texture2D}(${t}, uv);
    }
  `}function k3e(n){let t=n.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${e}(int index) {
        ${yb(n)}
      }
    `;let r=n.shapeInfo.texShape,o=r[0],s=r[1];if(s===1&&o===1)return`
      float ${e}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;let i=Pg(t);return s===1?`
      float ${e}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${i}) + 0.5) / ${o}.0);
        return sampleTexture(${t}, uv);
      }
    `:o===1?`
      float ${e}(int index) {
        vec2 uv = vec2((float(index + ${i}) + 0.5) / ${s}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
    float ${e}(int index) {
      vec2 uv = uvFromFlat(${o}, ${s}, index + ${i});
      return sampleTexture(${t}, uv);
    }
  `}function A3e(n){let t=n.shapeInfo.logicalShape,e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),o=n.shapeInfo.texShape,s=o[0],i=o[1],a=_r();if(o!=null&&N.arraysEqual(t,o))return`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${i}.0, ${s}.0);

        return ${a.texture2D}(${e}, uv);
      }
    `;let c=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],l=Math.ceil(t[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${l}, ${c[0]}, ${c[1]}, row, col);
      return ${a.texture2D}(${e}, uv);
    }
  `}function O3e(n){let t=n.shapeInfo.logicalShape,e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),o=n.shapeInfo.texShape;if(o!=null&&N.arraysEqual(t,o)){let f=o[0],y=o[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${y}.0, ${f}.0);
      return sampleTexture(${e}, uv);
    }
  `}let{newShape:s,keptDims:i}=N.squeezeShape(t),a=s;if(a.length<t.length){let f=xb(n,a),y=["row","col"];return`
      ${gb(f)}
      float ${r}(int row, int col) {
        return ${r}(${vb(y,i)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${yb(n)}
      }
    `;let c=o[0],l=o[1],p=Pg(e);return l===1?`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${e}, uv);
    }
  `:c===1?`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${l}.0, 0.5);
      return sampleTexture(${e}, uv);
    }
  `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${p};
    vec2 uv = uvFromFlat(${c}, ${l}, index);
    return sampleTexture(${e}, uv);
  }
`}function M3e(n){let t=n.shapeInfo.logicalShape,e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),o=n.shapeInfo.texShape,s=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(t[0]===1){let f=t.slice(1),y=[1,2],d=xb(n,f),h=["b","row","col"];return`
        ${wue(d)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${vb(h,y)});
        }
      `}let i=s[0],a=s[1],c=Math.ceil(t[2]/2),l=c*Math.ceil(t[1]/2),p=_r();return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${i}, ${a}, ${l}, ${c}, b, row, col);
      return ${p.texture2D}(${e}, uv);
    }
  `}function R3e(n){let t=n.shapeInfo.logicalShape,e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),o=t[1]*t[2],s=t[2],{newShape:i,keptDims:a}=N.squeezeShape(t),c=i;if(c.length<t.length){let h=xb(n,c),m=["row","col","depth"];return`
        ${gb(h)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${vb(m,a)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${s}, 1)));
        ${yb(n)}
      }
    `;let l=n.shapeInfo.texShape,p=l[0],f=l[1],y=n.shapeInfo.flatOffset;if(f===o&&y==null)return`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${s}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${f}.0, ${p}.0);
          return sampleTexture(${e}, uv);
        }
      `;if(f===s&&y==null)return`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}.0, ${p}.0);
      return sampleTexture(${e}, uv);
    }
  `;let d=Pg(e);return`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${s} + depth + ${d};
        vec2 uv = uvFromFlat(${p}, ${f}, index);
        return sampleTexture(${e}, uv);
      }
  `}function P3e(n){let t=n.shapeInfo.logicalShape,e=t.length,r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n.shapeInfo.texShape,i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],a=i[0],c=i[1],l=Math.ceil(t[e-1]/2),p=l*Math.ceil(t[e-2]/2),f="int b, int row, int col",y=`b * ${p} + (row / 2) * ${l} + (col / 2)`;for(let h=2;h<e-1;h++)f=`int b${h}, `+f,p*=t[e-h-1],y=`b${h} * ${p} + `+y;let d=_r();return`
    vec4 ${o}(${f}) {
      int index = ${y};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${a});
      return ${d.texture2D}(${r}, uv);
    }
  `}function F3e(n){let t=n.shapeInfo.logicalShape,e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),o=t[3],s=t[2]*o,i=t[1]*s,{newShape:a,keptDims:c}=N.squeezeShape(t);if(a.length<t.length){let h=xb(n,a),m=["row","col","depth","depth2"];return`
      ${gb(h)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${vb(m,c)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${i}, ${s}, ${o}, 1)));
        ${yb(n)}
      }
    `;let l=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,f=p[0],y=p[1];if(y===i&&l==null)return`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${s}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}.0, ${f}.0);
        return sampleTexture(${e}, uv);
      }
    `;if(y===o&&l==null)return`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${y}.0, ${f}.0);
        return sampleTexture(${e}, uv);
      }
    `;let d=Pg(e);return`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${i} + col * ${s} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${f}, ${y}, index + ${d});
      return sampleTexture(${e}, uv);
    }
  `}function $3e(n){let t=n.shapeInfo.logicalShape,e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),o=t[4],s=t[3]*o,i=t[2]*s,a=t[1]*i,{newShape:c,keptDims:l}=N.squeezeShape(t);if(c.length<t.length){let m=xb(n,c),x=["row","col","depth","depth2","depth3"];return`
      ${gb(m)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${vb(x,l)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${s}, ${o})) +
          depth3;
        ${yb(n)}
      }
    `;let p=n.shapeInfo.flatOffset,f=n.shapeInfo.texShape,y=f[0],d=f[1];if(d===a&&p==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${s}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${d}.0, ${y}.0);
        return sampleTexture(${e}, uv);
      }
    `;if(d===o&&p==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${d}.0, ${y}.0);
        return sampleTexture(${e}, uv);
      }
    `;let h=Pg(e);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${s} +
          depth2 * ${o} + depth3 + ${h};
      vec2 uv = uvFromFlat(${y}, ${d}, index);
      return sampleTexture(${e}, uv);
    }
  `}function L3e(n){let t=n.shapeInfo.logicalShape,e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),{newShape:o,keptDims:s}=N.squeezeShape(t);if(o.length<t.length){let x=xb(n,o),w=["row","col","depth","depth2","depth3","depth4"];return`
      ${gb(x)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${vb(w,s)});
      }
    `}let i=t[5],a=t[4]*i,c=t[3]*a,l=t[2]*c,p=t[1]*l;if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${p}, ${l}, ${c}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${yb(n)}
      }
    `;let f=n.shapeInfo.flatOffset,y=n.shapeInfo.texShape,d=y[0],h=y[1];if(h===p&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${l}, ${c}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${d}.0);
        return sampleTexture(${e}, uv);
      }
    `;if(h===i&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${d}.0);
        return sampleTexture(${e}, uv);
      }
    `;let m=Pg(e);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${p} + col * ${l} + depth * ${c} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${m};
      vec2 uv = uvFromFlat(${d}, ${h}, index);
      return sampleTexture(${e}, uv);
    }
  `}function yb(n){let t=n.name,e=N.sizeFromShape(n.shapeInfo.logicalShape);return e<2?`return ${t};`:`
    for (int i = 0; i < ${e}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function z3e(n,t){let e=n.name,r=e.charAt(0).toUpperCase()+e.slice(1),o="get"+r+"AtOutCoords",s=n.shapeInfo.logicalShape.length,i=t.logicalShape.length,a=vue(n.shapeInfo.logicalShape,t.logicalShape),c=Xt(i),l=i-s,p,f=["x","y","z","w","u","v"];s===0?p="":i<2&&a.length>=1?p="coords = 0;":p=a.map(_=>`coords.${f[_+l]} = 0;`).join(`
`);let y="";i<2&&s>0?y="coords":y=n.shapeInfo.logicalShape.map((_,I)=>`coords.${f[I+l]}`).join(", ");let d="return outputValue;",m=N.sizeFromShape(n.shapeInfo.logicalShape)===1,w=N.sizeFromShape(t.logicalShape)===1;if(s===1&&!m&&!w)d=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!w)i===1?d=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:d=`
        return vec4(outputValue.x);
      `;else if(a.length){let _=s-2,I=s-1;a.indexOf(_)>-1&&a.indexOf(I)>-1?d="return vec4(outputValue.x);":a.indexOf(_)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(I)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${o}() {
      ${c} coords = getOutputCoords();
      ${p}
      vec4 outputValue = get${r}(${y});
      ${d}
    }
  `}function B3e(n,t){let e=n.name,r=e.charAt(0).toUpperCase()+e.slice(1),o="get"+r+"AtOutCoords",s=t.texShape,i=n.shapeInfo.texShape,a=n.shapeInfo.logicalShape.length,c=t.logicalShape.length;if(!n.shapeInfo.isUniform&&a===c&&n.shapeInfo.flatOffset==null&&N.arraysEqual(i,s))return`
      float ${o}() {
        return sampleTexture(${e}, resultUV);
      }
    `;let l=Xt(c),p=vue(n.shapeInfo.logicalShape,t.logicalShape),f=c-a,y,d=["x","y","z","w","u","v"];a===0?y="":c<2&&p.length>=1?y="coords = 0;":y=p.map(m=>`coords.${d[m+f]} = 0;`).join(`
`);let h="";return c<2&&a>0?h="coords":h=n.shapeInfo.logicalShape.map((m,x)=>`coords.${d[x+f]}`).join(", "),`
    float ${o}() {
      ${l} coords = getOutputCoords();
      ${y}
      return get${r}(${h});
    }
  `}function Xt(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function xb(n,t){let e=JSON.parse(JSON.stringify(n));return e.shapeInfo.logicalShape=t,e}function vb(n,t){return t.map(e=>n[e]).join(", ")}var vue,f3e,d3e,m3e,g3e,Kr=b(()=>{"use strict";$();Va();Ch();({getBroadcastDims:vue}=H);f3e=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,d3e=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,m3e=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,g3e=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`});function _ue(n,t,e,r){let o=t.userCode,s=e.map((d,h)=>{let m={logicalShape:d.shape,texShape:d.isUniform?null:d.texData.texShape,isUniform:d.isUniform,isPacked:d.isUniform?!1:d.texData.isPacked,flatOffset:null};return d.texData!=null&&d.texData.slice!=null&&d.texData.slice.flatOffset>0&&(m.flatOffset=d.texData.slice.flatOffset),{name:t.variableNames[h],shapeInfo:m}}),i=s.map(d=>d.shapeInfo),a={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},c=bue(s,a,o,t.packedInputs),l=n.createProgram(c),p=null,f=n.getUniformLocation(l,"NAN",!1);Te().getNumber("WEBGL_VERSION")===1&&(p=n.getUniformLocation(l,"INFINITY",!1));let y={};for(let d=0;d<t.variableNames.length;d++){let h=t.variableNames[d],m=!1;y[h]=n.getUniformLocation(l,h,m),y[`offset${h}`]=n.getUniformLocation(l,`offset${h}`,m)}return{program:t,source:c,webGLProgram:l,uniformLocations:y,inShapeInfos:i,outShapeInfo:a,infLoc:p,nanLoc:f}}function Cue(n,t){if(n.length!==t.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${t.length} inputs`);n.forEach((e,r)=>{let o=e.logicalShape,s=t[r],i=s.shape;if(!N.arraysEqual(o,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${o} and ${i} must match`);if(e.isUniform&&s.isUniform)return;let a=e.texShape,c=s.isUniform?null:s.texData.texShape;if(!N.arraysEqual(a,c))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${c} must match`)})}function Tue(n,t,e,r,o){Cue(t.inShapeInfos,e),Cue([t.outShapeInfo],[r]);let s=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?n.setOutputPackedMatrixTexture(s,i[0],i[1]):n.setOutputMatrixTexture(s,i[0],i[1]),n.setProgram(t.webGLProgram),Te().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&n.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&n.gl.uniform1f(t.nanLoc,NaN),e.forEach((a,c)=>{let l=t.program.variableNames[c],p=t.uniformLocations[l],f=t.uniformLocations[`offset${l}`];if(p!=null){if(a.isUniform){if(N.sizeFromShape(a.shape)<2)n.gl.uniform1f(p,a.uniformValues[0]);else{let y=a.uniformValues;y instanceof Float32Array||(y=new Float32Array(y)),n.gl.uniform1fv(p,y)}return}a.texData.slice!=null&&f!=null&&n.gl.uniform1i(f,a.texData.slice.flatOffset),n.setInputMatrixTexture(a.texData.texture,p,c)}}),o?.(n,t.webGLProgram),n.executeProgram()}function Iue(n,t,e){let r="";t.concat(e).forEach(i=>{let a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0,c=i.isUniform?"uniform":i.texData.texShape;r+=`${i.shape}_${c}_${a}`});let o=n.userCode,s=n.constructor.name;return s+="_"+r+"_"+o,s}var Eue=b(()=>{"use strict";$();Kr();});var Nue,vD,Due,kue,Aue,Oue,Mue,Rue,Pue,Fue,$ue,Lue,zue,Bue,Vue,que,Uue,jue,Gue,Wue,Hue,bD,Kue,Xue,Que,Yue,Zue,Fg,Jue,rr=b(()=>{"use strict";Fre();({addImpl:Nue,bincountImpl:vD,bincountReduceImpl:Due,ceilImpl:kue,concatImpl:Aue,expImpl:Oue,expm1Impl:Mue,floorImpl:Rue,gatherV2Impl:Pue,greaterImpl:Fue,lessImpl:$ue,linSpaceImpl:Lue,logImpl:zue,maxImpl:Bue,maximumImpl:Vue,minimumImpl:que,multiplyImpl:Uue,negImpl:jue,prodImpl:Gue,rangeImpl:Wue,rsqrtImpl:Hue,simpleAbsImpl:bD,sliceImpl:Kue,stridedSliceImpl:Xue,subImpl:Que,tileImpl:Yue,topKImpl:Zue,transposeImpl:Fg,uniqueImpl:Jue}=K3)});function Wz(n,t){return["x","y","z","w","u","v"].slice(0,t).map(e=>`${n}.${e}`)}function Vr(n,t){return t===1?[n]:Wz(n,t)}function ele(n,t){if(n===1)return"rc";let e="";for(let r=0;r<n;r++)e+=t[r],r<n-1&&(e+=",");return e}var Oc=b(()=>{"use strict";});function U3e(n,t){let e=[];for(let r=0;r<=1;r++)for(let o=0;o<=1;o++){let s=`${r===0?"r":"rp1"}, ${o===0?"c":"cp1"}`;for(let i=2;i<n;i++)s=`${t[t.length-1-i]},`+s;e.push(s)}return e}function j3e(n,t,e){if(n===1)return`rc > ${t[0]}`;let r="";for(let o=n-2;o<n;o++)r+=`${e[o]} >= ${t[o]}`,o<n-1&&(r+="||");return r}function G3e(n,t,e,r){if(n===1)return"";let o=r.slice(-2);return`
    int r = ${o[0]};
    int c = ${o[1]};
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= ${t};
    bool rEdge = rp1 >= ${e};
  `}function W3e(n,t){let e=n.length,r=U3e(e,t);return e===1?`getA(rc),
            rc + 1 >= ${n[0]} ? 0. : getA(rc + 1),
            0, 0`:`getA(${r[0]}),
          cEdge ? 0. : getA(${r[1]}),
          rEdge ? 0. : getA(${r[2]}),
          rEdge || cEdge ? 0. : getA(${r[3]})`}var wD,tle=b(()=>{"use strict";Oc();Kr();wD=class{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;let e=t.length;if(e===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{let r=Vr("rc",e),o=Xt(e),s=j3e(e,t,r),i=G3e(e,t[t.length-1],t[t.length-2],r),a=W3e(t,r);this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${a}));
          }
        }
      `}}}});function H3e(n){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${Ac(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}var bb,Hz=b(()=>{"use strict";Ch();bb=class{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;let r="";for(let o=0;o<4;o++){let s="thisRC = rc;";o%2===1&&(s+="thisRC.z += 1;"),o>1&&(s+="thisRC.y += 1;"),r+=`
        ${s}
        ${o>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${o}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${o>0?"}":""}
      `}this.userCode=`
      ${H3e(e)}
      ${db(t)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${t[1]};
        int cols = ${t[2]};

        ${r}

        setOutput(result);
      }
    `}}});function K3e(n,t){let e=n;if(t===e.R32F)return 4;if(t===e.R16F)return 2;if(t===e.RGBA32F)return 16;if(t===n.RGBA)return 16;if(t===e.RGBA16F)return 8;throw new Error(`Unknown internal format ${t}`)}function nle(n,t,e,r,o){let s=X3e(t,r),i;if(o){let[c,l]=Al(n[0],n[1]);i=c*l}else{let[c,l]=Mg(n[0],n[1]);i=c*l}let a=K3e(e,s);return i*a}function X3e(n,t){switch(n){case os.PACKED_2X2_FLOAT32:return Uz(t);case os.PACKED_2X2_FLOAT16:return jz(t);case os.UNPACKED_FLOAT32:return Bz(t);case os.UNPACKED_FLOAT16:return Vz(t);case os.PACKED_4X1_UNSIGNED_BYTE:return qz(t);default:throw new Error(`Unknown physical texture type ${n}`)}}function Q3e(n){return Te().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?os.PACKED_2X2_FLOAT32:os.UNPACKED_FLOAT32:n?os.PACKED_2X2_FLOAT16:os.UNPACKED_FLOAT16}function rle(n,t){if(n===Ts.UPLOAD)return os.PACKED_2X2_FLOAT32;if(n===Ts.RENDER||n==null)return Q3e(t);if(n===Ts.DOWNLOAD||n===Ts.PIXELS)return os.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function ole(n,t,e){return`${n[0]}_${n[1]}_${t}_${e}`}var SD,sle=b(()=>{"use strict";$();Gz();Ba();SD=class{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(t,e,r){let o=rle(e,r),s=ole(t,o,r);s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]);let i=nle(t,o,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();let c=this.freeTextures[s].shift();return this.usedTextures[s].push(c),c}let a;return o===os.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):o===os.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):o===os.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):o===os.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):o===os.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[s].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(t,e,r,o){if(this.freeTextures==null)return;let s=rle(r,o),i=ole(e,s,o);i in this.freeTextures||(this.freeTextures[i]=[]);let a=nle(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,o),c=Te().get("WEBGL_DELETE_TEXTURE_THRESHOLD");c!==-1&&this._numBytesAllocated>c?(this.gpgpu.deleteMatrixTexture(t),this._numBytesAllocated-=a):(this.freeTextures[i].push(t),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;let l=this.usedTextures[i],p=l.indexOf(t);if(p<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l.splice(p,1),this.log()}log(){if(!this.logEnabled)return;let t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);let e=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*e)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(let t in this.freeTextures)this.freeTextures[t].forEach(e=>{this.gpgpu.deleteMatrixTexture(e)});for(let t in this.usedTextures)this.usedTextures[t].forEach(e=>{this.gpgpu.deleteMatrixTexture(e)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}});var js,Ao,ile,Kz,ale,cle,ule,qS,Is=b(()=>{"use strict";js=class{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      float unaryOperation(float x) {
        ${e}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}},Ao="if (isnan(x)) return x;",ile="return x;",Kz="return abs(x);",ale="return (x >= 0.0) ? x : (exp(x) - 1.0);",cle=Ao+`
  return (x < 0.0) ? 0.0 : x;
`,ule=Ao+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,qS="return x;"});var ple,hle,fle,dle,qa,wb=b(()=>{"use strict";ple="return x;",hle=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,fle=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,dle=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,qa=class{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${e}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}});var CD,mle=b(()=>{"use strict";Oc();Kr();CD=class{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;let e=t.length,r=Vr("rc",e),o=Xt(e),s=ele(e,r),i=r.slice(-2),a=e<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${o} rc = getOutputCoords();
        vec4 packedInput = getA(${s});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}});function tze(n){return n in _D||(_D[n]={}),_D[n]}function oze(){return Te().global.screen==null?1024:Te().global.screen.height*Te().global.screen.width*window.devicePixelRatio*rze/1024/1024}function sze(n,t){if(t==="float32"||t==="complex64")return n;if(t==="int32"||t==="bool"){let e=t==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let r=0;r<e.length;++r)e[r]=Math.round(n[r]);return e}else throw new Error(`Unknown dtype ${t}`)}var Z3e,J3e,eze,_D,nze,rze,TD,gle=b(()=>{"use strict";Xce();$();sD();Qce();Yce();Zce();Jce();eue();tue();xue();Eue();rr();tle();Hz();Ba();Ba();sle();Is();Is();wb();mle();Qi();Z3e=Vo.whereImpl,J3e=1e-7,eze=1e-4,_D={};nze=128,rze=600;TD=class extends eu{constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.warnedAboutCPUBackend=!1,this.pendingDeletes=0,this.disposed=!1,!Te().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(t==null){let e=Ki(Te().getNumber("WEBGL_VERSION"));this.binaryCache=tze(Te().getNumber("WEBGL_VERSION")),this.gpgpu=new xD(e),this.canvas=e.canvas,this.gpgpuCreatedLocally=!0}else this.gpgpu=t,this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;this.textureManager=new SD(this.gpgpu),this.numMBBeforeWarning=oze(),this.texData=new ef(this,eh())}numDataIds(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}write(t,e,r){if((Te().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Te().getBool("DEBUG"))&&this.checkNumericalProblems(t),r==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let o={};return this.texData.set(o,{shape:e,dtype:r,values:t,usage:Ts.UPLOAD,refCount:1,complexParentRefCount:0}),o}incRef(t){let e=this.texData.get(t);e.refCount++}decRef(t){if(this.texData.has(t)){let e=this.texData.get(t);e.refCount--}}decComplexRef(t){if(this.texData.has(t)){let e=this.texData.get(t);e.complexParentRefCount>0&&e.refCount--}}move(t,e,r,o){if(Te().getBool("DEBUG")&&this.checkNumericalProblems(e),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:r,dtype:o,values:e,usage:Ts.UPLOAD,refCount:1,complexParentRefCount:0})}disposeIntermediateTensorInfo(t){let e=t.dataId;if(this.texData.has(e)){let r=this.texData.get(e);r.refCount--,r.refCount<1&&this.disposeData(e)}}readSync(t){let e=this.texData.get(t),{values:r,dtype:o,complexTensorInfos:s,slice:i,shape:a,isPacked:c}=e;if(i!=null){let y;c?y=new qa(a,qS):y=new js(a,qS);let d=this.runWebGLProgram(y,[{dataId:t,shape:a,dtype:o}],o),h=this.readSync(d.dataId);return this.disposeIntermediateTensorInfo(d),h}if(r!=null)return this.convertAndCacheOnCPU(t);if(o==="string")return r;let l=this.activeTimers!=null,p;l&&(p=N.now());let f;if(o==="complex64"){let y=this.readSync(s.real.dataId),d=this.readSync(s.imag.dataId);f=H.mergeRealAndImagArrays(y,d)}else f=this.getValuesFromTexture(t);return l&&(this.downloadWaitMs+=N.now()-p),this.convertAndCacheOnCPU(t,f)}read(t){return Y(this,null,function*(){if(this.pendingRead.has(t)){let h=this.pendingRead.get(t);return new Promise(m=>h.push(m))}let e=this.texData.get(t),{values:r,shape:o,slice:s,dtype:i,complexTensorInfos:a,isPacked:c}=e;if(s!=null){let h;c?h=new qa(o,qS):h=new js(o,qS);let m=this.runWebGLProgram(h,[{dataId:t,shape:o,dtype:i}],i),x=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),x}if(r!=null)return this.convertAndCacheOnCPU(t);if(!Te().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Te().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l=null,p;if(i!=="complex64"&&Te().get("WEBGL_BUFFER_SUPPORTED")){p=this.decode(t);let h=this.texData.get(p.dataId);l=this.gpgpu.createBufferFromTexture(h.texture,...nd(o))}this.pendingRead.set(t,[]),i!=="complex64"&&(yield this.gpgpu.createAndWaitForFence());let f;if(i==="complex64"){let h=yield Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=h[0],x=h[1];f=H.mergeRealAndImagArrays(m,x)}else if(l==null)f=this.getValuesFromTexture(t);else{let h=N.sizeFromShape(o);f=this.gpgpu.downloadFloat32MatrixFromBuffer(l,h)}p!=null&&this.disposeIntermediateTensorInfo(p);let y=this.convertAndCacheOnCPU(t,f),d=this.pendingRead.get(t);return this.pendingRead.delete(t),d.forEach(h=>h(y)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),y})}bufferSync(t){let e=this.readSync(t.dataId),r=e;if(t.dtype==="string")try{r=e.map(o=>N.decodeString(o))}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return It(t.shape,t.dtype,r)}checkNumericalProblems(t){if(t!=null)for(let e=0;e<t.length;e++){let r=t[e];if(!Dce(r))throw Te().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(t){let{shape:e,dtype:r,isPacked:o}=this.texData.get(t),s=N.sizeFromShape(e);if(Te().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let y=this.decode(t),d=this.texData.get(y.dataId),h=this.gpgpu.downloadMatrixFromPackedTexture(d.texture,...nd(e)).subarray(0,s);return this.disposeIntermediateTensorInfo(y),h}let i=Te().getBool("WEBGL_PACK")&&o===!0,a=i?uD(e):e,c=i?new mD(a):new dD(a),l=this.runWebGLProgram(c,[{shape:a,dtype:r,dataId:t}],"float32"),p=this.texData.get(l.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(p.texture,p.texShape[0],p.texShape[1]).subarray(0,s);return this.disposeIntermediateTensorInfo(l),f}time(t){return Y(this,null,function*(){let e=this.activeTimers,r=[],o=!1;this.programTimersStack==null?(this.programTimersStack=r,o=!0):this.activeTimers.push(r),this.activeTimers=r,t();let s=N.flatten(this.activeTimers.map(c=>c.query)).filter(c=>c!=null),i=N.flatten(this.activeTimers.map(c=>c.name)).filter(c=>c!=null);this.activeTimers=e,o&&(this.programTimersStack=null);let a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};if(Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let c=yield Promise.all(s);a.kernelMs=N.sum(c),a.getExtraProfileInfo=()=>c.map((l,p)=>({name:i[p],ms:l})).map(l=>`${l.name}: ${l.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:N.now(),endMs:null}}endTimer(t){return Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=N.now(),t)}getQueryTime(t){return Y(this,null,function*(){if(Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);let e=t;return e.endMs-e.startMs})}disposeData(t){if(this.pendingDisposal.has(t))return;if(this.pendingRead.has(t)){this.pendingDisposal.add(t),this.pendingDeletes++;return}if(!this.texData.has(t))return;if(this.texData.get(t).complexParentRefCount>0){this.texData.get(t).refCount--;return}this.releaseGPUData(t);let{complexTensorInfos:e}=this.texData.get(t);e!=null&&(this.texData.get(e.real.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(e.real),this.texData.get(e.imag.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(e.imag)),this.texData.delete(t)}releaseGPUData(t){let{texture:e,dtype:r,texShape:o,usage:s,isPacked:i,slice:a}=this.texData.get(t),c=a&&a.origDataId||t,l=this.dataRefCount.get(c);l>1?this.dataRefCount.set(c,l-1):(this.dataRefCount.delete(c),e!=null&&(this.numBytesInGPU-=this.computeBytes(o,r),this.textureManager.releaseTexture(e,o,s,i)));let p=this.texData.get(t);p.texture=null,p.texShape=null,p.isPacked=!1,p.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture}getDataInfo(t){return this.texData.get(t)}getCPUBackend(){return Te().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=eh().findBackend("cpu")),this.cpuBackend):null}shouldExecuteOnCPU(t,e=nze){let r=this.getCPUBackend();return!Te().getBool("IS_TEST")&&!this.warnedAboutCPUBackend&&r==null&&(console.warn("Your application contains ops that are small enough to be executed on the CPU backend, however the CPU backend cannot be found. Consider importing the CPU backend (@tensorflow/tfjs-backend-cpu) for better performance."),this.warnedAboutCPUBackend=!0),r!=null&&t.every(o=>this.texData.get(o.dataId).texture==null&&N.sizeFromShape(o.shape)<e)}getGPGPUContext(){return this.gpgpu}where(t){H.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let e=t.dataSync();return Z3e(t.shape,e)}packedUnaryOp(t,e,r){let o=new qa(t.shape,e);return this.compileAndRun(o,[t],r)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){let r=bD(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,r)}if(Te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Kz,t.dtype);let e=new js(t.shape,Kz);return this.compileAndRun(e,[t])}makeTensorInfo(t,e,r){let o;if(e==="string"&&r!=null&&r.length>0&&N.isString(r[0])){let s=r.map(i=>N.encodeString(i));o=this.write(s,t,e)}else o=this.write(r,t,e);return this.texData.get(o).usage=null,{dataId:o,shape:t,dtype:e}}makeOutput(t,e,r){let{dataId:o}=this.makeTensorInfo(t,e,r);return eh().makeTensorFromDataId(o,t,e,this)}unpackTensor(t){let e=new CD(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){let e=new wD(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}packedReshape(t,e){let r=[rd(t.shape),...od(t.shape)],o={dtype:t.dtype,shape:r,dataId:t.dataId},s=[rd(e),...od(e)],i=new bb(s,r),c=this.runWebGLProgram(i,[o],t.dtype,null,!0);return{dataId:c.dataId,shape:e,dtype:c.dtype}}decode(t){let e=this.texData.get(t),{isPacked:r,shape:o,dtype:s}=e,i=uD(o),a;r?a=new fD(i):a=new hD(i);let l=this.runWebGLProgram(a,[{shape:i,dtype:s,dataId:t}],s,null,!0);return{dtype:s,shape:o,dataId:l.dataId}}runWebGLProgram(t,e,r,o,s=!1){let i=this.makeTensorInfo(t.outputShape,r),a=this.texData.get(i.dataId);if(t.packedOutput&&(a.isPacked=!0),t.outPackingScheme===Og.DENSE){let m=nd(t.outputShape);a.texShape=m.map(x=>x*2)}if(t.outTexUsage!=null&&(a.usage=t.outTexUsage),N.sizeFromShape(i.shape)===0)return a.values=N.getTypedArrayFromDType(i.dtype,0),i;let c=[],l=e.map(m=>{if(m.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let x=this.texData.get(m.dataId);if(x.texture==null){if(!t.packedInputs&&N.sizeFromShape(m.shape)<=Te().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:m.shape,texData:null,isUniform:!0,uniformValues:x.values};t.packedInputs&&(x.isPacked=!0,x.shape=m.shape)}else if(!!x.isPacked!=!!t.packedInputs)m=x.isPacked?this.unpackTensor(m):this.packTensor(m),c.push(m),x=this.texData.get(m.dataId);else if(x.isPacked&&!Rg(x.shape,m.shape)){let w=m,_=m.shape;m.shape=x.shape,m=this.packedReshape(m,_),c.push(m),x=this.texData.get(m.dataId),w.shape=_}return this.uploadToGPU(m.dataId),{shape:m.shape,texData:x,isUniform:!1}});this.uploadToGPU(i.dataId);let p={shape:i.shape,texData:a,isUniform:!1},f=Iue(t,l,p),y=this.getAndSaveBinary(f,()=>_ue(this.gpgpu,t,l,p)),d=this.activeTimers!=null,h;if(d&&(h=this.startTimer()),Tue(this.gpgpu,y,l,p,o),c.forEach(m=>this.disposeIntermediateTensorInfo(m)),d&&(h=this.endTimer(h),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(h)})),!Te().getBool("WEBGL_LAZILY_UNPACK")&&a.isPacked&&s===!1){let m=this.unpackTensor(i);return this.disposeIntermediateTensorInfo(i),m}return i}compileAndRun(t,e,r,o,s=!1){r=r||e[0].dtype;let i=this.runWebGLProgram(t,e,r,o,s);return eh().makeTensorFromDataId(i.dataId,i.shape,i.dtype)}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Te().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=de(()=>{if(!Te().get("WEBGL_RENDER_FLOAT32_ENABLED")){let t=Te().getBool("DEBUG");Te().set("DEBUG",!1);let e=this.abs(it(1e-8)).dataSync()[0];if(Te().set("DEBUG",t),e>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?J3e:eze}uploadToGPU(t){let e=this.texData.get(t),{shape:r,dtype:o,values:s,texture:i,usage:a,isPacked:c}=e;if(i!=null)return;let l=this.activeTimers!=null,p;l&&(p=N.now());let f=e.texShape;if(f==null&&(f=qce(r,c),e.texShape=f),s!=null){let y=uD(r),d,h=f[1],m=f[0],x=s instanceof Uint8Array;c?([h,m]=Al(f[0],f[1]),d=new yD(y,[m,h],x)):d=new gD(y,[m,h],x);let w=this.makeTensorInfo([m,h],o);x?this.texData.get(w.dataId).usage=Ts.PIXELS:this.texData.get(w.dataId).usage=Ts.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(w.dataId),h,m,s);let I=this.runWebGLProgram(d,[w],o,null,!0),T=this.texData.get(I.dataId);e.texture=T.texture,e.texShape=T.texShape,e.isPacked=T.isPacked,e.usage=T.usage,this.disposeIntermediateTensorInfo(w),this.texData.delete(I.dataId),e.values=null,l&&(this.uploadWaitMs+=N.now()-p)}else{let y=this.acquireTexture(f,a,o,c);e.texture=y}}convertAndCacheOnCPU(t,e){let r=this.texData.get(t),{dtype:o}=r;return this.releaseGPUData(t),e!=null&&(r.values=sze(e,o)),r.values}acquireTexture(t,e,r,o){if(this.numBytesInGPU+=this.computeBytes(t,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){let s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${s} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,e,o)}computeBytes(t,e){return t[0]*t[1]*N.bytesPerElement(e)}}});var Xz,yle=b(()=>{"use strict";Xz="2.8.6"});var xle=b(()=>{"use strict";$();});var vle=b(()=>{"use strict";$();gle();yle();xle();mf.isBrowser()&&f0("webgl",()=>new TD,2)});var ID,Yi,sd=b(()=>{"use strict";$();ID=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`,Yi=class{constructor(t,e,r){this.variableNames=["A","B"],this.outputShape=H.assertAndGetBroadcastShape(e,r),this.userCode=`
      float binaryOperation(float a, float b) {
        ${t}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}});var id,Ua,Ml=b(()=>{"use strict";$();Oc();Kr();id=`
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;
`,Ua=class{constructor(t,e,r,o=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=H.assertAndGetBroadcastShape(e,r);let s=this.outputShape.length,i="";if(o)if(s===0||N.sizeFromShape(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${Xt(s)} coords = getOutputCoords();
        `,s===1)i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{let c=Vr("coords",s);i+=`
            bool nextRowOutOfBounds =
              (${c[s-2]} + 1) >= ${this.outputShape[s-2]};
            bool nextColOutOfBounds =
              (${c[s-1]} + 1) >= ${this.outputShape[s-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${t}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}});function qr(n){let{inputs:t,backend:e}=n,{x:r}=t;return e.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var ble,Zi=b(()=>{"use strict";$();ble={kernelName:wp,backendName:"webgl",kernelFunc:qr}});function si(n){let{inputs:t,backend:e}=n,{real:r,imag:o}=t,s=e.makeTensorInfo(r.shape,"complex64"),i=e.texData.get(s.dataId),a=qr({inputs:{x:r},backend:e}),c=e.texData.get(a.dataId);c.complexParentRefCount++;let l=qr({inputs:{x:o},backend:e}),p=e.texData.get(l.dataId);return p.complexParentRefCount++,i.complexTensorInfos={real:a,imag:l},s}var wle,_h=b(()=>{"use strict";$();Zi();wle={kernelName:tm,backendName:"webgl",kernelFunc:si}});function ize(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{alpha:s}=r,i=e.makeTensorInfo([],"float32",N.createScalarValue(s,"float32")),a=Te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ua(Yz,o.shape,i.shape):new Yi(Qz,o.shape,i.shape),c=e.runWebGLProgram(a,[o,i],o.dtype);return e.disposeIntermediateTensorInfo(i),c}var Qz,Yz,Sle,Zz=b(()=>{"use strict";$();sd();Ml();Qz="return (a < 0.) ? b * a : a;",Yz=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;Sle={kernelName:Sp,backendName:"webgl",kernelFunc:ize}});function aze(n){let{inputs:t,backend:e}=n,{x:r,alpha:o}=t,s=Te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ua(eB,r.shape,o.shape):new Yi(Jz,r.shape,o.shape);return e.runWebGLProgram(s,[r,o],r.dtype)}var Jz,eB,Cle,tB=b(()=>{"use strict";$();sd();Ml();Jz="return (a < 0.) ? b * a : a;",eB=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;Cle={kernelName:Pp,backendName:"webgl",kernelFunc:aze}});function _t({opSnippet:n,packedOpSnippet:t,cpuKernelImpl:e,dtype:r}){return({inputs:o,backend:s})=>{let{x:i}=o,a=s,c=r||i.dtype;if(a.shouldExecuteOnCPU([i])&&e!=null){let f=a.texData.get(i.dataId),y=e(f.values,c);return a.makeTensorInfo(i.shape,c,y)}let l=Te().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null,p;return l?p=new qa(i.shape,t):p=new js(i.shape,n),a.runWebGLProgram(p,[i],c)}}function kn({opSnippet:n,packedOpSnippet:t,checkOutOfBounds:e=!1,supportsComplex:r=!1,cpuKernelImpl:o,dtype:s}){return({inputs:i,backend:a})=>{let{a:c,b:l}=i,p=a;if(r&&c.dtype==="complex64"){let h=p.texData.get(c.dataId),m=p.texData.get(l.dataId),[x,w]=[[h.complexTensorInfos.real,m.complexTensorInfos.real],[h.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(I=>{let[T,D]=I,O={dataId:T.dataId,dtype:T.dtype,shape:c.shape},R={dataId:D.dataId,dtype:D.dtype,shape:l.shape},P=new Yi(n,c.shape,l.shape);return p.runWebGLProgram(P,[O,R],ro(T.dtype,D.dtype))}),_=si({inputs:{real:x,imag:w},backend:p});return p.disposeIntermediateTensorInfo(x),p.disposeIntermediateTensorInfo(w),_}let f=s||ro(c.dtype,l.dtype);if(p.shouldExecuteOnCPU([c,l])&&o!=null){let h=p.texData.get(c.dataId),m=p.texData.get(l.dataId),[x,w]=o(c.shape,l.shape,h.values,m.values,f),_=p.makeTensorInfo(w,f),I=p.texData.get(_.dataId);return I.values=x,_}let y=Te().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null,d;return y?d=new Ua(t,c.shape,l.shape,e):d=new Yi(n,c.shape,l.shape),p.runWebGLProgram(d,[c,l],f)}}function ad(n,t=!1){if(n==="linear")return t?ple:ile;if(n==="relu")return t?fle:cle;if(n==="elu")return t?hle:ale;if(n==="relu6")return t?dle:ule;if(n==="prelu")return t?eB:Jz;if(n==="leakyrelu")return t?Yz:Qz;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}var ED,_le,Tle,$t=b(()=>{"use strict";$();sd();Ml();_h();Zz();tB();Is();Is();wb();wb();ED="if (isnan(x)) return x;",_le=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`,Tle=`
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;
`});var Sb,nB=b(()=>{"use strict";Sb=class{constructor(t,e,r,o=!1,s=!1,i=!1,a=null,c=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;let p=o?t[1]:t[2],f=Math.ceil(p/2),y=o?"i * 2, rc.y":"rc.y, i * 2",d=s?"rc.z, i * 2":"i * 2, rc.z",h=o?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=s?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],x="",w="";a&&(c?x=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:l?x=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:x=`vec4 activation(vec4 x) {
          ${a}
        }`,w="result = activation(result);");let _=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let I="rc.x",T="rc.x";t[0]<e[0]?I=`int(min(float(rc.x), ${t[0]-1}.))`:e[0]<t[0]&&(T=`int(min(float(rc.x), ${e[0]-1}.))`),this.userCode=`
      ${x}

      const float sharedDimension = ${f}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${f}; i++) {
          int batchA = ${I};
          int batchB = ${T};
          vec4 a = getMatrixA(batchA, ${y});
          vec4 b = getMatrixB(batchB, ${d});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${h[0]} * ${m[0]});
          result += (${h[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${_}

        ${w}

        setOutput(result);
      }
    `}}});var rB,US,oB=b(()=>{"use strict";$();rB={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},US=class{constructor(t,e,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=H.assertAndGetBroadcastShape(e,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${t}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}});function sB(n){let{inputs:t,backend:e}=n,{a:r,b:o}=t,s=H.upcastType(r.dtype,o.dtype);if(r.dtype==="complex64"){let a=e.texData.get(r.dataId),c=e.texData.get(o.dataId),l=new US(rB.REAL,r.shape,o.shape),p=new US(rB.IMAG,r.shape,o.shape),f=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:c.complexTensorInfos.real.dataId,dtype:c.complexTensorInfos.real.dtype,shape:o.shape},{dataId:c.complexTensorInfos.imag.dataId,dtype:c.complexTensorInfos.imag.dtype,shape:o.shape}],y=e.runWebGLProgram(l,f,"float32"),d=e.runWebGLProgram(p,f,"float32"),h=si({inputs:{real:y,imag:d},backend:e});return e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(d),h}if(e.shouldExecuteOnCPU([r,o])){let a=e.texData.get(r.dataId),c=e.texData.get(o.dataId),[l,p]=Uue(r.shape,o.shape,a.values,c.values,s),f=e.makeTensorInfo(p,s),y=e.texData.get(f.dataId);return y.values=l,f}let i;return Te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new Ua(Ile,r.shape,o.shape):i=new Yi(Ile,r.shape,o.shape),e.runWebGLProgram(i,[r,o],s)}var Ile,Ele,iB=b(()=>{"use strict";$();oB();oB();sd();Ml();rr();_h();Ile="return a * b;";Ele={kernelName:ku,backendName:"webgl",kernelFunc:sB}});function Nle(n,t,e){let r=[rd(n.shape),...od(n.shape)],o={dtype:n.dtype,shape:r,dataId:n.dataId},s=[rd(t),...od(t)],i=new bb(s,r),c=e.runWebGLProgram(i,[o],n.dtype,null,!0);return{dataId:c.dataId,shape:t,dtype:c.dtype}}var Dle=b(()=>{"use strict";Hz();Qi();});function ut(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{shape:s}=r,i=e,a=N.sizeFromShape(o.shape),c=N.inferFromImplicitShape(s,a),l=N.sizeFromShape(c);N.assert(a===l,()=>`The new shape (${c}) has ${l} elements and the old shape (${o.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);let p=i.texData.get(o.dataId);return p.isPacked&&!Rg(o.shape,c)&&!(p.texture!==null&&Rg(p.shape,c))?Nle(o,c,i):(i.incRef(o.dataId),{dataId:o.dataId,shape:c,dtype:o.dtype})}var kle,ir=b(()=>{"use strict";$();Dle();Qi();kle={kernelName:Fp,backendName:"webgl",kernelFunc:ut}});var jS,Ale=b(()=>{"use strict";$();jS=class{constructor(t,e){this.variableNames=["x"];let{windowSize:r,batchSize:o,inSize:s,outSize:i}=t;this.outputShape=[o,i];let a=Math.floor(r/4)*4,c=r%4,l="sumValue += dot(values, ones);";if(e!=null){let f=1/e;l=`sumValue += dot(values * ${N.isInt(f)?f.toPrecision(2):f}, ones);`}let p="";s%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${l}
        }

        int inIdx = inOffset + ${a};
        if (${c===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${l}
        } else if (${c===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${l}
        } else if (${c===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${l}
        }
        setOutput(sumValue);
      }
    `}}});var ND,Ole=b(()=>{"use strict";ND=class{constructor(t,e){this.variableNames=["x"];let{windowSize:r,batchSize:o,inSize:s,outSize:i}=t;this.outputShape=[o,i];let a="0.0",c="";e==="prod"?a="1.0":e==="min"?(a="1.0 / 1e-20",c="min"):e==="max"&&(a="-1.0 / 1e-20",c="max");let l=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="sum"?l="sumValue":e==="prod"?l="prodValue":e==="all"?l="allValue":e==="any"&&(l="anyValue");let p=Math.floor(r/4)*4,f=r%4,y=`
      if (${e==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${e==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${c}(values, minMaxValue);
      }
    `,d="vec4";e==="all"?(a="1.0",y=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,d="bvec4"):e==="any"&&(a="0.0",y=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,d="bvec4");let h="";s%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${p}; i += 4) {
          int inIdx = inOffset + i;
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${y}
        }

        int inIdx = inOffset + ${p};
        if (${f===1}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${y}
        } else if (${f===2}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${y}
        } else if (${f===3}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${y}
        }
        setOutput(${l});
      }
    `}}});function uze(n){let t=[];for(;t.length===0||t[t.length-1].outSize!==1;){let e=t.length?t[t.length-1].outSize:n[1],r=H.computeOptimalWindowSize(e);t.push({inSize:e,windowSize:r,outSize:Math.ceil(e/r)})}return t}function Ei(n,t,e,r){let o=uze(n.shape),s=n;for(let i=0;i<o.length;i++){let{inSize:a,windowSize:c,outSize:l}=o[i],p,f;e==="mean"?p=i===0?new jS({windowSize:c,inSize:a,batchSize:n.shape[0],outSize:l},a):new jS({windowSize:c,inSize:a,batchSize:n.shape[0],outSize:l}):p=new ND({windowSize:c,inSize:a,batchSize:n.shape[0],outSize:l},e),f=s,s=r.runWebGLProgram(p,[s],t),f.dataId!==n.dataId&&r.disposeIntermediateTensorInfo(f)}return s}var cd=b(()=>{"use strict";$();Ale();Ole();});function lze(n){let t=n.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);let e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let o=0;o<n.length;o++)r[n[o]]=e[o];return r.join()}var DD,Mle=b(()=>{"use strict";Kr();DD=class{constructor(t,e){this.variableNames=["A"];let r=new Array(t.length);for(let i=0;i<r.length;i++)r[i]=t[e[i]];this.outputShape=r,this.rank=r.length;let o=Xt(this.rank),s=lze(e);this.userCode=`
    void main() {
      ${o} resRC = getOutputCoords();
      setOutput(getA(${s}));
    }
    `}}});var kD,Rle=b(()=>{"use strict";Oc();Kr();kD=class{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let r=new Array(t.length);for(let p=0;p<r.length;p++)r[p]=t[e[p]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);let o=Xt(this.rank),s=Wz("rc",this.rank),i=new Array(this.rank);for(let p=0;p<e.length;p++)i[e[p]]=s[p];let a=`vec2(${i.slice(-2).join()})`,c=`++${s[this.rank-1]} < ${r[this.rank-1]}`,l=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${o} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${l};
      if(${c}) {
        result[1] = ${l};
      }
      --${s[this.rank-1]};
      if(++${s[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${l};
        if(${c}) {
          result[3] = ${l};
        }
      }
      setOutput(result);
    }
    `}}});function ud(n,t,e){let r=Te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new kD(n.shape,t):new DD(n.shape,t);return e.runWebGLProgram(r,[n],n.dtype)}var Cb=b(()=>{"use strict";$();rr();Mle();Rle();});function Ple(n,t,e,r){let o=t,s=n.shape.length,i=N.parseAxisParam(o,n.shape),a=i,c=H.getAxesPermutation(a,s),l=c!=null,p=n;l&&(p=ud(n,c,r),a=H.getInnerMostAxes(a.length,s)),H.assertAxesAreInnerMostDims("sum",a,s);let[f,y]=H.computeOutAndReduceShapes(p.shape,a),d=f;e&&(d=H.expandShapeToKeepDim(f,i));let h=N.sizeFromShape(y),x=N.sizeFromShape(n.shape)/h,w=ut({inputs:{x:p},attrs:{shape:[x,h]},backend:r}),_=df(n.dtype),I=Ei(w,_,"sum",r),T=ut({inputs:{x:I},attrs:{shape:d},backend:r});return r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(I),l&&r.disposeIntermediateTensorInfo(p),T}var Fle=b(()=>{"use strict";$();cd();ir();Cb();});function GS(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s,keepDims:i}=r;return Ple(o,s,i,e)}var $le,AD=b(()=>{"use strict";$();Fle();$le={kernelName:qp,backendName:"webgl",kernelFunc:GS}});function kr(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{perm:s}=r,i=e,a=o.shape.length,c=new Array(a);for(let p=0;p<c.length;p++)c[p]=o.shape[s[p]];let l;if(i.shouldExecuteOnCPU([o])){let f=i.texData.get(o.dataId).values,y=Fg(f,o.shape,o.dtype,s,c);l=i.makeTensorInfo(c,o.dtype);let d=i.texData.get(l.dataId);d.values=y}else l=ud(o,s,i);return l}var Lle,Ji=b(()=>{"use strict";$();Cb();Cb();Lle={kernelName:Wp,backendName:"webgl",kernelFunc:kr}});function $g({a:n,b:t,transposeA:e,transposeB:r,backend:o,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:c=null}){let l=n.shape.length,p=t.shape.length,f=e?n.shape[l-2]:n.shape[l-1],y=r?t.shape[p-1]:t.shape[p-2],d=e?n.shape[l-1]:n.shape[l-2],h=r?t.shape[p-2]:t.shape[p-1],m=n.shape.slice(0,-2),x=t.shape.slice(0,-2),w=N.sizeFromShape(m),_=N.sizeFromShape(x),I=w===_||w===1||_===1;N.assert(l>=2&&p>=2&&I,()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${m}) and (${x}).`);let D=(w>_?n.shape.slice(0,-2):t.shape.slice(0,-2)).concat([d,h]);N.assert(f===y,()=>`Error in matMul: inner shapes (${f}) and (${y}) of Tensors with shapes ${n.shape} and ${t.shape} and transposeA=${e} and transposeB=${r} must match.`);let O=e?[w,f,d]:[w,d,f],R=r?[_,h,y]:[_,y,h],P=ut({inputs:{x:n},backend:o,attrs:{shape:O}}),j=ut({inputs:{x:t},backend:o,attrs:{shape:R}}),G=[P,j],Q=Math.max(w,_),ie=e?P.shape[1]:P.shape[2],pe=s!=null,xe=i!=null,ne=c==="leakyrelu",fe=c!=null?ad(c,!0):null,te=pe||xe||ne||fe!=null,se;if((d===1||h===1)&&ie>aB&&te===!1){let we=P,be=j;e&&(we=kr({inputs:{x:P},backend:o,attrs:{perm:[0,2,1]}}),G.push(we)),r&&(be=kr({inputs:{x:j},backend:o,attrs:{perm:[0,2,1]}}),G.push(be));let ke=h!==1,De=h===1,Re=we;ke&&(Re=ut({inputs:{x:we},backend:o,attrs:{shape:[Q,ie,1]}}),G.push(Re));let Ce=h===1?2:1,Je=be;De&&(Je=ut({inputs:{x:be},backend:o,attrs:{shape:[Q,1,ie]}}),G.push(Je));let rt=sB({inputs:{a:Re,b:Je},backend:o});se=GS({inputs:{x:rt},backend:o,attrs:{axis:Ce,keepDims:!0}}),G.push(rt)}else{let we=ro(n.dtype,t.dtype),be=new Sb(O,R,[Q,d,h],e,r,pe,fe,xe,ne),ke=[P,j];if(s!=null&&ke.push(s),xe&&ke.push(i),ne){let De=o.makeTensorInfo([],"float32",N.createScalarValue(a,"float32"));ke.push(De),G.push(De)}se=o.runWebGLProgram(be,ke,we)}let ee=ut({inputs:{x:se},backend:o,attrs:{shape:D}});G.push(se);for(let we of G)o.disposeIntermediateTensorInfo(we);return ee}var aB,OD=b(()=>{"use strict";$();$t();nB();iB();ir();AD();Ji();aB=1e3});function pze(n){let{inputs:t,backend:e,attrs:r}=n,{a:o,b:s,bias:i,preluActivationWeights:a}=t,{transposeA:c,transposeB:l,activation:p,leakyreluAlpha:f}=r;return $g({a:o,b:s,transposeA:c,transposeB:l,backend:e,bias:i,preluActivationWeights:a,leakyreluAlpha:f,activation:p})}var zle,Ble=b(()=>{"use strict";$();OD();zle={kernelName:lf,backendName:"webgl",kernelFunc:pze}});function hze(n){let{inputs:t,backend:e}=n,{x:r}=t;if(e.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){let s=e.texData.get(r.dataId),i=bD(s.values);return e.makeTensorInfo(r.shape,r.dtype,i)}let o;return Te().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new qa(r.shape,Vle):o=new js(r.shape,Vle),e.runWebGLProgram(o,[r],r.dtype)}var Vle,qle,Ule=b(()=>{"use strict";$();rr();Is();wb();Vle="return abs(x);";qle={kernelName:np,backendName:"webgl",kernelFunc:hze}});var fze,dze,jle,Gle=b(()=>{"use strict";$();$t();Is();fze=Ao+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,dze=_t({opSnippet:fze}),jle={kernelName:ru,backendName:"webgl",kernelFunc:dze}});var mze,gze,Wle,Hle=b(()=>{"use strict";$();$t();Is();mze=Ao+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,gze=_t({opSnippet:mze}),Wle={kernelName:ou,backendName:"webgl",kernelFunc:gze}});var Kle,yze,Xle,Qle=b(()=>{"use strict";$();$t();rr();Kle="return a + b;",yze=kn({opSnippet:Kle,packedOpSnippet:Kle,supportsComplex:!0,cpuKernelImpl:Nue}),Xle={kernelName:ma,backendName:"webgl",kernelFunc:yze}});var MD,Yle=b(()=>{"use strict";MD=class{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((s,i)=>`T${i}`);let r=[];this.variableNames.forEach(s=>{r.push(`float v${s} = get${s}AtOutCoords();`)});let o=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${o};
        setOutput(result);
      }
    `}}});var RD,Zle=b(()=>{"use strict";RD=class{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((s,i)=>`T${i}`);let r=[];this.variableNames.forEach(s=>{r.push(`vec4 v${s} = get${s}AtOutCoords();`)});let o=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${o};
        setOutput(result);
      }
    `}}});function PD(n){let{inputs:t,backend:e}=n,r=t;if(r.length===1)return qr({inputs:{x:r[0]},backend:e});if(r.length>Te().get("WEBGL_MAX_TEXTURES_IN_SHADER")){let c=Math.floor(r.length/2),l=PD({inputs:r.slice(0,c),backend:e}),p=PD({inputs:r.slice(c),backend:e});return PD({inputs:[l,p],backend:e})}let o=r.map(c=>c.dtype).reduce((c,l)=>ro(c,l)),s=r.map(c=>c.shape),a=Te().getBool("WEBGL_PACK")?new RD(r[0].shape,s):new MD(r[0].shape,s);return e.runWebGLProgram(a,r,o)}var Jle,epe=b(()=>{"use strict";$();Yle();Zle();Zi();Jle={kernelName:rp,backendName:"webgl",kernelFunc:PD}});function xze(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s,keepDims:i}=r,a=o.shape.length,c=N.parseAxisParam(s,o.shape),l=c,p=H.getAxesPermutation(l,a),f=o;p!=null&&(f=kr({inputs:{x:o},backend:e,attrs:{perm:p}}),l=H.getInnerMostAxes(l.length,a)),H.assertAxesAreInnerMostDims("all",l,a);let[y,d]=H.computeOutAndReduceShapes(f.shape,l),h=N.sizeFromShape(d),m=ut({inputs:{x:f},backend:e,attrs:{shape:[-1,h]}}),x=Ei(m,m.dtype,"all",e),w;if(i){let _=H.expandShapeToKeepDim(y,c);w=ut({inputs:{x},backend:e,attrs:{shape:_}})}else w=ut({inputs:{x},backend:e,attrs:{shape:y}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(x),p!=null&&e.disposeIntermediateTensorInfo(f),w}var tpe,npe=b(()=>{"use strict";$();cd();ir();Ji();tpe={kernelName:Qd,backendName:"webgl",kernelFunc:xze}});function vze(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s,keepDims:i}=r,a=o.shape.length,c=N.parseAxisParam(s,o.shape),l=c,p=H.getAxesPermutation(l,a),f=o;p!=null&&(f=kr({inputs:{x:o},backend:e,attrs:{perm:p}}),l=H.getInnerMostAxes(l.length,a)),H.assertAxesAreInnerMostDims("any",l,a);let[y,d]=H.computeOutAndReduceShapes(f.shape,l),h=N.sizeFromShape(d),m=ut({inputs:{x:f},backend:e,attrs:{shape:[-1,h]}}),x=Ei(m,m.dtype,"any",e),w;if(i){let _=H.expandShapeToKeepDim(y,c);w=ut({inputs:{x},backend:e,attrs:{shape:_}})}else w=ut({inputs:{x},backend:e,attrs:{shape:y}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(x),p!=null&&e.disposeIntermediateTensorInfo(f),w}var rpe,ope=b(()=>{"use strict";$();cd();ir();Ji();rpe={kernelName:Yd,backendName:"webgl",kernelFunc:vze}});var FD,spe=b(()=>{"use strict";FD=class{constructor(t,e,r){this.variableNames=["A"];let{windowSize:o,batchSize:s,outSize:i}=t;r||this.variableNames.push("bestIndicesA"),this.outputShape=[s,i];let a=e==="max"?">":"<",c=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${o};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${o}; i++) {
          int inIdx = ${c};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}});var $D,ipe=b(()=>{"use strict";$();Oc();Kr();$D=class{constructor(t,e,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,N.assert(t.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);let s=t[t.length-1],i=Math.ceil(s/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),o||this.variableNames.push("bestIndicesA");let a=this.outputShape,c=a.length,l=Xt(c),p=Vr("coords",c),f,y;if(i===1){y=c+1;let P=Xt(y);f=`
        ${P} sourceLocR = ${P}(${p.join()}, 0);
        ++${p[c-1]};
        ${P} sourceLocG = ${P}(${p.join()}, 0);
        ++${p[c-2]};
        ${P} sourceLocA = ${P}(${p.join()}, 0);
        --${p[c-1]};
        ${P} sourceLocB = ${P}(${p.join()}, 0);
        --${p[c-2]};`}else y=c,f=`
        ${l} sourceLocR = coords;
        ++${p[c-1]};
        ${l} sourceLocG = coords;
        ++${p[c-2]};
        ${l} sourceLocA = coords;
        --${p[c-1]};
        ${l} sourceLocB = coords;
        --${p[c-2]};`;let d=["x","y","z","w","u","v"].slice(0,y),h="."+d[y-1],m=d.map(P=>"int "+P),x=Vr("sourceLocR",y-1).concat("inIdx.r"),w=Vr("sourceLocG",y-1).concat("inIdx.g"),_=Vr("sourceLocB",y-1).concat("inIdx.b"),I=Vr("sourceLocA",y-1).concat("inIdx.a"),T=r==="max"?"greaterThan":"lessThan",D=o?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${w.join()}),
                             getBestIndicesAChannel(${_.join()}),
                             getBestIndicesAChannel(${I.join()})));`,O=`vec4(
            getAChannel(${x.join()}),
            hasNextCol ? getAChannel(${w.join()}) : 0.,
            hasNextRow ? getAChannel(${_.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${I.join()}) : 0.)`,R=o?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${d.join()}),
                                          vec2(${d.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${d.join()}),
                               vec2(${d.slice(-2).join()}));
      }
      ${R}
      void main() {
        ${l} coords = getOutputCoords();
        bool hasNextCol = ${p[c-1]} < ${a[c-1]-1};
        bool hasNextRow = ${p[c-2]} < ${a[c-2]-1};
        ${f}
        ivec4 srcIdx = ivec4(sourceLocR${h}, sourceLocG${h},
          sourceLocB${h}, sourceLocA${h}) * ${e};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${O};

        for (int i = 0; i < ${e}; i++) {
          inIdx = srcIdx;
          ${D}
          vec4 candidate = ${O};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${T}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}});function ape(n,t,e,r=null){let o=t.shape[0],s=t.shape[1];r!=null&&(o=r.shape[0],s=r.shape[1]);let i=H.computeOptimalWindowSize(s),a={windowSize:i,inSize:s,batchSize:o,outSize:Math.ceil(s/i)},c=new FD(a,e,r==null),l=[t];r!=null&&l.push(r);let p=n.runWebGLProgram(c,l,"int32");if(p.shape[1]===1)return p;let f=ape(n,t,e,p);return n.disposeIntermediateTensorInfo(p),f}function cpe(n,t,e,r=null){let o=r!=null?r.shape:t.shape,s=o[o.length-1],i=H.computeOptimalWindowSize(s),a=new $D(o,i,e,r==null),c=r==null?[t]:[t,r],l=n.runWebGLProgram(a,c,"int32");if(l.shape.length===t.shape.length){let p=cpe(n,t,e,l);return n.disposeIntermediateTensorInfo(l),p}return l}function LD(n,t,e,r){let o=[e];if(H.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),o,t.shape.length),!Te().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){let s=[],[i,a]=H.computeOutAndReduceShapes(t.shape,o),c=N.sizeFromShape(a),l=ut({inputs:{x:t},backend:n,attrs:{shape:[-1,c]}});s.push(l);let p=ape(n,l,r);s.push(p);let f=ut({inputs:{x:p},backend:n,attrs:{shape:i}});return s.forEach(y=>n.disposeIntermediateTensorInfo(y)),f}return cpe(n,t,r)}var cB=b(()=>{"use strict";$();spe();ipe();ir();});function bze(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s}=r,i=N.parseAxisParam(s,o.shape),a=H.getAxesPermutation(i,o.shape.length),c=o,l=[];a!=null&&(c=kr({inputs:{x:o},backend:e,attrs:{perm:a}}),l.push(c),i=H.getInnerMostAxes(i.length,c.shape.length)),H.assertAxesAreInnerMostDims("argMax",[i[0]],c.shape.length);let p=LD(e,c,i[0],"max");return l.forEach(f=>e.disposeIntermediateTensorInfo(f)),p}var upe,lpe=b(()=>{"use strict";$();cB();Ji();upe={kernelName:op,backendName:"webgl",kernelFunc:bze}});function wze(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s}=r,i=N.parseAxisParam(s,o.shape),a=H.getAxesPermutation(i,o.shape.length),c=o,l=[];a!=null&&(c=kr({inputs:{x:o},backend:e,attrs:{perm:a}}),l.push(c),i=H.getInnerMostAxes(i.length,c.shape.length)),H.assertAxesAreInnerMostDims("argMin",[i[0]],c.shape.length);let p=LD(e,c,i[0],"min");return l.forEach(f=>e.disposeIntermediateTensorInfo(f)),p}var ppe,hpe=b(()=>{"use strict";$();cB();Ji();ppe={kernelName:sp,backendName:"webgl",kernelFunc:wze}});var Sze,Cze,fpe,dpe=b(()=>{"use strict";$();$t();Is();Sze=Ao+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Cze=_t({opSnippet:Sze}),fpe={kernelName:su,backendName:"webgl",kernelFunc:Cze}});var _ze,Tze,mpe,gpe=b(()=>{"use strict";$();$t();Is();_ze=Ao+"return log(x + sqrt(x * x + 1.0));",Tze=_t({opSnippet:_ze}),mpe={kernelName:iu,backendName:"webgl",kernelFunc:Tze}});var Ize,Eze,ype,xpe=b(()=>{"use strict";$();$t();Is();Ize=Ao+`
  return atan(x);
`,Eze=_t({opSnippet:Ize}),ype={kernelName:au,backendName:"webgl",kernelFunc:Eze}});var Nze,Dze,kze,vpe,bpe=b(()=>{"use strict";$();$t();Nze=_le+`
  return atan(a, b);
`,Dze=`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+Tle+`
  return result;
`,kze=kn({opSnippet:Nze,packedOpSnippet:Dze}),vpe={kernelName:uu,backendName:"webgl",kernelFunc:kze}});var Aze,Oze,wpe,Spe=b(()=>{"use strict";$();$t();Is();Aze=Ao+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Oze=_t({opSnippet:Aze}),wpe={kernelName:cu,backendName:"webgl",kernelFunc:Oze}});var Mc,ld,pd=b(()=>{"use strict";Mc=class{constructor(t,e,r,o=!1,s=!1){if(this.variableNames=["x"],e==="avg"&&r)throw new Error("Cannot compute positions for average pool.");let i=t.filterWidth,a=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,p=t.dilationWidth,f=t.effectiveFilterHeight,y=t.effectiveFilterWidth,d=t.padInfo.top,h=t.padInfo.left;this.outputShape=t.outShape;let m=e==="avg",x=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,w=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`,_="0.0";if(m||(_="-1.0 / 1e-20"),r){let P=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${c});
        const ivec2 pads = ivec2(${d}, ${h});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${f};
              wR += ${l}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${y};
                wC += ${p}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${P} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${o?s?x:w:`wR * ${y} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let I="max",T=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="avg"&&(T="avgValue / count");let D=Math.floor(i/4)*4,O=i%4,R=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${I}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${c});
      const ivec2 pads = ivec2(${d}, ${h});
      const float initializationValue = ${_};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${_});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${f};
            wR += ${l}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${D}; wC += 4) {
            int xC = xCCorner + wC * ${p};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${p}, d),
              getValue(batch, xR, xC + 2 * ${p}, d),
              getValue(batch, xR, xC + 3 * ${p}, d)
            );

            ${R}
          }

          int xC = xCCorner + ${D};
          if (${O===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${R}
          } else if (${O===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${p}, d),
              initializationValue,
              initializationValue
            );

            ${R}
          } else if (${O===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${p}, d),
              getValue(batch, xR, xC + 2 * ${p}, d),
              initializationValue
            );

            ${R}
          }
        }
        setOutput(${T});
      }
    `}},ld=class{constructor(t,e,r,o=!1,s=!1){if(this.variableNames=["x"],e==="avg"&&r)throw new Error("Cannot compute positions for average pool.");let i=t.filterWidth,a=t.strideDepth,c=t.strideHeight,l=t.strideWidth,p=t.dilationDepth,f=t.dilationHeight,y=t.dilationWidth,d=t.effectiveFilterDepth,h=t.effectiveFilterHeight,m=t.effectiveFilterWidth,x=t.padInfo.front,w=t.padInfo.top,_=t.padInfo.left;this.outputShape=t.outShape;let I=e==="avg",T="0.0";if(I||(T="-1.0 / 1e-20"),r){let G=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${c}, ${l});
        const ivec3 pads = ivec3(${x}, ${w}, ${_});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${d};
              wD += ${p}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${t.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${h};
                wR += ${f}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${y}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${G} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${o?s?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${h} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let D="max",O=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="avg"&&(O="avgValue / count");let R=Math.floor(i/4)*4,P=i%4,j=`
      if (${I}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${D}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${c}, ${l});
      const ivec3 pads = ivec3(${x}, ${w}, ${_});
      const float initializationValue = ${T};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${T});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${p}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h};
            wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${R}; wC += 4) {
              int xC = xCCorner + wC * ${y};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${y}, ch),
                getValue(batch, xD, xR, xC + 2 * ${y}, ch),
                getValue(batch, xD, xR, xC + 3 * ${y}, ch)
              );

              ${j}
            }

            int xC = xCCorner + ${R};
            if (${P===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${j}
            } else if (${P===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${y}, ch),
                initializationValue,
                initializationValue
              );

              ${j}
            } else if (${P===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${y}, ch),
                getValue(batch, xD, xR, xC + 2 * ${y}, ch),
                initializationValue
              );

              ${j}
            }
          }
          setOutput(${O});
        }
      }
    `}}});function Mze(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t;Ol(o,"avgPool");let{filterSize:s,strides:i,pad:a,dimRoundingMode:c}=r,l=1;N.assert(H.eitherStridesOrDilationsAreOne(i,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${l}'`);let p=H.computePool2DInfo(o.shape,s,i,l,a,c);if(p.filterWidth===1&&p.filterHeight===1&&N.arraysEqual(p.inShape,p.outShape))return qr({inputs:{x:o},backend:e});let f=new Mc(p,"avg",!1);return e.runWebGLProgram(f,[o],"float32")}var Cpe,_pe=b(()=>{"use strict";$();pd();Qi();Zi();Cpe={kernelName:ip,backendName:"webgl",kernelFunc:Mze}});function Rze(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{filterSize:s,strides:i,pad:a,dimRoundingMode:c,dataFormat:l}=r,p=[1,1,1],f=H.computePool3DInfo(o.shape,s,i,p,a,c,l),y=new ld(f,"avg",!1);return e.runWebGLProgram(y,[o],"float32")}var Tpe,Ipe=b(()=>{"use strict";$();pd();Tpe={kernelName:ap,backendName:"webgl",kernelFunc:Rze}});var zD,BD,uB=b(()=>{"use strict";zD=class{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;let e=t.filterHeight,r=t.filterWidth,o=t.strideHeight,s=t.strideWidth,i=t.dilationHeight,a=t.dilationWidth,c=t.effectiveFilterHeight,l=t.effectiveFilterWidth,p=c-1-t.padInfo.top,f=l-1-t.padInfo.left,y=1/(e*r);this.userCode=`
      const ivec2 pads = ivec2(${p}, ${f});
      const float avgMultiplier = float(${y});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${c};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${l};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}},BD=class{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;let e=t.filterDepth,r=t.filterHeight,o=t.filterWidth,s=t.strideDepth,i=t.strideHeight,a=t.strideWidth,c=t.dilationDepth,l=t.dilationHeight,p=t.dilationWidth,f=t.effectiveFilterDepth,y=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=f-1-t.padInfo.front,m=y-1-t.padInfo.top,x=d-1-t.padInfo.left,w=1/(e*r*o);this.userCode=`
      const ivec3 pads = ivec3(${h}, ${m}, ${x});
      const float avgMultiplier = float(${w});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${c}) {
          float dyD = float(dyDCorner + wD) / ${s}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${y};
              wR += ${l}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${d};
                wC += ${p}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}});function Pze(n){let{inputs:t,backend:e,attrs:r}=n,{dy:o,input:s}=t,i=s,{filterSize:a,strides:c,pad:l,dimRoundingMode:p}=r,f=[1,1,1],y=H.computePool3DInfo(i.shape,a,c,f,l,p),d=new BD(y);return e.runWebGLProgram(d,[o],i.dtype)}var Epe,Npe=b(()=>{"use strict";$();uB();Epe={kernelName:Jd,backendName:"webgl",kernelFunc:Pze}});function Fze(n){let{inputs:t,backend:e,attrs:r}=n,{dy:o,input:s}=t,i=s;Ol([o,s],"avgPoolGrad");let{filterSize:a,strides:c,pad:l}=r,p=H.computePool2DInfo(i.shape,a,c,1,l),f=new zD(p);return e.runWebGLProgram(f,[o],i.dtype)}var Dpe,kpe=b(()=>{"use strict";$();uB();Qi();Dpe={kernelName:Zd,backendName:"webgl",kernelFunc:Fze}});function $ze(n){let{inputs:t,backend:e,attrs:r}=n,{a:o,b:s}=t,{transposeA:i,transposeB:a}=r;return $g({a:o,b:s,transposeA:i,transposeB:a,backend:e})}var Ape,Ope=b(()=>{"use strict";$();OD();Ape={kernelName:cp,backendName:"webgl",kernelFunc:$ze}});var VD,Mpe=b(()=>{"use strict";$();VD=class{constructor(t,e,r,o,s,i){this.outputShape=[],this.variableNames=["x","mean","variance"],H.assertAndGetBroadcastShape(t,e),H.assertAndGetBroadcastShape(t,r);let a="0.0";o!=null&&(H.assertAndGetBroadcastShape(t,o),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let c="1.0";s!=null&&(H.assertAndGetBroadcastShape(t,s),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${c};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}});var qD,Rpe=b(()=>{"use strict";$();qD=class{constructor(t,e,r,o,s,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],H.assertAndGetBroadcastShape(t,e),H.assertAndGetBroadcastShape(t,r);let a="vec4(0.0)";o!=null&&(H.assertAndGetBroadcastShape(t,o),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let c="vec4(1.0)";s!=null&&(H.assertAndGetBroadcastShape(t,s),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${c};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}});var Lze,Ppe,Fpe=b(()=>{"use strict";$();Mpe();Rpe();Lze=({inputs:n,backend:t,attrs:e})=>{let{x:r,mean:o,variance:s,offset:i,scale:a}=n;N.assert(o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),N.assert(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),N.assert(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:c}=e;c==null&&(c=.001);let l=[r,o,s],p=null;i!=null&&(p=i.shape,l.push(i));let f=null;a!=null&&(f=a.shape,l.push(a));let y=Te().getBool("WEBGL_PACK_NORMALIZATION")?new qD(r.shape,o.shape,s.shape,p,f,c):new VD(r.shape,o.shape,s.shape,p,f,c);return t.runWebGLProgram(y,l,l[0].dtype)},Ppe={kernelName:vp,backendName:"webgl",kernelFunc:Lze}});function zze(n){if(n===1)return"sourceLoc";if(n<=6)return lB.slice(0,n).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}var UD,lB,$pe=b(()=>{"use strict";Kr();UD=class{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;let e=Xt(this.rank),r=`uniform int start[${this.rank}];`,o=zze(this.rank),s,i=t.map((a,c)=>`sourceLoc.${lB[c]} = start[${c}] + coords.${lB[c]};`);s=`
        ${e} sourceLoc;
        ${e} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      ${r}
      void main() {
        ${s}
        setOutput(getSource(${o}));
      }
    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the length of start (${t.length})`);return(e,r)=>{this.startLoc==null&&(this.startLoc=e.getUniformLocationNoThrow(r,"start"),this.startLoc==null)||e.gl.uniform1iv(this.startLoc,t)}}},lB=["x","y","z","w","u","v"]});var jD,Lpe=b(()=>{"use strict";Oc();Kr();jD=class{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;let e=Xt(this.rank),r=Vr("coords",this.rank),o=Vr("sourceLoc",this.rank),s=this.rank===1?"sourceLoc":`vec2(${o.slice(-2).join()})`,i=`getChannel(getSource(${o.join()}), ${s})`,a=`
      result.x = ${i};
      if (++${r[this.rank-1]} < ${t[this.rank-1]}) {
        ++${o[this.rank-1]};
        result.y = ${i};
        --${o[this.rank-1]};
      }
    `,c=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${t[this.rank-2]}) {
        ++${o[this.rank-2]};
        result.z = ${i};
        if (++${r[this.rank-1]} < ${t[this.rank-1]}) {
          ++${o[this.rank-1]};
          result.w = ${i};
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            ${e}(${t.map((p,f)=>`start[${f}]`).join()});`:t.map((p,f)=>`${o[f]} = ${r[f]} + start[${f}];`).join(`
`);this.userCode=`
      uniform int start[${this.rank}];
      void main() {
        ${e} coords = getOutputCoords();
        ${e} sourceLoc;
        ${l}
        vec4 result = vec4(0.);
        ${a}
        ${c}
        setOutput(result);
      }
    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the length of start (${t.length})`);return(e,r)=>{this.startLoc==null&&(this.startLoc=e.getUniformLocationNoThrow(r,"start"),this.startLoc==null)||e.gl.uniform1iv(this.startLoc,t)}}}});function Bze(n,t,e,r){let o=r.texData.get(n.dataId),s=r.makeTensorInfo(e,n.dtype),i=r.texData.get(s.dataId);Object.assign(i,o),i.complexParentRefCount=0,i.refCount=1,i.shape=e,i.dtype=n.dtype;let a=Fo.computeFlatOffset(t,N.computeStrides(n.shape));o.slice&&(a+=o.slice.flatOffset),i.slice={flatOffset:a,origDataId:o.slice&&o.slice.origDataId||n.dataId};let c=r.dataRefCount.get(i.slice.origDataId)||1;return r.dataRefCount.set(i.slice.origDataId,c+1),s}function Th(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{begin:s,size:i}=r,[a,c]=Fo.parseSliceParams(o,s,i);if(Fo.assertParamsValid(o,a,c),N.sizeFromShape(c)===0)return e.makeTensorInfo(c,o.dtype,[]);if(e.shouldExecuteOnCPU([o])||o.dtype==="string"){let f=e.texData.get(o.dataId),y=Kue(f.values,a,c,o.shape,o.dtype);return e.makeTensorInfo(c,o.dtype,y)}let{isPacked:l}=e.texData.get(o.dataId),p=Fo.isSliceContinous(o.shape,a,c);if(l||!p){let f=Te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new jD(c):new UD(c),y=f.getCustomSetupFunc(a);return e.runWebGLProgram(f,[o],o.dtype,y)}return e.uploadToGPU(o.dataId),Bze(o,a,c,e)}var zpe,_b=b(()=>{"use strict";$();rr();$pe();Lpe();zpe={kernelName:Vp,backendName:"webgl",kernelFunc:Th}});var Vze,Bpe,Vpe=b(()=>{"use strict";$();ir();_b();Ji();Vze=n=>{let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{blockShape:s,crops:i}=r;N.assert(o.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let a=s.reduce((_,I)=>_*I),c=H.getReshaped(o.shape,s,a),l=H.getPermuted(c.length,s.length),p=H.getReshapedPermuted(o.shape,s,a),f=H.getSliceBeginCoords(i,s.length),y=H.getSliceSize(p,i,s.length),d=[],h=ut({inputs:{x:o},backend:e,attrs:{shape:c}}),m=kr({inputs:{x:h},backend:e,attrs:{perm:l}}),x=ut({inputs:{x:m},backend:e,attrs:{shape:p}}),w=Th({inputs:{x},backend:e,attrs:{begin:f,size:y}});return d.push(h),d.push(m),d.push(x),d.forEach(_=>e.disposeIntermediateTensorInfo(_)),w},Bpe={kernelName:up,backendName:"webgl",kernelFunc:Vze}});function qze(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,weights:s}=t,{size:i}=r,a=e.readSync(o.dataId),c=e.readSync(s.dataId),l=vD(a,c,s.dtype,s.shape,i);return e.makeTensorInfo([i],s.dtype,l)}var qpe,Upe=b(()=>{"use strict";$();rr();qpe={kernelName:em,backendName:"webgl",kernelFunc:qze}});var Uze,pB,jpe,hB=b(()=>{"use strict";$();$t();Uze="return float(a != b);",pB=kn({opSnippet:Uze,dtype:"bool"}),jpe={kernelName:uf,backendName:"webgl",kernelFunc:pB}});function Ih(n){let{inputs:t,backend:e}=n,{input:r}=t,o=e.texData.get(r.dataId);return qr({inputs:{x:o.complexTensorInfos.real},backend:e})}var Gpe,Tb=b(()=>{"use strict";$();Zi();Gpe={kernelName:Dm,backendName:"webgl",kernelFunc:Ih}});function Wpe(n,t){let e=new js(n.shape,jze),r=t.runWebGLProgram(e,[n],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var jze,Hpe=b(()=>{"use strict";Is();jze="return float(int(x));"});function fB(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{dtype:s}=r;if(s==="complex64"){if(o.dtype==="complex64")return qr({inputs:{x:o},backend:e});let i=An(o.shape),a=fB({inputs:{x:o},backend:e,attrs:{dtype:"float32"}}),c=si({inputs:{real:a,imag:i},backend:e});return i.dispose(),e.disposeIntermediateTensorInfo(a),c}if(o.dtype==="complex64"){let i=Ih({inputs:{input:o},backend:e}),a=fB({inputs:{x:i},backend:e,attrs:{dtype:s}});return e.disposeIntermediateTensorInfo(i),a}if(!N.hasEncodingLoss(o.dtype,s)){let i=qr({inputs:{x:o},backend:e});return{dataId:i.dataId,shape:i.shape,dtype:s}}if(s==="int32")return Wpe(o,e);if(s==="bool"){let i=e.makeTensorInfo([],"bool",N.getTypedArrayFromDType("bool",1)),c=pB({inputs:{a:o,b:i},backend:e});return e.disposeIntermediateTensorInfo(i),c}throw new Error(`Error in Cast: failed to cast ${o.dtype} to ${s}`)}var Kpe,Xpe=b(()=>{"use strict";$();$();_h();Zi();hB();Tb();Hpe();Kpe={kernelName:lc,backendName:"webgl",kernelFunc:fB}});var Qpe,Gze,Ype,Zpe=b(()=>{"use strict";$();$t();rr();Qpe="return ceil(x);",Gze=_t({opSnippet:Qpe,packedOpSnippet:Qpe,cpuKernelImpl:kue}),Ype={kernelName:lu,backendName:"webgl",kernelFunc:Gze}});var GD,Jpe=b(()=>{"use strict";GD=class{constructor(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}getCustomSetupFunc(t,e){return(r,o)=>{this.minLoc==null&&(this.minLoc=r.getUniformLocationNoThrow(o,"minVal"),this.maxLoc=r.getUniformLocationNoThrow(o,"maxVal")),r.gl.uniform1f(this.minLoc,t),r.gl.uniform1f(this.maxLoc,e)}}}});var WD,ehe=b(()=>{"use strict";WD=class{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}getCustomSetupFunc(t,e){return(r,o)=>{this.minLoc==null&&(this.minLoc=r.getUniformLocationNoThrow(o,"minVal"),this.maxLoc=r.getUniformLocationNoThrow(o,"maxVal")),r.gl.uniform1f(this.minLoc,t),r.gl.uniform1f(this.maxLoc,e)}}}});function Wze(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{clipValueMin:s,clipValueMax:i}=r,a;Te().getBool("WEBGL_PACK_CLIP")?a=new WD(o.shape):a=new GD(o.shape);let c=a.getCustomSetupFunc(s,i);return e.runWebGLProgram(a,[o],o.dtype,c)}var the,nhe=b(()=>{"use strict";$();Jpe();ehe();the={kernelName:pu,backendName:"webgl",kernelFunc:Wze}});var HD,rhe=b(()=>{"use strict";HD=class{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}});function ohe(n,t){return{dataId:t.dataId,dtype:t.dtype,shape:n.shape}}function Hze(n){let{inputs:t,backend:e}=n,{x:r}=t,o=e.texData.get(r.dataId),s=new HD(r.shape),i=[ohe(r,o.complexTensorInfos.real),ohe(r,o.complexTensorInfos.imag)];return e.runWebGLProgram(s,i,i[0].dtype)}var she,ihe=b(()=>{"use strict";$();rhe();she={kernelName:lp,backendName:"webgl",kernelFunc:Hze}});var KD,ahe=b(()=>{"use strict";$();KD=class{constructor(t){this.outputShape=[],this.outputShape=H.computeOutShape(t,1),this.variableNames=t.map((i,a)=>`T${a}`);let e=new Array(t.length-1);e[0]=t[0][1];for(let i=1;i<e.length;i++)e[i]=e[i-1]+t[i][1];let r=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<e.length;i++){let a=e[i-1];r.push(`else if (yC < ${e[i]}) setOutput(getT${i}(yR, yC-${a}));`)}let o=e.length,s=e[e.length-1];r.push(`else setOutput(getT${o}(yR, yC-${s}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}});function XD(n,t,e){let r=n.indexOf(t);return n.map((s,i)=>i===r?`${s} - ${e}`:s).join()}var QD,che=b(()=>{"use strict";$();Oc();Kr();QD=class{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=H.computeOutShape(t,e);let r=this.outputShape,o=r.length,s=Xt(o),i=Vr("coords",o),a=["x","y","z","w","u","v"].slice(0,o);this.variableNames=t.map((m,x)=>`T${x}`);let c=new Array(t.length-1);c[0]=t[0][e];for(let m=1;m<c.length;m++)c[m]=c[m-1]+t[m][e];let l=a[e],p=a.slice(-2),f=a.join(),y=`if (${l} < ${c[0]}) {
        return getChannel(
            getT0(${f}), vec2(${p.join()}));
        }`;for(let m=1;m<c.length;m++){let x=c[m-1];y+=`
        if (${l} < ${c[m]}  && ${l} >= ${c[m-1]}) {
          return getChannel(
            getT${m}(${XD(a,l,x)}),
            vec2(${XD(p,l,x)}));
        }`}let d=c.length,h=c[c.length-1];y+=`
        return getChannel(
          getT${d}(${XD(a,l,h)}),
          vec2(${XD(p,l,h)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${y}
      }

      void main() {
        ${s} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[o-1]} = ${i[o-1]} + 1;
        if (${i[o-1]} < ${r[o-1]}) {
          result.g = getValue(${i});
        }

        ${i[o-2]} = ${i[o-2]} + 1;
        if (${i[o-2]} < ${r[o-2]}) {
          result.a = getValue(${i});
        }

        ${i[o-1]} = ${i[o-1]} - 1;
        if (${i[o-2]} < ${r[o-2]} &&
            ${i[o-1]} < ${r[o-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}});function Lg(n){let{inputs:t,backend:e}=n,{input:r}=t,o=e.texData.get(r.dataId);return qr({inputs:{x:o.complexTensorInfos.imag},backend:e})}var uhe,WS=b(()=>{"use strict";$();Zi();uhe={kernelName:ym,backendName:"webgl",kernelFunc:Lg}});function zg(n,t,e){let r=n[0].dtype;if(r==="complex64"){let l=n.map(h=>Ih({inputs:{input:h},backend:e})),p=n.map(h=>Lg({inputs:{input:h},backend:e})),f=zg(l,t,e),y=zg(p,t,e),d=si({inputs:{real:f,imag:y},backend:e});return l.forEach(h=>e.disposeIntermediateTensorInfo(h)),p.forEach(h=>e.disposeIntermediateTensorInfo(h)),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(y),d}if(r==="string"){let{tensors2D:l,outShape:p}=lhe(n,t,e),f=l.map(x=>({vals:e.readSync(x.dataId),shape:x.shape})),y=l[0].shape[0]===1,d=Aue(f,p,r,y),h=H.computeOutShape(n.map(x=>x.shape),t),m=e.makeTensorInfo(h,r,d);return l.forEach(x=>e.disposeIntermediateTensorInfo(x)),m}if(n.length>Te().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){let l=Math.floor(n.length/2),p=zg(n.slice(0,l),t,e),f=zg(n.slice(l),t,e),y=zg([p,f],t,e);return e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(f),y}if(Te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].shape.length>1){let l=new QD(n.map(p=>p.shape),t);return e.runWebGLProgram(l,n,r)}let{tensors2D:o,outShape:s}=lhe(n,t,e),i=new KD(o.map(l=>l.shape)),a=e.runWebGLProgram(i,o,r);o.forEach(l=>e.disposeIntermediateTensorInfo(l));let c=ut({inputs:{x:a},attrs:{shape:s},backend:e});return e.disposeIntermediateTensorInfo(a),c}function lhe(n,t,e){let r=H.computeOutShape(n.map(s=>s.shape),t);return{tensors2D:n.map(s=>ut({inputs:{x:s},attrs:{shape:[-1,N.sizeFromShape(s.shape.slice(t))]},backend:e})),outShape:r}}var phe=b(()=>{"use strict";$();ahe();che();rr();_h();WS();Tb();ir();});function dB(n){let{inputs:t,backend:e,attrs:r}=n,{axis:o}=r,s=N.parseAxisParam(o,t[0].shape)[0],i=H.computeOutShape(t.map(l=>l.shape),s);if(N.sizeFromShape(i)===0)return e.makeTensorInfo(i,t[0].dtype,[]);let a=t.filter(l=>N.sizeFromShape(l.shape)>0);if(a.length===1)return qr({inputs:{x:a[0]},backend:e});let c=a.map(l=>l.shape);return H.assertParamsConsistent(c,s),zg(a,s,e)}var hhe,mB=b(()=>{"use strict";$();phe();Zi();hhe={kernelName:pp,backendName:"webgl",kernelFunc:dB}});var Ib,YD,ZD=b(()=>{"use strict";Ib=class{constructor(t,e=!1,r=null,o=!1,s=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;let i=t.padInfo.top,a=t.padInfo.left,c=t.strideHeight,l=t.strideWidth,p=t.dilationHeight,f=t.dilationWidth,y=t.filterHeight,d=t.filterWidth,h=Math.floor(t.inChannels/4)*4,m=t.inChannels%4,x=t.dataFormat==="channelsLast",w=x?1:2,_=x?2:3,I=x?3:1,T="",D="";r&&(o?T=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?T=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:T=`
          float activation(float x) {
            ${r}
          }
        `,D="result = activation(result);");let O=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${T}

      const ivec2 strides = ivec2(${c}, ${l});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${I}];

        ivec2 xRCCorner =
            ivec2(coords[${w}], coords[${_}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${y}; wR++) {
          int xR = xRCorner + wR * ${p};

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${d}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${t.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${h}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${x}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${x}) {
                dotProd +=
                    getX(batch, xR, xC, ${h}) *
                    getW(wR, wC, ${h}, d2);
              } else {
                dotProd +=
                    getX(batch, ${h}, xR, xC) *
                    getW(wR, wC, ${h}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${h}, d2),
                getW(wR, wC, ${h} + 1, d2)
              );

              if (${x}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${h}),
                  getX(batch, xR, xC, ${h} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${h}, xR, xC),
                  getX(batch, ${h} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${h}, d2),
                getW(wR, wC, ${h} + 1, d2),
                getW(wR, wC, ${h} + 2, d2)
              );

              if (${x}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${h}),
                  getX(batch, xR, xC, ${h} + 1),
                  getX(batch, xR, xC, ${h} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${h}, xR, xC),
                  getX(batch, ${h} + 1, xR, xC),
                  getX(batch, ${h} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${O}
        ${D}
        setOutput(result);
      }
    `}},YD=class{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;let e=t.padInfo.front,r=t.padInfo.top,o=t.padInfo.left,s=t.strideDepth,i=t.strideHeight,a=t.strideWidth,c=t.dilationDepth,l=t.dilationHeight,p=t.dilationWidth,f=t.filterDepth,y=t.filterHeight,d=t.filterWidth,h=Math.floor(t.inChannels/4)*4,m=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${s}, ${i}, ${a});
      const ivec3 pads = ivec3(${e}, ${r}, ${o});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${f}; wF++) {
          int xF = xFCorner + wF * ${c};

          if (xF < 0 || xF >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${y}; wR++) {
            int xR = xRCorner + wR * ${l};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d}; wC++) {
              int xC = xCCorner + wC * ${p};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${h}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${h}) *
                  getW(wF, wR, wC, ${h}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${h}),
                  getX(batch, xF, xR, xC, ${h} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${h}, d2),
                  getW(wF, wR, wC, ${h} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${h}),
                  getX(batch, xF, xR, xC, ${h} + 1),
                  getX(batch, xF, xR, xC, ${h} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${h}, d2),
                  getW(wF, wR, wC, ${h} + 1, d2),
                  getW(wF, wR, wC, ${h} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}});var JD,fhe=b(()=>{"use strict";Va();JD=class{constructor(t,e,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;let{filterWidth:o,inChannels:s,strideWidth:i,strideHeight:a,padInfo:c,outWidth:l,dilationWidth:p,dilationHeight:f,dataFormat:y}=r,{left:d,top:h}=c,m=s*o,x=_r(),w=y==="channelsLast",_=w?0:1,I=w?1:2,T="";for(let D=0;D<=1;D++)for(let O=0;O<=1;O++)T+=`
          blockIndex = rc.y + ${O};
          pos = rc.x + ${D};

          if(blockIndex < ${t[1]} && pos < ${t[0]}) {
            offsetY = int(blockIndex / (${l})) * ${a} - ${h};
            d0 = offsetY + ${f} * (pos / ${m});

            if(d0 < ${e[_]} && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), ${l}.) * ${i}. - ${d}.);
              d1 = offsetX + ${p} * (int(mod(float(pos), ${m}.) / ${s}.));

              if(d1 < ${e[I]} && d1 >= 0) {

                ch = int(mod(float(pos), ${s}.));

                if (${w}) {
                  innerDims = vec2(d1, ch);
                  result[${D*2+O}] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${D*2+O}] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${T}

        ${x.output} = result;
      }
    `}}});function ek({x:n,filter:t,convInfo:e,backend:r,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:i=0,activation:a=null}){let c=n.shape,l=r.texData.get(n.dataId),p=e.inChannels,f=c[0]*c[1]*c[2],y=e.outChannels,d=e.dataFormat==="channelsLast",h=!1,m=!1,x,w=[],_=(f===1||y===1)&&p>aB,I=c[2]%2!==0&&!!l.isPacked;if(_||!Te().getBool("WEBGL_LAZILY_UNPACK")||!Te().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!I){let T=d?c[0]*c[1]*c[2]:c[0]*c[2]*c[3],D=ut({inputs:{x:n},backend:r,attrs:{shape:[1,T,e.inChannels]}}),O=ut({inputs:{x:t},backend:r,attrs:{shape:[1,e.inChannels,e.outChannels]}}),R=$g({a:D,b:O,transposeA:h,transposeB:m,backend:r,bias:o,activation:a,preluActivationWeights:s,leakyreluAlpha:i});x=ut({inputs:{x:R},backend:r,attrs:{shape:e.outShape}}),w.push(D),w.push(O),w.push(R)}else{let T=d?c[0]*c[1]*(c[2]+1):c[0]*c[2]*(c[3]+1),D={dataId:n.dataId,shape:[1,T,e.inChannels],dtype:n.dtype},O=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,N.assert(Rg(l.shape,D.shape),()=>`packed reshape ${l.shape} to ${D.shape} isn't free`);let R=ut({inputs:{x:t},backend:r,attrs:{shape:[1,e.inChannels,e.outChannels]}});w.push(R);let P=$g({a:D,b:R,backend:r,transposeA:h,transposeB:m,bias:o,activation:a,preluActivationWeights:s,leakyreluAlpha:i}),j=r.texData.get(P.dataId);N.assert(j.isPacked,()=>"batchMatMul result is expected to be packed"),l.shape=O,j.shape=e.outShape,x=qr({inputs:{x:P},backend:r}),x.shape=e.outShape,w.push(P)}for(let T of w)r.disposeIntermediateTensorInfo(T);return x}function tk({x:n,filter:t,convInfo:e,backend:r,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:i=0,activation:a=null}){let{filterWidth:c,filterHeight:l,inChannels:p,outWidth:f,outHeight:y,dataFormat:d}=e,h=d==="channelsLast",m=c*l*p,x=y*f,w=[m,x],_=!0,I=!1,T=[],D=ut({inputs:{x:n},backend:r,attrs:{shape:n.shape.slice(1)}}),O=ut({inputs:{x:t},backend:r,attrs:{shape:[1,m,N.sizeFromShape(t.shape)/m]}});T.push(D),T.push(O);let R=new JD(w,D.shape,e),P=r.runWebGLProgram(R,[D],"float32"),j=ut({inputs:{x:P},backend:r,attrs:{shape:[1,w[0],w[1]]}});T.push(P),T.push(j);let G=o!=null,Q=s!=null,ie=a==="leakyrelu",pe=a?ad(a,!0):null,xe=new Sb(j.shape,O.shape,[1,x,e.outChannels],_,I,G,pe,Q,ie),ne=[j,O];if(o&&ne.push(o),Q&&ne.push(s),ie){let ee=r.makeTensorInfo([],"float32",N.createScalarValue(i,"float32"));ne.push(ee),T.push(ee)}let fe=r.runWebGLProgram(xe,ne,"float32"),te=h?[1,y,f,e.outChannels]:[1,e.outChannels,y,f],se=ut({inputs:{x:fe},backend:r,attrs:{shape:te}});T.push(fe);for(let ee of T)r.disposeIntermediateTensorInfo(ee);return se}var gB=b(()=>{"use strict";$();fhe();$t();nB();Qi();OD();Zi();ir();});function Kze(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,filter:s}=t,{strides:i,pad:a,dataFormat:c,dilations:l,dimRoundingMode:p}=r,f=H.convertConv2DDataFormat(c),y=H.computeConv2DInfo(o.shape,s.shape,i,l,a,p,!1,f),d;if(y.filterHeight===1&&y.filterWidth===1&&y.dilationHeight===1&&y.dilationWidth===1&&y.strideHeight===1&&y.strideWidth===1&&(y.padInfo.type==="SAME"||y.padInfo.type==="VALID"))d=ek({x:o,filter:s,convInfo:y,backend:e});else if(Te().getBool("WEBGL_CONV_IM2COL")&&o.shape[0]===1)d=tk({x:o,filter:s,convInfo:y,backend:e});else{let m=new Ib(y);d=e.runWebGLProgram(m,[o,s],"float32")}let h=ut({inputs:{x:d},backend:e,attrs:{shape:y.outShape}});return e.disposeIntermediateTensorInfo(d),h}var dhe,mhe=b(()=>{"use strict";$();ZD();gB();ir();dhe={kernelName:hp,backendName:"webgl",kernelFunc:Kze}});var nk,rk,ok,sk,HS=b(()=>{"use strict";nk=class{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;let e=t.strideHeight,r=t.strideWidth,o=t.padInfo.top,s=t.padInfo.left,i=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${e} - ${o};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              if (${i}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}},rk=class{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;let e=t.filterHeight,r=t.filterWidth,o=t.strideHeight,s=t.strideWidth,i=t.dataFormat==="channelsLast",a=e-1-t.padInfo.top,c=r-1-t.padInfo.left,l=i?1:2,p=i?2:3,f=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${f}];

        ivec2 dyCorner = ivec2(coords[${l}], coords[${p}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}},ok=class{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;let e=t.strideDepth,r=t.strideHeight,o=t.strideWidth,s=t.padInfo.front,i=t.padInfo.top,a=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yF = 0; yF < ${t.outDepth}; yF++) {
            int xF = wF + yF * ${e} - ${s};

            if (xF < 0 || xF >= ${t.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${t.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${i};

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${t.outWidth}; yC++) {
                int xC = wC + yC * ${o} - ${a};

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},sk=class{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;let e=t.filterDepth,r=t.filterHeight,o=t.filterWidth,s=t.strideDepth,i=t.strideHeight,a=t.strideWidth,c=e-1-t.padInfo.front,l=r-1-t.padInfo.top,p=o-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${c}, ${l}, ${p});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${e}; wF++) {
          float dyF = float(dyFCorner + wF) / ${s}.0;

          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${e} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${o}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${o} - 1 - wC;

              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}});function Xze(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,dy:s}=t,{strides:i,pad:a,dataFormat:c,dimRoundingMode:l,filterShape:p}=r,f=H.convertConv2DDataFormat(c),y=H.computeConv2DInfo(o.shape,p,i,1,a,l,!1,f),d=new nk(y);return e.runWebGLProgram(d,[o,s],"float32")}var ghe,yhe=b(()=>{"use strict";$();HS();ghe={kernelName:nm,backendName:"webgl",kernelFunc:Xze}});function Qze(n){let{inputs:t,backend:e,attrs:r}=n,{dy:o,filter:s}=t,{inputShape:i,strides:a,pad:c,dataFormat:l,dimRoundingMode:p}=r,f=H.convertConv2DDataFormat(l),y=H.computeConv2DInfo(i,s.shape,a,1,c,p,!1,f),d=new rk(y);return e.runWebGLProgram(d,[o,s],"float32")}var xhe,vhe=b(()=>{"use strict";$();HS();xhe={kernelName:fp,backendName:"webgl",kernelFunc:Qze}});function Yze(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,filter:s}=t,{strides:i,pad:a,dilations:c}=r,l=H.computeConv3DInfo(o.shape,s.shape,i,c,a),p=new YD(l);return e.runWebGLProgram(p,[o,s],"float32")}var bhe,whe=b(()=>{"use strict";$();ZD();bhe={kernelName:dp,backendName:"webgl",kernelFunc:Yze}});function Zze(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,dy:s}=t,{strides:i,pad:a,filterShape:c}=r,l=H.computeConv3DInfo(o.shape,c,i,1,a),p=new ok(l);return e.runWebGLProgram(p,[o,s],"float32")}var She,Che=b(()=>{"use strict";$();HS();She={kernelName:rm,backendName:"webgl",kernelFunc:Zze}});function Jze(n){let{inputs:t,backend:e,attrs:r}=n,{dy:o,filter:s}=t,{pad:i,strides:a,inputShape:c}=r,l=H.computeConv3DInfo(c,s.shape,a,1,i),p=new sk(l);return e.runWebGLProgram(p,[o,s],"float32")}var _he,The=b(()=>{"use strict";$();HS();_he={kernelName:om,backendName:"webgl",kernelFunc:Jze}});var eBe,tBe,Ihe,Ehe=b(()=>{"use strict";$();$t();eBe=ED+`
  return cos(x);
`,tBe=_t({opSnippet:eBe}),Ihe={kernelName:hu,backendName:"webgl",kernelFunc:tBe}});var nBe,rBe,Nhe,Dhe=b(()=>{"use strict";$();$t();nBe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,rBe=_t({opSnippet:nBe}),Nhe={kernelName:fu,backendName:"webgl",kernelFunc:rBe}});var ik,khe=b(()=>{"use strict";ik=class{constructor(t,e,r,o,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[i,a,c,l]=t,[p]=e,[f,y]=r;this.outputShape=[p,f,y,l];let d=o==="bilinear"?1:0,[h,m]=[`${a-1}.0`,`${c-1}.0`],[x,w,_]=f>1?[`${(a-1)/(f-1)}`,"(y2-y1) * height_ratio",`y1*${h} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${h}`],[I,T,D]=y>1?[`${(c-1)/(y-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${x});
      const float width_ratio = float(${I});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${w};
        float width_scale = ${T};

        float in_y = ${_};
        if( in_y < 0.0 || in_y > ${h} ) {
          setOutput(float(${s}));
          return;
        }
        float in_x = ${D};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${s}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${d} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}});var oBe,Ahe,Ohe=b(()=>{"use strict";$();khe();oBe=n=>{let{inputs:t,backend:e,attrs:r}=n,{image:o,boxes:s,boxInd:i}=t,{cropSize:a,method:c,extrapolationValue:l}=r,p=new ik(o.shape,s.shape,a,c,l);return e.runWebGLProgram(p,[o,s,i],"float32")},Ahe={kernelName:sm,backendName:"webgl",kernelFunc:oBe}});function Mhe(n,t){if(n===1)return`${t}`;if(n===2)return`${t}.x, ${t}.y`;if(n===3)return`${t}.x, ${t}.y, ${t}.z`;if(n===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw Error(`Cumulative sum for rank ${n} is not yet supported`)}function Rhe(n,t){if(n===1)return`${t}`;if(n===2)return`${t}.y`;if(n===3)return`${t}.z`;if(n===4)return`${t}.w`;throw Error(`Cumulative sum for rank ${n} is not yet supported`)}var KS,Phe=b(()=>{"use strict";Kr();KS=class{constructor(t,e,r){this.variableNames=["x"],this.outputShape=t;let o=t.length,s=e?"0.0":`getX(${Mhe(o,"coords")})`,i=t[t.length-1],a="",c="";e?(a=r?`end != ${i-1}`:"end != 0",c=r?"end + 1":"end - 1"):(a=r?`end + pow2 < ${i}`:"end >= pow2",c=r?"end + pow2":"end - pow2"),this.userCode=`
      uniform float index;
      void main() {
        ${Xt(o)} coords = getOutputCoords();
        int end = ${Rhe(o,"coords")};
        float val = ${s};
        int pow2 = int(pow(2.0, index));
        if (${a}) {
          int idx = ${c};
          ${Rhe(o,"coords")} = idx;
          val += getX(${Mhe(o,"coords")});
        }
        setOutput(val);
      }
    `}getCustomSetupFunc(t){return(e,r)=>{this.index==null&&(this.index=e.getUniformLocation(r,"index")),e.gl.uniform1f(this.index,t)}}}});function sBe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s,exclusive:i,reverse:a}=r,c=o.shape.length,l=H.getAxesPermutation([s],c),p=o;l!=null&&(p=kr({inputs:{x:o},backend:e,attrs:{perm:l}}));let f=H.getInnerMostAxes(1,c)[0];if(f!==c-1)throw new Error(`WebGL cumsum shader expects an inner-most axis=${o.shape.length-1} but got axis=${s}`);let y=p.shape[f],d=qr({inputs:{x:p},backend:e});for(let h=0;h<=Math.ceil(Math.log2(y))-1;h++){let m=new KS(p.shape,!1,a),x=m.getCustomSetupFunc(h),w=d;d=e.runWebGLProgram(m,[d],d.dtype,x),e.disposeIntermediateTensorInfo(w)}if(i){let h=new KS(p.shape,i,a),m=d;d=e.runWebGLProgram(h,[d],d.dtype),e.disposeIntermediateTensorInfo(m)}if(l!=null){let h=H.getUndoAxesPermutation(l),m=kr({inputs:{x:d},backend:e,attrs:{perm:h}});return e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(p),m}return d}var Fhe,$he=b(()=>{"use strict";$();Phe();Zi();Ji();Fhe={kernelName:mp,backendName:"webgl",kernelFunc:sBe}});function iBe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,weights:s}=t,{size:i,binaryOutput:a}=r;if(o.shape.length===1){let c=e.readSync(o.dataId),l=e.readSync(s.dataId),p=vD(c,l,s.dtype,s.shape,i);return e.makeTensorInfo([i],s.dtype,p)}else if(o.shape.length===2){let c=e.bufferSync(o),l=e.bufferSync(s),p=Due(c,l,i,a);return e.makeTensorInfo(p.shape,s.dtype,p.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}var Lhe,zhe=b(()=>{"use strict";$();rr();Lhe={kernelName:im,backendName:"webgl",kernelFunc:iBe}});var ak,Bhe=b(()=>{"use strict";ak=class{constructor(t,e,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${e};
      int offset_h = imod(h, ${e});
      int in_w = w / ${e};
      int offset_w = imod(w, ${e});
      int offset_d = (offset_h * ${e} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}});function aBe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{blockSize:s,dataFormat:i}=r;N.assert(s>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${s}`);let a=o.shape[0],c=i==="NHWC"?o.shape[1]:o.shape[2],l=i==="NHWC"?o.shape[2]:o.shape[3],p=i==="NHWC"?o.shape[3]:o.shape[1],f=c*s,y=l*s,d=p/(s*s),h=i==="NHWC"?[a,f,y,d]:[a,d,f,y],m=new ak(h,s,i);return e.runWebGLProgram(m,[o],o.dtype)}var Vhe,qhe=b(()=>{"use strict";$();Bhe();Vhe={kernelName:am,backendName:"webgl",kernelFunc:aBe}});var Eb,yB=b(()=>{"use strict";Eb=class{constructor(t,e=!1,r=null,o=!1,s=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;let i=t.inHeight,a=t.inWidth,c=t.padInfo.top,l=t.padInfo.left,p=t.strideHeight,f=t.strideWidth,y=t.dilationHeight,d=t.dilationWidth,h=t.filterHeight,m=t.filterWidth,x=t.outChannels/t.inChannels,w="",_="";r&&(o?w=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?w=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:w=`
          float activation(float x) {
            ${r}
          }
        `,_="result = activation(result);");let I=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${w}

      const ivec2 strides = ivec2(${p}, ${f});
      const ivec2 pads = ivec2(${c}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${x};
        int q = d2 - d1 * ${x};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${y};

          if (xR < 0 || xR >= ${i}) {
            continue;
          }

          for (int wC = 0; wC < ${m}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${a}) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${I}
        ${_}
        setOutput(result);
      }
    `}}});var Nb,xB=b(()=>{"use strict";$();Nb=class{constructor(t,e=!1,r=null,o=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;let i=t.inHeight,a=t.inWidth,c=t.padInfo.top,l=t.padInfo.left,p=t.strideHeight,f=t.strideWidth,y=t.dilationHeight,d=t.dilationWidth,h=t.filterHeight,m=t.filterWidth,x=m,w="int xR; int xC; int xCOffset;";for(let D=0;D<h;D++)for(let O=0;O<m;O++)w+=`
          vec4 xTexelR${D}C${O*2} = vec4(0.);
          vec4 wR${D}C${O} = vec4(0.);
          vec4 xR${D}C${O} = vec4(0.);`;for(let D=0;D<h;D++)for(let O=0;O<x;O++){let R=O*2;if(w+=`
          xR = xRCorner + ${D*y};
          xC = xCCorner + ${R*d};
        `,f===1){if(R<m&&(l%2===1?w+=`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < ${i} && xCOffset >= 0 && xCOffset < ${a}) {
                  xTexelR${D}C${R} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= ${a}) {
                    xTexelR${D}C${R}.zw = vec2(0.);
                  }
                } else {
                  xTexelR${D}C${R} = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < ${i} && xCOffset >= 0 && xCOffset < ${a}) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= ${a}) {
                    previous.zw = vec2(0.);
                  }

                  xR${D}C${R} = vec4(previous.zw, xTexelR${D}C${R}.xy);
                } else {
                  xR${D}C${R} = vec4(0, 0, xTexelR${D}C${R}.xy);
                }
              `:w+=`
                if(xR >= 0 && xR < ${i} && xC >= 0 && xC < ${a}) {
                  xTexelR${D}C${R} = getX(batch, xR, xC, d1);
                } else {
                  xTexelR${D}C${R} = vec4(0.);
                }

                xR${D}C${R} = xTexelR${D}C${R};
              `,R+1<m)){let P=l%2===0?N.nearestLargerEven(d):d;d%2===0&&l%2===1||d%2!==0&&l%2!==1?(w+=`
                  xCOffset = xC + ${l%2} + ${P};

                  if(xR >= 0 && xR < ${i} &&
                    xCOffset >= 0 && xCOffset < ${a}) {
                    xTexelR${D}C${R+2} = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(w+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < ${i} &&
                      xCOffset >= 0 && xCOffset < ${a}) {
                      xTexelR${D}C${R} = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR${D}C${R} = vec4(0.);
                    }
                  `),w+=`
                  xR${D}C${R+1} = vec4(
                    xTexelR${D}C${R}.zw, xTexelR${D}C${R+2}.xy);
                `):w+=`
                  xCOffset = xC + ${P};

                  if(xR >= 0 && xR < ${i} &&
                    xCOffset >= 0 && xCOffset < ${a}) {
                    xTexelR${D}C${R+2} = getX(batch, xR, xCOffset, d1);
                  }

                  xR${D}C${R+1} = xTexelR${D}C${R+2};
                `}}else R<m&&(w+=`
              if(xR >= 0 && xR < ${i}) {
            `,l%2===1?(w+=`
                xCOffset = xC + 1 - ${f};
                if(xCOffset >= 0 && xCOffset < ${a}) {
                  xTexelR${D}C${R} = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR${D}C${R} = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < ${a}) {
                  xTexelR${D}C${R+2} = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR${D}C${R+2} = vec4(0.);
                }

                xR${D}C${R} = vec4(
                  xTexelR${D}C${R}.zw, xTexelR${D}C${R+2}.zw);
              `,R+1<m&&(w+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + ${f};
                  if(xCOffset >= 0 && xCOffset < ${a}) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR${D}C${R+1} = vec4(xTexelR${D}C${R+2}.xy, final.xy);
                `)):(w+=`
                if(xC >= 0 && xC < ${a}) {
                  xTexelR${D}C${R} = getX(batch, xR, xC, d1);
                } else {
                  xTexelR${D}C${R} = vec4(0.);
                }

                xCOffset = xC + ${f};
                if(xCOffset >= 0 && xCOffset < ${a}) {
                  xTexelR${D}C${R+2} = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR${D}C${R+2} = vec4(0.);
                }

                xR${D}C${R} = vec4(
                  xTexelR${D}C${R}.xy, xTexelR${D}C${R+2}.xy);
              `,R+1<m&&(w+=`
                  xR${D}C${R+1} = vec4(
                    xTexelR${D}C${R}.zw, xTexelR${D}C${R+2}.zw);
                `)),w+="}");R<m&&(w+=`
            vec4 wTexelR${D}C${R} = getW(${D}, ${R}, d1, q);
            wR${D}C${R} = vec4(wTexelR${D}C${R}.xz, wTexelR${D}C${R}.xz);
          `,R+1<m&&(w+=`
              vec4 wTexelR${D}C${R+1} = getW(${D}, ${R+1}, d1, q);
              wR${D}C${R+1} =
                vec4(wTexelR${D}C${R+1}.xz, wTexelR${D}C${R+1}.xz);`))}for(let D=0;D<h;D++)for(let O=0;O<m;O++)w+=`dotProd += xR${D}C${O} * wR${D}C${O};`;let _="",I="";r&&(o?_=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?_=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:_=`vec4 activation(vec4 x) {
          ${r}
        }`,I="result = activation(result);");let T=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${_}

      const ivec2 strides = ivec2(${p}, ${f});
      const ivec2 pads = ivec2(${c}, ${l});

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        ${w}

        vec4 result = dotProd;
        ${T}
        ${I}
        setOutput(result);
      }
    `}}});function cBe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,filter:s}=t,{strides:i,pad:a,dilations:c,dimRoundingMode:l}=r,p=c;p==null&&(p=[1,1]),N.assert(H.eitherStridesOrDilationsAreOne(i,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${p}'`);let f=H.computeConv2DInfo(o.shape,s.shape,i,p,a,l,!0),y;return Te().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?y=new Nb(f):y=new Eb(f),e.runWebGLProgram(y,[o,s],"float32")}var Uhe,jhe=b(()=>{"use strict";$();yB();xB();Uhe={kernelName:gp,backendName:"webgl",kernelFunc:cBe}});var ck,uk,vB=b(()=>{"use strict";ck=class{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;let e=t.strideHeight,r=t.strideWidth,o=t.padInfo.top,s=t.padInfo.left,i=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${e} - ${o};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}},uk=class{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;let e=t.filterHeight,r=t.filterWidth,o=t.strideHeight,s=t.strideWidth,i=e-1-t.padInfo.top,a=r-1-t.padInfo.left,c=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${c}; dm++) {
              int d2 = d1 * ${c} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}});function uBe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,dy:s}=t,{strides:i,dilations:a,pad:c,dimRoundingMode:l,filterShape:p}=r,f=H.computeConv2DInfo(o.shape,p,i,a,c,l,!0),y=new ck(f);return e.runWebGLProgram(y,[o,s],"float32")}var Ghe,Whe=b(()=>{"use strict";$();vB();Ghe={kernelName:cm,backendName:"webgl",kernelFunc:uBe}});function lBe(n){let{inputs:t,backend:e,attrs:r}=n,{dy:o,filter:s}=t,{strides:i,dilations:a,pad:c,dimRoundingMode:l,inputShape:p}=r,f=H.computeConv2DInfo(p,s.shape,i,a,c,l,!0),y=new uk(f);return e.runWebGLProgram(y,[o,s],"float32")}var Hhe,Khe=b(()=>{"use strict";$();vB();Hhe={kernelName:um,backendName:"webgl",kernelFunc:lBe}});var lk,Xhe=b(()=>{"use strict";lk=class{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}});function pBe(n){let{inputs:t,backend:e}=n,{x:r}=t,o=[...r.shape,...r.shape],s=N.sizeFromShape(r.shape),i=ut({inputs:{x:r},backend:e,attrs:{shape:[s]}}),a=new lk(s),c=e.runWebGLProgram(a,[i],i.dtype),l=ut({inputs:{x:c},backend:e,attrs:{shape:o}});return e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(c),l}var Qhe,Yhe=b(()=>{"use strict";$();Xhe();ir();Qhe={kernelName:lm,backendName:"webgl",kernelFunc:pBe}});var pk,Zhe=b(()=>{"use strict";pk=class{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;let{inHeight:e,inWidth:r,padInfo:o,strideHeight:s,strideWidth:i,filterHeight:a,filterWidth:c,dilationHeight:l,dilationWidth:p}=t,{top:f,left:y}=o;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${i});
      const ivec2 pads = ivec2(${f}, ${y});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${l};

          if (hIn >= 0 && hIn < ${e}) {
            for (int w = 0; w < ${c}; w++) {
              int wIn = wBeg + w * ${p};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}});function hBe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,filter:s}=t,{strides:i,pad:a,dilations:c}=r,l=H.computeDilation2DInfo(o.shape,s.shape,i,a,"NHWC",c),p,f=new pk(l);p=e.runWebGLProgram(f,[o,s],"float32");let y=ut({inputs:{x:p},backend:e,attrs:{shape:l.outShape}});return e.disposeIntermediateTensorInfo(p),y}var Jhe,efe=b(()=>{"use strict";$();Zhe();ir();Jhe={kernelName:yp,backendName:"webgl",kernelFunc:hBe}});var fBe,dBe,mBe,tfe,nfe=b(()=>{"use strict";$();$t();fBe="return (x >= 0.0) ? x : (exp(x) - 1.0);",dBe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,mBe=_t({opSnippet:fBe,packedOpSnippet:dBe}),tfe={kernelName:mu,backendName:"webgl",kernelFunc:mBe}});var gBe,yBe,xBe,rfe,ofe=b(()=>{"use strict";$();sd();Ml();gBe="return (b >= 1.0) ? a : a * (b + 1.0);",yBe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,xBe=n=>{let{inputs:t,backend:e}=n,{dy:r,y:o}=t,s=Te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ua(yBe,r.shape,o.shape):new Yi(gBe,r.shape,o.shape);return e.runWebGLProgram(s,[r,o],r.dtype)},rfe={kernelName:pm,backendName:"webgl",kernelFunc:xBe}});var vBe,bBe,wBe,sfe,ife=b(()=>{"use strict";$();$t();vBe=`
  return vec4(equal(a, b));
`,bBe="return float(a == b);",wBe=kn({opSnippet:bBe,packedOpSnippet:vBe,dtype:"bool"}),sfe={kernelName:tf,backendName:"webgl",kernelFunc:wBe}});var SBe,CBe,afe,cfe=b(()=>{"use strict";$();$t();SBe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${H.ERF_P};
  float a1 = ${H.ERF_A1};
  float a2 = ${H.ERF_A2};
  float a3 = ${H.ERF_A3};
  float a4 = ${H.ERF_A4};
  float a5 = ${H.ERF_A5};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,CBe=_t({opSnippet:SBe}),afe={kernelName:gu,backendName:"webgl",kernelFunc:CBe}});var ufe,bB,lfe,wB=b(()=>{"use strict";$();$t();rr();ufe="return exp(x);",bB=_t({opSnippet:ufe,packedOpSnippet:ufe,cpuKernelImpl:Oue}),lfe={kernelName:yu,backendName:"webgl",kernelFunc:bB}});function hk(n){let{inputs:t,attrs:e,backend:r}=n,{dim:o}=e,{input:s}=t,i=s.shape.length,a=s.shape.slice(),c=o;return o<0&&(N.assert(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),c=i+o+1),a.splice(c,0,1),ut({inputs:{x:s},backend:r,attrs:{shape:a}})}var pfe,SB=b(()=>{"use strict";$();ir();pfe={kernelName:xp,backendName:"webgl",kernelFunc:hk}});var hfe,_Be,ffe,dfe=b(()=>{"use strict";$();$t();rr();hfe="return exp(x) - 1.0;",_Be=_t({opSnippet:hfe,packedOpSnippet:hfe,cpuKernelImpl:Mue}),ffe={kernelName:xu,backendName:"webgl",kernelFunc:_Be}});var XS,mfe=b(()=>{"use strict";XS=class{constructor(t,e,r){this.variableNames=["real","imag"];let o=e[1];this.outputShape=e;let s=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=r?`${o}.0`:"1.0",a;if(t==="real")a="return real * expR - imag * expI;";else if(t==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);this.userCode=`
      const float exponentMultiplier = ${s};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${o});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${o}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}});function fk(n,t,e){let r=e.texData.get(n.dataId),o=N.sizeFromShape(n.shape),s=n.shape[n.shape.length-1],i=o/s,a=ut({inputs:{x:n},backend:e,attrs:{shape:[i,s]}}),c=a.shape,l=new XS("real",c,t),p=new XS("imag",c,t),f=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:c},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:c}],y=e.runWebGLProgram(l,f,"float32"),d=e.runWebGLProgram(p,f,"float32"),h=si({inputs:{real:y,imag:d},backend:e});e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(d);let m=ut({inputs:{x:h},backend:e,attrs:{shape:n.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(h),m}var CB=b(()=>{"use strict";$();mfe();_h();ir();});function TBe(n){let{inputs:t,backend:e}=n,{input:r}=t;return fk(r,!1,e)}var gfe,yfe=b(()=>{"use strict";$();CB();gfe={kernelName:hm,backendName:"webgl",kernelFunc:TBe}});var dk,xfe=b(()=>{"use strict";dk=class{constructor(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}getCustomSetupFunc(t){return(e,r)=>{this.valueLoc==null&&(this.valueLoc=e.getUniformLocationNoThrow(r,"value")),e.gl.uniform1f(this.valueLoc,t)}}}});function QS(n){let{backend:t,attrs:e}=n,{shape:r,value:o}=e,{dtype:s}=e;if(s=s||N.inferDtype(o),s==="string"){let i=N.getArrayFromDType(s,N.sizeFromShape(r));return i.fill(o),t.makeTensorInfo(r,s,i)}else{let i=new dk(r,o),a=i.getCustomSetupFunc(o);return t.runWebGLProgram(i,[],s,a)}}var vfe,mk=b(()=>{"use strict";$();xfe();vfe={kernelName:fm,backendName:"webgl",kernelFunc:QS}});var gk,bfe=b(()=>{"use strict";gk=class{constructor(t){this.variableNames=["Image"],this.outputShape=[];let e=t[2];this.outputShape=t,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${e} - x;
          float outputValue;
          if(coordX >= 0 && coordX < ${e}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}});var wfe,Sfe=b(()=>{"use strict";$();bfe();wfe={kernelName:dm,backendName:"webgl",kernelFunc:({inputs:n,backend:t})=>{let{image:e}=n,r=t,o=new gk(e.shape);return r.runWebGLProgram(o,[e],e.dtype)}}});var Cfe,IBe,_fe,Tfe=b(()=>{"use strict";$();$t();rr();Cfe="return floor(x);",IBe=_t({opSnippet:Cfe,packedOpSnippet:Cfe,cpuKernelImpl:Rue}),_fe={kernelName:vu,backendName:"webgl",kernelFunc:IBe}});var EBe,NBe,DBe,Ife,Efe=b(()=>{"use strict";$();$t();EBe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,NBe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,DBe=kn({opSnippet:EBe,packedOpSnippet:NBe,dtype:"int32"}),Ife={kernelName:bu,backendName:"webgl",kernelFunc:DBe}});var yk,Nfe=b(()=>{"use strict";Va();yk=class{constructor(t){this.variableNames=["A"];let e=_r(),[r,o]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${o}.0, ${r}.0);

        vec4 values = ${e.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}});var xk,Dfe=b(()=>{"use strict";Va();xk=class{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let e=_r(),[r,o]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${o}.0, ${r}.0);
            vec4 values = ${e.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${e.output} = result;
      }
    `}}});function kBe(n){let{inputs:t,backend:e,attrs:r}=n,{pixels:o}=t,{numChannels:s}=r,i=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,c=typeof ImageBitmap<"u"&&o instanceof ImageBitmap,[l,p]=i?[o.videoWidth,o.videoHeight]:[o.width,o.height],f=[p,l],y=[p,l,s];(a||i||c)&&(Db==null&&(Db=document.createElement("canvas").getContext("2d")),Db.canvas.width=l,Db.canvas.height=p,Db.drawImage(o,0,0,l,p),o=Db.canvas);let d=e.makeTensorInfo(f,"int32");e.texData.get(d.dataId).usage=Ts.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(d.dataId),o);let h=Te().getBool("WEBGL_PACK")?new xk(y):new yk(y),m=e.runWebGLProgram(h,[d],"int32");return e.disposeData(d.dataId),m}var kfe,Db,Afe=b(()=>{"use strict";$();$();Ba();Nfe();Dfe();kfe={kernelName:Sx,backendName:"webgl",kernelFunc:kBe}});function ABe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,filter:s,bias:i,preluActivationWeights:a}=t,{strides:c,pad:l,dataFormat:p,dilations:f,dimRoundingMode:y,activation:d,leakyreluAlpha:h}=r,m=H.convertConv2DDataFormat(p),x=H.computeConv2DInfo(o.shape,s.shape,c,f,l,y,!1,m),w,_=[];if(x.filterHeight===1&&x.filterWidth===1&&x.dilationHeight===1&&x.dilationWidth===1&&x.strideHeight===1&&x.strideWidth===1&&(x.padInfo.type==="SAME"||x.padInfo.type==="VALID"))w=ek({x:o,filter:s,convInfo:x,backend:e,bias:i,activation:d,preluActivationWeights:a,leakyreluAlpha:h});else if(Te().getBool("WEBGL_CONV_IM2COL")&&o.shape[0]===1)w=tk({x:o,filter:s,convInfo:x,backend:e,bias:i,activation:d,preluActivationWeights:a,leakyreluAlpha:h});else{let T=i!=null,D=a!=null,O=d==="leakyrelu",R=d?ad(d,!1):null,P=new Ib(x,T,R,D,O),j=[o,s];if(i&&j.push(i),a&&j.push(a),O){let G=e.makeTensorInfo([],"float32",N.createScalarValue(h,"float32"));j.push(G),_.push(G)}w=e.runWebGLProgram(P,j,"float32")}let I=ut({inputs:{x:w},backend:e,attrs:{shape:x.outShape}});return _.push(w),_.forEach(T=>e.disposeIntermediateTensorInfo(T)),I}var Ofe,Mfe=b(()=>{"use strict";$();ZD();$t();gB();ir();Ofe={kernelName:pf,backendName:"webgl",kernelFunc:ABe}});function OBe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,filter:s,bias:i,preluActivationWeights:a}=t,{strides:c,pad:l,dilations:p,dimRoundingMode:f,activation:y,leakyreluAlpha:d}=r,h=[],m=p;m==null&&(m=[1,1]),N.assert(H.eitherStridesOrDilationsAreOne(c,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${c} and dilations '${m}'`);let x=H.computeConv2DInfo(o.shape,s.shape,c,m,l,f,!0),w=Te().getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels===1,_=y?ad(y,w):null,I=[o,s],T=i!=null,D=a!=null,O=y==="leakyrelu";if(T&&I.push(i),D&&I.push(a),O){let j=e.makeTensorInfo([],"float32",N.createScalarValue(d,"float32"));I.push(j),h.push(j)}let R;w?R=new Nb(x,T,_,D,O):R=new Eb(x,T,_,D,O);let P=e.runWebGLProgram(R,I,"float32");return h.forEach(j=>e.disposeIntermediateTensorInfo(j)),P}var Rfe,Pfe=b(()=>{"use strict";$();yB();xB();$t();Rfe={kernelName:hf,backendName:"webgl",kernelFunc:OBe}});var vk,Ffe=b(()=>{"use strict";Kr();vk=class{constructor(t,e,r){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=r;let o=Xt(e.length),s=Xt(r.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        ${o} strides = ${o}(${this.strides});
         void main() {
          ${s} coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < ${this.sliceDim}; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * ${i};
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `}}});function MBe(n){let{inputs:t,backend:e}=n,{params:r,indices:o}=t,s=o.shape,i=s[s.length-1],[a,c,l,p]=H.prepareAndValidate(r,o),f=ut({inputs:{x:o},backend:e,attrs:{shape:[c,i]}}),y=ut({inputs:{x:r},backend:e,attrs:{shape:[N.sizeFromShape(r.shape)/l,l]}}),d=new vk(i,p,[c,l]),h=e.runWebGLProgram(d,[y,f],y.dtype),m=ut({inputs:{x:h},backend:e,attrs:{shape:a}});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(h),m}var $fe,Lfe=b(()=>{"use strict";$();Ffe();ir();$fe={kernelName:mm,backendName:"webgl",kernelFunc:MBe}});function RBe(n,t){let e=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let o=0;o<n.length;o++)o===2?r.push("int(getIndices(resRC.x, resRC.z))"):r.push(`${e[o]}`);return r.join()}var bk,zfe=b(()=>{"use strict";Kr();bk=class{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;let r=Xt(this.rank),o=RBe(t,2);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}});function PBe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,indices:s}=t,{axis:i,batchDims:a}=r,c=N.parseAxisParam(i,o.shape)[0],l=H.segment_util.collectGatherOpShapeInfo(o,s,c,a),p=N.sizeFromShape(s.shape),f=[],y=ut({inputs:{x:o},backend:e,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),d=ut({inputs:{x:s},backend:e,attrs:{shape:[l.batchSize,p/l.batchSize]}});f.push(y),f.push(d);let h=[l.batchSize,l.outerSize,p/l.batchSize,l.sliceSize];if(e.shouldExecuteOnCPU([o,s])||o.dtype==="string"){let _=e.bufferSync(d),I=e.bufferSync(y),T=Pue(I,_,h);return f.forEach(D=>e.disposeIntermediateTensorInfo(D)),e.makeTensorInfo(l.outputShape,T.dtype,T.values)}let m=new bk(y.shape,h),x=e.runWebGLProgram(m,[y,d],y.dtype);f.push(x);let w=ut({inputs:{x},backend:e,attrs:{shape:l.outputShape}});return f.forEach(_=>e.disposeIntermediateTensorInfo(_)),w}var Bfe,Vfe=b(()=>{"use strict";$();zfe();rr();ir();Bfe={kernelName:bp,backendName:"webgl",kernelFunc:PBe}});var FBe,$Be,LBe,qfe,Ufe=b(()=>{"use strict";$();$t();rr();FBe="return float(a > b);",$Be=`
  return vec4(greaterThan(a, b));
`,LBe=kn({opSnippet:FBe,packedOpSnippet:$Be,cpuKernelImpl:Fue,dtype:"bool"}),qfe={kernelName:nf,backendName:"webgl",kernelFunc:LBe}});var zBe,BBe,VBe,jfe,Gfe=b(()=>{"use strict";$();$t();zBe="return float(a >= b);",BBe=`
  return vec4(greaterThanEqual(a, b));
`,VBe=kn({opSnippet:zBe,packedOpSnippet:BBe,dtype:"bool"}),jfe={kernelName:wu,backendName:"webgl",kernelFunc:VBe}});function qBe(n){let{inputs:t,backend:e}=n,{input:r}=t;return fk(r,!0,e)}var Wfe,Hfe=b(()=>{"use strict";$();CB();Wfe={kernelName:gm,backendName:"webgl",kernelFunc:qBe}});var UBe,jBe,Kfe,Xfe=b(()=>{"use strict";$();$t();UBe="return float(!isnan(x) && !isinf(x));",jBe=_t({opSnippet:UBe,dtype:"bool"}),Kfe={kernelName:Su,backendName:"webgl",kernelFunc:jBe}});var GBe,WBe,Qfe,Yfe=b(()=>{"use strict";$();$t();GBe="return float(isinf(x));",WBe=_t({opSnippet:GBe,dtype:"bool"}),Qfe={kernelName:Cu,backendName:"webgl",kernelFunc:WBe}});var HBe,KBe,Zfe,Jfe=b(()=>{"use strict";$();$t();HBe="return float(isnan(x));",KBe=_t({opSnippet:HBe,dtype:"bool"}),Zfe={kernelName:_u,backendName:"webgl",kernelFunc:KBe}});var XBe,QBe,YBe,ede,tde=b(()=>{"use strict";$();$t();rr();XBe="return float(a < b);",QBe=`
  return vec4(lessThan(a, b));
`,YBe=kn({opSnippet:XBe,packedOpSnippet:QBe,cpuKernelImpl:$ue,dtype:"bool"}),ede={kernelName:rf,backendName:"webgl",kernelFunc:YBe}});var ZBe,JBe,eVe,nde,rde=b(()=>{"use strict";$();$t();ZBe="return float(a <= b);",JBe=`
  return vec4(lessThanEqual(a, b));
`,eVe=kn({opSnippet:ZBe,packedOpSnippet:JBe,dtype:"bool"}),nde={kernelName:of,backendName:"webgl",kernelFunc:eVe}});function tVe(n){let{backend:t,attrs:e}=n,{start:r,stop:o,num:s}=e,i=Lue(r,o,s);return t.makeTensorInfo([i.length],"float32",i)}var ode,sde=b(()=>{"use strict";$();rr();ode={kernelName:xm,backendName:"webgl",kernelFunc:tVe}});var nVe,rVe,oVe,ide,ade=b(()=>{"use strict";$();$t();rr();nVe=`if (x < 0.0) return NAN;
  return log(x);`,rVe=`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,oVe=_t({opSnippet:nVe,packedOpSnippet:rVe,cpuKernelImpl:zue}),ide={kernelName:Tu,backendName:"webgl",kernelFunc:oVe}});var sVe,iVe,cde,ude=b(()=>{"use strict";$();$t();sVe="return log(1.0 + x);",iVe=_t({opSnippet:sVe}),cde={kernelName:Iu,backendName:"webgl",kernelFunc:iVe}});var aVe,cVe,uVe,lde,pde=b(()=>{"use strict";$();$t();aVe="return float(a >= 1.0 && b >= 1.0);",cVe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,uVe=kn({opSnippet:aVe,packedOpSnippet:cVe,dtype:"bool"}),lde={kernelName:sf,backendName:"webgl",kernelFunc:uVe}});var lVe,pVe,hde,fde=b(()=>{"use strict";$();$t();lVe="return float(!(x >= 1.0));",pVe=_t({opSnippet:lVe}),hde={kernelName:af,backendName:"webgl",kernelFunc:pVe}});var hVe,fVe,dVe,dde,mde=b(()=>{"use strict";$();$t();hVe="return float(a >= 1.0 || b >= 1.0);",fVe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,dVe=kn({opSnippet:hVe,packedOpSnippet:fVe,dtype:"bool"}),dde={kernelName:cf,backendName:"webgl",kernelFunc:dVe}});var wk,gde=b(()=>{"use strict";wk=class{constructor(t,e,r,o,s){this.variableNames=["x"],this.outputShape=[];let i=e,a=t[3]-1;this.outputShape=t;let c,l=`float(${r}) + float(${o}) * sum`;s===.5?c=`inversesqrt(${l})`:s===1?c=`1.0/(${l})`:c=`exp(log(${l}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${c};
        setOutput(val);
      }
    `}}});var Sk,yde=b(()=>{"use strict";Sk=class{constructor(t,e,r,o,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let i=e,a=t[3]-1;this.outputShape=t;let c,l=`float(${r}) + float(${o}) * sum`;s===.5?c=`inversesqrt(${l})`:s===1?c=`1.0/(${l})`:c=`exp(log(${l}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${c};
        setOutput(result);
      }
    `}}});var mVe,xde,vde=b(()=>{"use strict";$();gde();yde();mVe=n=>{let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{depthRadius:s,bias:i,alpha:a,beta:c}=r,l=Te().getBool("WEBGL_PACK_NORMALIZATION")?new Sk(o.shape,s,i,a,c):new wk(o.shape,s,i,a,c);return e.runWebGLProgram(l,[o],o.dtype)},xde={kernelName:Cp,backendName:"webgl",kernelFunc:mVe}});var Ck,bde=b(()=>{"use strict";Ck=class{constructor(t,e,r,o,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=r,this.alpha=o,this.beta=s,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${e})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${e} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${o}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${o})
                * float(${s})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${s});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}});var gVe,wde,Sde=b(()=>{"use strict";$();bde();gVe=n=>{let{inputs:t,backend:e,attrs:r}=n,{x:o,y:s,dy:i}=t,{depthRadius:a,bias:c,alpha:l,beta:p}=r,f=new Ck(o.shape,a,c,l,p);return e.runWebGLProgram(f,[o,s,i],o.dtype)},wde={kernelName:vm,backendName:"webgl",kernelFunc:gVe}});function Cde(n,t,e,r){let o=N.sizeFromShape(t),i=N.sizeFromShape(n.shape)/o,a=ut({inputs:{x:n},attrs:{shape:[i,o]},backend:r}),c=Ei(a,n.dtype,"max",r),l=ut({inputs:{x:c},attrs:{shape:e},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(c),l}var _de=b(()=>{"use strict";$();cd();ir();});function _B(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{reductionIndices:s,keepDims:i}=r,a=o.shape.length,c=N.parseAxisParam(s,o.shape),l=c,p=H.getAxesPermutation(l,a),f=p!=null,y=e.shouldExecuteOnCPU([o]),d=o;if(f){if(y){let I=e.texData.get(d.dataId).values,T=new Array(a);for(let R=0;R<T.length;R++)T[R]=o.shape[p[R]];let D=Fg(I,o.shape,o.dtype,p,T);d=e.makeTensorInfo(T,o.dtype);let O=e.texData.get(d.dataId);O.values=D}else d=ud(o,p,e);l=H.getInnerMostAxes(l.length,a)}H.assertAxesAreInnerMostDims("max",l,a);let[h,m]=H.computeOutAndReduceShapes(d.shape,l),x=h;i&&(x=H.expandShapeToKeepDim(h,c));let w;if(y){let I=e.texData.get(d.dataId).values,T=Bue(I,N.sizeFromShape(m),x,o.dtype);w=e.makeTensorInfo(x,o.dtype);let D=e.texData.get(w.dataId);D.values=T}else w=Cde(d,m,x,e);return f&&e.disposeIntermediateTensorInfo(d),w}var Tde,TB=b(()=>{"use strict";$();$();rr();_de();Cb();Tde={kernelName:_p,backendName:"webgl",kernelFunc:_B}});var yVe,xVe,vVe,Ide,Ede=b(()=>{"use strict";$();sd();Ml();$t();rr();yVe=ID+`
  return max(a, b);
`,xVe=`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+id+`
  return result;
`,vVe=kn({opSnippet:yVe,packedOpSnippet:xVe,cpuKernelImpl:Vue}),Ide={kernelName:Eu,backendName:"webgl",kernelFunc:vVe}});function bVe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t;Ol(o,"maxPool");let{filterSize:s,strides:i,pad:a,dimRoundingMode:c}=r,l=1;N.assert(H.eitherStridesOrDilationsAreOne(i,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${l}'`);let p=H.computePool2DInfo(o.shape,s,i,l,a,c);if(p.filterWidth===1&&p.filterHeight===1&&N.arraysEqual(p.inShape,p.outShape))return qr({inputs:{x:o},backend:e});let f=new Mc(p,"max",!1);return e.runWebGLProgram(f,[o],o.dtype)}var Nde,Dde=b(()=>{"use strict";$();pd();Qi();Zi();Nde={kernelName:Tp,backendName:"webgl",kernelFunc:bVe}});function wVe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{filterSize:s,strides:i,pad:a,dataFormat:c,dimRoundingMode:l}=r,p=[1,1,1],f=H.computePool3DInfo(o.shape,s,i,p,a,l,c),y=new ld(f,"max",!1);return e.runWebGLProgram(y,[o],o.dtype)}var kde,Ade=b(()=>{"use strict";$();pd();kde={kernelName:Ip,backendName:"webgl",kernelFunc:wVe}});var _k,Tk,IB=b(()=>{"use strict";_k=class{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;let e=t.strideHeight,r=t.strideWidth,o=t.dilationHeight,s=t.effectiveFilterHeight,i=t.effectiveFilterWidth,a=s-1-t.padInfo.top,c=i-1-t.padInfo.left,l=s*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${s};
          wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${e}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${l} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}},Tk=class{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;let e=t.strideDepth,r=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,i=t.dilationHeight,a=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,p=t.effectiveFilterWidth,f=c-1-t.padInfo.front,y=l-1-t.padInfo.top,d=p-1-t.padInfo.left,h=c*l*p-1;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${y}, ${d});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${c};
           wD += ${s}) {
          float dyD = float(dyDCorner + wD) / ${e}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${l};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${p};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${h} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${l} * ${p} +
                  wR * ${p} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}});function SVe(n){let{inputs:t,backend:e,attrs:r}=n,{dy:o,input:s}=t,i=s,{filterSize:a,strides:c,pad:l,dimRoundingMode:p}=r,f=[1,1,1],y=H.computePool3DInfo(i.shape,a,c,f,l,p),d=new ld(y,"max",!0),h=e.runWebGLProgram(d,[i],i.dtype),m=new Tk(y),x=e.runWebGLProgram(m,[o,h],i.dtype);return e.disposeIntermediateTensorInfo(h),x}var Ode,Mde=b(()=>{"use strict";$();IB();pd();Ode={kernelName:wm,backendName:"webgl",kernelFunc:SVe}});function CVe(n){let{inputs:t,backend:e,attrs:r}=n,{dy:o,input:s,output:i}=t,a=s;Ol([s,i],"maxPoolGrad");let{filterSize:c,strides:l,pad:p,dimRoundingMode:f}=r,y=H.computePool2DInfo(a.shape,c,l,1,p,f),d=!0,h=new Mc(y,"max",d),m=e.runWebGLProgram(h,[a],a.dtype),x=new _k(y),w=e.runWebGLProgram(x,[o,m],a.dtype);return e.disposeIntermediateTensorInfo(m),w}var Rde,Pde=b(()=>{"use strict";$();IB();pd();Qi();Rde={kernelName:bm,backendName:"webgl",kernelFunc:CVe}});function Fde(n,t,e,r){let o=new Mc(e,"max",!1),s=r.runWebGLProgram(o,[n],"float32");o=new Mc(e,"max",!0,!0,t);let i=r.runWebGLProgram(o,[n],"float32");return[s,i]}var $de=b(()=>{"use strict";pd();});var Lde,zde=b(()=>{"use strict";$();$();$de();Lde={kernelName:Sm,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{let{x:r}=n,{filterSize:o,strides:s,pad:i,includeBatchInIndex:a}=t,c=e;N.assert(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);let l=[1,1];N.assert(H.eitherStridesOrDilationsAreOne(s,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${l}'`);let p=H.computePool2DInfo(r.shape,o,s,l,i),[f,y]=Fde(r,a,p,c);return[f,y]}}});function Bde(n,t,e,r){let o=N.sizeFromShape(t),i=N.sizeFromShape(n.shape)/o,a=ut({inputs:{x:n},attrs:{shape:[i,o]},backend:r}),c=Ei(a,"float32","mean",r),l=ut({inputs:{x:c},attrs:{shape:e},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(c),l}var Vde=b(()=>{"use strict";$();cd();ir();});var qde,Ude=b(()=>{"use strict";$();Vde();Cb();qde={kernelName:Ep,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{let{x:r}=n,{keepDims:o,axis:s}=t,i=e,a=r.shape.length,c=N.parseAxisParam(s,r.shape),l=c,p=H.getAxesPermutation(l,a),f=p!=null,y=i.shouldExecuteOnCPU([r]),d=[],h=r;if(f){if(y){let T=i.texData.get(h.dataId).values,D=new Array(a);for(let P=0;P<D.length;P++)D[P]=r.shape[p[P]];let O=Fg(T,r.shape,r.dtype,p,D);h=i.makeTensorInfo(D,r.dtype);let R=i.texData.get(h.dataId);R.values=O}else h=ud(r,p,i);d.push(h),l=H.getInnerMostAxes(l.length,a)}H.assertAxesAreInnerMostDims("sum",l,a);let[m,x]=H.computeOutAndReduceShapes(h.shape,l),w=m;o&&(w=H.expandShapeToKeepDim(m,c));let _=Bde(h,x,w,i);for(let I of d)i.disposeIntermediateTensorInfo(I);return _}}});function _Ve(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s,keepDims:i}=r,a=o.shape.length,c=N.parseAxisParam(s,o.shape),l=c,p=H.getAxesPermutation(l,a),f=o;p!=null&&(f=kr({inputs:{x:o},backend:e,attrs:{perm:p}}),l=H.getInnerMostAxes(l.length,o.shape.length)),H.assertAxesAreInnerMostDims("min",l,a);let[y,d]=H.computeOutAndReduceShapes(f.shape,l),h=N.sizeFromShape(d),m=ut({inputs:{x:f},backend:e,attrs:{shape:[-1,h]}}),x=Ei(m,m.dtype,"min",e),w;if(i){let _=H.expandShapeToKeepDim(y,c);w=ut({inputs:{x},backend:e,attrs:{shape:_}})}else w=ut({inputs:{x},backend:e,attrs:{shape:y}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(x),p!=null&&e.disposeIntermediateTensorInfo(f),w}var jde,Gde=b(()=>{"use strict";$();cd();ir();Ji();jde={kernelName:Np,backendName:"webgl",kernelFunc:_Ve}});var TVe,IVe,EVe,Wde,Hde=b(()=>{"use strict";$();sd();Ml();$t();rr();TVe=ID+`
  return min(a, b);
`,IVe=`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+id+`
  return result;
`,EVe=kn({opSnippet:TVe,packedOpSnippet:IVe,cpuKernelImpl:que}),Wde={kernelName:Nu,backendName:"webgl",kernelFunc:EVe}});var Ik,Kde=b(()=>{"use strict";Kr();Ik=class{constructor(t,e,r){this.variableNames=["x"],this.outputShape=e.map((p,f)=>p[0]+t[f]+p[1]);let o=t.length,s=Xt(o),i=e.map(p=>p[0]).join(","),a=e.map((p,f)=>p[0]+t[f]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o),l=r==="reflect"?0:1;if(o===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${l};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${l};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${i});
      ${s} end = ${s}(${a});

      void main() {
        ${s} outC = getOutputCoords();
        for (int i = 0; i < ${o}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${l};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};
          }
        }
        ${s} coords = outC - start;
        setOutput(getX(${c}));
      }
    `}}});var Ek,Xde=b(()=>{"use strict";Oc();Kr();Ek=class{constructor(t,e,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((h,m)=>h[0]+t[m]+h[1]);let o=t.length,s=Xt(o),i=e.map(h=>h[0]).join(","),a=e.map((h,m)=>h[0]+t[m]).join(","),c=Vr("rc",o),l=Vr("source",o),p=`${c[o-1]} < ${this.outputShape[o-1]}`,f=o===1?"source":`vec2(${l.slice(-2).join()})`,y=r==="reflect"?0:1,d="";if(o===1){let h=`
        ${s} source = rc;
        if (source < start) {
          source = start * 2 - source - ${y};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${y};
        }
        source -= start;
      `;d=`
        ${s} rc = outputLoc;
        ${h}
        result[0] = getChannel(getX(${l.join()}), ${f});
        ${c[o-1]} += 1;
        if(${p}) {
          ${h}
          result[1] = getChannel(getX(${l.join()}), ${f});
        }
      `}else{let h=`
        ${s} source = rc;
        ${s} lt = ${s}(lessThan(source, start));
        ${s} gte = ${s}(greaterThanEqual(source, end));
        ${s} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${y}) +
                gte * ((end - 1) * 2 - source + ${y});
        source -= start;
      `;d=`
        ${s} rc = outputLoc;
        ${h}
        result[0] = getChannel(getX(${l.join()}), ${f});
        ${c[o-1]} += 1;
        if(${p}) {
          ${h}
          result[1] = getChannel(getX(${l.join()}), ${f});
        }
        rc = outputLoc;
        ${c[o-2]} += 1;
        if(${c[o-2]} < ${this.outputShape[o-2]}) {
          ${h}
          result[2] = getChannel(getX(${l.join()}), ${f});
          ${c[o-1]} += 1;
          if(${p}) {
            ${h}
            result[3] = getChannel(getX(${l.join()}), ${f});
          }
        }
      `}this.userCode=`
      const ${s} start = ${s}(${i});
      const ${s} end = ${s}(${a});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${d}
        setOutput(result);
      }
    `}}});var NVe,Qde,Yde=b(()=>{"use strict";$();Kde();Xde();NVe=({inputs:n,backend:t,attrs:e})=>{let{x:r}=n,{paddings:o,mode:s}=e,i=Te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ek(r.shape,o,s):new Ik(r.shape,o,s);return t.runWebGLProgram(i,[r],r.dtype)},Qde={kernelName:Dp,backendName:"webgl",kernelFunc:NVe}});var DVe,kVe,AVe,Zde,Jde=b(()=>{"use strict";$();Ml();$t();DVe=`if (b == 0.0) return NAN;
  return mod(a, b);`,kVe=`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  `+id+`
  return result;
`,AVe=kn({opSnippet:DVe,packedOpSnippet:kVe}),Zde={kernelName:Du,backendName:"webgl",kernelFunc:AVe}});var Nk,eme=b(()=>{"use strict";Nk=class{constructor(t,e,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${e-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${e-1}));
      }
    `}getCustomSetupFunc(t){return(e,r)=>{this.seedLoc==null&&(this.seedLoc=e.getUniformLocation(r,"seed")),e.gl.uniform1f(this.seedLoc,t)}}}});var OVe,MVe,EB,tme,NB=b(()=>{"use strict";$();$t();OVe=`
if (a == b) {
  return 1.0;
};
return a / b;`,MVe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,EB=kn({opSnippet:OVe,packedOpSnippet:MVe,checkOutOfBounds:!0}),tme={kernelName:du,backendName:"webgl",kernelFunc:EB}});var nme,DB,rme,kB=b(()=>{"use strict";$();$t();rr();nme="return a - b;",DB=kn({opSnippet:nme,packedOpSnippet:nme,supportsComplex:!0,cpuKernelImpl:Que}),rme={kernelName:Gu,backendName:"webgl",kernelFunc:DB}});function AB(n){let{inputs:t,backend:e,attrs:r}=n,{logits:o}=t,{dim:s}=r,i=N.parseAxisParam([s],o.shape),a=_B({inputs:{x:o},backend:e,attrs:{reductionIndices:i,keepDims:!1}}),c=H.expandShapeToKeepDim(a.shape,i),l=ut({inputs:{x:a},backend:e,attrs:{shape:c}}),p=DB({inputs:{a:o,b:l},backend:e}),f=bB({inputs:{x:p},backend:e}),y=GS({inputs:{x:f},backend:e,attrs:{axis:i,keepDims:!1}}),d=ut({inputs:{x:y},backend:e,attrs:{shape:c}}),h=EB({inputs:{a:f,b:d},backend:e});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(l),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(d),h}var ome,OB=b(()=>{"use strict";$();wB();TB();NB();ir();kB();AD();ome={kernelName:Gp,backendName:"webgl",kernelFunc:AB}});function RVe(n){let{inputs:t,backend:e,attrs:r}=n,{logits:o}=t,{numSamples:s,seed:i,normalized:a}=r,c=a?o:AB({inputs:{logits:o},backend:e,attrs:{dim:o.shape.length-1}}),l=c.shape[0],p=c.shape[1],f=new Nk(l,p,s),y=f.getCustomSetupFunc(i),d=e.runWebGLProgram(f,[c],"int32",y);return a||e.disposeIntermediateTensorInfo(c),d}var sme,ime=b(()=>{"use strict";$();eme();OB();sme={kernelName:Cm,backendName:"webgl",kernelFunc:RVe}});function PVe(n){let{inputs:t,backend:e}=n,{x:r}=t;if(e.shouldExecuteOnCPU([r])){let s=e.texData.get(r.dataId),[i,a]=jue(s.values,r.shape,r.dtype);return e.makeTensorInfo(a,r.dtype,i)}let o;return Te().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new qa(r.shape,ame):o=new js(r.shape,ame),e.runWebGLProgram(o,[r],r.dtype)}var ame,cme,ume=b(()=>{"use strict";$();rr();Is();wb();ame="return -x;";cme={kernelName:kp,backendName:"webgl",kernelFunc:PVe}});function $Ve(n){H.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:e,attrs:r}=n,{boxes:o,scores:s}=t,{maxOutputSize:i,iouThreshold:a,scoreThreshold:c}=r,l=e.readSync(o.dataId),p=e.readSync(s.dataId),{selectedIndices:f}=FVe(l,p,i,a,c);return e.makeTensorInfo([f.length],"int32",new Int32Array(f))}var FVe,lme,pme=b(()=>{"use strict";$();FVe=Vo.nonMaxSuppressionV3Impl;lme={kernelName:_m,backendName:"webgl",kernelFunc:$Ve}});function zVe(n){H.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:e,attrs:r}=n,{boxes:o,scores:s}=t,{maxOutputSize:i,iouThreshold:a,scoreThreshold:c,padToMaxOutputSize:l}=r,p=e.readSync(o.dataId),f=e.readSync(s.dataId),{selectedIndices:y,validOutputs:d}=LVe(p,f,i,a,c,l);return[e.makeTensorInfo([y.length],"int32",new Int32Array(y)),e.makeTensorInfo([],"int32",new Int32Array([d]))]}var LVe,hme,fme=b(()=>{"use strict";$();LVe=Vo.nonMaxSuppressionV4Impl;hme={kernelName:Tm,backendName:"webgl",kernelFunc:zVe}});function VVe(n){H.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:e,attrs:r}=n,{boxes:o,scores:s}=t,{maxOutputSize:i,iouThreshold:a,scoreThreshold:c,softNmsSigma:l}=r,p=e.readSync(o.dataId),f=e.readSync(s.dataId),y=i,d=a,h=c,m=l,{selectedIndices:x,selectedScores:w}=BVe(p,f,y,d,h,m);return[e.makeTensorInfo([x.length],"int32",new Int32Array(x)),e.makeTensorInfo([w.length],"float32",new Float32Array(w))]}var BVe,dme,mme=b(()=>{"use strict";$();BVe=Vo.nonMaxSuppressionV5Impl;dme={kernelName:Im,backendName:"webgl",kernelFunc:VVe}});var Dk,gme=b(()=>{"use strict";Dk=class{constructor(t,e,r,o){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${o}), float(${r}),
                      float(index == coords.y)));
      }
    `}}});var qVe,yme,xme=b(()=>{"use strict";$();gme();ir();qVe=n=>{let{inputs:t,backend:e,attrs:r}=n,{indices:o}=t,{depth:s,onValue:i,offValue:a}=r,c=N.sizeFromShape(o.shape),l=new Dk(c,s,i,a),p=ut({inputs:{x:o},backend:e,attrs:{shape:[c]}}),f=e.runWebGLProgram(l,[p],o.dtype);e.disposeIntermediateTensorInfo(p);let y=[...o.shape,s],d=ut({inputs:{x:f},backend:e,attrs:{shape:y}});return e.disposeIntermediateTensorInfo(f),d},yme={kernelName:Op,backendName:"webgl",kernelFunc:qVe}});function YS(n){let{inputs:t,backend:e}=n,{x:r}=t;if(r.dtype==="complex64"){let o=Ih({inputs:{input:r},backend:e}),s=YS({inputs:{x:o},backend:e}),i=Lg({inputs:{input:r},backend:e}),a=YS({inputs:{x:i},backend:e}),c=si({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(a),c}else return QS({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:e})}var vme,MB=b(()=>{"use strict";$();_h();mk();WS();Tb();vme={kernelName:Xp,backendName:"webgl",kernelFunc:YS}});function bme(n){let{inputs:t,backend:e}=n,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){let o=Ih({inputs:{input:r},backend:e}),s=bme({inputs:{x:o},backend:e}),i=Lg({inputs:{input:r},backend:e}),a=YS({inputs:{x:i},backend:e}),c=si({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(a),c}else return QS({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:e})}var wme,Sme=b(()=>{"use strict";$();_h();mk();WS();Tb();MB();wme={kernelName:Ap,backendName:"webgl",kernelFunc:bme}});function UVe(n){let{inputs:t,backend:e,attrs:r}=n,{axis:o}=r;if(t.length===1)return hk({inputs:{input:t[0]},backend:e,attrs:{dim:o}});let s=t[0].shape,i=t[0].dtype;t.forEach(p=>{N.assertShapesMatch(s,p.shape,"All tensors passed to stack must have matching shapes"),N.assert(i===p.dtype,()=>"All tensors passed to stack must have matching dtypes")});let a=[],c=t.map(p=>{let f=hk({inputs:{input:p},backend:e,attrs:{dim:o}});return a.push(f),f}),l=dB({inputs:c,backend:e,attrs:{axis:o}});return a.forEach(p=>e.disposeIntermediateTensorInfo(p)),l}var Cme,_me=b(()=>{"use strict";$();mB();SB();Cme={kernelName:Mp,backendName:"webgl",kernelFunc:UVe}});var kk,Tme=b(()=>{"use strict";Kr();kk=class{constructor(t,e,r){this.variableNames=["x"],this.outputShape=e.map((l,p)=>l[0]+t[p]+l[1]);let o=t.length,s=Xt(o),i=e.map(l=>l[0]).join(","),a=e.map((l,p)=>l[0]+t[p]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o);if(o===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(${r}));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${i});
      ${s} end = ${s}(${a});

      void main() {
        ${s} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(${r}));
        } else {
          ${s} coords = outC - start;
          setOutput(getX(${c}));
        }
      }
    `}}});var Ak,Ime=b(()=>{"use strict";Oc();Kr();Ak=class{constructor(t,e,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((m,x)=>m[0]+t[x]+m[1]);let o=t.length,s=Xt(o),i=e.map(m=>m[0]).join(","),a=e.map((m,x)=>m[0]+t[x]).join(","),c=Vr("rc",o),l=Vr("source",o),p=`${c[o-1]} < ${this.outputShape[o-1]}`,f=o===1?"source":`vec2(${l.slice(-2).join()})`,y=[`${s} rc = outputLoc;`,`${c[o-1]} += 1;
       if(${p}) {
      `,o===1?"":`}
       rc = outputLoc;
       ${c[o-2]} += 1;
       if(${c[o-2]} < ${this.outputShape[o-2]}) {`,o===1?"":`  ${c[o-1]} += 1;
         if(${p}) {`],d=o===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="";for(let m=0,x=o===1?2:4;m<x;m++)h+=`
        ${y[m]}
        if (${d}) {
          result[${m}] = float(${r});
        } else {
          ${s} source = rc - start;
          result[${m}] = getChannel(getX(${l.join()}), ${f});
        }
      `;h+=o===1?"} ":"}}",this.userCode=`
      const ${s} start = ${s}(${i});
      const ${s} end = ${s}(${a});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}}});var RB,Eme,PB=b(()=>{"use strict";$();Tme();Ime();RB=n=>{let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{paddings:s,constantValue:i}=r,a=Te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ak(o.shape,s,i):new kk(o.shape,s,i);return e.runWebGLProgram(a,[o],o.dtype)},Eme={kernelName:Rp,backendName:"webgl",kernelFunc:RB}});var jVe,GVe,WVe,Nme,Dme=b(()=>{"use strict";$();Ml();$t();jVe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,GVe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  `+id+`
  return result;
`,WVe=kn({opSnippet:jVe,packedOpSnippet:GVe}),Nme={kernelName:Au,backendName:"webgl",kernelFunc:WVe}});function HVe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{axis:s,keepDims:i}=r,a=o.shape.length,c=[],l=N.parseAxisParam(s,o.shape),p=l,f=H.getAxesPermutation(p,a),y=o;f!=null&&(y=kr({inputs:{x:o},backend:e,attrs:{perm:f}}),p=H.getInnerMostAxes(p.length,a),c.push(y)),H.assertAxesAreInnerMostDims("prod",p,a);let d;if(e.shouldExecuteOnCPU([y])){let h=e.texData.get(y.dataId).values,{outVals:m,outShape:x,outDtype:w}=Gue(y.shape,y.dtype,h,p);d=e.makeTensorInfo(x,w,m)}else{let[h,m]=H.computeOutAndReduceShapes(y.shape,p),x=N.sizeFromShape(m),w=ut({inputs:{x:y},backend:e,attrs:{shape:[-1,x]}}),_=df(o.dtype),I=Ei(w,_,"prod",e);d=ut({inputs:{x:I},backend:e,attrs:{shape:h}}),c.push(w),c.push(I)}if(i){c.push(d);let h=H.expandShapeToKeepDim(d.shape,l);d=ut({inputs:{x:d},backend:e,attrs:{shape:h}})}return c.forEach(h=>e.disposeIntermediateTensorInfo(h)),d}var kme,Ame=b(()=>{"use strict";$();cd();rr();ir();Ji();kme={kernelName:Em,backendName:"webgl",kernelFunc:HVe}});var FB,Ome,$B=b(()=>{"use strict";$();rr();FB=n=>{let{backend:t,attrs:e}=n,{start:r,stop:o,step:s,dtype:i}=e,a=Wue(r,o,s,i);return t.makeTensorInfo([a.length],i,a)},Ome={kernelName:Nm,backendName:"webgl",kernelFunc:FB}});var KVe,XVe,Mme,Rme=b(()=>{"use strict";$();$t();KVe="return 1.0 / x;",XVe=_t({opSnippet:KVe}),Mme={kernelName:Ou,backendName:"webgl",kernelFunc:XVe}});var QVe,YVe,ZVe,Pme,Fme=b(()=>{"use strict";$();$t();Is();QVe=Ao+`
  return (x < 0.0) ? 0.0 : x;
`,YVe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ZVe=_t({opSnippet:QVe,packedOpSnippet:YVe}),Pme={kernelName:Mu,backendName:"webgl",kernelFunc:ZVe}});var JVe,eqe,tqe,$me,Lme=b(()=>{"use strict";$();$t();Is();JVe=Ao+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,eqe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,tqe=_t({opSnippet:JVe,packedOpSnippet:eqe}),$me={kernelName:Ru,backendName:"webgl",kernelFunc:tqe}});var Ok,zme=b(()=>{"use strict";Ok=class{constructor(t,e,r,o,s){this.variableNames=["A"],this.outputShape=[];let[i,a,c,l]=t;this.outputShape=[i,e,r,l];let p=[o&&e>1?a-1:a,o&&r>1?c-1:c],f=[o&&e>1?e-1:e,o&&r>1?r-1:r],y;s?y="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":y="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${p[0]/f[0]},
          ${p[1]/f[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${c}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${y};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}});var Mk,Bme=b(()=>{"use strict";Mk=class{constructor(t,e,r,o,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,a,c,l]=t;this.outputShape=[i,e,r,l];let p=[o&&e>1?a-1:a,o&&r>1?c-1:c],f=[o&&e>1?e-1:e,o&&r>1?r-1:r],y;s?y="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":y="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${p[0]/f[0]},
          ${p[1]/f[1]},
          ${p[1]/f[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${c}.0,
                                     ${c}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${y};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}});function nqe(n){let{inputs:t,backend:e,attrs:r}=n,{images:o}=t,{alignCorners:s,halfPixelCenters:i,size:a}=r,[c,l]=a,p=Te().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Mk(o.shape,c,l,s,i):new Ok(o.shape,c,l,s,i);return e.runWebGLProgram(p,[o],"float32")}var Vme,qme=b(()=>{"use strict";$();zme();Bme();Vme={kernelName:Lp,backendName:"webgl",kernelFunc:nqe}});var Rk,Ume=b(()=>{"use strict";Rk=class{constructor(t,e,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;let[,o,s]=e,[,i,a]=t,c=[r&&i>1?o-1:o,r&&a>1?s-1:s],l=[r&&i>1?i-1:i,r&&a>1?a-1:a],p=c[0]/l[0],f=c[1]/l[1],y=1/p,d=1/f,h=Math.ceil(y)*2+2,m=Math.ceil(d)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${p});
        const float widthScale = float(${f});

        const float invHeightScale = float(${y});
        const float invWidthScale = float(${d});

        const int winHeight = int(${h});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${o-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${s-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}});function rqe(n){let{inputs:t,backend:e,attrs:r}=n,{images:o,dy:s}=t,{alignCorners:i}=r,a=new Rk(s.shape,o.shape,i);return e.runWebGLProgram(a,[s],s.dtype)}var jme,Gme=b(()=>{"use strict";$();Ume();jme={kernelName:Am,backendName:"webgl",kernelFunc:rqe}});var Pk,Wme=b(()=>{"use strict";Pk=class{constructor(t,e,r,o,s){this.variableNames=["A"],this.outputShape=[];let[i,a,c,l]=t;this.outputShape=[i,e,r,l];let p=[o&&e>1?a-1:a,o&&r>1?c-1:c],f=[o&&e>1?e-1:e,o&&r>1?r-1:r],y=o?"0.5":"0.0",d;s?d="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${p[0]/f[0]},
          ${p[1]/f[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${c}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${y})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}});function oqe(n){let{inputs:t,backend:e,attrs:r}=n,{images:o}=t,{alignCorners:s,halfPixelCenters:i,size:a}=r,[c,l]=a,p=new Pk(o.shape,c,l,s,i);return e.runWebGLProgram(p,[o],o.dtype)}var Hme,Kme=b(()=>{"use strict";$();Wme();Hme={kernelName:$p,backendName:"webgl",kernelFunc:oqe}});var Fk,Xme=b(()=>{"use strict";Fk=class{constructor(t,e,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;let[,o,s]=e,[,i,a]=t,c=[r&&i>1?o-1:o,r&&a>1?s-1:s],l=[r&&i>1?i-1:i,r&&a>1?a-1:a],p=c[0]/l[0],f=c[1]/l[1],y=1/p,d=1/f,h=Math.ceil(y)*2+2,m=Math.ceil(d)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${p});
        const float widthScale = float(${f});

        const float invHeightScale = float(${y});
        const float invWidthScale = float(${d});

        const int winHeight = int(${h});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${c[0]}) *
                (float(dyR) / float(${l[0]}));

            float sourceFracCol =
                float(${c[1]}) *
                  (float(dyC) / float(${l[1]}));

            int sourceNearestRow = int(min(
                float(int(${o}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}});function sqe(n){let{inputs:t,backend:e,attrs:r}=n,{images:o,dy:s}=t,{alignCorners:i}=r,a=new Fk(s.shape,o.shape,i);return e.runWebGLProgram(a,[s],s.dtype)}var Qme,Yme=b(()=>{"use strict";$();Xme();Qme={kernelName:km,backendName:"webgl",kernelFunc:sqe}});var $k,Zme=b(()=>{"use strict";Kr();$k=class{constructor(t,e){this.variableNames=["x"];let r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=t,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${t[0]} - coord - 1));
        }
      `;return}let o=a=>e.indexOf(a)!==-1&&t[a]!==1?`${t[a]} - coords[${a}] - 1`:`coords[${a}]`,s=t.map((a,c)=>o(c)).join(","),i=Xt(r);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}}});var Lk,Jme=b(()=>{"use strict";Oc();Kr();Lk=class{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=t;let o=Vr("rc",r),s=`${o[r-1]} + 1 < ${this.outputShape[r-1]}`,i=`${o[r-2]} + 1 < ${this.outputShape[r-2]}`,a=Xt(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${t[0]} - rc - 1),
            ${t[0]} - rc - 1);
          if(${s}){
              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),
                ${t[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${c(o.slice())};
          if(${s}){
            result.g = ${l(o.slice())};
          }
          if(${i}) {
            result.b = ${p(o.slice())};
            if(${s}) {
              result.a = ${f(o.slice())};
            }
          }
          setOutput(result);
        }
    `;function c(h){return y(h)}function l(h){return h[r-1]="("+h[r-1]+" + 1)",y(h)}function p(h){return h[r-2]="("+h[r-2]+" + 1)",y(h)}function f(h){return h[r-1]="("+h[r-1]+" + 1)",h[r-2]="("+h[r-2]+" + 1)",y(h)}function y(h){let m=t.map((_,I)=>d(I,h)),x=m.join(","),w=m.slice(-2).join(",");return`getChannel(getX(${x}), vec2(${w}))`}function d(h,m){return e.indexOf(h)!==-1&&t[h]!==1?`${t[h]} - ${m[h]} - 1`:`${m[h]}`}}}});function iqe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{dims:s}=r,i=o.shape.length,a=N.parseAxisParam(s,o.shape);if(i===0)return qr({inputs:{x:o},backend:e});let c=Te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Lk(o.shape,a):new $k(o.shape,a);return e.runWebGLProgram(c,[o],o.dtype)}var ege,tge=b(()=>{"use strict";$();Zme();Jme();Zi();ege={kernelName:zp,backendName:"webgl",kernelFunc:iqe}});var zk,nge=b(()=>{"use strict";$();zk=class{constructor(t,e,r,o){this.variableNames=["Image"],this.outputShape=[];let s=t[1],i=t[2],a=Math.sin(e).toFixed(3),c=Math.cos(e).toFixed(3);this.outputShape=t;let[l,p]=H.getImageCenter(o,s,i),f=l.toFixed(3),y=p.toFixed(3),d="";typeof r=="number"?d=`float outputValue = ${r.toFixed(2)};`:d=`
        vec3 fill = vec3(${r.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - ${f}) * ${c} - (float(y) - ${y}) * ${a};
          float coordYFloat = (float(x) - ${f}) * ${a} + (float(y) - ${y}) * ${c};
          int coordX = int(round(coordXFloat + ${f}));
          int coordY = int(round(coordYFloat + ${y}));
          ${d}
          if(coordX >= 0 && coordX < ${i} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}});var rge,oge=b(()=>{"use strict";$();nge();rge={kernelName:Lm,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{let{image:r}=n,{radians:o,fillValue:s,center:i}=t,a=e,c=new zk(r.shape,o,s,i);return a.runWebGLProgram(c,[r],r.dtype)}}});var aqe,cqe,sge,ige=b(()=>{"use strict";$();$t();aqe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,cqe=_t({opSnippet:aqe}),sge={kernelName:Pu,backendName:"webgl",kernelFunc:cqe}});var uqe,lqe,age,cge=b(()=>{"use strict";$();$t();rr();uqe="return inversesqrt(x);",lqe=_t({opSnippet:uqe,cpuKernelImpl:Hue}),age={kernelName:Fu,backendName:"webgl",kernelFunc:lqe}});var kb,LB=b(()=>{"use strict";Kr();kb=class{constructor(t,e,r,o,s,i,a=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;let c=Xt(s.length),l=Xt(i.length),p="";r===1?p="i":r===2&&(p="i, j");let f=`getIndices(${p})`,y="";o===1?y="i":o===2&&(y="i, coords[1]");let d=`getUpdates(${y})`,h=e>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${s});

        void main() {
          ${l} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${t}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${e}; j++) {
              int index = round(${f});
              flattenedIndex += index * ${h};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${d};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}});function pqe(n){let{inputs:t,backend:e,attrs:r}=n,{indices:o,updates:s}=t,{shape:i}=r,{sliceRank:a,numUpdates:c,sliceSize:l,strides:p,outputSize:f}=H.calculateShapes(s,o,i),y=[f/l,l];if(f===0)return e.makeTensorInfo(i,o.dtype);let d=ut({inputs:{x:o},backend:e,attrs:{shape:[c,a]}}),h=ut({inputs:{x:s},backend:e,attrs:{shape:[c,l]}}),m=e.makeTensorInfo([],"float32",new Float32Array([0])),x=new kb(c,a,d.shape.length,h.shape.length,p,y),w=e.runWebGLProgram(x,[h,d,m],h.dtype),_=ut({inputs:{x:w},backend:e,attrs:{shape:i}});return e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(w),e.disposeIntermediateTensorInfo(m),_}var uge,lge=b(()=>{"use strict";$();LB();ir();uge={kernelName:Om,backendName:"webgl",kernelFunc:pqe}});var Bk,pge=b(()=>{"use strict";Kr();Bk=class{constructor(t,e,r){this.variableNames=["c","a","b"],this.outputShape=e;let o,s;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)s="resRC",o="resRC";else{let a=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],l=[];for(let p=0;p<e.length;p++)l.push(`${a[p]}`),p<t&&c.push(`${a[p]}`);o=c.join(),s=l.join()}let i=Xt(r);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${o});
        if (cVal >= 1.0) {
          setOutput(getA(${s}));
        } else {
          setOutput(getB(${s}));
        }
      }
    `}}});function hqe(n){let{inputs:t,backend:e}=n,{condition:r,t:o,e:s}=t,i=new Bk(r.shape.length,o.shape,o.shape.length);return e.runWebGLProgram(i,[r,o,s],ro(o.dtype,s.dtype))}var hge,fge=b(()=>{"use strict";$();pge();hge={kernelName:Bp,backendName:"webgl",kernelFunc:hqe}});var fqe,dqe,dge,mge=b(()=>{"use strict";$();$t();fqe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${H.SELU_SCALEALPHA};
  float scale = ${H.SELU_SCALE};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,dqe=_t({opSnippet:fqe}),dge={kernelName:$u,backendName:"webgl",kernelFunc:dqe}});var mqe,gqe,gge,yge=b(()=>{"use strict";$();$t();mqe="return 1.0 / (1.0 + exp(-1.0 * x));",gqe=_t({opSnippet:mqe}),gge={kernelName:Vu,backendName:"webgl",kernelFunc:gqe}});var yqe,xqe,xge,vge=b(()=>{"use strict";$();$t();yqe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,xqe=_t({opSnippet:yqe}),xge={kernelName:Bu,backendName:"webgl",kernelFunc:xqe}});var vqe,bqe,bge,wge=b(()=>{"use strict";$();$t();vqe=ED+`
  return sin(x);
`,bqe=_t({opSnippet:vqe}),bge={kernelName:Lu,backendName:"webgl",kernelFunc:bqe}});var wqe,Sqe,Sge,Cge=b(()=>{"use strict";$();$t();wqe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Sqe=_t({opSnippet:wqe}),Sge={kernelName:zu,backendName:"webgl",kernelFunc:Sqe}});var Cqe,_qe,_ge,Tge=b(()=>{"use strict";$();$t();Cqe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,_qe=_t({opSnippet:Cqe}),_ge={kernelName:qu,backendName:"webgl",kernelFunc:_qe}});var Tqe,Ige,Ege=b(()=>{"use strict";$();PB();ir();Ji();Tqe=n=>{let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{blockShape:s,paddings:i}=r;N.assert(o.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let a=s.reduce((w,_)=>w*_),c=[[0,0]];c.push(...i);for(let w=1+s.length;w<o.shape.length;++w)c.push([0,0]);let l=[],p=RB({inputs:{x:o},backend:e,attrs:{paddings:c,constantValue:0}}),f=H.getReshaped(p.shape,s,a,!1),y=H.getPermuted(f.length,s.length,!1),d=H.getReshapedPermuted(p.shape,s,a,!1),h=ut({inputs:{x:p},backend:e,attrs:{shape:f}}),m=kr({inputs:{x:h},backend:e,attrs:{perm:y}}),x=ut({inputs:{x:m},backend:e,attrs:{shape:d}});return l.push(p),l.push(h),l.push(m),l.forEach(w=>e.disposeIntermediateTensorInfo(w)),x},Ige={kernelName:Up,backendName:"webgl",kernelFunc:Tqe}});function Iqe(n){let{inputs:t,backend:e,attrs:r}=n,{sparseIndices:o,sparseValues:s,defaultValue:i}=t,{outputShape:a}=r,{sliceRank:c,numUpdates:l,strides:p,outputSize:f}=H.calculateShapes(s,o,a),y=!1,d=new kb(l,c,o.shape.length,s.shape.length,p,[f,1],y),h=e.runWebGLProgram(d,[s,o,i],s.dtype),m=ut({inputs:{x:h},backend:e,attrs:{shape:a}});return e.disposeIntermediateTensorInfo(h),m}var Nge,Dge=b(()=>{"use strict";$();LB();ir();Nge={kernelName:Rm,backendName:"webgl",kernelFunc:Iqe}});function Eqe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{numOrSizeSplits:s,axis:i}=r,a=N.parseAxisParam(i,o.shape)[0],c=H.prepareSplitSize(o,s,a),l=o.shape.length,p=new Array(l).fill(0),f=o.shape.slice();return c.map(y=>{let d=[...f];d[a]=y;let h=Th({inputs:{x:o},backend:e,attrs:{begin:p,size:d}});return p[a]+=y,h})}var kge,Age=b(()=>{"use strict";$();_b();kge={kernelName:jp,backendName:"webgl",kernelFunc:Eqe}});var Nqe,Dqe,Oge,Mge=b(()=>{"use strict";$();$t();Nqe="return sqrt(x);",Dqe=_t({opSnippet:Nqe}),Oge={kernelName:Uu,backendName:"webgl",kernelFunc:Dqe}});var kqe,Aqe,Rge,Pge=b(()=>{"use strict";$();$t();kqe="return x * x;",Aqe=_t({opSnippet:kqe}),Rge={kernelName:Mm,backendName:"webgl",kernelFunc:Aqe}});var Fge,Oqe,$ge,Lge=b(()=>{"use strict";$();$t();Fge="return (a - b) * (a - b);",Oqe=kn({opSnippet:Fge,packedOpSnippet:Fge}),$ge={kernelName:ju,backendName:"webgl",kernelFunc:Oqe}});function Mqe({inputs:n,attrs:t,backend:e}){let{x:r}=n,o=Ao+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,s=new js(r.shape,o);return e.runWebGLProgram(s,[r],r.dtype)}var zge,Bge=b(()=>{"use strict";$();Is();zge={kernelName:Ku,backendName:"webgl",kernelFunc:Mqe}});var Vk,Vge=b(()=>{"use strict";Kr();Vk=class{constructor(t,e,r){this.variableNames=["x"],this.outputShape=r;let o=r.length,s=Xt(r.length),i=Xt(r.length),a="";if(o===1)a="coords * strides + begin";else{let c=0;a=r.map((l,p)=>(c++,r.length===1?`coords * strides[${p}] + begin[${p}]`:`coords[${c-1}] * strides[${p}] + begin[${p}]`)).join(",")}this.userCode=`
      ${s} begin = ${s}(${t});
      ${s} strides = ${s}(${e});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}});function Rqe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{begin:s,end:i,strides:a,beginMask:c,endMask:l,ellipsisMask:p,newAxisMask:f,shrinkAxisMask:y}=r,{nonStrided:d,$begin:h,$strides:m,size:x,newShape:w,outShape:_}=Fo.sliceInfo(o.shape,s,i,a,c,l,p,f,y),I=ut({inputs:{x:o},backend:e,attrs:{shape:w}}),T;if(d){let O=Th({inputs:{x:I},backend:e,attrs:{begin:h,size:x}});T=ut({inputs:{x:O},backend:e,attrs:{shape:_}}),e.disposeIntermediateTensorInfo(O)}else if(_.some(O=>O===0))T=e.makeTensorInfo(_,o.dtype,[]);else if(e.shouldExecuteOnCPU([I])){let P=e.texData.get(I.dataId).values,j=It(I.shape,I.dtype,P),G=Xue(_,j,m,h);T=e.makeTensorInfo(_,I.dtype,G.values)}else{let R=new Vk(h,m,_);T=e.runWebGLProgram(R,[I],I.dtype)}let D=ut({inputs:{x:T},backend:e,attrs:{shape:_}});return e.disposeIntermediateTensorInfo(I),e.disposeIntermediateTensorInfo(T),D}var qge,Uge=b(()=>{"use strict";$();rr();Vge();ir();_b();qge={kernelName:Pm,backendName:"webgl",kernelFunc:Rqe}});var Pqe,Fqe,jge,Gge=b(()=>{"use strict";$();$t();Pqe="return tan(x);",Fqe=_t({opSnippet:Pqe}),jge={kernelName:Wu,backendName:"webgl",kernelFunc:Fqe}});var $qe,Lqe,Wge,Hge=b(()=>{"use strict";$();$t();$qe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,Lqe=_t({opSnippet:$qe}),Wge={kernelName:Hu,backendName:"webgl",kernelFunc:Lqe}});function zqe(n){let t=n.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${n[0]})`;let e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let o=0;o<n.length;o++)r.push(`imod(${e[o]}, ${n[o]})`);return r.join()}var qk,Kge=b(()=>{"use strict";Kr();qk=class{constructor(t,e){this.variableNames=["A"];let r=new Array(t.length);for(let i=0;i<r.length;i++)r[i]=t[i]*e[i];this.outputShape=r,this.rank=r.length;let o=Xt(this.rank),s=zqe(t);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        setOutput(getA(${s}));
      }
    `}}});function zB(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{reps:s}=r;if(o.dtype==="string"){let l=e.readSync(o.dataId).map(y=>N.decodeString(y)),p=It(o.shape,o.dtype,l),f=Yue(p,s);return e.makeTensorInfo(f.shape,f.dtype,f.values)}let i=new qk(o.shape,s);return e.runWebGLProgram(i,[o],o.dtype)}var Xge,BB=b(()=>{"use strict";$();rr();Kge();Xge={kernelName:pc,backendName:"webgl",kernelFunc:zB}});function Bqe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o}=t,{k:s,sorted:i}=r,a=e.readSync(o.dataId),[c,l]=Zue(a,o.shape,o.dtype,s,i);return[e.makeTensorInfo(c.shape,c.dtype,c.values),e.makeTensorInfo(l.shape,l.dtype,l.values)]}var Qge,Yge=b(()=>{"use strict";$();rr();Qge={kernelName:Fm,backendName:"webgl",kernelFunc:Bqe}});function Vqe(n){let{inputs:t,attrs:e,backend:r}=n,{axis:o}=e,{x:s}=t;Ol(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let i=r.readSync(s.dataId),{outputValues:a,outputShape:c,indices:l}=Jue(i,o,s.shape,s.dtype);return[r.makeTensorInfo(c,s.dtype,a),r.makeTensorInfo([l.length],"int32",l)]}var Zge,Jge=b(()=>{"use strict";$();rr();Qi();Zge={kernelName:$m,backendName:"webgl",kernelFunc:Vqe}});function qqe(n){let{inputs:t,backend:e,attrs:r}=n,{value:o}=t,{axis:s}=r;s<0&&(s+=o.shape.length);let i=o,a=i.shape.length,c=o.shape[s],l=new Array(a-1),p=0;for(let m=0;m<a;m++)m!==s&&(l[p++]=i.shape[m]);let f=[],y=new Array(a).fill(0),d=i.shape.slice();d[s]=1;let h=new Array(c);for(let m=0;m<h.length;m++){y[s]=m;let x=Th({inputs:{x:i},backend:e,attrs:{begin:y,size:d}}),w=ut({inputs:{x},backend:e,attrs:{shape:l}});h[m]=w,f.push(x)}return f.forEach(m=>e.disposeIntermediateTensorInfo(m)),h}var eye,tye=b(()=>{"use strict";$();ir();_b();eye={kernelName:Hp,backendName:"webgl",kernelFunc:qqe}});var Uk,nye=b(()=>{"use strict";Uk=class{constructor(t,e){this.variableNames=["x","segmentIds"];let r=t.windowSize,o=t.batchSize,s=t.inSize,i=t.numSegments,a=i*Math.ceil(s/r);this.outputShape=[o,a];let c="0.0",l="sumValue",p=Math.floor(r/4)*4,f=r%4,y=`
        sumValue += dot(values, segFilter);
    `,d="";s%r>0&&(d=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `);let h="";s%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${c};

      float getValue(int batch, int inIdx) {
        ${d}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${h}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${p}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${y}
        }

        int inIdx = inOffset + ${p};
        if (${f===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${y}
        } else if (${f===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${y}
        } else if (${f===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${y}
        }
        setOutput(${l});
      }
    `}}});function Uqe(n){let{inputs:t,backend:e,attrs:r}=n,{x:o,segmentIds:s}=t,{numSegments:i}=r,a=o.shape.length,c=[],l=0,p=H.getAxesPermutation([l],a),f=o;p!=null&&(f=kr({inputs:{x:o},backend:e,attrs:{perm:p}}),c.push(f),l=H.getInnerMostAxes(1,a)[0]);let y=H.segment_util.computeOutShape(f.shape,l,i),d=N.sizeFromShape([f.shape[l]]),h=ut({inputs:{x:f},backend:e,attrs:{shape:[-1,d]}});c.push(h);let m=df(o.dtype),x=(T,D,O,R,P)=>{let j=T.shape[0],G=T.shape[1],Q=H.segment_util.segOpComputeOptimalWindowSize(G,P),ie={windowSize:Q,inSize:G,batchSize:j,numSegments:P},pe=new Uk(ie,D),xe=e.compileAndRun(pe,[T,O],R);if(c.push(xe),xe.shape[1]===P)return xe;let ne=FB({backend:e,attrs:{start:0,stop:P,step:1,dtype:"float32"}}),fe=zB({inputs:{x:ne},backend:e,attrs:{reps:[G/Q]}});return c.push(ne),c.push(fe),x(xe,D,fe,R,P)},w=x(h,"unsortedSegmentSum",s,m,i),_=ut({inputs:{x:w},backend:e,attrs:{shape:y}}),I=_;if(p!=null){c.push(_);let T=H.getUndoAxesPermutation(p);I=kr({inputs:{x:I},backend:e,attrs:{perm:T}})}return c.forEach(T=>e.disposeIntermediateTensorInfo(T)),I}var rye,oye=b(()=>{"use strict";$();nye();$B();ir();BB();Ji();rye={kernelName:Kp,backendName:"webgl",kernelFunc:Uqe}});var jqe,sye=b(()=>{"use strict";$();Ble();Ule();Gle();Hle();Qle();epe();npe();ope();lpe();hpe();dpe();gpe();xpe();bpe();Spe();_pe();Ipe();Npe();kpe();Ope();Fpe();Vpe();Upe();Xpe();Zpe();nhe();_h();ihe();mB();mhe();yhe();vhe();whe();Che();The();Ehe();Dhe();Ohe();$he();zhe();qhe();jhe();Whe();Khe();Yhe();efe();nfe();ofe();ife();cfe();wB();SB();dfe();yfe();mk();Sfe();Tfe();Efe();Afe();Mfe();Pfe();Lfe();Vfe();Ufe();Gfe();Zi();Hfe();WS();Xfe();Yfe();Jfe();Zz();tde();rde();sde();ade();ude();pde();fde();mde();vde();Sde();TB();Ede();Dde();Ade();Mde();Pde();zde();Ude();Gde();Hde();Yde();Jde();ime();iB();ume();pme();fme();mme();hB();xme();Sme();_me();PB();Dme();tB();Ame();$B();Tb();NB();Rme();Fme();Lme();ir();qme();Gme();Kme();Yme();tge();oge();ige();cge();lge();fge();mge();yge();vge();wge();Cge();_b();OB();Tge();Ege();Dge();Age();Mge();Pge();Lge();Bge();Uge();kB();AD();Gge();Hge();BB();Yge();Ji();Jge();tye();oye();MB();jqe=[xde,wde,zle,qle,jle,Wle,Xle,Jle,tpe,rpe,upe,ppe,fpe,mpe,vpe,ype,wpe,Tpe,Cpe,Epe,Dpe,Ape,Ppe,Bpe,qpe,Kpe,Ype,the,she,wle,hhe,ghe,xhe,dhe,She,_he,bhe,Ihe,Nhe,Ahe,Fhe,Lhe,Vhe,Ghe,Hhe,Uhe,Qhe,Jhe,tfe,rfe,sfe,afe,lfe,pfe,ffe,gfe,vfe,wfe,_fe,Ife,kfe,Ofe,Rfe,$fe,Bfe,qfe,jfe,ble,Wfe,uhe,Kfe,Qfe,Zfe,Sle,ede,nde,ode,cde,ide,lde,hde,dde,Tde,kde,Nde,Ode,Rde,Lde,Ide,qde,jde,Wde,Qde,Zde,sme,Ele,cme,lme,hme,dme,jpe,yme,wme,Cme,Eme,Nme,Cle,kme,Ome,Gpe,tme,Mme,$me,Pme,kle,Vme,jme,Hme,Qme,ege,rge,sge,age,uge,hge,dge,gge,xge,bge,Sge,zpe,ome,_ge,Ige,Nge,kge,Oge,Rge,$ge,zge,qge,rme,$le,jge,Wge,Xge,Qge,Lle,Zge,eye,rye,vme];for(let n of jqe)_x(n)});var VB=b(()=>{"use strict";vle();sye();});var iye,aye=b(()=>{"use strict";iye="2.8.6"});var qB={};xn(qB,{Abs:()=>np,Acos:()=>ru,Acosh:()=>ou,AdadeltaOptimizer:()=>F0,AdagradOptimizer:()=>$0,AdamOptimizer:()=>L0,AdamaxOptimizer:()=>z0,Add:()=>ma,AddN:()=>rp,All:()=>Qd,Any:()=>Yd,ArgMax:()=>op,ArgMin:()=>sp,Asin:()=>su,Asinh:()=>iu,Atan:()=>au,Atan2:()=>uu,Atanh:()=>cu,AvgPool:()=>ip,AvgPool3D:()=>ap,AvgPool3DGrad:()=>Jd,AvgPoolGrad:()=>Zd,BatchMatMul:()=>cp,BatchToSpaceND:()=>up,Bincount:()=>em,BroadcastTo:()=>vR,Callback:()=>gS,CallbackList:()=>X0,Cast:()=>lc,Ceil:()=>lu,ClipByValue:()=>pu,Complex:()=>tm,ComplexAbs:()=>lp,Concat:()=>pp,Conv2D:()=>hp,Conv2DBackpropFilter:()=>nm,Conv2DBackpropInput:()=>fp,Conv3D:()=>dp,Conv3DBackpropFilterV2:()=>rm,Conv3DBackpropInputV2:()=>om,Cos:()=>hu,Cosh:()=>fu,CropAndResize:()=>sm,Cumsum:()=>mp,CustomCallback:()=>Y0,DataStorage:()=>ef,DenseBincount:()=>im,DepthToSpace:()=>am,DepthwiseConv2dNative:()=>gp,DepthwiseConv2dNativeBackpropFilter:()=>cm,DepthwiseConv2dNativeBackpropInput:()=>um,Diag:()=>lm,Dilation2D:()=>yp,Dilation2DBackpropFilter:()=>wx,Dilation2DBackpropInput:()=>bx,ENV:()=>hI,EarlyStopping:()=>yS,Elu:()=>mu,EluGrad:()=>pm,Environment:()=>vx,Equal:()=>tf,Erf:()=>gu,Exp:()=>yu,ExpandDims:()=>xp,Expm1:()=>xu,FFT:()=>hm,Fill:()=>fm,FlipLeftRight:()=>dm,Floor:()=>vu,FloorDiv:()=>bu,FromPixels:()=>Sx,FusedBatchNorm:()=>vp,FusedConv2D:()=>pf,FusedDepthwiseConv2D:()=>hf,GatherNd:()=>mm,GatherV2:()=>bp,GraphModel:()=>SS,Greater:()=>nf,GreaterEqual:()=>wu,History:()=>Q0,IFFT:()=>gm,Identity:()=>wp,Imag:()=>ym,InputSpec:()=>nr,IsFinite:()=>Su,IsInf:()=>Cu,IsNan:()=>_u,KernelBackend:()=>eu,LRN:()=>Cp,LRNGrad:()=>vm,LayerVariable:()=>$v,LayersModel:()=>Oa,LeakyRelu:()=>Sp,Less:()=>rf,LessEqual:()=>of,LinSpace:()=>xm,Log:()=>Tu,Log1p:()=>Iu,LogSoftmax:()=>bR,LogicalAnd:()=>sf,LogicalNot:()=>af,LogicalOr:()=>cf,Max:()=>_p,MaxPool:()=>Tp,MaxPool3D:()=>Ip,MaxPool3DGrad:()=>wm,MaxPoolGrad:()=>bm,MaxPoolWithArgmax:()=>Sm,Maximum:()=>Eu,Mean:()=>Ep,Min:()=>Np,Minimum:()=>Nu,MirrorPad:()=>Dp,Mod:()=>Du,MomentumOptimizer:()=>B0,Multinomial:()=>Cm,Multiply:()=>ku,Neg:()=>kp,NonMaxSuppressionV3:()=>_m,NonMaxSuppressionV4:()=>Tm,NonMaxSuppressionV5:()=>Im,NotEqual:()=>uf,OP_SCOPE_SUFFIX:()=>kR,OneHot:()=>Op,OnesLike:()=>Ap,Optimizer:()=>Bo,Pack:()=>Mp,PadV2:()=>Rp,Pool:()=>oIe,Pow:()=>Au,Prelu:()=>Pp,Prod:()=>Em,RMSPropOptimizer:()=>V0,RNN:()=>Ec,Range:()=>Nm,Rank:()=>TR,Real:()=>Dm,RealDiv:()=>du,Reciprocal:()=>Ou,Reduction:()=>Lr,Relu:()=>Mu,Relu6:()=>Ru,Reshape:()=>Fp,ResizeBilinear:()=>Lp,ResizeBilinearGrad:()=>Am,ResizeNearestNeighbor:()=>$p,ResizeNearestNeighborGrad:()=>km,Reverse:()=>zp,RotateWithOffset:()=>Lm,Round:()=>Pu,Rsqrt:()=>Fu,SGDOptimizer:()=>hg,ScatterNd:()=>Om,Select:()=>Bp,Selu:()=>$u,Sequential:()=>iS,Sigmoid:()=>Vu,Sign:()=>Bu,Sin:()=>Lu,Sinh:()=>zu,Slice:()=>Vp,Softmax:()=>Gp,Softplus:()=>qu,SpaceToBatchND:()=>Up,SparseToDense:()=>Rm,SplitV:()=>jp,Sqrt:()=>Uu,Square:()=>Mm,SquaredDifference:()=>ju,Step:()=>Ku,StridedSlice:()=>Pm,Sub:()=>Gu,Sum:()=>qp,SymbolicTensor:()=>ts,Tan:()=>Wu,Tanh:()=>Hu,Tensor:()=>K,TensorBuffer:()=>Dn,Tile:()=>pc,TopK:()=>Fm,Transpose:()=>Wp,Unique:()=>$m,Unpack:()=>Hp,UnsortedSegmentSum:()=>Kp,Variable:()=>Qu,ZerosLike:()=>Xp,_FusedMatMul:()=>lf,abs:()=>Jn,acos:()=>Fx,acosh:()=>$x,add:()=>je,addN:()=>LI,addStrict:()=>aP,all:()=>vf,any:()=>th,argMax:()=>nh,argMin:()=>Lx,asin:()=>zx,asinh:()=>Bx,atan:()=>Vx,atan2:()=>qx,atanh:()=>Ux,avgPool:()=>tl,avgPool3d:()=>Gx,backend:()=>a2,backend_util:()=>H,basicLSTMCell:()=>WH,batchNorm:()=>Ui,batchNorm2d:()=>VI,batchNorm3d:()=>qI,batchNorm4d:()=>UI,batchToSpaceND:()=>nl,bincount:()=>jI,booleanMaskAsync:()=>UDe,broadcastTo:()=>rh,browser:()=>p0,buffer:()=>It,callbacks:()=>Eee,cast:()=>Ye,ceil:()=>Hx,clipByValue:()=>oo,clone:()=>bi,complex:()=>Xs,concat:()=>gn,concat1d:()=>WI,concat2d:()=>HI,concat3d:()=>KI,concat4d:()=>XI,constraints:()=>JP,conv1d:()=>bf,conv2d:()=>vs,conv2dTranspose:()=>wf,conv3d:()=>Xx,conv3dTranspose:()=>a5,copyRegisteredKernels:()=>aIe,cos:()=>rl,cosh:()=>Sf,cosineWindow:()=>M0,cumsum:()=>Cf,customGrad:()=>ws,data:()=>r3,denseBincount:()=>e1,deprecationWarn:()=>Pr,depthToSpace:()=>Qx,depthwiseConv2d:()=>Si,deregisterOp:()=>Oee,device_util:()=>mf,diag:()=>l5,dilation2d:()=>Zx,disableDeprecationWarnings:()=>g1e,dispose:()=>Mt,disposeVariables:()=>y1e,div:()=>ct,divNoNan:()=>ev,divStrict:()=>cP,dot:()=>t1,dropout:()=>xP,elu:()=>xa,enableDebugMode:()=>m1e,enableProdMode:()=>d1e,enclosingPowerOfTwo:()=>vP,engine:()=>eh,env:()=>Te,equal:()=>bs,equalStrict:()=>tP,erf:()=>tv,exp:()=>Wr,expandDims:()=>Io,expm1:()=>nv,eye:()=>Qm,fft:()=>dl,fill:()=>sl,findBackend:()=>C1e,findBackendFactory:()=>_1e,floor:()=>va,floorDiv:()=>xf,fused:()=>Gi,gather:()=>ji,gatherND:()=>yP,gather_util:()=>JR,getBackend:()=>w1e,getGradient:()=>fI,getKernel:()=>n0,getKernelsForBackend:()=>r0,grad:()=>x5,grads:()=>v5,greater:()=>Fr,greaterEqual:()=>Yo,greaterEqualStrict:()=>nP,greaterStrict:()=>rP,ifft:()=>gc,imag:()=>If,image:()=>bc,inTopKAsync:()=>dke,initializers:()=>hF,input:()=>FE,io:()=>Po,irfft:()=>zf,isFinite:()=>i1,isInf:()=>a1,isNaN:()=>c1,keep:()=>ur,kernel_impls:()=>Vo,layers:()=>R$,leakyRelu:()=>al,less:()=>cl,lessEqual:()=>Rs,lessEqualStrict:()=>oP,lessStrict:()=>sP,linalg:()=>EP,linspace:()=>l1,loadGraphModel:()=>Xte,loadLayersModel:()=>JJ,localResponseNormalization:()=>rv,log:()=>so,log1p:()=>Nf,logSigmoid:()=>h1,logSoftmax:()=>Df,logSumExp:()=>iv,logicalAnd:()=>vo,logicalNot:()=>ul,logicalOr:()=>kf,logicalXor:()=>m1,losses:()=>rAe,matMul:()=>an,math:()=>YR,max:()=>io,maxPool:()=>ll,maxPool3d:()=>av,maxPoolWithArgmax:()=>y1,maximum:()=>$o,maximumStrict:()=>uP,mean:()=>Un,memory:()=>Px,metrics:()=>P$,min:()=>mc,minimum:()=>_i,minimumStrict:()=>lP,mirrorPad:()=>uv,mod:()=>Af,modStrict:()=>pP,model:()=>YJ,models:()=>F$,moments:()=>Zm,movingAverage:()=>ake,mul:()=>oe,mulStrict:()=>hP,multiRNNCell:()=>N5,multinomial:()=>b1,neg:()=>un,nextFrame:()=>Dv,norm:()=>ig,notEqual:()=>Zs,notEqualStrict:()=>iP,oneHot:()=>ga,ones:()=>Lo,onesLike:()=>Yr,op:()=>z,outerProduct:()=>O5,pad:()=>Jo,pad1d:()=>R5,pad2d:()=>F5,pad3d:()=>L5,pad4d:()=>B5,pool:()=>w1,pow:()=>Eo,powStrict:()=>fP,prelu:()=>hl,print:()=>TI,prod:()=>Mf,profile:()=>x1e,rand:()=>q5,randomGamma:()=>s8,randomNormal:()=>N0,randomUniform:()=>Sa,range:()=>ng,ready:()=>b1e,real:()=>ih,reciprocal:()=>pv,registerBackend:()=>f0,registerCallbackConstructor:()=>eee,registerGradient:()=>wR,registerKernel:()=>_x,registerOp:()=>Aee,regularizers:()=>$$,relu:()=>zo,relu6:()=>Rf,removeBackend:()=>S1e,reshape:()=>ue,reverse:()=>$r,reverse1d:()=>u8,reverse2d:()=>p8,reverse3d:()=>f8,reverse4d:()=>m8,rfft:()=>ml,round:()=>fv,rsqrt:()=>Pf,scalar:()=>it,scatterND:()=>gP,scatter_util:()=>AI,selu:()=>Ff,separableConv2d:()=>dv,sequential:()=>ZJ,serialization:()=>He,setBackend:()=>PH,setPlatform:()=>T1e,setdiff1dAsync:()=>k1,sigmoid:()=>xs,sign:()=>mv,signal:()=>nAe,sin:()=>$f,sinh:()=>Lf,slice:()=>Bt,slice1d:()=>gv,slice2d:()=>D0,slice3d:()=>yv,slice4d:()=>rg,slice_util:()=>Fo,softmax:()=>fl,softplus:()=>ba,spaceToBatchND:()=>pl,sparseToDense:()=>O0,spectral:()=>tAe,split:()=>co,sqrt:()=>jn,square:()=>Gt,squaredDifference:()=>gl,squaredDifferenceStrict:()=>dP,squeeze:()=>Js,stack:()=>Ir,step:()=>Ca,stridedSlice:()=>bv,sub:()=>at,subStrict:()=>mP,sum:()=>gt,sumOutType:()=>df,tan:()=>wv,tanh:()=>fc,tensor:()=>Qo,tensor1d:()=>Er,tensor2d:()=>xc,tensor3d:()=>DI,tensor4d:()=>E8,tensor5d:()=>D8,tensor6d:()=>A8,tensor_util:()=>Bi,test_util:()=>i2,tidy:()=>de,tile:()=>Ci,time:()=>v1e,topk:()=>Cv,train:()=>qf,transpose:()=>pn,truncatedNormal:()=>Bf,unique:()=>sg,unregisterGradient:()=>iIe,unregisterKernel:()=>sIe,unsortedSegmentSum:()=>_v,unstack:()=>uo,upcastType:()=>ro,util:()=>N,valueAndGrad:()=>b5,valueAndGrads:()=>w5,variable:()=>F1,variableGrads:()=>b0,version:()=>Gqe,version_converter:()=>gN,version_core:()=>FI,version_layers:()=>Hf,where:()=>pr,whereAsync:()=>Iv,zeros:()=>An,zerosLike:()=>Et});var Gqe,UB=b(()=>{"use strict";$();L$();lL();o3();Az();VB();$();Az();VB();o3();L$();lL();aye();Gqe={"tfjs-core":FI,"tfjs-backend-cpu":X3,"tfjs-backend-webgl":Xz,"tfjs-data":RN,"tfjs-layers":Hf,"tfjs-converter":gN,tfjs:iye}});var lye={};var jB=b(()=>{"use strict";(function(n,t){typeof exports=="object"&&typeof module=="object"?module.exports=t():typeof define=="function"&&define.amd?define([],t):typeof exports=="object"?exports.Tone=t():n.Tone=t()})(typeof self<"u"?self:void 0,()=>(()=>{var n={382:function(o,s,i){(function(a,c,l,p){"use strict";var f=function(ne,fe,te){return{endTime:fe,insertTime:te,type:"exponentialRampToValue",value:ne}},y=function(ne,fe,te){return{endTime:fe,insertTime:te,type:"linearRampToValue",value:ne}},d=function(ne,fe){return{startTime:fe,type:"setValue",value:ne}},h=function(ne,fe,te){return{duration:te,startTime:fe,type:"setValueCurve",values:ne}},m=function(ne,fe,te){var se=te.startTime,ee=te.target,we=te.timeConstant;return ee+(fe-ee)*Math.exp((se-ne)/we)},x=function(ne){return ne.type==="exponentialRampToValue"},w=function(ne){return ne.type==="linearRampToValue"},_=function(ne){return x(ne)||w(ne)},I=function(ne){return ne.type==="setValue"},T=function(ne){return ne.type==="setValueCurve"},D=function ne(fe,te,se,ee){var we=fe[te];return we===void 0?ee:_(we)||I(we)?we.value:T(we)?we.values[we.values.length-1]:m(se,ne(fe,te-1,we.startTime,ee),we)},O=function(ne,fe,te,se,ee){return te===void 0?[se.insertTime,ee]:_(te)?[te.endTime,te.value]:I(te)?[te.startTime,te.value]:T(te)?[te.startTime+te.duration,te.values[te.values.length-1]]:[te.startTime,D(ne,fe-1,te.startTime,ee)]},R=function(ne){return ne.type==="cancelAndHold"},P=function(ne){return ne.type==="cancelScheduledValues"},j=function(ne){return R(ne)||P(ne)?ne.cancelTime:x(ne)||w(ne)?ne.endTime:ne.startTime},G=function(ne,fe,te,se){var ee=se.endTime,we=se.value;return te===we?we:0<te&&0<we||te<0&&we<0?te*Math.pow(we/te,(ne-fe)/(ee-fe)):0},Q=function(ne,fe,te,se){return te+(ne-fe)/(se.endTime-fe)*(se.value-te)},ie=function(ne,fe){var te=fe.duration,se=fe.startTime,ee=fe.values;return function(we,be){var ke=Math.floor(be),De=Math.ceil(be);return ke===De?we[ke]:(1-(be-ke))*we[ke]+(1-(De-be))*we[De]}(ee,(ne-se)/te*(ee.length-1))},pe=function(ne){return ne.type==="setTarget"},xe=function(){return p(function ne(fe){l(this,ne),this._automationEvents=[],this._currenTime=0,this._defaultValue=fe},[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(ne){var fe=j(ne);if(R(ne)||P(ne)){var te=this._automationEvents.findIndex(function(Qe){return P(ne)&&T(Qe)?Qe.startTime+Qe.duration>=fe:j(Qe)>=fe}),se=this._automationEvents[te];if(te!==-1&&(this._automationEvents=this._automationEvents.slice(0,te)),R(ne)){var ee=this._automationEvents[this._automationEvents.length-1];if(se!==void 0&&_(se)){if(ee!==void 0&&pe(ee))throw new Error("The internal list is malformed.");var we=ee===void 0?se.insertTime:T(ee)?ee.startTime+ee.duration:j(ee),be=ee===void 0?this._defaultValue:T(ee)?ee.values[ee.values.length-1]:ee.value,ke=x(se)?G(fe,we,be,se):Q(fe,we,be,se),De=x(se)?f(ke,fe,this._currenTime):y(ke,fe,this._currenTime);this._automationEvents.push(De)}if(ee!==void 0&&pe(ee)&&this._automationEvents.push(d(this.getValue(fe),fe)),ee!==void 0&&T(ee)&&ee.startTime+ee.duration>fe){var Re=fe-ee.startTime,Ce=(ee.values.length-1)/ee.duration,Je=Math.max(2,1+Math.ceil(Re*Ce)),rt=Re/(Je-1)*Ce,qe=ee.values.slice(0,Je);if(rt<1)for(var B=1;B<Je;B+=1){var J=rt*B%1;qe[B]=ee.values[B-1]*(1-J)+ee.values[B]*J}this._automationEvents[this._automationEvents.length-1]=h(qe,ee.startTime,Re)}}}else{var Z=this._automationEvents.findIndex(function(Qe){return j(Qe)>fe}),le=Z===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[Z-1];if(le!==void 0&&T(le)&&j(le)+le.duration>fe)return!1;var Ge=x(ne)?f(ne.value,ne.endTime,this._currenTime):w(ne)?y(ne.value,fe,this._currenTime):ne;if(Z===-1)this._automationEvents.push(Ge);else{if(T(ne)&&fe+ne.duration>j(this._automationEvents[Z]))return!1;this._automationEvents.splice(Z,0,Ge)}}return!0}},{key:"flush",value:function(ne){var fe=this._automationEvents.findIndex(function(ee){return j(ee)>ne});if(fe>1){var te=this._automationEvents.slice(fe-1),se=te[0];pe(se)&&te.unshift(d(D(this._automationEvents,fe-2,se.startTime,this._defaultValue),se.startTime)),this._automationEvents=te}}},{key:"getValue",value:function(ne){if(this._automationEvents.length===0)return this._defaultValue;var fe=this._automationEvents.findIndex(function(qe){return j(qe)>ne}),te=this._automationEvents[fe],se=(fe===-1?this._automationEvents.length:fe)-1,ee=this._automationEvents[se];if(ee!==void 0&&pe(ee)&&(te===void 0||!_(te)||te.insertTime>ne))return m(ne,D(this._automationEvents,se-1,ee.startTime,this._defaultValue),ee);if(ee!==void 0&&I(ee)&&(te===void 0||!_(te)))return ee.value;if(ee!==void 0&&T(ee)&&(te===void 0||!_(te)||ee.startTime+ee.duration>ne))return ne<ee.startTime+ee.duration?ie(ne,ee):ee.values[ee.values.length-1];if(ee!==void 0&&_(ee)&&(te===void 0||!_(te)))return ee.value;if(te!==void 0&&x(te)){var we=O(this._automationEvents,se,ee,te,this._defaultValue),be=c(we,2),ke=be[0],De=be[1];return G(ne,ke,De,te)}if(te!==void 0&&w(te)){var Re=O(this._automationEvents,se,ee,te,this._defaultValue),Ce=c(Re,2),Je=Ce[0],rt=Ce[1];return Q(ne,Je,rt,te)}return this._defaultValue}}])}();a.AutomationEventList=xe,a.createCancelAndHoldAutomationEvent=function(ne){return{cancelTime:ne,type:"cancelAndHold"}},a.createCancelScheduledValuesAutomationEvent=function(ne){return{cancelTime:ne,type:"cancelScheduledValues"}},a.createExponentialRampToValueAutomationEvent=function(ne,fe){return{endTime:fe,type:"exponentialRampToValue",value:ne}},a.createLinearRampToValueAutomationEvent=function(ne,fe){return{endTime:fe,type:"linearRampToValue",value:ne}},a.createSetTargetAutomationEvent=function(ne,fe,te){return{startTime:fe,target:ne,timeConstant:te,type:"setTarget"}},a.createSetValueAutomationEvent=d,a.createSetValueCurveAutomationEvent=h})(s,i(424),i(690),i(728))},897:o=>{o.exports=function(s,i){(i==null||i>s.length)&&(i=s.length);for(var a=0,c=new Array(i);a<i;a++)c[a]=s[a];return c},o.exports.__esModule=!0,o.exports.default=o.exports},372:o=>{o.exports=function(s){if(Array.isArray(s))return s},o.exports.__esModule=!0,o.exports.default=o.exports},690:o=>{o.exports=function(s,i){if(!(s instanceof i))throw new TypeError("Cannot call a class as a function")},o.exports.__esModule=!0,o.exports.default=o.exports},728:(o,s,i)=>{var a=i(62);function c(l,p){for(var f=0;f<p.length;f++){var y=p[f];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(l,a(y.key),y)}}o.exports=function(l,p,f){return p&&c(l.prototype,p),f&&c(l,f),Object.defineProperty(l,"prototype",{writable:!1}),l},o.exports.__esModule=!0,o.exports.default=o.exports},872:o=>{o.exports=function(s,i){var a=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(a!=null){var c,l,p,f,y=[],d=!0,h=!1;try{if(p=(a=a.call(s)).next,i===0){if(Object(a)!==a)return;d=!1}else for(;!(d=(c=p.call(a)).done)&&(y.push(c.value),y.length!==i);d=!0);}catch(m){h=!0,l=m}finally{try{if(!d&&a.return!=null&&(f=a.return(),Object(f)!==f))return}finally{if(h)throw l}}return y}},o.exports.__esModule=!0,o.exports.default=o.exports},218:o=>{o.exports=function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},o.exports.__esModule=!0,o.exports.default=o.exports},424:(o,s,i)=>{var a=i(372),c=i(872),l=i(116),p=i(218);o.exports=function(f,y){return a(f)||c(f,y)||l(f,y)||p()},o.exports.__esModule=!0,o.exports.default=o.exports},36:(o,s,i)=>{var a=i(698).default;o.exports=function(c,l){if(a(c)!="object"||!c)return c;var p=c[Symbol.toPrimitive];if(p!==void 0){var f=p.call(c,l||"default");if(a(f)!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(c)},o.exports.__esModule=!0,o.exports.default=o.exports},62:(o,s,i)=>{var a=i(698).default,c=i(36);o.exports=function(l){var p=c(l,"string");return a(p)=="symbol"?p:p+""},o.exports.__esModule=!0,o.exports.default=o.exports},698:o=>{function s(i){return o.exports=s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},o.exports.__esModule=!0,o.exports.default=o.exports,s(i)}o.exports=s,o.exports.__esModule=!0,o.exports.default=o.exports},116:(o,s,i)=>{var a=i(897);o.exports=function(c,l){if(c){if(typeof c=="string")return a(c,l);var p=Object.prototype.toString.call(c).slice(8,-1);return p==="Object"&&c.constructor&&(p=c.constructor.name),p==="Map"||p==="Set"?Array.from(c):p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p)?a(c,l):void 0}},o.exports.__esModule=!0,o.exports.default=o.exports}},t={};function e(o){var s=t[o];if(s!==void 0)return s.exports;var i=t[o]={exports:{}};return n[o].call(i.exports,i,i.exports,e),i.exports}e.d=(o,s)=>{for(var i in s)e.o(s,i)&&!e.o(o,i)&&Object.defineProperty(o,i,{enumerable:!0,get:s[i]})},e.o=(o,s)=>Object.prototype.hasOwnProperty.call(o,s),e.r=o=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})};var r={};return(()=>{"use strict";e.r(r),e.d(r,{AMOscillator:()=>uy,AMSynth:()=>yA,Abs:()=>$V,Add:()=>Cd,AmplitudeEnvelope:()=>hy,Analyser:()=>Ty,AudioToGain:()=>dC,AutoFilter:()=>DC,AutoPanner:()=>kC,AutoWah:()=>AC,BaseContext:()=>pA,BiquadFilter:()=>dy,BitCrusher:()=>OC,Buffer:()=>Eve,BufferSource:()=>Dve,Buffers:()=>Nve,Channel:()=>Lh,Chebyshev:()=>RC,Chorus:()=>PC,Clock:()=>xd,Compressor:()=>Vc,Context:()=>Zg,Convolver:()=>o_,CrossFade:()=>Id,DCMeter:()=>SA,Delay:()=>li,Destination:()=>xve,Distortion:()=>FC,Draw:()=>Cve,DuoSynth:()=>bC,EQ3:()=>r_,Emitter:()=>Yg,Envelope:()=>Go,FFT:()=>QC,FMOscillator:()=>wd,FMSynth:()=>wC,FatOscillator:()=>ly,FeedbackCombFilter:()=>yy,FeedbackDelay:()=>LC,Filter:()=>pi,Follower:()=>_y,Freeverb:()=>BC,Frequency:()=>Xxe,FrequencyClass:()=>Ws,FrequencyEnvelope:()=>my,FrequencyShifter:()=>zC,Gain:()=>Dt,GainToAudio:()=>LV,Gate:()=>JC,GrainPlayer:()=>yC,GreaterThan:()=>jb,GreaterThanZero:()=>xC,IntervalTimeline:()=>MV,JCReverb:()=>VC,LFO:()=>Ds,Limiter:()=>e_,Listener:()=>wve,Loop:()=>wy,LowpassCombFilter:()=>vy,Master:()=>vve,MembraneSynth:()=>gy,Merge:()=>Ul,MetalSynth:()=>SC,Meter:()=>XC,MidSideCompressor:()=>t_,MidSideMerge:()=>Kb,MidSideSplit:()=>Hb,Midi:()=>Jxe,MidiClass:()=>sy,Mono:()=>CA,MonoSynth:()=>Ph,MultibandCompressor:()=>n_,MultibandSplit:()=>Iy,Multiply:()=>Mr,Negate:()=>gA,Noise:()=>zl,NoiseSynth:()=>CC,Offline:()=>Zxe,OfflineContext:()=>Jg,OmniOscillator:()=>Lc,OnePoleFilter:()=>xy,Oscillator:()=>Ns,PWMOscillator:()=>py,PanVol:()=>Xb,Panner:()=>Cy,Panner3D:()=>ZC,Param:()=>Yt,Part:()=>Sy,Pattern:()=>IC,Phaser:()=>jC,PingPongDelay:()=>qC,PitchShift:()=>UC,Player:()=>_d,Players:()=>gC,PluckSynth:()=>_C,PolySynth:()=>TC,Pow:()=>vd,PulseOscillator:()=>Sd,Recorder:()=>Qb,Reverb:()=>GC,Sampler:()=>by,Scale:()=>zc,ScaleExp:()=>Gb,Sequence:()=>EC,Signal:()=>zt,Solo:()=>eo,Split:()=>Fh,StateTimeline:()=>ny,StereoWidener:()=>WC,Subtract:()=>Td,SyncedSignal:()=>ove,Synth:()=>ql,Ticks:()=>eve,TicksClass:()=>Ur,Time:()=>Wxe,TimeClass:()=>ki,Timeline:()=>Di,ToneAudioBuffer:()=>Mn,ToneAudioBuffers:()=>oy,ToneAudioNode:()=>st,ToneBufferSource:()=>Ll,ToneEvent:()=>Za,ToneOscillatorNode:()=>cy,Transport:()=>gve,TransportTime:()=>Qxe,TransportTimeClass:()=>Co,Tremolo:()=>HC,Unit:()=>s,UserMedia:()=>ay,Vibrato:()=>KC,Volume:()=>$c,WaveShaper:()=>ia,Waveform:()=>YC,Zero:()=>mC,connect:()=>Hs,connectSeries:()=>Ai,connectSignal:()=>qb,context:()=>Tve,dbToGain:()=>ey,debug:()=>o,defaultArg:()=>sa,disconnect:()=>dA,fanIn:()=>Yxe,ftom:()=>Rh,gainToDb:()=>Bb,getContext:()=>Or,getDestination:()=>bve,getDraw:()=>_ve,getListener:()=>Sve,getTransport:()=>yve,immediate:()=>mve,intervalToFrequencyRatio:()=>ty,isArray:()=>cs,isBoolean:()=>sA,isDefined:()=>ln,isFunction:()=>_V,isNote:()=>$b,isNumber:()=>Ni,isObject:()=>Fl,isString:()=>Xa,isUndef:()=>ui,loaded:()=>Ive,mtof:()=>hA,now:()=>dve,optionsFromArguments:()=>ge,setContext:()=>aC,start:()=>Gxe,supported:()=>Bxe,version:()=>i});var o={};e.r(o),e.d(o,{assert:()=>Ot,assertContextRunning:()=>iA,assertRange:()=>us,assertUsedScheduleTime:()=>EV,enterScheduledCallback:()=>aA,log:()=>NV,setLogger:()=>Vxe,warn:()=>Kg});var s={};e.r(s);let i="14.9.17";var a=e(382);let c=new WeakSet,l=new WeakMap,p=new WeakMap,f=new WeakMap,y=new WeakMap,d=new WeakMap,h=new WeakMap,m=new WeakMap,x=new WeakMap,w=new WeakMap,_={construct:()=>_},I=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,T=(C,u)=>{let g=[],v=C.replace(/^[\s]+/,""),S=v.match(I);for(;S!==null;){let E=S[1].slice(1,-1),k=S[0].replace(/([\s]+)?;?$/,"").replace(E,new URL(E,u).toString());g.push(k),v=v.slice(S[0].length).replace(/^[\s]+/,""),S=v.match(I)}return[g.join(";"),v]},D=C=>{if(C!==void 0&&!Array.isArray(C))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},O=C=>{if(!(u=>{try{new new Proxy(u,_)}catch{return!1}return!0})(C))throw new TypeError("The given value for processorCtor should be a constructor.");if(C.prototype===null||typeof C.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},R=(C,u)=>{let g=C.get(u);if(g===void 0)throw new Error("A value with the given key could not be found.");return g},P=(C,u)=>{let g=Array.from(C).filter(u);if(g.length>1)throw Error("More than one element was found.");if(g.length===0)throw Error("No element was found.");let[v]=g;return C.delete(v),v},j=(C,u,g,v)=>{let S=R(C,u),E=P(S,k=>k[0]===g&&k[1]===v);return S.size===0&&C.delete(u),E},G=C=>R(h,C),Q=C=>{if(c.has(C))throw new Error("The AudioNode is already stored.");c.add(C),G(C).forEach(u=>u(!0))},ie=C=>"port"in C,pe=C=>{if(!c.has(C))throw new Error("The AudioNode is not stored.");c.delete(C),G(C).forEach(u=>u(!1))},xe=(C,u)=>{!ie(C)&&u.every(g=>g.size===0)&&pe(C)},ne={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},fe=(C,u)=>C.context===u,te=C=>{try{C.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},se=()=>new DOMException("","IndexSizeError"),ee=C=>{var u;C.getChannelData=(u=C.getChannelData,g=>{try{return u.call(C,g)}catch(v){throw v.code===12?se():v}})},we={numberOfChannels:1},be=-34028234663852886e22,ke=-be,De=C=>c.has(C),Re={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},Ce=C=>R(l,C),Je=C=>R(f,C),rt=(C,u)=>{let{activeInputs:g}=Ce(C);g.forEach(S=>S.forEach(([E])=>{u.includes(C)||rt(E,[...u,C])}));let v=(S=>"playbackRate"in S)(C)?[C.playbackRate]:ie(C)?Array.from(C.parameters.values()):(S=>"frequency"in S&&"gain"in S)(C)?[C.Q,C.detune,C.frequency,C.gain]:(S=>"offset"in S)(C)?[C.offset]:(S=>!("frequency"in S)&&"gain"in S)(C)?[C.gain]:(S=>"detune"in S&&"frequency"in S)(C)?[C.detune,C.frequency]:(S=>"pan"in S)(C)?[C.pan]:[];for(let S of v){let E=Je(S);E!==void 0&&E.activeInputs.forEach(([k])=>rt(k,u))}De(C)&&pe(C)},qe=C=>{rt(C.destination,[])},B=C=>"context"in C,J=C=>B(C[0]),Z=(C,u,g,v)=>{for(let S of C)if(g(S)){if(v)return!1;throw Error("The set contains at least one similar element.")}return C.add(u),!0},le=(C,u,[g,v],S)=>{Z(C,[u,g,v],E=>E[0]===u&&E[1]===g,S)},Ge=(C,[u,g,v],S)=>{let E=C.get(u);E===void 0?C.set(u,new Set([[g,v]])):Z(E,[g,v],k=>k[0]===g,S)},Qe=C=>"inputs"in C,dt=(C,u,g,v)=>{if(Qe(u)){let S=u.inputs[v];return C.connect(S,g,0),[S,g,0]}return C.connect(u,g,v),[u,g,v]},yt=(C,u,g)=>{for(let v of C)if(v[0]===u&&v[1]===g)return C.delete(v),v;return null},Vt=(C,u)=>{if(!G(C).delete(u))throw new Error("Missing the expected event listener.")},En=(C,u,g)=>{let v=R(C,u),S=P(v,E=>E[0]===g);return v.size===0&&C.delete(u),S},ss=(C,u,g,v)=>{Qe(u)?C.disconnect(u.inputs[v],g,0):C.disconnect(u,g,v)},tn=C=>R(p,C),So=C=>R(y,C),Ar=C=>m.has(C),ii=C=>!c.has(C),is=(C,u)=>new Promise(g=>{if(u!==null)g(!0);else{let v=C.createScriptProcessor(256,1,1),S=C.createGain(),E=C.createBuffer(1,2,44100),k=E.getChannelData(0);k[0]=1,k[1]=1;let M=C.createBufferSource();M.buffer=E,M.loop=!0,M.connect(v).connect(C.destination),M.connect(S),M.disconnect(S),v.onaudioprocess=L=>{let V=L.inputBuffer.getChannelData(0);Array.prototype.some.call(V,W=>W===1)?g(!0):g(!1),M.stop(),v.onaudioprocess=null,M.disconnect(v),v.disconnect(C.destination)},M.start()}}),Es=(C,u)=>{let g=new Map;for(let v of C)for(let S of v){let E=g.get(S);g.set(S,E===void 0?1:E+1)}g.forEach((v,S)=>u(S,v))},Xr=C=>"context"in C,ja=C=>{let u=new Map;C.connect=(g=>(v,S=0,E=0)=>{let k=Xr(v)?g(v,S,E):g(v,S),M=u.get(v);return M===void 0?u.set(v,[{input:E,output:S}]):M.every(L=>L.input!==E||L.output!==S)&&M.push({input:E,output:S}),k})(C.connect.bind(C)),C.disconnect=(g=>(v,S,E)=>{if(g.apply(C),v===void 0)u.clear();else if(typeof v=="number")for(let[k,M]of u){let L=M.filter(V=>V.output!==v);L.length===0?u.delete(k):u.set(k,L)}else if(u.has(v))if(S===void 0)u.delete(v);else{let k=u.get(v);if(k!==void 0){let M=k.filter(L=>L.output!==S&&(L.input!==E||E===void 0));M.length===0?u.delete(v):u.set(v,M)}}for(let[k,M]of u)M.forEach(L=>{Xr(k)?C.connect(k,L.output,L.input):C.connect(k,L.output)})})(C.disconnect)},ai=(C,u,g,v,S)=>{let[E,k]=((M,L,V,W)=>{let{activeInputs:X,passiveInputs:ce}=Ce(L),re=yt(X[W],M,V);return re===null?[j(ce,M,V,W)[2],!1]:[re[2],!0]})(C,g,v,S);if(E!==null&&(Vt(C,E),!k||u||Ar(C)||ss(tn(C),tn(g),v,S)),De(g)){let{activeInputs:M}=Ce(g);xe(g,M)}},Ga=(C,u,g,v)=>{let[S,E]=((k,M,L)=>{let{activeInputs:V,passiveInputs:W}=Je(M),X=yt(V,k,L);return X===null?[En(W,k,L)[1],!1]:[X[2],!0]})(C,g,v);S!==null&&(Vt(C,S),!E||u||Ar(C)||tn(C).disconnect(So(g),v))};class Wa{constructor(u){this._map=new Map(u)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(u,g=null){return this._map.forEach((v,S)=>u.call(g,v,S,this))}get(u){return this._map.get(u)}has(u){return this._map.has(u)}keys(){return this._map.keys()}values(){return this._map.values()}}let Rc={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function Eh(C,u,g,v,S){if(typeof C.copyFromChannel=="function")u[g].byteLength===0&&(u[g]=new Float32Array(128)),C.copyFromChannel(u[g],v,S);else{let E=C.getChannelData(v);if(u[g].byteLength===0)u[g]=E.slice(S,S+128);else{let k=new Float32Array(E.buffer,S*Float32Array.BYTES_PER_ELEMENT,128);u[g].set(k)}}}let Rl=(C,u,g,v,S)=>{typeof C.copyToChannel=="function"?u[g].byteLength!==0&&C.copyToChannel(u[g],v,S):u[g].byteLength!==0&&C.getChannelData(v).set(u[g],S)},Nh=(C,u)=>{let g=[];for(let v=0;v<C;v+=1){let S=[],E=typeof u=="number"?u:u[v];for(let k=0;k<E;k+=1)S.push(new Float32Array(128));g.push(S)}return g},Ab=(C,u,g,v,S,E,k)=>Y(void 0,null,function*(){let M=u===null?128*Math.ceil(C.context.length/128):u.length,L=v.channelCount*v.numberOfInputs,V=S.reduce((me,Ne)=>me+Ne,0),W=V===0?null:g.createBuffer(V,M,g.sampleRate);if(E===void 0)throw new Error("Missing the processor constructor.");let X=Ce(C),ce=yield((me,Ne)=>{let Oe=R(w,me),Be=tn(Ne);return R(Oe,Be)})(g,C),re=Nh(v.numberOfInputs,v.channelCount),ve=Nh(v.numberOfOutputs,S),_e=Array.from(C.parameters.keys()).reduce((me,Ne)=>vt(Fe({},me),{[Ne]:new Float32Array(128)}),{});for(let me=0;me<M;me+=128){if(v.numberOfInputs>0&&u!==null)for(let Ne=0;Ne<v.numberOfInputs;Ne+=1)for(let Oe=0;Oe<v.channelCount;Oe+=1)Eh(u,re[Ne],Oe,Oe,me);E.parameterDescriptors!==void 0&&u!==null&&E.parameterDescriptors.forEach(({name:Ne},Oe)=>{Eh(u,_e,Ne,L+Oe,me)});for(let Ne=0;Ne<v.numberOfInputs;Ne+=1)for(let Oe=0;Oe<S[Ne];Oe+=1)ve[Ne][Oe].byteLength===0&&(ve[Ne][Oe]=new Float32Array(128));try{let Ne=re.map((Be,We)=>X.activeInputs[We].size===0?[]:Be),Oe=k(me/g.sampleRate,g.sampleRate,()=>ce.process(Ne,ve,_e));if(W!==null)for(let Be=0,We=0;Be<v.numberOfOutputs;Be+=1){for(let Me=0;Me<S[Be];Me+=1)Rl(W,ve[Be],Me,We+Me,me);We+=S[Be]}if(!Oe)break}catch(Ne){C.dispatchEvent(new ErrorEvent("processorerror",{colno:Ne.colno,filename:Ne.filename,lineno:Ne.lineno,message:Ne.message}));break}}return W}),Gk={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Bg={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},ea={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Wk={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Vg={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},hd=C=>{let{port1:u,port2:g}=new MessageChannel;return new Promise(v=>{let S=()=>{g.onmessage=null,u.close(),g.close(),v()};g.onmessage=()=>S();try{u.postMessage(C,[C])}catch{}finally{S()}})},Ob={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},ta=(C,u,g)=>{let v=u[g];if(v===void 0)throw C();return v},qg={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Hk={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},fo=()=>new DOMException("","InvalidStateError"),fd=()=>new DOMException("","InvalidAccessError"),ZS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},$e=(C,u,g,v,S,E,k,M,L,V,W)=>{let X=V.length,ce=M;for(let re=0;re<X;re+=1){let ve=g[0]*V[re];for(let _e=1;_e<S;_e+=1){let me=ce-_e&L-1;ve+=g[_e]*E[me],ve-=C[_e]*k[me]}for(let _e=S;_e<v;_e+=1)ve+=g[_e]*E[ce-_e&L-1];for(let _e=S;_e<u;_e+=1)ve-=C[_e]*k[ce-_e&L-1];E[ce]=V[re],k[ce]=ve,ce=ce+1&L-1,W[re]=ve}return ce},Ve={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},ot=C=>{let u=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{let g=C.decodeAudioData(u.buffer,()=>{});return g!==void 0&&(g.catch(()=>{}),!0)}catch{}return!1},ht=(C,u,g)=>{let v=u[g];v!==void 0&&v!==C[g]&&(C[g]=v)},ft=(C,u)=>{ht(C,u,"channelCount"),ht(C,u,"channelCountMode"),ht(C,u,"channelInterpretation")},dn=C=>typeof C.getFloatTimeDomainData=="function",Qt=(C,u,g)=>{let v=u[g];v!==void 0&&v!==C[g].value&&(C[g].value=v)},ar=C=>{C.start=(u=>(g=0,v=0,S)=>{if(typeof S=="number"&&S<0||v<0||g<0)throw new RangeError("The parameters can't be negative.");u.call(C,g,v,S)})(C.start)},na=C=>{var u;C.stop=(u=C.stop,(g=0)=>{if(g<0)throw new RangeError("The parameter can't be negative.");u.call(C,g)})},Pl=(C,u)=>C===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(C*u))))),Mb=(C,u)=>{let g=C.createBiquadFilter();return ft(g,u),Qt(g,u,"Q"),Qt(g,u,"detune"),Qt(g,u,"frequency"),Qt(g,u,"gain"),ht(g,u,"type"),g},dd=(C,u)=>{let g=C.createChannelSplitter(u.numberOfOutputs);return ft(g,u),(v=>{let S=v.numberOfOutputs;Object.defineProperty(v,"channelCount",{get:()=>S,set:E=>{if(E!==S)throw fo()}}),Object.defineProperty(v,"channelCountMode",{get:()=>"explicit",set:E=>{if(E!=="explicit")throw fo()}}),Object.defineProperty(v,"channelInterpretation",{get:()=>"discrete",set:E=>{if(E!=="discrete")throw fo()}})})(g),g},Ug=(C,u)=>(C.connect=u.connect.bind(u),C.disconnect=u.disconnect.bind(u),C),GB=(C,u)=>{let g=C.createDelay(u.maxDelayTime);return ft(g,u),Qt(g,u,"delayTime"),g},ci=(C,u)=>{let g=C.createGain();return ft(g,u),Qt(g,u,"gain"),g};function fye(C,u){let g=u[0]*u[0]+u[1]*u[1];return[(C[0]*u[0]+C[1]*u[1])/g,(C[1]*u[0]-C[0]*u[1])/g]}function WB(C,u){let g=[0,0];for(let E=C.length-1;E>=0;E-=1)S=u,g=[(v=g)[0]*S[0]-v[1]*S[1],v[0]*S[1]+v[1]*S[0]],g[0]+=C[E];var v,S;return g}let Rb=(C,u,g,v)=>C.createScriptProcessor(u,g,v),Gs=()=>new DOMException("","NotSupportedError"),dye={numberOfChannels:1},mye={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},gye={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},yye={disableNormalization:!1},xye={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},vye=()=>new DOMException("","UnknownError"),bye={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},HB=(C,u,g)=>C.copyFromChannel===void 0?C.getChannelData(g)[0]:(C.copyFromChannel(u,g),u[0]),KB=C=>{if(C===null)return!1;let u=C.length;return u%2!=0?C[Math.floor(u/2)]!==0:C[u/2-1]+C[u/2]!==0},Pb=(C,u,g,v)=>{let S=C;for(;!S.hasOwnProperty(u);)S=Object.getPrototypeOf(S);let{get:E,set:k}=Object.getOwnPropertyDescriptor(S,u);Object.defineProperty(C,u,{get:g(E),set:v(k)})},XB=(C,u,g)=>{try{C.setValueAtTime(u,g)}catch(v){if(v.code!==9)throw v;XB(C,u,g+1e-7)}},Kk=C=>{let u=C.createOscillator();try{u.start(-1)}catch(g){return g instanceof RangeError}return!1},QB=C=>{let u=C.createBuffer(1,1,44100),g=C.createBufferSource();g.buffer=u,g.start(),g.stop();try{return g.stop(),!0}catch{return!1}},Xk=C=>{let u=C.createOscillator();try{u.stop(-1)}catch(g){return g instanceof RangeError}return!1},wye=()=>{try{new DOMException}catch{return!1}return!0},Sye=()=>new Promise(C=>{let u=new ArrayBuffer(0),{port1:g,port2:v}=new MessageChannel;g.onmessage=({data:S})=>C(S!==null),v.postMessage(u,[u])}),YB=(C,u)=>{let g=u.createGain();C.connect(g);let v=(S=>()=>{S.call(C,g),C.removeEventListener("ended",v)})(C.disconnect);C.addEventListener("ended",v),Ug(C,g),C.stop=(S=>{let E=!1;return(k=0)=>{if(E)try{S.call(C,k)}catch{g.gain.setValueAtTime(0,k)}else S.call(C,k),E=!0}})(C.stop)},jg=(C,u)=>g=>{let v={value:C};return Object.defineProperties(g,{currentTarget:v,target:v}),typeof u=="function"?u.call(C,g):u.handleEvent.call(C,g)},Cye=(C=>(u,g,[v,S,E],k)=>{C(u[S],[g,v,E],M=>M[0]===g&&M[1]===v,k)})(Z),_ye=(C=>(u,g,[v,S,E],k)=>{let M=u.get(v);M===void 0?u.set(v,new Set([[S,g,E]])):C(M,[S,g,E],L=>L[0]===S&&L[1]===g,k)})(Z),Tye=(C=>(u,g,v,S)=>C(u[S],E=>E[0]===g&&E[1]===v))(P),ZB=new WeakMap,Iye=(C=>u=>{var g;return(g=C.get(u))!==null&&g!==void 0?g:0})(ZB),ra=(JS=new Map,Fb=new WeakMap,(C,u)=>{let g=Fb.get(C);if(g!==void 0)return g;let v=JS.get(C);if(v!==void 0)return v;try{let S=u();return S instanceof Promise?(JS.set(C,S),S.catch(()=>!1).then(E=>(JS.delete(C),Fb.set(C,E),E))):(Fb.set(C,S),S)}catch{return Fb.set(C,!1),!1}});var JS,Fb;let Ha=typeof window>"u"?null:window,JB=((C,u)=>(g,v)=>{let S=g.createAnalyser();if(ft(S,v),!(v.maxDecibels>v.minDecibels))throw u();return ht(S,v,"fftSize"),ht(S,v,"maxDecibels"),ht(S,v,"minDecibels"),ht(S,v,"smoothingTimeConstant"),C(dn,()=>dn(S))||(E=>{E.getFloatTimeDomainData=k=>{let M=new Uint8Array(k.length);E.getByteTimeDomainData(M);let L=Math.max(M.length,E.fftSize);for(let V=0;V<L;V+=1)k[V]=.0078125*(M[V]-128);return k}})(S),S})(ra,se),Qk=(C=>u=>{let g=C(u);if(g.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return g.renderer})(Ce),as=((C,u,g)=>(v,S,E)=>Y(void 0,null,function*(){let k=C(v);yield Promise.all(k.activeInputs.map((M,L)=>Array.from(M).map(X=>Y(void 0,[X],function*([V,W]){let ce=u(V),re=yield ce.render(V,S),ve=v.context.destination;g(V)||v===ve&&g(v)||re.connect(E,W,L)}))).reduce((M,L)=>[...M,...L],[]))}))(Ce,Qk,Ar),Eye=((C,u,g)=>()=>{let v=new WeakMap;return{render(S,E){let k=v.get(E);return k!==void 0?Promise.resolve(k):((M,L)=>Y(null,null,function*(){let V=u(M);if(!fe(V,L)){let W={channelCount:V.channelCount,channelCountMode:V.channelCountMode,channelInterpretation:V.channelInterpretation,fftSize:V.fftSize,maxDecibels:V.maxDecibels,minDecibels:V.minDecibels,smoothingTimeConstant:V.smoothingTimeConstant};V=C(L,W)}return v.set(L,V),yield g(M,L,V),V}))(S,E)}}})(JB,tn,as),Tr=(eV=d,C=>{let u=eV.get(C);if(u===void 0)throw fo();return u});var eV;let Uo=(C=>C===null?null:C.hasOwnProperty("OfflineAudioContext")?C.OfflineAudioContext:C.hasOwnProperty("webkitOfflineAudioContext")?C.webkitOfflineAudioContext:null)(Ha),hr=(C=>u=>C!==null&&u instanceof C)(Uo),tV=new WeakMap,nV=(C=>class{constructor(u){this._nativeEventTarget=u,this._listeners=new WeakMap}addEventListener(u,g,v){if(g!==null){let S=this._listeners.get(g);S===void 0&&(S=C(this,g),typeof g=="function"&&this._listeners.set(g,S)),this._nativeEventTarget.addEventListener(u,S,v)}}dispatchEvent(u){return this._nativeEventTarget.dispatchEvent(u)}removeEventListener(u,g,v){let S=g===null?void 0:this._listeners.get(g);this._nativeEventTarget.removeEventListener(u,S===void 0?null:S,v)}})(jg),Dh=(C=>C===null?null:C.hasOwnProperty("AudioContext")?C.AudioContext:C.hasOwnProperty("webkitAudioContext")?C.webkitAudioContext:null)(Ha),Yk=(C=>u=>C!==null&&u instanceof C)(Dh),Zk=(C=>u=>C!==null&&typeof C.AudioNode=="function"&&u instanceof C.AudioNode)(Ha),rV=(C=>u=>C!==null&&typeof C.AudioParam=="function"&&u instanceof C.AudioParam)(Ha),Gg=(C=>C===null?null:C.hasOwnProperty("AudioWorkletNode")?C.AudioWorkletNode:null)(Ha),mo=((C,u,g,v,S,E,k,M,L,V,W,X,ce,re,ve,_e)=>class extends V{constructor(me,Ne,Oe,Be){super(Oe),this._context=me,this._nativeAudioNode=Oe;let We=W(me);X(We)&&g(is,()=>is(We,_e))!==!0&&ja(Oe),p.set(this,Oe),h.set(this,new Set),me.state!=="closed"&&Ne&&Q(this),C(this,Be,Oe)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(me){this._nativeAudioNode.channelCount=me}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(me){this._nativeAudioNode.channelCountMode=me}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(me){this._nativeAudioNode.channelInterpretation=me}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(me,Ne=0,Oe=0){if(Ne<0||Ne>=this._nativeAudioNode.numberOfOutputs)throw S();let Be=W(this._context),We=ve(Be);if(ce(me)||re(me))throw E();if(B(me)){let Ie=tn(me);try{let Ue=dt(this._nativeAudioNode,Ie,Ne,Oe),Pe=ii(this);(We||Pe)&&this._nativeAudioNode.disconnect(...Ue),this.context.state!=="closed"&&!Pe&&ii(me)&&Q(me)}catch(Ue){throw Ue.code===12?E():Ue}if(u(this,me,Ne,Oe,We)){let Ue=L([this],me);Es(Ue,v(We))}return me}let Me=So(me);if(Me.name==="playbackRate"&&Me.maxValue===1024)throw k();try{this._nativeAudioNode.connect(Me,Ne),(We||ii(this))&&this._nativeAudioNode.disconnect(Me,Ne)}catch(Ie){throw Ie.code===12?E():Ie}if(((Ie,Ue,Pe,et)=>{let{activeInputs:Xe,passiveInputs:nt}=Je(Ue),{outputs:tt}=Ce(Ie),lt=G(Ie),Tt=wt=>{let Nt=tn(Ie),en=So(Ue);if(wt){let St=En(nt,Ie,Pe);le(Xe,Ie,St,!1),et||Ar(Ie)||Nt.connect(en,Pe)}else{let St=((cn,Tn,jr)=>P(cn,Qr=>Qr[0]===Tn&&Qr[1]===jr))(Xe,Ie,Pe);Ge(nt,St,!1),et||Ar(Ie)||Nt.disconnect(en,Pe)}};return!!Z(tt,[Ue,Pe],wt=>wt[0]===Ue&&wt[1]===Pe,!0)&&(lt.add(Tt),De(Ie)?le(Xe,Ie,[Pe,Tt],!0):Ge(nt,[Ie,Pe,Tt],!0),!0)})(this,me,Ne,We)){let Ie=L([this],me);Es(Ie,v(We))}}disconnect(me,Ne,Oe){let Be,We=W(this._context),Me=ve(We);if(me===void 0)Be=((Ie,Ue)=>{let Pe=Ce(Ie),et=[];for(let Xe of Pe.outputs)J(Xe)?ai(Ie,Ue,...Xe):Ga(Ie,Ue,...Xe),et.push(Xe[0]);return Pe.outputs.clear(),et})(this,Me);else if(typeof me=="number"){if(me<0||me>=this.numberOfOutputs)throw S();Be=((Ie,Ue,Pe)=>{let et=Ce(Ie),Xe=[];for(let nt of et.outputs)nt[1]===Pe&&(J(nt)?ai(Ie,Ue,...nt):Ga(Ie,Ue,...nt),Xe.push(nt[0]),et.outputs.delete(nt));return Xe})(this,Me,me)}else{if(Ne!==void 0&&(Ne<0||Ne>=this.numberOfOutputs)||B(me)&&Oe!==void 0&&(Oe<0||Oe>=me.numberOfInputs))throw S();if(Be=((Ie,Ue,Pe,et,Xe)=>{let nt=Ce(Ie);return Array.from(nt.outputs).filter(tt=>!(tt[0]!==Pe||et!==void 0&&tt[1]!==et||Xe!==void 0&&tt[2]!==Xe)).map(tt=>(J(tt)?ai(Ie,Ue,...tt):Ga(Ie,Ue,...tt),nt.outputs.delete(tt),tt[0]))})(this,Me,me,Ne,Oe),Be.length===0)throw E()}for(let Ie of Be){let Ue=L([this],Ie);Es(Ue,M)}}})((oV=l,(C,u,g)=>{let v=[];for(let S=0;S<g.numberOfInputs;S+=1)v.push(new Set);oV.set(C,{activeInputs:v,outputs:new Set,passiveInputs:new WeakMap,renderer:u})}),((C,u,g,v,S,E,k,M,L,V,W,X,ce)=>{let re=new WeakMap;return(ve,_e,me,Ne,Oe)=>{let{activeInputs:Be,passiveInputs:We}=E(_e),{outputs:Me}=E(ve),Ie=M(ve),Ue=Pe=>{let et=L(_e),Xe=L(ve);if(Pe){let nt=j(We,ve,me,Ne);C(Be,ve,nt,!1),Oe||X(ve)||g(Xe,et,me,Ne),ce(_e)&&Q(_e)}else{let nt=v(Be,ve,me,Ne);u(We,Ne,nt,!1),Oe||X(ve)||S(Xe,et,me,Ne);let tt=k(_e);if(tt===0)W(_e)&&xe(_e,Be);else{let lt=re.get(_e);lt!==void 0&&clearTimeout(lt),re.set(_e,setTimeout(()=>{W(_e)&&xe(_e,Be)},1e3*tt))}}};return!!V(Me,[_e,me,Ne],Pe=>Pe[0]===_e&&Pe[1]===me&&Pe[2]===Ne,!0)&&(Ie.add(Ue),W(ve)?C(Be,ve,[me,Ne,Ue],!0):u(We,Ne,[ve,me,Ue],!0),!0)}})(Cye,_ye,dt,Tye,ss,Ce,Iye,G,tn,Z,De,Ar,ii),ra,((C,u,g,v,S,E)=>k=>(M,L)=>{let V=C.get(M);if(V===void 0){if(!k&&E(M)){let W=v(M),{outputs:X}=g(M);for(let ce of X)if(J(ce)){let re=v(ce[0]);u(W,re,ce[1],ce[2])}else{let re=S(ce[0]);W.disconnect(re,ce[1])}}C.set(M,L)}else C.set(M,V+L)})(m,ss,Ce,tn,So,De),se,fd,Gs,((C,u,g,v,S,E,k,M)=>(L,V)=>{let W=u.get(L);if(W===void 0)throw new Error("Missing the expected cycle count.");let X=E(L.context),ce=M(X);if(W===V){if(u.delete(L),!ce&&k(L)){let re=v(L),{outputs:ve}=g(L);for(let _e of ve)if(J(_e)){let me=v(_e[0]);C(re,me,_e[1],_e[2])}else{let me=S(_e[0]);re.connect(me,_e[1])}}}else u.set(L,W-V)})(dt,m,Ce,tn,So,Tr,De,hr),((C,u,g)=>function v(S,E){let k=B(E)?E:g(C,E);if((L=>"delayTime"in L)(k))return[];if(S[0]===k)return[S];if(S.includes(k))return[];let{outputs:M}=u(k);return Array.from(M).map(L=>v([...S,k],L[0])).reduce((L,V)=>L.concat(V),[])})(tV,Ce,R),nV,Tr,Yk,Zk,rV,hr,Gg);var oV;let Nye=((C,u,g,v,S,E)=>class extends C{constructor(k,M){let L=S(k),V=Fe(Fe({},ne),M),W=v(L,V);super(k,!1,W,E(L)?u():null),this._nativeAnalyserNode=W}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(k){this._nativeAnalyserNode.fftSize=k}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(k){let M=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=k,!(k>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=M,g()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(k){let M=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=k,!(this._nativeAnalyserNode.maxDecibels>k))throw this._nativeAnalyserNode.minDecibels=M,g()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(k){this._nativeAnalyserNode.smoothingTimeConstant=k}getByteFrequencyData(k){this._nativeAnalyserNode.getByteFrequencyData(k)}getByteTimeDomainData(k){this._nativeAnalyserNode.getByteTimeDomainData(k)}getFloatFrequencyData(k){this._nativeAnalyserNode.getFloatFrequencyData(k)}getFloatTimeDomainData(k){this._nativeAnalyserNode.getFloatTimeDomainData(k)}})(mo,Eye,se,JB,Tr,hr),Jk=new WeakSet,sV=(C=>C===null?null:C.hasOwnProperty("AudioBuffer")?C.AudioBuffer:null)(Ha),iV=(eA=new Uint32Array(1),C=>(eA[0]=C,eA[0]));var eA;let tA=((C,u)=>g=>{g.copyFromChannel=(v,S,E=0)=>{let k=C(E),M=C(S);if(M>=g.numberOfChannels)throw u();let L=g.length,V=g.getChannelData(M),W=v.length;for(let X=k<0?-k:0;X+k<L&&X<W;X+=1)v[X]=V[X+k]},g.copyToChannel=(v,S,E=0)=>{let k=C(E),M=C(S);if(M>=g.numberOfChannels)throw u();let L=g.length,V=g.getChannelData(M),W=v.length;for(let X=k<0?-k:0;X+k<L&&X<W;X+=1)V[X+k]=v[X]}})(iV,se),nA=(C=>u=>{u.copyFromChannel=(g=>(v,S,E=0)=>{let k=C(E),M=C(S);if(k<u.length)return g.call(u,v,M,k)})(u.copyFromChannel),u.copyToChannel=(g=>(v,S,E=0)=>{let k=C(E),M=C(S);if(k<u.length)return g.call(u,v,M,k)})(u.copyToChannel)})(iV),aV=((C,u,g,v,S,E,k,M)=>{let L=null;return class cye{constructor(W){if(S===null)throw new Error("Missing the native OfflineAudioContext constructor.");let{length:X,numberOfChannels:ce,sampleRate:re}=Fe(Fe({},we),W);L===null&&(L=new S(1,1,44100));let ve=v!==null&&u(E,E)?new v({length:X,numberOfChannels:ce,sampleRate:re}):L.createBuffer(ce,X,re);if(ve.numberOfChannels===0)throw g();return typeof ve.copyFromChannel!="function"?(k(ve),ee(ve)):u(te,()=>te(ve))||M(ve),C.add(ve),ve}static[Symbol.hasInstance](W){return W!==null&&typeof W=="object"&&Object.getPrototypeOf(W)===cye.prototype||C.has(W)}}})(Jk,ra,Gs,sV,Uo,(C=>()=>{if(C===null)return!1;try{new C({length:1,sampleRate:44100})}catch{return!1}return!0})(sV),tA,nA),eC=(C=>(u,g)=>{let v=C(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});g.connect(v).connect(u.destination);let S=()=>{g.removeEventListener("ended",S),g.disconnect(v),v.disconnect()};g.addEventListener("ended",S)})(ci),cV=((C,u,g)=>(v,S,E)=>Y(void 0,null,function*(){let k=u(v);yield Promise.all(Array.from(k.activeInputs).map(V=>Y(void 0,[V],function*([M,L]){let W=C(M),X=yield W.render(M,S);g(M)||X.connect(E,L)})))}))(Qk,Je,Ar),Pc=(C=>(u,g,v)=>C(g,u,v))(cV),Wg=((C,u,g,v,S,E,k,M,L,V,W)=>(X,ce)=>{let re=X.createBufferSource();return ft(re,ce),Qt(re,ce,"playbackRate"),ht(re,ce,"buffer"),ht(re,ce,"loop"),ht(re,ce,"loopEnd"),ht(re,ce,"loopStart"),u(g,()=>g(X))||(ve=>{ve.start=(_e=>{let me=!1;return(Ne=0,Oe=0,Be)=>{if(me)throw fo();_e.call(ve,Ne,Oe,Be),me=!0}})(ve.start)})(re),u(v,()=>v(X))||(ve=>{ve.start=(_e=>(me=0,Ne=0,Oe)=>{let Be=ve.buffer,We=Be===null?Ne:Math.min(Be.duration,Ne);Be!==null&&We>Be.duration-.5/ve.context.sampleRate?_e.call(ve,me,0,0):_e.call(ve,me,We,Oe)})(ve.start)})(re),u(S,()=>S(X))||V(re,X),u(E,()=>E(X))||ar(re),u(k,()=>k(X))||W(re,X),u(M,()=>M(X))||na(re),C(X,re),re})(eC,ra,C=>{let u=C.createBufferSource();u.start();try{u.start()}catch{return!0}return!1},C=>{let u=C.createBufferSource(),g=C.createBuffer(1,1,44100);u.buffer=g;try{u.start(0,1)}catch{return!1}return!0},C=>{let u=C.createBufferSource();u.start();try{u.stop()}catch{return!1}return!0},Kk,QB,Xk,0,(C=>(u,g)=>{let v=g.createBuffer(1,1,44100);u.buffer===null&&(u.buffer=v),C(u,"buffer",S=>()=>{let E=S.call(u);return E===v?null:E},S=>E=>S.call(u,E===null?v:E))})(Pb),YB),Fc=((C,u)=>(g,v,S)=>(C(v).replay(S),u(v,g,S)))((C=>u=>{let g=C(u);if(g.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return g.renderer})(Je),cV),Dye=((C,u,g,v,S)=>()=>{let E=new WeakMap,k=null,M=null;return{set start(L){k=L},set stop(L){M=L},render(L,V){let W=E.get(V);return W!==void 0?Promise.resolve(W):((X,ce)=>Y(null,null,function*(){let re=g(X),ve=fe(re,ce);if(!ve){let _e={buffer:re.buffer,channelCount:re.channelCount,channelCountMode:re.channelCountMode,channelInterpretation:re.channelInterpretation,loop:re.loop,loopEnd:re.loopEnd,loopStart:re.loopStart,playbackRate:re.playbackRate.value};re=u(ce,_e),k!==null&&re.start(...k),M!==null&&re.stop(M)}return E.set(ce,re),ve?yield C(ce,X.playbackRate,re.playbackRate):yield v(ce,X.playbackRate,re.playbackRate),yield S(X,ce,re),re}))(L,V)}}})(Pc,Wg,tn,Fc,as),Ka=((C,u,g,v,S,E,k,M,L,V,W,X,ce)=>(re,ve,_e,me=null,Ne=null)=>{let Oe=_e.value,Be=new a.AutomationEventList(Oe),We=ve?(Ie=>({replay(Ue){for(let Pe of Ie)if(Pe.type==="exponentialRampToValue"){let{endTime:et,value:Xe}=Pe;Ue.exponentialRampToValueAtTime(Xe,et)}else if(Pe.type==="linearRampToValue"){let{endTime:et,value:Xe}=Pe;Ue.linearRampToValueAtTime(Xe,et)}else if(Pe.type==="setTarget"){let{startTime:et,target:Xe,timeConstant:nt}=Pe;Ue.setTargetAtTime(Xe,et,nt)}else if(Pe.type==="setValue"){let{startTime:et,value:Xe}=Pe;Ue.setValueAtTime(Xe,et)}else{if(Pe.type!=="setValueCurve")throw new Error("Can't apply an unknown automation.");{let{duration:et,startTime:Xe,values:nt}=Pe;Ue.setValueCurveAtTime(nt,Xe,et)}}}}))(Be):null,Me={get defaultValue(){return Oe},get maxValue(){return me===null?_e.maxValue:me},get minValue(){return Ne===null?_e.minValue:Ne},get value(){return _e.value},set value(Ie){_e.value=Ie,Me.setValueAtTime(Ie,re.context.currentTime)},cancelAndHoldAtTime(Ie){if(typeof _e.cancelAndHoldAtTime=="function")We===null&&Be.flush(re.context.currentTime),Be.add(S(Ie)),_e.cancelAndHoldAtTime(Ie);else{let Ue=Array.from(Be).pop();We===null&&Be.flush(re.context.currentTime),Be.add(S(Ie));let Pe=Array.from(Be).pop();_e.cancelScheduledValues(Ie),Ue!==Pe&&Pe!==void 0&&(Pe.type==="exponentialRampToValue"?_e.exponentialRampToValueAtTime(Pe.value,Pe.endTime):Pe.type==="linearRampToValue"?_e.linearRampToValueAtTime(Pe.value,Pe.endTime):Pe.type==="setValue"?_e.setValueAtTime(Pe.value,Pe.startTime):Pe.type==="setValueCurve"&&_e.setValueCurveAtTime(Pe.values,Pe.startTime,Pe.duration))}return Me},cancelScheduledValues:Ie=>(We===null&&Be.flush(re.context.currentTime),Be.add(E(Ie)),_e.cancelScheduledValues(Ie),Me),exponentialRampToValueAtTime(Ie,Ue){if(Ie===0)throw new RangeError;if(!Number.isFinite(Ue)||Ue<0)throw new RangeError;let Pe=re.context.currentTime;return We===null&&Be.flush(Pe),Array.from(Be).length===0&&(Be.add(V(Oe,Pe)),_e.setValueAtTime(Oe,Pe)),Be.add(k(Ie,Ue)),_e.exponentialRampToValueAtTime(Ie,Ue),Me},linearRampToValueAtTime(Ie,Ue){let Pe=re.context.currentTime;return We===null&&Be.flush(Pe),Array.from(Be).length===0&&(Be.add(V(Oe,Pe)),_e.setValueAtTime(Oe,Pe)),Be.add(M(Ie,Ue)),_e.linearRampToValueAtTime(Ie,Ue),Me},setTargetAtTime:(Ie,Ue,Pe)=>(We===null&&Be.flush(re.context.currentTime),Be.add(L(Ie,Ue,Pe)),_e.setTargetAtTime(Ie,Ue,Pe),Me),setValueAtTime:(Ie,Ue)=>(We===null&&Be.flush(re.context.currentTime),Be.add(V(Ie,Ue)),_e.setValueAtTime(Ie,Ue),Me),setValueCurveAtTime(Ie,Ue,Pe){let et=Ie instanceof Float32Array?Ie:new Float32Array(Ie);if(X!==null&&X.name==="webkitAudioContext"){let Xe=Ue+Pe,nt=re.context.sampleRate,tt=Math.ceil(Ue*nt),lt=Math.floor(Xe*nt),Tt=lt-tt,wt=new Float32Array(Tt);for(let en=0;en<Tt;en+=1){let St=(et.length-1)/Pe*((tt+en)/nt-Ue),cn=Math.floor(St),Tn=Math.ceil(St);wt[en]=cn===Tn?et[cn]:(1-(St-cn))*et[cn]+(1-(Tn-St))*et[Tn]}We===null&&Be.flush(re.context.currentTime),Be.add(W(wt,Ue,Pe)),_e.setValueCurveAtTime(wt,Ue,Pe);let Nt=lt/nt;Nt<Xe&&ce(Me,wt[wt.length-1],Nt),ce(Me,et[et.length-1],Xe)}else We===null&&Be.flush(re.context.currentTime),Be.add(W(et,Ue,Pe)),_e.setValueCurveAtTime(et,Ue,Pe);return Me}};return g.set(Me,_e),u.set(Me,re),C(Me,We),Me})((uV=f,(C,u)=>{uV.set(C,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:u})}),tV,y,0,a.createCancelAndHoldAutomationEvent,a.createCancelScheduledValuesAutomationEvent,a.createExponentialRampToValueAutomationEvent,a.createLinearRampToValueAutomationEvent,a.createSetTargetAutomationEvent,a.createSetValueAutomationEvent,a.createSetValueCurveAutomationEvent,Dh,XB);var uV;let kye=((C,u,g,v,S,E,k,M)=>class extends C{constructor(L,V){let W=E(L),X=Fe(Fe({},Re),V),ce=S(W,X),re=k(W),ve=re?u():null;super(L,!1,ce,ve),this._audioBufferSourceNodeRenderer=ve,this._isBufferNullified=!1,this._isBufferSet=X.buffer!==null,this._nativeAudioBufferSourceNode=ce,this._onended=null,this._playbackRate=g(this,re,ce.playbackRate,ke,be)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(L){if(this._nativeAudioBufferSourceNode.buffer=L,L!==null){if(this._isBufferSet)throw v();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(L){this._nativeAudioBufferSourceNode.loop=L}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(L){this._nativeAudioBufferSourceNode.loopEnd=L}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(L){this._nativeAudioBufferSourceNode.loopStart=L}get onended(){return this._onended}set onended(L){let V=typeof L=="function"?M(this,L):null;this._nativeAudioBufferSourceNode.onended=V;let W=this._nativeAudioBufferSourceNode.onended;this._onended=W!==null&&W===V?L:W}get playbackRate(){return this._playbackRate}start(L=0,V=0,W){if(this._nativeAudioBufferSourceNode.start(L,V,W),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=W===void 0?[L,V]:[L,V,W]),this.context.state!=="closed"){Q(this);let X=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",X),De(this)&&pe(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",X)}}stop(L=0){this._nativeAudioBufferSourceNode.stop(L),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=L)}})(mo,Dye,Ka,fo,Wg,Tr,hr,jg),Aye=((C,u,g,v,S,E,k,M)=>class extends C{constructor(L,V){let W=E(L),X=k(W),ce=S(W,V,X);super(L,!1,ce,X?(re=>{let ve=new WeakMap;return{render(_e,me){let Ne=ve.get(me);return Ne!==void 0?Promise.resolve(Ne):((Oe,Be)=>Y(null,null,function*(){let We=Be.destination;return ve.set(Be,We),yield re(Oe,Be,We),We}))(_e,me)}}})(M):null),this._isNodeOfNativeOfflineAudioContext=X,this._nativeAudioDestinationNode=ce}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(L){if(this._isNodeOfNativeOfflineAudioContext)throw v();if(L>this._nativeAudioDestinationNode.maxChannelCount)throw g();this._nativeAudioDestinationNode.channelCount=L}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(L){if(this._isNodeOfNativeOfflineAudioContext)throw v();this._nativeAudioDestinationNode.channelCountMode=L}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(mo,0,se,fo,((C,u)=>(g,v,S)=>{let E=g.destination;if(E.channelCount!==v)try{E.channelCount=v}catch{}S&&E.channelCountMode!=="explicit"&&(E.channelCountMode="explicit"),E.maxChannelCount===0&&Object.defineProperty(E,"maxChannelCount",{value:v});let k=C(g,{channelCount:v,channelCountMode:E.channelCountMode,channelInterpretation:E.channelInterpretation,gain:1});return u(k,"channelCount",M=>()=>M.call(k),M=>L=>{M.call(k,L);try{E.channelCount=L}catch(V){if(L>E.maxChannelCount)throw V}}),u(k,"channelCountMode",M=>()=>M.call(k),M=>L=>{M.call(k,L),E.channelCountMode=L}),u(k,"channelInterpretation",M=>()=>M.call(k),M=>L=>{M.call(k,L),E.channelInterpretation=L}),Object.defineProperty(k,"maxChannelCount",{get:()=>E.maxChannelCount}),k.connect(E),k})(ci,Pb),Tr,hr,as),Oye=((C,u,g,v,S)=>()=>{let E=new WeakMap;return{render(k,M){let L=E.get(M);return L!==void 0?Promise.resolve(L):((V,W)=>Y(null,null,function*(){let X=g(V),ce=fe(X,W);if(!ce){let re={Q:X.Q.value,channelCount:X.channelCount,channelCountMode:X.channelCountMode,channelInterpretation:X.channelInterpretation,detune:X.detune.value,frequency:X.frequency.value,gain:X.gain.value,type:X.type};X=u(W,re)}return E.set(W,X),ce?(yield C(W,V.Q,X.Q),yield C(W,V.detune,X.detune),yield C(W,V.frequency,X.frequency),yield C(W,V.gain,X.gain)):(yield v(W,V.Q,X.Q),yield v(W,V.detune,X.detune),yield v(W,V.frequency,X.frequency),yield v(W,V.gain,X.gain)),yield S(V,W,X),X}))(k,M)}}})(Pc,Mb,tn,Fc,as),md=(C=>(u,g)=>C.set(u,g))(ZB),Mye=((C,u,g,v,S,E,k,M)=>class extends C{constructor(L,V){let W=E(L),X=Fe(Fe({},Gk),V),ce=S(W,X),re=k(W);super(L,!1,ce,re?g():null),this._Q=u(this,re,ce.Q,ke,be),this._detune=u(this,re,ce.detune,1200*Math.log2(ke),-1200*Math.log2(ke)),this._frequency=u(this,re,ce.frequency,L.sampleRate/2,0),this._gain=u(this,re,ce.gain,40*Math.log10(ke),be),this._nativeBiquadFilterNode=ce,M(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(L){this._nativeBiquadFilterNode.type=L}getFrequencyResponse(L,V,W){try{this._nativeBiquadFilterNode.getFrequencyResponse(L,V,W)}catch(X){throw X.code===11?v():X}if(L.length!==V.length||V.length!==W.length)throw v()}})(mo,Ka,Oye,fd,Mb,Tr,hr,md),kh=((C,u)=>(g,v,S)=>{let E=new Set;return g.connect=(k=>(M,L=0,V=0)=>{let W=E.size===0;if(u(M))return k.call(g,M,L,V),C(E,[M,L,V],X=>X[0]===M&&X[1]===L&&X[2]===V,!0),W&&v(),M;k.call(g,M,L),C(E,[M,L],X=>X[0]===M&&X[1]===L,!0),W&&v()})(g.connect),g.disconnect=(k=>(M,L,V)=>{let W=E.size>0;if(M===void 0)k.apply(g),E.clear();else if(typeof M=="number"){k.call(g,M);for(let ce of E)ce[1]===M&&E.delete(ce)}else{u(M)?k.call(g,M,L,V):k.call(g,M,L);for(let ce of E)ce[0]!==M||L!==void 0&&ce[1]!==L||V!==void 0&&ce[2]!==V||E.delete(ce)}let X=E.size===0;W&&X&&S()})(g.disconnect),g})(Z,Zk),Rye=((C,u)=>(g,v)=>{v.channelCount=1,v.channelCountMode="explicit",Object.defineProperty(v,"channelCount",{get:()=>1,set:()=>{throw C()}}),Object.defineProperty(v,"channelCountMode",{get:()=>"explicit",set:()=>{throw C()}});let S=g.createBufferSource();u(v,()=>{let E=v.numberOfInputs;for(let k=0;k<E;k+=1)S.connect(v,0,k)},()=>S.disconnect(v))})(fo,kh),Ah=((C,u)=>(g,v)=>{let S=g.createChannelMerger(v.numberOfInputs);return C!==null&&C.name==="webkitAudioContext"&&u(g,S),ft(S,v),S})(Dh,Rye),Pye=((C,u,g)=>()=>{let v=new WeakMap;return{render(S,E){let k=v.get(E);return k!==void 0?Promise.resolve(k):((M,L)=>Y(null,null,function*(){let V=u(M);if(!fe(V,L)){let W={channelCount:V.channelCount,channelCountMode:V.channelCountMode,channelInterpretation:V.channelInterpretation,numberOfInputs:V.numberOfInputs};V=C(L,W)}return v.set(L,V),yield g(M,L,V),V}))(S,E)}}})(Ah,tn,as),Fye=((C,u,g,v,S)=>class extends C{constructor(E,k){let M=v(E),L=Fe(Fe({},Bg),k);super(E,!1,g(M,L),S(M)?u():null)}})(mo,Pye,Ah,Tr,hr),$ye=((C,u,g)=>()=>{let v=new WeakMap;return{render(S,E){let k=v.get(E);return k!==void 0?Promise.resolve(k):((M,L)=>Y(null,null,function*(){let V=u(M);if(!fe(V,L)){let W={channelCount:V.channelCount,channelCountMode:V.channelCountMode,channelInterpretation:V.channelInterpretation,numberOfOutputs:V.numberOfOutputs};V=C(L,W)}return v.set(L,V),yield g(M,L,V),V}))(S,E)}}})(dd,tn,as),Lye=((C,u,g,v,S,E)=>class extends C{constructor(k,M){let L=v(k),V=(W=>vt(Fe({},W),{channelCount:W.numberOfOutputs}))(Fe(Fe({},ea),M));super(k,!1,g(L,V),S(L)?u():null)}})(mo,$ye,dd,Tr,hr),zye=((C,u,g,v)=>(S,M)=>{var L=M,{offset:E}=L,k=Zb(L,["offset"]);let V=S.createBuffer(1,2,44100),W=u(S,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),X=g(S,vt(Fe({},k),{gain:E})),ce=V.getChannelData(0);ce[0]=1,ce[1]=1,W.buffer=V,W.loop=!0;let re={get bufferSize(){},get channelCount(){return X.channelCount},set channelCount(ve){X.channelCount=ve},get channelCountMode(){return X.channelCountMode},set channelCountMode(ve){X.channelCountMode=ve},get channelInterpretation(){return X.channelInterpretation},set channelInterpretation(ve){X.channelInterpretation=ve},get context(){return X.context},get inputs(){return[]},get numberOfInputs(){return W.numberOfInputs},get numberOfOutputs(){return X.numberOfOutputs},get offset(){return X.gain},get onended(){return W.onended},set onended(ve){W.onended=ve},addEventListener:(...ve)=>W.addEventListener(ve[0],ve[1],ve[2]),dispatchEvent:(...ve)=>W.dispatchEvent(ve[0]),removeEventListener:(...ve)=>W.removeEventListener(ve[0],ve[1],ve[2]),start(ve=0){W.start.call(W,ve)},stop(ve=0){W.stop.call(W,ve)}};return C(S,W),v(Ug(re,X),()=>W.connect(X),()=>W.disconnect(X))})(eC,Wg,ci,kh),Hg=((C,u,g,v,S)=>(E,k)=>{if(E.createConstantSource===void 0)return g(E,k);let M=E.createConstantSource();return ft(M,k),Qt(M,k,"offset"),u(v,()=>v(E))||ar(M),u(S,()=>S(E))||na(M),C(E,M),M})(eC,ra,zye,Kk,Xk),Bye=((C,u,g,v,S)=>()=>{let E=new WeakMap,k=null,M=null;return{set start(L){k=L},set stop(L){M=L},render(L,V){let W=E.get(V);return W!==void 0?Promise.resolve(W):((X,ce)=>Y(null,null,function*(){let re=g(X),ve=fe(re,ce);if(!ve){let _e={channelCount:re.channelCount,channelCountMode:re.channelCountMode,channelInterpretation:re.channelInterpretation,offset:re.offset.value};re=u(ce,_e),k!==null&&re.start(k),M!==null&&re.stop(M)}return E.set(ce,re),ve?yield C(ce,X.offset,re.offset):yield v(ce,X.offset,re.offset),yield S(X,ce,re),re}))(L,V)}}})(Pc,Hg,tn,Fc,as),Vye=((C,u,g,v,S,E,k)=>class extends C{constructor(M,L){let V=S(M),W=Fe(Fe({},Wk),L),X=v(V,W),ce=E(V),re=ce?g():null;super(M,!1,X,re),this._constantSourceNodeRenderer=re,this._nativeConstantSourceNode=X,this._offset=u(this,ce,X.offset,ke,be),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(M){let L=typeof M=="function"?k(this,M):null;this._nativeConstantSourceNode.onended=L;let V=this._nativeConstantSourceNode.onended;this._onended=V!==null&&V===L?M:V}start(M=0){if(this._nativeConstantSourceNode.start(M),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=M),this.context.state!=="closed"){Q(this);let L=()=>{this._nativeConstantSourceNode.removeEventListener("ended",L),De(this)&&pe(this)};this._nativeConstantSourceNode.addEventListener("ended",L)}}stop(M=0){this._nativeConstantSourceNode.stop(M),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=M)}})(mo,Ka,Bye,Hg,Tr,hr,jg),lV=((C,u)=>(g,v)=>{let S=g.createConvolver();if(ft(S,v),v.disableNormalization===S.normalize&&(S.normalize=!v.disableNormalization),ht(S,v,"buffer"),v.channelCount>2||(u(S,"channelCount",E=>()=>E.call(S),E=>k=>{if(k>2)throw C();return E.call(S,k)}),v.channelCountMode==="max"))throw C();return u(S,"channelCountMode",E=>()=>E.call(S),E=>k=>{if(k==="max")throw C();return E.call(S,k)}),S})(Gs,Pb),qye=((C,u,g)=>()=>{let v=new WeakMap;return{render(S,E){let k=v.get(E);return k!==void 0?Promise.resolve(k):((M,L)=>Y(null,null,function*(){let V=u(M);if(!fe(V,L)){let W={buffer:V.buffer,channelCount:V.channelCount,channelCountMode:V.channelCountMode,channelInterpretation:V.channelInterpretation,disableNormalization:!V.normalize};V=C(L,W)}return v.set(L,V),Qe(V)?yield g(M,L,V.inputs[0]):yield g(M,L,V),V}))(S,E)}}})(lV,tn,as),Uye=((C,u,g,v,S,E)=>class extends C{constructor(k,M){let L=v(k),V=Fe(Fe({},Vg),M),W=g(L,V);super(k,!1,W,S(L)?u():null),this._isBufferNullified=!1,this._nativeConvolverNode=W,V.buffer!==null&&E(this,V.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(k){if(this._nativeConvolverNode.buffer=k,k===null&&this._nativeConvolverNode.buffer!==null){let M=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=M.createBuffer(1,1,M.sampleRate),this._isBufferNullified=!0,E(this,0)}else this._isBufferNullified=!1,E(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(k){this._nativeConvolverNode.normalize=k}})(mo,qye,lV,Tr,hr,md),jye=((C,u,g,v,S)=>E=>{let k=new WeakMap;return{render(M,L){let V=k.get(L);return V!==void 0?Promise.resolve(V):((W,X)=>Y(null,null,function*(){let ce=g(W),re=fe(ce,X);if(!re){let ve={channelCount:ce.channelCount,channelCountMode:ce.channelCountMode,channelInterpretation:ce.channelInterpretation,delayTime:ce.delayTime.value,maxDelayTime:E};ce=u(X,ve)}return k.set(X,ce),re?yield C(X,W.delayTime,ce.delayTime):yield v(X,W.delayTime,ce.delayTime),yield S(W,X,ce),ce}))(M,L)}}})(Pc,GB,tn,Fc,as),Gye=((C,u,g,v,S,E,k)=>class extends C{constructor(M,L){let V=S(M),W=Fe(Fe({},Ob),L),X=v(V,W),ce=E(V);super(M,!1,X,ce?g(W.maxDelayTime):null),this._delayTime=u(this,ce,X.delayTime),k(this,W.maxDelayTime)}get delayTime(){return this._delayTime}})(mo,Ka,jye,GB,Tr,hr,md),pV=(C=>(u,g)=>{let v=u.createDynamicsCompressor();if(ft(v,g),g.channelCount>2||g.channelCountMode==="max")throw C();return Qt(v,g,"attack"),Qt(v,g,"knee"),Qt(v,g,"ratio"),Qt(v,g,"release"),Qt(v,g,"threshold"),v})(Gs),Wye=((C,u,g,v,S)=>()=>{let E=new WeakMap;return{render(k,M){let L=E.get(M);return L!==void 0?Promise.resolve(L):((V,W)=>Y(null,null,function*(){let X=g(V),ce=fe(X,W);if(!ce){let re={attack:X.attack.value,channelCount:X.channelCount,channelCountMode:X.channelCountMode,channelInterpretation:X.channelInterpretation,knee:X.knee.value,ratio:X.ratio.value,release:X.release.value,threshold:X.threshold.value};X=u(W,re)}return E.set(W,X),ce?(yield C(W,V.attack,X.attack),yield C(W,V.knee,X.knee),yield C(W,V.ratio,X.ratio),yield C(W,V.release,X.release),yield C(W,V.threshold,X.threshold)):(yield v(W,V.attack,X.attack),yield v(W,V.knee,X.knee),yield v(W,V.ratio,X.ratio),yield v(W,V.release,X.release),yield v(W,V.threshold,X.threshold)),yield S(V,W,X),X}))(k,M)}}})(Pc,pV,tn,Fc,as),Hye=((C,u,g,v,S,E,k,M)=>class extends C{constructor(L,V){let W=E(L),X=Fe(Fe({},qg),V),ce=v(W,X),re=k(W);super(L,!1,ce,re?g():null),this._attack=u(this,re,ce.attack),this._knee=u(this,re,ce.knee),this._nativeDynamicsCompressorNode=ce,this._ratio=u(this,re,ce.ratio),this._release=u(this,re,ce.release),this._threshold=u(this,re,ce.threshold),M(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(L){let V=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=L,L>2)throw this._nativeDynamicsCompressorNode.channelCount=V,S()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(L){let V=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=L,L==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=V,S()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(mo,Ka,Wye,pV,Gs,Tr,hr,md),Kye=((C,u,g,v,S)=>()=>{let E=new WeakMap;return{render(k,M){let L=E.get(M);return L!==void 0?Promise.resolve(L):((V,W)=>Y(null,null,function*(){let X=g(V),ce=fe(X,W);if(!ce){let re={channelCount:X.channelCount,channelCountMode:X.channelCountMode,channelInterpretation:X.channelInterpretation,gain:X.gain.value};X=u(W,re)}return E.set(W,X),ce?yield C(W,V.gain,X.gain):yield v(W,V.gain,X.gain),yield S(V,W,X),X}))(k,M)}}})(Pc,ci,tn,Fc,as),Xye=((C,u,g,v,S,E)=>class extends C{constructor(k,M){let L=S(k),V=Fe(Fe({},Hk),M),W=v(L,V),X=E(L);super(k,!1,W,X?g():null),this._gain=u(this,X,W.gain,ke,be)}get gain(){return this._gain}})(mo,Ka,Kye,ci,Tr,hr),Qye=((C,u,g,v)=>(S,E,{channelCount:k,channelCountMode:M,channelInterpretation:L,feedback:V,feedforward:W})=>{let X=Pl(E,S.sampleRate),ce=V instanceof Float64Array?V:new Float64Array(V),re=W instanceof Float64Array?W:new Float64Array(W),ve=ce.length,_e=re.length,me=Math.min(ve,_e);if(ve===0||ve>20)throw v();if(ce[0]===0)throw u();if(_e===0||_e>20)throw v();if(re[0]===0)throw u();if(ce[0]!==1){for(let Ie=0;Ie<_e;Ie+=1)re[Ie]/=ce[0];for(let Ie=1;Ie<ve;Ie+=1)ce[Ie]/=ce[0]}let Ne=g(S,X,k,k);Ne.channelCount=k,Ne.channelCountMode=M,Ne.channelInterpretation=L;let Oe=[],Be=[],We=[];for(let Ie=0;Ie<k;Ie+=1){Oe.push(0);let Ue=new Float32Array(32),Pe=new Float32Array(32);Ue.fill(0),Pe.fill(0),Be.push(Ue),We.push(Pe)}Ne.onaudioprocess=Ie=>{let Ue=Ie.inputBuffer,Pe=Ie.outputBuffer,et=Ue.numberOfChannels;for(let Xe=0;Xe<et;Xe+=1){let nt=Ue.getChannelData(Xe),tt=Pe.getChannelData(Xe);Oe[Xe]=$e(ce,ve,re,_e,me,Be[Xe],We[Xe],Oe[Xe],32,nt,tt)}};let Me=S.sampleRate/2;return Ug({get bufferSize(){return X},get channelCount(){return Ne.channelCount},set channelCount(Ie){Ne.channelCount=Ie},get channelCountMode(){return Ne.channelCountMode},set channelCountMode(Ie){Ne.channelCountMode=Ie},get channelInterpretation(){return Ne.channelInterpretation},set channelInterpretation(Ie){Ne.channelInterpretation=Ie},get context(){return Ne.context},get inputs(){return[Ne]},get numberOfInputs(){return Ne.numberOfInputs},get numberOfOutputs(){return Ne.numberOfOutputs},addEventListener:(...Ie)=>Ne.addEventListener(Ie[0],Ie[1],Ie[2]),dispatchEvent:(...Ie)=>Ne.dispatchEvent(Ie[0]),getFrequencyResponse(Ie,Ue,Pe){if(Ie.length!==Ue.length||Ue.length!==Pe.length)throw C();let et=Ie.length;for(let Xe=0;Xe<et;Xe+=1){let nt=-Math.PI*(Ie[Xe]/Me),tt=[Math.cos(nt),Math.sin(nt)],lt=fye(WB(re,tt),WB(ce,tt));Ue[Xe]=Math.sqrt(lt[0]*lt[0]+lt[1]*lt[1]),Pe[Xe]=Math.atan2(lt[1],lt[0])}},removeEventListener:(...Ie)=>Ne.removeEventListener(Ie[0],Ie[1],Ie[2])},Ne)})(fd,fo,Rb,Gs),tC=((C,u,g,v)=>S=>C(ot,()=>ot(S))?Promise.resolve(C(v,v)).then(E=>{if(!E){let k=g(S,512,0,1);S.oncomplete=()=>{k.onaudioprocess=null,k.disconnect()},k.onaudioprocess=()=>S.currentTime,k.connect(S.destination)}return S.startRendering()}):new Promise(E=>{let k=u(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});S.oncomplete=M=>{k.disconnect(),E(M.renderedBuffer)},k.connect(S.destination),S.startRendering()}))(ra,ci,Rb,((C,u)=>()=>{if(u===null)return Promise.resolve(!1);let g=new u(1,1,44100),v=C(g,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(S=>{g.oncomplete=()=>{v.disconnect(),S(g.currentTime!==0)},g.startRendering()})})(ci,Uo)),Yye=((C,u,g,v,S)=>(E,k)=>{let M=new WeakMap,L=null;return{render(V,W){let X=M.get(W);return X!==void 0?Promise.resolve(X):((ce,re)=>Y(null,null,function*(){let ve=null,_e=u(ce),me=fe(_e,re);if(re.createIIRFilter===void 0?ve=C(re,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):me||(_e=re.createIIRFilter(k,E)),M.set(re,ve===null?_e:ve),ve!==null){if(L===null){if(g===null)throw new Error("Missing the native OfflineAudioContext constructor.");let Oe=new g(ce.context.destination.channelCount,ce.context.length,re.sampleRate);L=Y(null,null,function*(){return yield v(ce,Oe,Oe.destination),((Be,We,Me,Ie)=>{let Ue=Me instanceof Float64Array?Me:new Float64Array(Me),Pe=Ie instanceof Float64Array?Ie:new Float64Array(Ie),et=Ue.length,Xe=Pe.length,nt=Math.min(et,Xe);if(Ue[0]!==1){for(let Nt=0;Nt<et;Nt+=1)Pe[Nt]/=Ue[0];for(let Nt=1;Nt<Xe;Nt+=1)Ue[Nt]/=Ue[0]}let tt=new Float32Array(32),lt=new Float32Array(32),Tt=We.createBuffer(Be.numberOfChannels,Be.length,Be.sampleRate),wt=Be.numberOfChannels;for(let Nt=0;Nt<wt;Nt+=1){let en=Be.getChannelData(Nt),St=Tt.getChannelData(Nt);tt.fill(0),lt.fill(0),$e(Ue,et,Pe,Xe,nt,tt,lt,0,32,en,St)}return Tt})(yield S(Oe),re,E,k)})}let Ne=yield L;return ve.buffer=Ne,ve.start(0),ve}return yield v(ce,re,_e),_e}))(V,W)}}})(Wg,tn,Uo,as,tC),Zye=(C=>(u,g,v)=>{if(u.createIIRFilter===void 0)return C(u,g,v);let S=u.createIIRFilter(v.feedforward,v.feedback);return ft(S,v),S})(Qye),Jye=((C,u,g,v,S,E)=>class extends C{constructor(k,M){let L=v(k),V=S(L),W=Fe(Fe({},ZS),M),X=u(L,V?null:k.baseLatency,W);super(k,!1,X,V?g(W.feedback,W.feedforward):null),(ce=>{var re;ce.getFrequencyResponse=(re=ce.getFrequencyResponse,(ve,_e,me)=>{if(ve.length!==_e.length||_e.length!==me.length)throw fd();return re.call(ce,ve,_e,me)})})(X),this._nativeIIRFilterNode=X,E(this,1)}getFrequencyResponse(k,M,L){return this._nativeIIRFilterNode.getFrequencyResponse(k,M,L)}})(mo,Zye,Yye,Tr,hr,md),exe=((C,u,g,v,S,E,k,M)=>(L,V)=>{let W=V.listener,{forwardX:X,forwardY:ce,forwardZ:re,positionX:ve,positionY:_e,positionZ:me,upX:Ne,upY:Oe,upZ:Be}=W.forwardX===void 0?(()=>{let We=new Float32Array(1),Me=u(V,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),Ie=k(V),Ue=!1,Pe=[0,0,-1,0,1,0],et=[0,0,0],Xe=()=>{if(Ue)return;Ue=!0;let Tt=v(V,256,9,0);Tt.onaudioprocess=({inputBuffer:wt})=>{let Nt=[E(wt,We,0),E(wt,We,1),E(wt,We,2),E(wt,We,3),E(wt,We,4),E(wt,We,5)];Nt.some((St,cn)=>St!==Pe[cn])&&(W.setOrientation(...Nt),Pe=Nt);let en=[E(wt,We,6),E(wt,We,7),E(wt,We,8)];en.some((St,cn)=>St!==et[cn])&&(W.setPosition(...en),et=en)},Me.connect(Tt)},nt=Tt=>wt=>{wt!==Pe[Tt]&&(Pe[Tt]=wt,W.setOrientation(...Pe))},tt=Tt=>wt=>{wt!==et[Tt]&&(et[Tt]=wt,W.setPosition(...et))},lt=(Tt,wt,Nt)=>{let en=g(V,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:wt});en.connect(Me,0,Tt),en.start(),Object.defineProperty(en.offset,"defaultValue",{get:()=>wt});let St=C({context:L},Ie,en.offset,ke,be);var cn,Tn,jr,Qr,or,hi,ks;return M(St,"value",Qn=>()=>Qn.call(St),Qn=>qt=>{try{Qn.call(St,qt)}catch(xt){if(xt.code!==9)throw xt}Xe(),Ie&&Nt(qt)}),St.cancelAndHoldAtTime=(cn=St.cancelAndHoldAtTime,Ie?()=>{throw S()}:(...Qn)=>{let qt=cn.apply(St,Qn);return Xe(),qt}),St.cancelScheduledValues=(Tn=St.cancelScheduledValues,Ie?()=>{throw S()}:(...Qn)=>{let qt=Tn.apply(St,Qn);return Xe(),qt}),St.exponentialRampToValueAtTime=(jr=St.exponentialRampToValueAtTime,Ie?()=>{throw S()}:(...Qn)=>{let qt=jr.apply(St,Qn);return Xe(),qt}),St.linearRampToValueAtTime=(Qr=St.linearRampToValueAtTime,Ie?()=>{throw S()}:(...Qn)=>{let qt=Qr.apply(St,Qn);return Xe(),qt}),St.setTargetAtTime=(or=St.setTargetAtTime,Ie?()=>{throw S()}:(...Qn)=>{let qt=or.apply(St,Qn);return Xe(),qt}),St.setValueAtTime=(hi=St.setValueAtTime,Ie?()=>{throw S()}:(...Qn)=>{let qt=hi.apply(St,Qn);return Xe(),qt}),St.setValueCurveAtTime=(ks=St.setValueCurveAtTime,Ie?()=>{throw S()}:(...Qn)=>{let qt=ks.apply(St,Qn);return Xe(),qt}),St};return{forwardX:lt(0,0,nt(0)),forwardY:lt(1,0,nt(1)),forwardZ:lt(2,-1,nt(2)),positionX:lt(6,0,tt(0)),positionY:lt(7,0,tt(1)),positionZ:lt(8,0,tt(2)),upX:lt(3,0,nt(3)),upY:lt(4,1,nt(4)),upZ:lt(5,0,nt(5))}})():W;return{get forwardX(){return X},get forwardY(){return ce},get forwardZ(){return re},get positionX(){return ve},get positionY(){return _e},get positionZ(){return me},get upX(){return Ne},get upY(){return Oe},get upZ(){return Be}}})(Ka,Ah,Hg,Rb,Gs,HB,hr,Pb),hV=new WeakMap,txe=((C,u,g,v,S,E)=>class extends g{constructor(k,M){super(k),this._nativeContext=k,d.set(this,k),v(k)&&S.set(k,new Set),this._destination=new C(this,M),this._listener=u(this,k),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(k){let M=typeof k=="function"?E(this,k):null;this._nativeContext.onstatechange=M;let L=this._nativeContext.onstatechange;this._onstatechange=L!==null&&L===M?k:L}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(Aye,exe,nV,hr,hV,jg),fV=((C,u,g,v,S,E)=>(k,M)=>{let L=k.createOscillator();return ft(L,M),Qt(L,M,"detune"),Qt(L,M,"frequency"),M.periodicWave!==void 0?L.setPeriodicWave(M.periodicWave):ht(L,M,"type"),u(g,()=>g(k))||ar(L),u(v,()=>v(k))||E(L,k),u(S,()=>S(k))||na(L),C(k,L),L})(eC,ra,Kk,QB,Xk,YB),nxe=((C,u,g,v,S)=>()=>{let E=new WeakMap,k=null,M=null,L=null;return{set periodicWave(V){k=V},set start(V){M=V},set stop(V){L=V},render(V,W){let X=E.get(W);return X!==void 0?Promise.resolve(X):((ce,re)=>Y(null,null,function*(){let ve=g(ce),_e=fe(ve,re);if(!_e){let me={channelCount:ve.channelCount,channelCountMode:ve.channelCountMode,channelInterpretation:ve.channelInterpretation,detune:ve.detune.value,frequency:ve.frequency.value,periodicWave:k===null?void 0:k,type:ve.type};ve=u(re,me),M!==null&&ve.start(M),L!==null&&ve.stop(L)}return E.set(re,ve),_e?(yield C(re,ce.detune,ve.detune),yield C(re,ce.frequency,ve.frequency)):(yield v(re,ce.detune,ve.detune),yield v(re,ce.frequency,ve.frequency)),yield S(ce,re,ve),ve}))(V,W)}}})(Pc,fV,tn,Fc,as),rxe=((C,u,g,v,S,E,k)=>class extends C{constructor(M,L){let V=S(M),W=Fe(Fe({},mye),L),X=g(V,W),ce=E(V),re=ce?v():null,ve=M.sampleRate/2;super(M,!1,X,re),this._detune=u(this,ce,X.detune,153600,-153600),this._frequency=u(this,ce,X.frequency,ve,-ve),this._nativeOscillatorNode=X,this._onended=null,this._oscillatorNodeRenderer=re,this._oscillatorNodeRenderer!==null&&W.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=W.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(M){let L=typeof M=="function"?k(this,M):null;this._nativeOscillatorNode.onended=L;let V=this._nativeOscillatorNode.onended;this._onended=V!==null&&V===L?M:V}get type(){return this._nativeOscillatorNode.type}set type(M){this._nativeOscillatorNode.type=M,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(M){this._nativeOscillatorNode.setPeriodicWave(M),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=M)}start(M=0){if(this._nativeOscillatorNode.start(M),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=M),this.context.state!=="closed"){Q(this);let L=()=>{this._nativeOscillatorNode.removeEventListener("ended",L),De(this)&&pe(this)};this._nativeOscillatorNode.addEventListener("ended",L)}}stop(M=0){this._nativeOscillatorNode.stop(M),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=M)}})(mo,Ka,fV,nxe,Tr,hr,jg),dV=(C=>(u,g)=>{let v=C(u,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),S=u.createBuffer(1,2,44100);return v.buffer=S,v.loop=!0,v.connect(g),v.start(),()=>{v.stop(),v.disconnect(g)}})(Wg),oxe=((C,u,g,v,S)=>(E,V)=>{var W=V,{curve:k,oversample:M}=W,L=Zb(W,["curve","oversample"]);let X=E.createWaveShaper(),ce=E.createWaveShaper();ft(X,L),ft(ce,L);let re=g(E,vt(Fe({},L),{gain:1})),ve=g(E,vt(Fe({},L),{gain:-1})),_e=g(E,vt(Fe({},L),{gain:1})),me=g(E,vt(Fe({},L),{gain:-1})),Ne=null,Oe=!1,Be=null,We={get bufferSize(){},get channelCount(){return X.channelCount},set channelCount(Me){re.channelCount=Me,ve.channelCount=Me,X.channelCount=Me,_e.channelCount=Me,ce.channelCount=Me,me.channelCount=Me},get channelCountMode(){return X.channelCountMode},set channelCountMode(Me){re.channelCountMode=Me,ve.channelCountMode=Me,X.channelCountMode=Me,_e.channelCountMode=Me,ce.channelCountMode=Me,me.channelCountMode=Me},get channelInterpretation(){return X.channelInterpretation},set channelInterpretation(Me){re.channelInterpretation=Me,ve.channelInterpretation=Me,X.channelInterpretation=Me,_e.channelInterpretation=Me,ce.channelInterpretation=Me,me.channelInterpretation=Me},get context(){return X.context},get curve(){return Be},set curve(Me){if(Me!==null&&Me.length<2)throw u();if(Me===null)X.curve=Me,ce.curve=Me;else{let Ie=Me.length,Ue=new Float32Array(Ie+2-Ie%2),Pe=new Float32Array(Ie+2-Ie%2);Ue[0]=Me[0],Pe[0]=-Me[Ie-1];let et=Math.ceil((Ie+1)/2),Xe=(Ie+1)/2-1;for(let nt=1;nt<et;nt+=1){let tt=nt/et*Xe,lt=Math.floor(tt),Tt=Math.ceil(tt);Ue[nt]=lt===Tt?Me[lt]:(1-(tt-lt))*Me[lt]+(1-(Tt-tt))*Me[Tt],Pe[nt]=lt===Tt?-Me[Ie-1-lt]:-(1-(tt-lt))*Me[Ie-1-lt]-(1-(Tt-tt))*Me[Ie-1-Tt]}Ue[et]=Ie%2==1?Me[et-1]:(Me[et-2]+Me[et-1])/2,X.curve=Ue,ce.curve=Pe}Be=Me,Oe&&(v(Be)&&Ne===null?Ne=C(E,re):Ne!==null&&(Ne(),Ne=null))},get inputs(){return[re]},get numberOfInputs(){return X.numberOfInputs},get numberOfOutputs(){return X.numberOfOutputs},get oversample(){return X.oversample},set oversample(Me){X.oversample=Me,ce.oversample=Me},addEventListener:(...Me)=>re.addEventListener(Me[0],Me[1],Me[2]),dispatchEvent:(...Me)=>re.dispatchEvent(Me[0]),removeEventListener:(...Me)=>re.removeEventListener(Me[0],Me[1],Me[2])};return k!==null&&(We.curve=k instanceof Float32Array?k:new Float32Array(k)),M!==We.oversample&&(We.oversample=M),S(Ug(We,_e),()=>{re.connect(X).connect(_e),re.connect(ve).connect(ce).connect(me).connect(_e),Oe=!0,v(Be)&&(Ne=C(E,re))},()=>{re.disconnect(X),X.disconnect(_e),re.disconnect(ve),ve.disconnect(ce),ce.disconnect(me),me.disconnect(_e),Oe=!1,Ne!==null&&(Ne(),Ne=null)})})(dV,fo,ci,KB,kh),nC=((C,u,g,v,S,E,k)=>(M,L)=>{let V=M.createWaveShaper();if(E!==null&&E.name==="webkitAudioContext"&&M.createGain().gain.automationRate===void 0)return g(M,L);ft(V,L);let W=L.curve===null||L.curve instanceof Float32Array?L.curve:new Float32Array(L.curve);if(W!==null&&W.length<2)throw u();ht(V,{curve:W},"curve"),ht(V,L,"oversample");let X=null,ce=!1;return k(V,"curve",re=>()=>re.call(V),re=>ve=>(re.call(V,ve),ce&&(v(ve)&&X===null?X=C(M,V):v(ve)||X===null||(X(),X=null)),ve)),S(V,()=>{ce=!0,v(V.curve)&&(X=C(M,V))},()=>{ce=!1,X!==null&&(X(),X=null)})})(dV,fo,oxe,KB,kh,Dh,Pb),sxe=((C,u,g,v,S,E,k,M,L,V)=>(W,Xe)=>{var nt=Xe,{coneInnerAngle:X,coneOuterAngle:ce,coneOuterGain:re,distanceModel:ve,maxDistance:_e,orientationX:me,orientationY:Ne,orientationZ:Oe,panningModel:Be,positionX:We,positionY:Me,positionZ:Ie,refDistance:Ue,rolloffFactor:Pe}=nt,et=Zb(nt,["coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","orientationX","orientationY","orientationZ","panningModel","positionX","positionY","positionZ","refDistance","rolloffFactor"]);let tt=W.createPanner();if(et.channelCount>2||et.channelCountMode==="max")throw k();ft(tt,et);let lt={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},Tt=g(W,vt(Fe({},lt),{channelInterpretation:"speakers",numberOfInputs:6})),wt=v(W,vt(Fe({},et),{gain:1})),Nt=v(W,vt(Fe({},lt),{gain:1})),en=v(W,vt(Fe({},lt),{gain:0})),St=v(W,vt(Fe({},lt),{gain:0})),cn=v(W,vt(Fe({},lt),{gain:0})),Tn=v(W,vt(Fe({},lt),{gain:0})),jr=v(W,vt(Fe({},lt),{gain:0})),Qr=S(W,256,6,1),or=E(W,vt(Fe({},lt),{curve:new Float32Array([1,1]),oversample:"none"})),hi=[me,Ne,Oe],ks=[We,Me,Ie],Qn=new Float32Array(1);Qr.onaudioprocess=({inputBuffer:xt})=>{let ps=[L(xt,Qn,0),L(xt,Qn,1),L(xt,Qn,2)];ps.some((Ed,Nd)=>Ed!==hi[Nd])&&(tt.setOrientation(...ps),hi=ps);let zh=[L(xt,Qn,3),L(xt,Qn,4),L(xt,Qn,5)];zh.some((Ed,Nd)=>Ed!==ks[Nd])&&(tt.setPosition(...zh),ks=zh)},Object.defineProperty(en.gain,"defaultValue",{get:()=>0}),Object.defineProperty(St.gain,"defaultValue",{get:()=>0}),Object.defineProperty(cn.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Tn.gain,"defaultValue",{get:()=>0}),Object.defineProperty(jr.gain,"defaultValue",{get:()=>0});let qt={get bufferSize(){},get channelCount(){return tt.channelCount},set channelCount(xt){if(xt>2)throw k();wt.channelCount=xt,tt.channelCount=xt},get channelCountMode(){return tt.channelCountMode},set channelCountMode(xt){if(xt==="max")throw k();wt.channelCountMode=xt,tt.channelCountMode=xt},get channelInterpretation(){return tt.channelInterpretation},set channelInterpretation(xt){wt.channelInterpretation=xt,tt.channelInterpretation=xt},get coneInnerAngle(){return tt.coneInnerAngle},set coneInnerAngle(xt){tt.coneInnerAngle=xt},get coneOuterAngle(){return tt.coneOuterAngle},set coneOuterAngle(xt){tt.coneOuterAngle=xt},get coneOuterGain(){return tt.coneOuterGain},set coneOuterGain(xt){if(xt<0||xt>1)throw u();tt.coneOuterGain=xt},get context(){return tt.context},get distanceModel(){return tt.distanceModel},set distanceModel(xt){tt.distanceModel=xt},get inputs(){return[wt]},get maxDistance(){return tt.maxDistance},set maxDistance(xt){if(xt<0)throw new RangeError;tt.maxDistance=xt},get numberOfInputs(){return tt.numberOfInputs},get numberOfOutputs(){return tt.numberOfOutputs},get orientationX(){return Nt.gain},get orientationY(){return en.gain},get orientationZ(){return St.gain},get panningModel(){return tt.panningModel},set panningModel(xt){tt.panningModel=xt},get positionX(){return cn.gain},get positionY(){return Tn.gain},get positionZ(){return jr.gain},get refDistance(){return tt.refDistance},set refDistance(xt){if(xt<0)throw new RangeError;tt.refDistance=xt},get rolloffFactor(){return tt.rolloffFactor},set rolloffFactor(xt){if(xt<0)throw new RangeError;tt.rolloffFactor=xt},addEventListener:(...xt)=>wt.addEventListener(xt[0],xt[1],xt[2]),dispatchEvent:(...xt)=>wt.dispatchEvent(xt[0]),removeEventListener:(...xt)=>wt.removeEventListener(xt[0],xt[1],xt[2])};return X!==qt.coneInnerAngle&&(qt.coneInnerAngle=X),ce!==qt.coneOuterAngle&&(qt.coneOuterAngle=ce),re!==qt.coneOuterGain&&(qt.coneOuterGain=re),ve!==qt.distanceModel&&(qt.distanceModel=ve),_e!==qt.maxDistance&&(qt.maxDistance=_e),me!==qt.orientationX.value&&(qt.orientationX.value=me),Ne!==qt.orientationY.value&&(qt.orientationY.value=Ne),Oe!==qt.orientationZ.value&&(qt.orientationZ.value=Oe),Be!==qt.panningModel&&(qt.panningModel=Be),We!==qt.positionX.value&&(qt.positionX.value=We),Me!==qt.positionY.value&&(qt.positionY.value=Me),Ie!==qt.positionZ.value&&(qt.positionZ.value=Ie),Ue!==qt.refDistance&&(qt.refDistance=Ue),Pe!==qt.rolloffFactor&&(qt.rolloffFactor=Pe),hi[0]===1&&hi[1]===0&&hi[2]===0||tt.setOrientation(...hi),ks[0]===0&&ks[1]===0&&ks[2]===0||tt.setPosition(...ks),V(Ug(qt,tt),()=>{wt.connect(tt),C(wt,or,0,0),or.connect(Nt).connect(Tt,0,0),or.connect(en).connect(Tt,0,1),or.connect(St).connect(Tt,0,2),or.connect(cn).connect(Tt,0,3),or.connect(Tn).connect(Tt,0,4),or.connect(jr).connect(Tt,0,5),Tt.connect(Qr).connect(W.destination)},()=>{wt.disconnect(tt),M(wt,or,0,0),or.disconnect(Nt),Nt.disconnect(Tt),or.disconnect(en),en.disconnect(Tt),or.disconnect(St),St.disconnect(Tt),or.disconnect(cn),cn.disconnect(Tt),or.disconnect(Tn),Tn.disconnect(Tt),or.disconnect(jr),jr.disconnect(Tt),Tt.disconnect(Qr),Qr.disconnect(W.destination)})})(dt,fo,Ah,ci,Rb,nC,Gs,ss,HB,kh),mV=(C=>(u,g)=>{let v=u.createPanner();return v.orientationX===void 0?C(u,g):(ft(v,g),Qt(v,g,"orientationX"),Qt(v,g,"orientationY"),Qt(v,g,"orientationZ"),Qt(v,g,"positionX"),Qt(v,g,"positionY"),Qt(v,g,"positionZ"),ht(v,g,"coneInnerAngle"),ht(v,g,"coneOuterAngle"),ht(v,g,"coneOuterGain"),ht(v,g,"distanceModel"),ht(v,g,"maxDistance"),ht(v,g,"panningModel"),ht(v,g,"refDistance"),ht(v,g,"rolloffFactor"),v)})(sxe),ixe=((C,u,g,v,S,E,k,M,L,V)=>()=>{let W=new WeakMap,X=null;return{render(ce,re){let ve=W.get(re);return ve!==void 0?Promise.resolve(ve):((_e,me)=>Y(null,null,function*(){let Ne=null,Oe=E(_e),Be={channelCount:Oe.channelCount,channelCountMode:Oe.channelCountMode,channelInterpretation:Oe.channelInterpretation},We=vt(Fe({},Be),{coneInnerAngle:Oe.coneInnerAngle,coneOuterAngle:Oe.coneOuterAngle,coneOuterGain:Oe.coneOuterGain,distanceModel:Oe.distanceModel,maxDistance:Oe.maxDistance,panningModel:Oe.panningModel,refDistance:Oe.refDistance,rolloffFactor:Oe.rolloffFactor}),Me=fe(Oe,me);if("bufferSize"in Oe)Ne=v(me,vt(Fe({},Be),{gain:1}));else if(!Me){let Ie=vt(Fe({},We),{orientationX:Oe.orientationX.value,orientationY:Oe.orientationY.value,orientationZ:Oe.orientationZ.value,positionX:Oe.positionX.value,positionY:Oe.positionY.value,positionZ:Oe.positionZ.value});Oe=S(me,Ie)}if(W.set(me,Ne===null?Oe:Ne),Ne!==null){if(X===null){if(k===null)throw new Error("Missing the native OfflineAudioContext constructor.");let lt=new k(6,_e.context.length,me.sampleRate),Tt=u(lt,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});Tt.connect(lt.destination),X=Y(null,null,function*(){let wt=yield Promise.all([_e.orientationX,_e.orientationY,_e.orientationZ,_e.positionX,_e.positionY,_e.positionZ].map((Nt,en)=>Y(null,null,function*(){let St=g(lt,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:en===0?1:0});return yield M(lt,Nt,St.offset),St})));for(let Nt=0;Nt<6;Nt+=1)wt[Nt].connect(Tt,0,Nt),wt[Nt].start(0);return V(lt)})}let Ie=yield X,Ue=v(me,vt(Fe({},Be),{gain:1}));yield L(_e,me,Ue);let Pe=[];for(let lt=0;lt<Ie.numberOfChannels;lt+=1)Pe.push(Ie.getChannelData(lt));let et=[Pe[0][0],Pe[1][0],Pe[2][0]],Xe=[Pe[3][0],Pe[4][0],Pe[5][0]],nt=v(me,vt(Fe({},Be),{gain:1})),tt=S(me,vt(Fe({},We),{orientationX:et[0],orientationY:et[1],orientationZ:et[2],positionX:Xe[0],positionY:Xe[1],positionZ:Xe[2]}));Ue.connect(nt).connect(tt.inputs[0]),tt.connect(Ne);for(let lt=128;lt<Ie.length;lt+=128){let Tt=[Pe[0][lt],Pe[1][lt],Pe[2][lt]],wt=[Pe[3][lt],Pe[4][lt],Pe[5][lt]];if(Tt.some((Nt,en)=>Nt!==et[en])||wt.some((Nt,en)=>Nt!==Xe[en])){et=Tt,Xe=wt;let Nt=lt/me.sampleRate;nt.gain.setValueAtTime(0,Nt),nt=v(me,vt(Fe({},Be),{gain:0})),tt=S(me,vt(Fe({},We),{orientationX:et[0],orientationY:et[1],orientationZ:et[2],positionX:Xe[0],positionY:Xe[1],positionZ:Xe[2]})),nt.gain.setValueAtTime(1,Nt),Ue.connect(nt).connect(tt.inputs[0]),tt.connect(Ne)}}return Ne}return Me?(yield C(me,_e.orientationX,Oe.orientationX),yield C(me,_e.orientationY,Oe.orientationY),yield C(me,_e.orientationZ,Oe.orientationZ),yield C(me,_e.positionX,Oe.positionX),yield C(me,_e.positionY,Oe.positionY),yield C(me,_e.positionZ,Oe.positionZ)):(yield M(me,_e.orientationX,Oe.orientationX),yield M(me,_e.orientationY,Oe.orientationY),yield M(me,_e.orientationZ,Oe.orientationZ),yield M(me,_e.positionX,Oe.positionX),yield M(me,_e.positionY,Oe.positionY),yield M(me,_e.positionZ,Oe.positionZ)),Qe(Oe)?yield L(_e,me,Oe.inputs[0]):yield L(_e,me,Oe),Oe}))(ce,re)}}})(Pc,Ah,Hg,ci,mV,tn,Uo,Fc,as,tC),axe=((C,u,g,v,S,E,k)=>class extends C{constructor(M,L){let V=S(M),W=Fe(Fe({},gye),L),X=g(V,W),ce=E(V);super(M,!1,X,ce?v():null),this._nativePannerNode=X,this._orientationX=u(this,ce,X.orientationX,ke,be),this._orientationY=u(this,ce,X.orientationY,ke,be),this._orientationZ=u(this,ce,X.orientationZ,ke,be),this._positionX=u(this,ce,X.positionX,ke,be),this._positionY=u(this,ce,X.positionY,ke,be),this._positionZ=u(this,ce,X.positionZ,ke,be),k(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(M){this._nativePannerNode.coneInnerAngle=M}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(M){this._nativePannerNode.coneOuterAngle=M}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(M){this._nativePannerNode.coneOuterGain=M}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(M){this._nativePannerNode.distanceModel=M}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(M){this._nativePannerNode.maxDistance=M}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(M){this._nativePannerNode.panningModel=M}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(M){this._nativePannerNode.refDistance=M}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(M){this._nativePannerNode.rolloffFactor=M}})(mo,Ka,mV,ixe,Tr,hr,md),cxe=(C=>(u,{disableNormalization:g,imag:v,real:S})=>{let E=v instanceof Float32Array?v:new Float32Array(v),k=S instanceof Float32Array?S:new Float32Array(S),M=u.createPeriodicWave(k,E,{disableNormalization:g});if(Array.from(v).length<2)throw C();return M})(se),uxe=((C,u,g,v)=>class uye{constructor(E,k){let M=u(E),L=(W=>{let{imag:X,real:ce}=W;return X===void 0?ce===void 0?vt(Fe({},W),{imag:[0,0],real:[0,0]}):vt(Fe({},W),{imag:Array.from(ce,()=>0),real:ce}):ce===void 0?vt(Fe({},W),{imag:X,real:Array.from(X,()=>0)}):vt(Fe({},W),{imag:X,real:ce})})(Fe(Fe({},yye),k)),V=C(M,L);return g.add(V),V}static[Symbol.hasInstance](E){return E!==null&&typeof E=="object"&&Object.getPrototypeOf(E)===uye.prototype||g.has(E)}})(cxe,Tr,new WeakSet),lxe=((C,u,g,v,S,E)=>{let M=new Float32Array([1,1]),L=Math.PI/2,V={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},W=vt(Fe({},V),{oversample:"none"}),X=(ce,re,ve,_e,me)=>{if(re===1)return((Ne,Oe,Be,We)=>{let Me=new Float32Array(16385),Ie=new Float32Array(16385);for(let tt=0;tt<16385;tt+=1){let lt=tt/16384*L;Me[tt]=Math.cos(lt),Ie[tt]=Math.sin(lt)}let Ue=g(Ne,vt(Fe({},V),{gain:0})),Pe=v(Ne,vt(Fe({},W),{curve:Me})),et=v(Ne,vt(Fe({},W),{curve:M})),Xe=g(Ne,vt(Fe({},V),{gain:0})),nt=v(Ne,vt(Fe({},W),{curve:Ie}));return{connectGraph(){Oe.connect(Ue),Oe.connect(et.inputs===void 0?et:et.inputs[0]),Oe.connect(Xe),et.connect(Be),Be.connect(Pe.inputs===void 0?Pe:Pe.inputs[0]),Be.connect(nt.inputs===void 0?nt:nt.inputs[0]),Pe.connect(Ue.gain),nt.connect(Xe.gain),Ue.connect(We,0,0),Xe.connect(We,0,1)},disconnectGraph(){Oe.disconnect(Ue),Oe.disconnect(et.inputs===void 0?et:et.inputs[0]),Oe.disconnect(Xe),et.disconnect(Be),Be.disconnect(Pe.inputs===void 0?Pe:Pe.inputs[0]),Be.disconnect(nt.inputs===void 0?nt:nt.inputs[0]),Pe.disconnect(Ue.gain),nt.disconnect(Xe.gain),Ue.disconnect(We,0,0),Xe.disconnect(We,0,1)}}})(ce,ve,_e,me);if(re===2)return((Ne,Oe,Be,We)=>{let Me=new Float32Array(16385),Ie=new Float32Array(16385),Ue=new Float32Array(16385),Pe=new Float32Array(16385),et=Math.floor(8192.5);for(let Tn=0;Tn<16385;Tn+=1)if(Tn>et){let jr=(Tn-et)/(16384-et)*L;Me[Tn]=Math.cos(jr),Ie[Tn]=Math.sin(jr),Ue[Tn]=0,Pe[Tn]=1}else{let jr=Tn/(16384-et)*L;Me[Tn]=1,Ie[Tn]=0,Ue[Tn]=Math.cos(jr),Pe[Tn]=Math.sin(jr)}let Xe=u(Ne,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),nt=g(Ne,vt(Fe({},V),{gain:0})),tt=v(Ne,vt(Fe({},W),{curve:Me})),lt=g(Ne,vt(Fe({},V),{gain:0})),Tt=v(Ne,vt(Fe({},W),{curve:Ie})),wt=v(Ne,vt(Fe({},W),{curve:M})),Nt=g(Ne,vt(Fe({},V),{gain:0})),en=v(Ne,vt(Fe({},W),{curve:Ue})),St=g(Ne,vt(Fe({},V),{gain:0})),cn=v(Ne,vt(Fe({},W),{curve:Pe}));return{connectGraph(){Oe.connect(Xe),Oe.connect(wt.inputs===void 0?wt:wt.inputs[0]),Xe.connect(nt,0),Xe.connect(lt,0),Xe.connect(Nt,1),Xe.connect(St,1),wt.connect(Be),Be.connect(tt.inputs===void 0?tt:tt.inputs[0]),Be.connect(Tt.inputs===void 0?Tt:Tt.inputs[0]),Be.connect(en.inputs===void 0?en:en.inputs[0]),Be.connect(cn.inputs===void 0?cn:cn.inputs[0]),tt.connect(nt.gain),Tt.connect(lt.gain),en.connect(Nt.gain),cn.connect(St.gain),nt.connect(We,0,0),Nt.connect(We,0,0),lt.connect(We,0,1),St.connect(We,0,1)},disconnectGraph(){Oe.disconnect(Xe),Oe.disconnect(wt.inputs===void 0?wt:wt.inputs[0]),Xe.disconnect(nt,0),Xe.disconnect(lt,0),Xe.disconnect(Nt,1),Xe.disconnect(St,1),wt.disconnect(Be),Be.disconnect(tt.inputs===void 0?tt:tt.inputs[0]),Be.disconnect(Tt.inputs===void 0?Tt:Tt.inputs[0]),Be.disconnect(en.inputs===void 0?en:en.inputs[0]),Be.disconnect(cn.inputs===void 0?cn:cn.inputs[0]),tt.disconnect(nt.gain),Tt.disconnect(lt.gain),en.disconnect(Nt.gain),cn.disconnect(St.gain),nt.disconnect(We,0,0),Nt.disconnect(We,0,0),lt.disconnect(We,0,1),St.disconnect(We,0,1)}}})(ce,ve,_e,me);throw S()};return(ce,Ne)=>{var Oe=Ne,{channelCount:re,channelCountMode:ve,pan:_e}=Oe,me=Zb(Oe,["channelCount","channelCountMode","pan"]);if(ve==="max")throw S();let Be=C(ce,vt(Fe({},me),{channelCount:1,channelCountMode:ve,numberOfInputs:2})),We=g(ce,vt(Fe({},me),{channelCount:re,channelCountMode:ve,gain:1})),Me=g(ce,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:_e}),{connectGraph:Ie,disconnectGraph:Ue}=X(ce,re,We,Me,Be);Object.defineProperty(Me.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Me.gain,"maxValue",{get:()=>1}),Object.defineProperty(Me.gain,"minValue",{get:()=>-1});let Pe={get bufferSize(){},get channelCount(){return We.channelCount},set channelCount(Xe){We.channelCount!==Xe&&(et&&Ue(),{connectGraph:Ie,disconnectGraph:Ue}=X(ce,Xe,We,Me,Be),et&&Ie()),We.channelCount=Xe},get channelCountMode(){return We.channelCountMode},set channelCountMode(Xe){if(Xe==="clamped-max"||Xe==="max")throw S();We.channelCountMode=Xe},get channelInterpretation(){return We.channelInterpretation},set channelInterpretation(Xe){We.channelInterpretation=Xe},get context(){return We.context},get inputs(){return[We]},get numberOfInputs(){return We.numberOfInputs},get numberOfOutputs(){return We.numberOfOutputs},get pan(){return Me.gain},addEventListener:(...Xe)=>We.addEventListener(Xe[0],Xe[1],Xe[2]),dispatchEvent:(...Xe)=>We.dispatchEvent(Xe[0]),removeEventListener:(...Xe)=>We.removeEventListener(Xe[0],Xe[1],Xe[2])},et=!1;return E(Ug(Pe,Be),()=>{Ie(),et=!0},()=>{Ue(),et=!1})}})(Ah,dd,ci,nC,Gs,kh),gV=((C,u)=>(g,v)=>{let S=v.channelCountMode;if(S==="clamped-max")throw u();if(g.createStereoPanner===void 0)return C(g,v);let E=g.createStereoPanner();return ft(E,v),Qt(E,v,"pan"),Object.defineProperty(E,"channelCountMode",{get:()=>S,set:k=>{if(k!==S)throw u()}}),E})(lxe,Gs),pxe=((C,u,g,v,S)=>()=>{let E=new WeakMap;return{render(k,M){let L=E.get(M);return L!==void 0?Promise.resolve(L):((V,W)=>Y(null,null,function*(){let X=g(V),ce=fe(X,W);if(!ce){let re={channelCount:X.channelCount,channelCountMode:X.channelCountMode,channelInterpretation:X.channelInterpretation,pan:X.pan.value};X=u(W,re)}return E.set(W,X),ce?yield C(W,V.pan,X.pan):yield v(W,V.pan,X.pan),Qe(X)?yield S(V,W,X.inputs[0]):yield S(V,W,X),X}))(k,M)}}})(Pc,gV,tn,Fc,as),hxe=((C,u,g,v,S,E)=>class extends C{constructor(k,M){let L=S(k),V=Fe(Fe({},xye),M),W=g(L,V),X=E(L);super(k,!1,W,X?v():null),this._pan=u(this,X,W.pan)}get pan(){return this._pan}})(mo,Ka,gV,pxe,Tr,hr),fxe=((C,u,g)=>()=>{let v=new WeakMap;return{render(S,E){let k=v.get(E);return k!==void 0?Promise.resolve(k):((M,L)=>Y(null,null,function*(){let V=u(M);if(!fe(V,L)){let W={channelCount:V.channelCount,channelCountMode:V.channelCountMode,channelInterpretation:V.channelInterpretation,curve:V.curve,oversample:V.oversample};V=C(L,W)}return v.set(L,V),Qe(V)?yield g(M,L,V.inputs[0]):yield g(M,L,V),V}))(S,E)}}})(nC,tn,as),dxe=((C,u,g,v,S,E,k)=>class extends C{constructor(M,L){let V=S(M),W=Fe(Fe({},bye),L),X=g(V,W);super(M,!0,X,E(V)?v():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=X,k(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(M){if(M===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(M.length<2)throw u();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=M}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(M){this._nativeWaveShaperNode.oversample=M}})(mo,fo,nC,fxe,Tr,hr,md),yV=(C=>C!==null&&C.isSecureContext)(Ha),rA=(C=>(u,g,v)=>{Object.defineProperties(C,{currentFrame:{configurable:!0,get:()=>Math.round(u*g)},currentTime:{configurable:!0,get:()=>u}});try{return v()}finally{C!==null&&(delete C.currentFrame,delete C.currentTime)}})(Ha),xV=new WeakMap,mxe=((C,u)=>g=>{let v=C.get(g);if(v!==void 0)return v;if(u===null)throw new Error("Missing the native OfflineAudioContext constructor.");return v=new u(1,1,44100),C.set(g,v),v})(xV,Uo),gxe=yV?((C,u,g,v,S,E,k,M,L,V,W,X,ce)=>{let re=0;return(ve,_e,me={credentials:"omit"})=>{let Ne=W.get(ve);if(Ne!==void 0&&Ne.has(_e))return Promise.resolve();let Oe=V.get(ve);if(Oe!==void 0){let Me=Oe.get(_e);if(Me!==void 0)return Me}let Be=E(ve),We=Be.audioWorklet===void 0?S(_e).then(([Me,Ie])=>{let[Ue,Pe]=T(Me,Ie);return g(`${Ue};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${Pe}
})})(window,'_AWGS')`)}).then(()=>{let Me=ce._AWGS.pop();if(Me===void 0)throw new SyntaxError;v(Be.currentTime,Be.sampleRate,()=>Me(class{},void 0,(Ie,Ue)=>{if(Ie.trim()==="")throw u();let Pe=x.get(Be);if(Pe!==void 0){if(Pe.has(Ie))throw u();O(Ue),D(Ue.parameterDescriptors),Pe.set(Ie,Ue)}else O(Ue),D(Ue.parameterDescriptors),x.set(Be,new Map([[Ie,Ue]]))},Be.sampleRate,void 0,void 0))}):Promise.all([S(_e),Promise.resolve(C(X,X))]).then(([[Me,Ie],Ue])=>{let Pe=re+1;re=Pe;let[et,Xe]=T(Me,Ie),nt=new Blob([`${et};((AudioWorkletProcessor,registerProcessor)=>{${Xe}
})(${Ue?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${Ue?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${Ue?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${Pe}',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),tt=URL.createObjectURL(nt);return Be.audioWorklet.addModule(tt,me).then(()=>{if(M(Be))return Be;let lt=k(Be);return lt.audioWorklet.addModule(tt,me).then(()=>lt)}).then(lt=>{if(L===null)throw new SyntaxError;try{new L(lt,`__sac${Pe}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(tt))});return Oe===void 0?V.set(ve,new Map([[_e,We]])):Oe.set(_e,We),We.then(()=>{let Me=W.get(ve);Me===void 0?W.set(ve,new Set([_e])):Me.add(_e)}).finally(()=>{let Me=V.get(ve);Me!==void 0&&Me.delete(_e)}),We}})(ra,Gs,(C=>u=>new Promise((g,v)=>{if(C===null)return void v(new SyntaxError);let S=C.document.head;if(S===null)v(new SyntaxError);else{let E=C.document.createElement("script"),k=new Blob([u],{type:"application/javascript"}),M=URL.createObjectURL(k),L=C.onerror,V=()=>{C.onerror=L,URL.revokeObjectURL(M)};C.onerror=(W,X,ce,re,ve)=>X===M||X===C.location.href&&ce===1&&re===1?(V(),v(ve),!1):L!==null?L(W,X,ce,re,ve):void 0,E.onerror=()=>{V(),v(new SyntaxError)},E.onload=()=>{V(),g()},E.src=M,E.type="module",S.appendChild(E)}}))(Ha),rA,C=>Y(void 0,null,function*(){try{let u=yield fetch(C);if(u.ok)return[yield u.text(),u.url]}catch{}throw new DOMException("","AbortError")}),Tr,mxe,hr,Gg,new WeakMap,new WeakMap,((C,u)=>()=>Y(void 0,null,function*(){if(C===null)return!0;if(u===null)return!1;let g=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),v=new u(1,128,44100),S=URL.createObjectURL(g),E=!1,k=!1;try{yield v.audioWorklet.addModule(S);let M=new C(v,"a",{numberOfOutputs:0}),L=v.createOscillator();M.port.onmessage=()=>E=!0,M.onprocessorerror=()=>k=!0,L.connect(M),L.start(0),yield v.startRendering(),yield new Promise(V=>setTimeout(V))}catch{}finally{URL.revokeObjectURL(S)}return E&&!k}))(Gg,Uo),Ha):void 0,yxe=((C,u)=>g=>C(g)||u(g))(Yk,hr),xxe=((C,u,g,v,S,E,k,M,L,V,W)=>(X,ce)=>{let re=k(X)?X:E(X);if(S.has(ce)){let ve=new DOMException("","DataCloneError");return Promise.reject(ve)}try{S.add(ce)}catch{}return u(L,()=>L(re))?re.decodeAudioData(ce).then(ve=>(hd(ce).catch(()=>{}),u(M,()=>M(ve))||W(ve),C.add(ve),ve)):new Promise((ve,_e)=>{let me=()=>Y(void 0,null,function*(){try{yield hd(ce)}catch{}}),Ne=Oe=>{_e(Oe),me()};try{re.decodeAudioData(ce,Oe=>{typeof Oe.copyFromChannel!="function"&&(V(Oe),ee(Oe)),C.add(Oe),me().then(()=>ve(Oe))},Oe=>{Ne(Oe===null?new DOMException("","EncodingError"):Oe)})}catch(Oe){Ne(Oe)}})})(Jk,ra,0,0,new WeakSet,Tr,yxe,te,ot,tA,nA),vV=((C,u,g,v,S,E,k,M,L,V,W,X,ce,re,ve,_e,me,Ne,Oe,Be)=>class extends ve{constructor(We,Me){super(We,Me),this._nativeContext=We,this._audioWorklet=C===void 0?void 0:{addModule:(Ie,Ue)=>C(this,Ie,Ue)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new u(this)}createBiquadFilter(){return new S(this)}createBuffer(We,Me,Ie){return new g({length:Me,numberOfChannels:We,sampleRate:Ie})}createBufferSource(){return new v(this)}createChannelMerger(We=6){return new E(this,{numberOfInputs:We})}createChannelSplitter(We=6){return new k(this,{numberOfOutputs:We})}createConstantSource(){return new M(this)}createConvolver(){return new L(this)}createDelay(We=1){return new W(this,{maxDelayTime:We})}createDynamicsCompressor(){return new X(this)}createGain(){return new ce(this)}createIIRFilter(We,Me){return new re(this,{feedback:Me,feedforward:We})}createOscillator(){return new _e(this)}createPanner(){return new me(this)}createPeriodicWave(We,Me,Ie={disableNormalization:!1}){return new Ne(this,vt(Fe({},Ie),{imag:Me,real:We}))}createStereoPanner(){return new Oe(this)}createWaveShaper(){return new Be(this)}decodeAudioData(We,Me,Ie){return V(this._nativeContext,We).then(Ue=>(typeof Me=="function"&&Me(Ue),Ue),Ue=>{throw typeof Ie=="function"&&Ie(Ue),Ue})}})(gxe,Nye,aV,kye,Mye,Fye,Lye,Vye,Uye,xxe,Gye,Hye,Xye,Jye,txe,rxe,axe,uxe,hxe,dxe),vxe=((C,u,g,v)=>class extends C{constructor(S,E){let k=g(S),M=((L,V)=>L.createMediaElementSource(V.mediaElement))(k,E);if(v(k))throw TypeError();super(S,!0,M,null),this._nativeMediaElementAudioSourceNode=M}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(mo,0,Tr,hr),bxe=((C,u,g,v)=>class extends C{constructor(S,E){let k=g(S);if(v(k))throw new TypeError;let M=((L,V)=>{let W=L.createMediaStreamDestination();return ft(W,V),W.numberOfOutputs===1&&Object.defineProperty(W,"numberOfOutputs",{get:()=>0}),W})(k,Fe(Fe({},Ve),E));super(S,!1,M,null),this._nativeMediaStreamAudioDestinationNode=M}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(mo,0,Tr,hr),wxe=((C,u,g,v)=>class extends C{constructor(S,E){let k=g(S),M=((L,{mediaStream:V})=>{let W=V.getAudioTracks();W.sort((re,ve)=>re.id<ve.id?-1:re.id>ve.id?1:0);let X=W.slice(0,1),ce=L.createMediaStreamSource(new MediaStream(X));return Object.defineProperty(ce,"mediaStream",{value:V}),ce})(k,E);if(v(k))throw new TypeError;super(S,!0,M,null),this._nativeMediaStreamAudioSourceNode=M}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(mo,0,Tr,hr),Sxe=((C,u)=>(g,{mediaStreamTrack:v})=>{if(typeof g.createMediaStreamTrackSource=="function")return g.createMediaStreamTrackSource(v);let S=new MediaStream([v]),E=g.createMediaStreamSource(S);if(v.kind!=="audio")throw C();if(u(g))throw new TypeError;return E})(fo,hr),Cxe=((C,u,g)=>class extends C{constructor(v,S){let E=g(v);super(v,!0,u(E,S),null)}})(mo,Sxe,Tr),_xe=((C,u,g,v,S,E,k,M,L)=>class extends C{constructor(V={}){if(L===null)throw new Error("Missing the native AudioContext constructor.");let W;try{W=new L(V)}catch(re){throw re.code===12&&re.message==="sampleRate is not in range"?g():re}if(W===null)throw v();if(!(re=>re===void 0||typeof re=="number"||typeof re=="string"&&(re==="balanced"||re==="interactive"||re==="playback"))(V.latencyHint))throw new TypeError(`The provided value '${V.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(V.sampleRate!==void 0&&W.sampleRate!==V.sampleRate)throw g();super(W,2);let{latencyHint:X}=V,{sampleRate:ce}=W;if(this._baseLatency=typeof W.baseLatency=="number"?W.baseLatency:X==="balanced"?512/ce:X==="interactive"||X===void 0?256/ce:X==="playback"?1024/ce:128*Math.max(2,Math.min(128,Math.round(X*ce/128)))/ce,this._nativeAudioContext=W,L.name==="webkitAudioContext"?(this._nativeGainNode=W.createGain(),this._nativeOscillatorNode=W.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(W.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,W.state==="running"){this._state="suspended";let re=()=>{this._state==="suspended"&&(this._state=null),W.removeEventListener("statechange",re)};W.addEventListener("statechange",re)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw u()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),qe(this)}))}createMediaElementSource(V){return new S(this,{mediaElement:V})}createMediaStreamDestination(){return new E(this)}createMediaStreamSource(V){return new k(this,{mediaStream:V})}createMediaStreamTrackSource(V){return new M(this,{mediaStreamTrack:V})}resume(){return this._state==="suspended"?new Promise((V,W)=>{let X=()=>{this._nativeAudioContext.removeEventListener("statechange",X),this._nativeAudioContext.state==="running"?V():this.resume().then(V,W)};this._nativeAudioContext.addEventListener("statechange",X)}):this._nativeAudioContext.resume().catch(V=>{throw V===void 0||V.code===15?u():V})}suspend(){return this._nativeAudioContext.suspend().catch(V=>{throw V===void 0?u():V})}})(vV,fo,Gs,vye,vxe,bxe,wxe,Cxe,Dh),oA=(C=>u=>{let g=C.get(u);if(g===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return g})(hV),Txe=(C=>(u,g)=>{C(u).add(g)})(oA),bV=(C=>(u,g,v=0,S=0)=>{let E=u[v];if(E===void 0)throw C();return Xr(g)?E.connect(g,0,S):E.connect(g,0)})(se),Ixe=(C=>(u,g)=>{C(u).delete(g)})(oA),wV=(C=>(u,g,v,S=0)=>g===void 0?u.forEach(E=>E.disconnect()):typeof g=="number"?ta(C,u,g).disconnect():Xr(g)?v===void 0?u.forEach(E=>E.disconnect(g)):S===void 0?ta(C,u,v).disconnect(g,0):ta(C,u,v).disconnect(g,0,S):v===void 0?u.forEach(E=>E.disconnect(g)):ta(C,u,v).disconnect(g,0))(se),SV=new WeakMap,Exe=((C,u)=>g=>u(C,g))(SV,R),Nxe=((C,u,g,v,S,E,k,M,L,V,W,X,ce)=>(re,ve,_e,me)=>{if(me.numberOfInputs===0&&me.numberOfOutputs===0)throw L();let Ne=Array.isArray(me.outputChannelCount)?me.outputChannelCount:Array.from(me.outputChannelCount);if(Ne.some(pt=>pt<1))throw L();if(Ne.length!==me.numberOfOutputs)throw u();if(me.channelCountMode!=="explicit")throw L();let Oe=me.channelCount*me.numberOfInputs,Be=Ne.reduce((pt,Ln)=>pt+Ln,0),We=_e.parameterDescriptors===void 0?0:_e.parameterDescriptors.length;if(Oe+We>6||Be>6)throw L();let Me=new MessageChannel,Ie=[],Ue=[];for(let pt=0;pt<me.numberOfInputs;pt+=1)Ie.push(k(re,{channelCount:me.channelCount,channelCountMode:me.channelCountMode,channelInterpretation:me.channelInterpretation,gain:1})),Ue.push(S(re,{channelCount:me.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:me.channelCount}));let Pe=[];if(_e.parameterDescriptors!==void 0)for(let{defaultValue:pt,maxValue:Ln,minValue:hs,name:Gr}of _e.parameterDescriptors){let Rn=E(re,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:me.parameterData[Gr]!==void 0?me.parameterData[Gr]:pt===void 0?0:pt});Object.defineProperties(Rn.offset,{defaultValue:{get:()=>pt===void 0?0:pt},maxValue:{get:()=>Ln===void 0?ke:Ln},minValue:{get:()=>hs===void 0?be:hs}}),Pe.push(Rn)}let et=v(re,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,Oe+We)}),Xe=Pl(ve,re.sampleRate),nt=M(re,Xe,Oe+We,Math.max(1,Be)),tt=S(re,{channelCount:Math.max(1,Be),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,Be)}),lt=[];for(let pt=0;pt<me.numberOfOutputs;pt+=1)lt.push(v(re,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Ne[pt]}));for(let pt=0;pt<me.numberOfInputs;pt+=1){Ie[pt].connect(Ue[pt]);for(let Ln=0;Ln<me.channelCount;Ln+=1)Ue[pt].connect(et,Ln,pt*me.channelCount+Ln)}let Tt=new Wa(_e.parameterDescriptors===void 0?[]:_e.parameterDescriptors.map(({name:pt},Ln)=>{let hs=Pe[Ln];return hs.connect(et,0,Oe+Ln),hs.start(0),[pt,hs.offset]}));et.connect(nt);let wt=me.channelInterpretation,Nt=null,en=me.numberOfOutputs===0?[nt]:lt,St={get bufferSize(){return Xe},get channelCount(){return me.channelCount},set channelCount(pt){throw g()},get channelCountMode(){return me.channelCountMode},set channelCountMode(pt){throw g()},get channelInterpretation(){return wt},set channelInterpretation(pt){for(let Ln of Ie)Ln.channelInterpretation=pt;wt=pt},get context(){return nt.context},get inputs(){return Ie},get numberOfInputs(){return me.numberOfInputs},get numberOfOutputs(){return me.numberOfOutputs},get onprocessorerror(){return Nt},set onprocessorerror(pt){typeof Nt=="function"&&St.removeEventListener("processorerror",Nt),Nt=typeof pt=="function"?pt:null,typeof Nt=="function"&&St.addEventListener("processorerror",Nt)},get parameters(){return Tt},get port(){return Me.port2},addEventListener:(...pt)=>nt.addEventListener(pt[0],pt[1],pt[2]),connect:C.bind(null,en),disconnect:V.bind(null,en),dispatchEvent:(...pt)=>nt.dispatchEvent(pt[0]),removeEventListener:(...pt)=>nt.removeEventListener(pt[0],pt[1],pt[2])},cn=new Map;var Tn,jr;Me.port1.addEventListener=(Tn=Me.port1.addEventListener,(...pt)=>{if(pt[0]==="message"){let Ln=typeof pt[1]=="function"?pt[1]:typeof pt[1]=="object"&&pt[1]!==null&&typeof pt[1].handleEvent=="function"?pt[1].handleEvent:null;if(Ln!==null){let hs=cn.get(pt[1]);hs!==void 0?pt[1]=hs:(pt[1]=Gr=>{W(re.currentTime,re.sampleRate,()=>Ln(Gr))},cn.set(Ln,pt[1]))}}return Tn.call(Me.port1,pt[0],pt[1],pt[2])}),Me.port1.removeEventListener=(jr=Me.port1.removeEventListener,(...pt)=>{if(pt[0]==="message"){let Ln=cn.get(pt[1]);Ln!==void 0&&(cn.delete(pt[1]),pt[1]=Ln)}return jr.call(Me.port1,pt[0],pt[1],pt[2])});let Qr=null;Object.defineProperty(Me.port1,"onmessage",{get:()=>Qr,set:pt=>{typeof Qr=="function"&&Me.port1.removeEventListener("message",Qr),Qr=typeof pt=="function"?pt:null,typeof Qr=="function"&&(Me.port1.addEventListener("message",Qr),Me.port1.start())}}),_e.prototype.port=Me.port1;let or=null;((pt,Ln,hs,Gr)=>{let Rn=w.get(pt);Rn===void 0&&(Rn=new WeakMap,w.set(pt,Rn));let Rr=((fi,qc)=>Y(void 0,null,function*(){let Uc=yield(_A=>new Promise((TA,kve)=>{let{port1:s_,port2:IA}=new MessageChannel;s_.onmessage=({data:EA})=>{s_.close(),IA.close(),TA(EA)},s_.onmessageerror=({data:EA})=>{s_.close(),IA.close(),kve(EA)},IA.postMessage(_A)}))(qc);return new fi(Uc)}))(hs,Gr);return Rn.set(Ln,Rr),Rr})(re,St,_e,me).then(pt=>or=pt);let ks=Nh(me.numberOfInputs,me.channelCount),Qn=Nh(me.numberOfOutputs,Ne),qt=_e.parameterDescriptors===void 0?[]:_e.parameterDescriptors.reduce((pt,{name:Ln})=>vt(Fe({},pt),{[Ln]:new Float32Array(128)}),{}),xt=!0,ps=()=>{me.numberOfOutputs>0&&nt.disconnect(tt);for(let pt=0,Ln=0;pt<me.numberOfOutputs;pt+=1){let hs=lt[pt];for(let Gr=0;Gr<Ne[pt];Gr+=1)tt.disconnect(hs,Ln+Gr,Gr);Ln+=Ne[pt]}},zh=new Map;nt.onaudioprocess=({inputBuffer:pt,outputBuffer:Ln})=>{if(or!==null){let hs=X(St);for(let Gr=0;Gr<Xe;Gr+=128){for(let Rn=0;Rn<me.numberOfInputs;Rn+=1)for(let Rr=0;Rr<me.channelCount;Rr+=1)Eh(pt,ks[Rn],Rr,Rr,Gr);_e.parameterDescriptors!==void 0&&_e.parameterDescriptors.forEach(({name:Rn},Rr)=>{Eh(pt,qt,Rn,Oe+Rr,Gr)});for(let Rn=0;Rn<me.numberOfInputs;Rn+=1)for(let Rr=0;Rr<Ne[Rn];Rr+=1)Qn[Rn][Rr].byteLength===0&&(Qn[Rn][Rr]=new Float32Array(128));try{let Rn=ks.map((fi,qc)=>{if(hs[qc].size>0)return zh.set(qc,Xe/128),fi;let Uc=zh.get(qc);return Uc===void 0?[]:(fi.every(_A=>_A.every(TA=>TA===0))&&(Uc===1?zh.delete(qc):zh.set(qc,Uc-1)),fi)});xt=W(re.currentTime+Gr/re.sampleRate,re.sampleRate,()=>or.process(Rn,Qn,qt));for(let fi=0,qc=0;fi<me.numberOfOutputs;fi+=1){for(let Uc=0;Uc<Ne[fi];Uc+=1)Rl(Ln,Qn[fi],Uc,qc+Uc,Gr);qc+=Ne[fi]}}catch(Rn){xt=!1,St.dispatchEvent(new ErrorEvent("processorerror",{colno:Rn.colno,filename:Rn.filename,lineno:Rn.lineno,message:Rn.message}))}if(!xt){for(let Rn=0;Rn<me.numberOfInputs;Rn+=1){Ie[Rn].disconnect(Ue[Rn]);for(let Rr=0;Rr<me.channelCount;Rr+=1)Ue[Gr].disconnect(et,Rr,Rn*me.channelCount+Rr)}if(_e.parameterDescriptors!==void 0){let Rn=_e.parameterDescriptors.length;for(let Rr=0;Rr<Rn;Rr+=1){let fi=Pe[Rr];fi.disconnect(et,0,Oe+Rr),fi.stop()}}et.disconnect(nt),nt.onaudioprocess=null,Ed?ps():YV();break}}}};let Ed=!1,Nd=k(re,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),QV=()=>nt.connect(Nd).connect(re.destination),YV=()=>{nt.disconnect(Nd),Nd.disconnect()};return QV(),ce(St,()=>{if(xt){YV(),me.numberOfOutputs>0&&nt.connect(tt);for(let pt=0,Ln=0;pt<me.numberOfOutputs;pt+=1){let hs=lt[pt];for(let Gr=0;Gr<Ne[pt];Gr+=1)tt.connect(hs,Ln+Gr,Gr);Ln+=Ne[pt]}}Ed=!0},()=>{xt&&(QV(),ps()),Ed=!1})})(bV,se,fo,Ah,dd,Hg,ci,Rb,Gs,wV,rA,Exe,kh),Dxe=((C,u,g,v,S)=>(E,k,M,L,V,W)=>{if(M!==null)try{let re=new M(E,L,W),ve=new Map,_e=null;if(Object.defineProperties(re,{channelCount:{get:()=>W.channelCount,set:()=>{throw C()}},channelCountMode:{get:()=>"explicit",set:()=>{throw C()}},onprocessorerror:{get:()=>_e,set:me=>{typeof _e=="function"&&re.removeEventListener("processorerror",_e),_e=typeof me=="function"?me:null,typeof _e=="function"&&re.addEventListener("processorerror",_e)}}}),re.addEventListener=(ce=re.addEventListener,(...me)=>{if(me[0]==="processorerror"){let Ne=typeof me[1]=="function"?me[1]:typeof me[1]=="object"&&me[1]!==null&&typeof me[1].handleEvent=="function"?me[1].handleEvent:null;if(Ne!==null){let Oe=ve.get(me[1]);Oe!==void 0?me[1]=Oe:(me[1]=Be=>{Be.type==="error"?(Object.defineProperties(Be,{type:{value:"processorerror"}}),Ne(Be)):Ne(new ErrorEvent(me[0],Fe({},Be)))},ve.set(Ne,me[1]))}}return ce.call(re,"error",me[1],me[2]),ce.call(re,...me)}),re.removeEventListener=(X=re.removeEventListener,(...me)=>{if(me[0]==="processorerror"){let Ne=ve.get(me[1]);Ne!==void 0&&(ve.delete(me[1]),me[1]=Ne)}return X.call(re,"error",me[1],me[2]),X.call(re,me[0],me[1],me[2])}),W.numberOfOutputs!==0){let me=g(E,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return re.connect(me).connect(E.destination),S(re,()=>me.disconnect(),()=>me.connect(E.destination))}return re}catch(re){throw re.code===11?v():re}var X,ce;if(V===void 0)throw v();return(re=>{let{port1:ve}=new MessageChannel;try{ve.postMessage(re)}finally{ve.close()}})(W),u(E,k,V,W)})(fo,Nxe,ci,Gs,kh),kxe=((C,u,g,v,S,E,k,M,L,V,W,X,ce,re,ve,_e)=>(me,Ne,Oe)=>{let Be=new WeakMap,We=null;return{render(Me,Ie){M(Ie,Me);let Ue=Be.get(Ie);return Ue!==void 0?Promise.resolve(Ue):((Pe,et)=>Y(null,null,function*(){let Xe=W(Pe),nt=null,tt=fe(Xe,et),lt=Array.isArray(Ne.outputChannelCount)?Ne.outputChannelCount:Array.from(Ne.outputChannelCount);if(X===null){let Tt=lt.reduce((St,cn)=>St+cn,0),wt=S(et,{channelCount:Math.max(1,Tt),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,Tt)}),Nt=[];for(let St=0;St<Pe.numberOfOutputs;St+=1)Nt.push(v(et,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:lt[St]}));let en=k(et,{channelCount:Ne.channelCount,channelCountMode:Ne.channelCountMode,channelInterpretation:Ne.channelInterpretation,gain:1});en.connect=u.bind(null,Nt),en.disconnect=L.bind(null,Nt),nt=[wt,Nt,en]}else tt||(Xe=new X(et,me));if(Be.set(et,nt===null?Xe:nt[2]),nt!==null){if(We===null){if(Oe===void 0)throw new Error("Missing the processor constructor.");if(ce===null)throw new Error("Missing the native OfflineAudioContext constructor.");let cn=Pe.channelCount*Pe.numberOfInputs,Tn=Oe.parameterDescriptors===void 0?0:Oe.parameterDescriptors.length,jr=cn+Tn;We=Ab(Pe,jr===0?null:yield Y(null,null,function*(){let or=new ce(jr,128*Math.ceil(Pe.context.length/128),et.sampleRate),hi=[],ks=[];for(let xt=0;xt<Ne.numberOfInputs;xt+=1)hi.push(k(or,{channelCount:Ne.channelCount,channelCountMode:Ne.channelCountMode,channelInterpretation:Ne.channelInterpretation,gain:1})),ks.push(S(or,{channelCount:Ne.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Ne.channelCount}));let Qn=yield Promise.all(Array.from(Pe.parameters.values()).map(xt=>Y(null,null,function*(){let ps=E(or,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:xt.value});return yield re(or,xt,ps.offset),ps}))),qt=v(or,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,cn+Tn)});for(let xt=0;xt<Ne.numberOfInputs;xt+=1){hi[xt].connect(ks[xt]);for(let ps=0;ps<Ne.channelCount;ps+=1)ks[xt].connect(qt,ps,xt*Ne.channelCount+ps)}for(let[xt,ps]of Qn.entries())ps.connect(qt,0,cn+xt),ps.start(0);return qt.connect(or.destination),yield Promise.all(hi.map(xt=>ve(Pe,or,xt))),_e(or)}),et,Ne,lt,Oe,V)}let Tt=yield We,wt=g(et,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[Nt,en,St]=nt;Tt!==null&&(wt.buffer=Tt,wt.start(0)),wt.connect(Nt);for(let cn=0,Tn=0;cn<Pe.numberOfOutputs;cn+=1){let jr=en[cn];for(let Qr=0;Qr<lt[cn];Qr+=1)Nt.connect(jr,Tn+Qr,Qr);Tn+=lt[cn]}return St}if(tt)for(let[Tt,wt]of Pe.parameters.entries())yield C(et,wt,Xe.parameters.get(Tt));else for(let[Tt,wt]of Pe.parameters.entries())yield re(et,wt,Xe.parameters.get(Tt));return yield ve(Pe,et,Xe),Xe}))(Me,Ie)}}})(Pc,bV,Wg,Ah,dd,Hg,ci,Ixe,wV,rA,tn,Gg,Uo,Fc,as,tC),Axe=(C=>u=>C.get(u))(xV),Oxe=(C=>(u,g)=>{C.set(u,g)})(SV),CV=yV?((C,u,g,v,S,E,k,M,L,V,W,X,ce,re)=>class extends u{constructor(ve,_e,me){var Ne;let Oe=M(ve),Be=L(Oe),We=(nt=>vt(Fe({},nt),{outputChannelCount:nt.outputChannelCount!==void 0?nt.outputChannelCount:nt.numberOfInputs===1&&nt.numberOfOutputs===1?[nt.channelCount]:Array.from({length:nt.numberOfOutputs},()=>1)}))(Fe(Fe({},Rc),me));(nt=>{let{port1:tt,port2:lt}=new MessageChannel;try{tt.postMessage(nt)}finally{tt.close(),lt.close()}})(We);let Me=x.get(Oe),Ie=Me?.get(_e),Ue=Be||Oe.state!=="closed"?Oe:(Ne=k(Oe))!==null&&Ne!==void 0?Ne:Oe,Pe=S(Ue,Be?null:ve.baseLatency,V,_e,Ie,We);super(ve,!0,Pe,Be?v(_e,We,Ie):null);let et=[];Pe.parameters.forEach((nt,tt)=>{let lt=g(this,Be,nt);et.push([tt,lt])}),this._nativeAudioWorkletNode=Pe,this._onprocessorerror=null,this._parameters=new Wa(et),Be&&C(Oe,this);let{activeInputs:Xe}=E(this);X(Pe,Xe)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(ve){let _e=typeof ve=="function"?re(this,ve):null;this._nativeAudioWorkletNode.onprocessorerror=_e;let me=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=me!==null&&me===_e?ve:me}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(Txe,mo,Ka,kxe,Dxe,Ce,Axe,Tr,hr,Gg,0,Oxe,0,jg):void 0,Mxe=((C,u)=>(g,v,S)=>{if(u===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new u(g,v,S)}catch(E){throw E.name==="SyntaxError"?C():E}})(Gs,Uo),Rxe=((C,u,g,v,S,E,k,M)=>(L,V)=>g(L).render(L,V).then(()=>Promise.all(Array.from(v(V)).map(W=>g(W).render(W,V)))).then(()=>S(V)).then(W=>(typeof W.copyFromChannel!="function"?(k(W),ee(W)):u(E,()=>E(W))||M(W),C.add(W),W)))(Jk,ra,Qk,oA,tC,te,tA,nA),Pxe=((C,u,g,v,S)=>class extends C{constructor(E,k,M){let L;if(typeof E=="number"&&k!==void 0&&M!==void 0)L={length:k,numberOfChannels:E,sampleRate:M};else{if(typeof E!="object")throw new Error("The given parameters are not valid.");L=E}let{length:V,numberOfChannels:W,sampleRate:X}=Fe(Fe({},dye),L),ce=v(W,V,X);u(ot,()=>ot(ce))||ce.addEventListener("statechange",(()=>{let re=0,ve=_e=>{this._state==="running"&&(re>0?(ce.removeEventListener("statechange",ve),_e.stopImmediatePropagation(),this._waitForThePromiseToSettle(_e)):re+=1)};return ve})()),super(ce,W),this._length=V,this._nativeOfflineAudioContext=ce,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(g()):(this._state="running",S(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,qe(this)}))}_waitForThePromiseToSettle(E){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(E):setTimeout(()=>this._waitForThePromiseToSettle(E))}})(vV,ra,fo,Mxe,Rxe),Fxe=((C,u)=>g=>{let v=C.get(g);return u(v)||u(g)})(d,Yk),$xe=((C,u)=>g=>C.has(g)||u(g))(p,Zk),Lxe=((C,u)=>g=>C.has(g)||u(g))(y,rV),zxe=((C,u)=>g=>{let v=C.get(g);return u(v)||u(g)})(d,hr),Bxe=()=>((C,u,g,v,S,E,k,M,L,V,W,X,ce,re,ve,_e)=>Y(void 0,null,function*(){return!!(C(u,u)&&C(g,g)&&C(S,S)&&C(E,E)&&C(M,M)&&C(L,L)&&C(V,V)&&C(W,W)&&C(X,X)&&C(ce,ce)&&C(re,re))&&(yield Promise.all([C(v,v),C(k,k),C(ve,ve),C(_e,_e)])).every(me=>me)}))(ra,(C=>()=>{if(C===null)return!1;let u=new C(1,1,44100).createBuffer(1,1,44100);if(u.copyToChannel===void 0)return!0;let g=new Float32Array(2);try{u.copyFromChannel(g,0,0)}catch{return!1}return!0})(Uo),(C=>()=>{if(C===null)return!1;if(C.prototype!==void 0&&C.prototype.close!==void 0)return!0;let u=new C,g=u.close!==void 0;try{u.close()}catch{}return g})(Dh),(C=>()=>{if(C===null)return Promise.resolve(!1);let u=new C(1,1,44100);return new Promise(g=>{let v=!0,S=k=>{v&&(v=!1,u.startRendering(),g(k instanceof TypeError))},E;try{E=u.decodeAudioData(null,()=>{},S)}catch(k){S(k)}E!==void 0&&E.catch(S)})})(Uo),(C=>()=>{if(C===null)return!1;let u;try{u=new C({latencyHint:"balanced"})}catch{return!1}return u.close(),!0})(Dh),(C=>()=>{if(C===null)return!1;let u=new C(1,1,44100).createGain(),g=u.connect(u)===u;return u.disconnect(u),g})(Uo),((C,u)=>()=>Y(void 0,null,function*(){if(C===null)return!0;if(u===null)return!1;let g=new Blob(['let c,p;class A extends AudioWorkletProcessor{constructor(){super();this.port.onmessage=(e)=>{p=e.data;p.onmessage=()=>{p.postMessage(c);p.close()};this.port.postMessage(0)}}process(){c=1}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),v=new MessageChannel,S=new u(1,128,44100),E=URL.createObjectURL(g),k=!1;try{yield S.audioWorklet.addModule(E);let M=new C(S,"a",{numberOfOutputs:0}),L=S.createOscillator();yield new Promise(V=>{M.port.onmessage=()=>V(),M.port.postMessage(v.port2,[v.port2])}),M.port.onmessage=()=>k=!0,L.connect(M),L.start(0),yield S.startRendering(),k=yield new Promise(V=>{v.port1.onmessage=({data:W})=>V(W===1),v.port1.postMessage(0)})}catch{}finally{v.port1.close(),URL.revokeObjectURL(E)}return k}))(Gg,Uo),(C=>()=>{if(C===null)return!1;let u=new C(1,1,44100).createChannelMerger();if(u.channelCountMode==="max")return!0;try{u.channelCount=2}catch{return!0}return!1})(Uo),(C=>()=>{if(C===null)return!1;let u=new C(1,1,44100);return u.createConstantSource===void 0||u.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY})(Uo),(C=>()=>{if(C===null)return!1;let u=new C(1,1,44100),g=u.createConvolver();g.buffer=u.createBuffer(1,1,u.sampleRate);try{g.buffer=u.createBuffer(1,1,u.sampleRate)}catch{return!1}return!0})(Uo),(C=>()=>{if(C===null)return!1;let u=new C(1,1,44100).createConvolver();try{u.channelCount=1}catch{return!1}return!0})(Uo),wye,(C=>()=>C!==null&&C.hasOwnProperty("isSecureContext"))(Ha),(C=>()=>{if(C===null)return!1;let u=new C;try{return u.createMediaStreamSource(new MediaStream),!1}catch{return!0}finally{u.close()}})(Dh),(C=>()=>{if(C===null)return Promise.resolve(!1);let u=new C(1,1,44100);if(u.createStereoPanner===void 0||u.createConstantSource===void 0)return Promise.resolve(!0);let g=u.createConstantSource(),v=u.createStereoPanner();return g.channelCount=1,g.offset.value=1,v.channelCount=1,g.start(),g.connect(v).connect(u.destination),u.startRendering().then(S=>S.getChannelData(0)[0]!==1)})(Uo),Sye);function ui(C){return C===void 0}function ln(C){return C!==void 0}function _V(C){return typeof C=="function"}function Ni(C){return typeof C=="number"}function Fl(C){return Object.prototype.toString.call(C)==="[object Object]"&&C.constructor===Object}function sA(C){return typeof C=="boolean"}function cs(C){return Array.isArray(C)}function Xa(C){return typeof C=="string"}function $b(C){return Xa(C)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(C)}function Ot(C,u){if(!C)throw new Error(u)}function us(C,u,g=1/0){if(!(u<=C&&C<=g))throw new RangeError(`Value must be within [${u}, ${g}], got: ${C}`)}function iA(C){C.isOffline||C.state==="running"||Kg('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let TV=!1,IV=!1;function aA(C){TV=C}function EV(C){ui(C)&&TV&&!IV&&(IV=!0,Kg("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let cA=console;function Vxe(C){cA=C}function NV(...C){cA.log(...C)}function Kg(...C){cA.warn(...C)}let $l=typeof self=="object"?self:null,qxe=$l&&($l.hasOwnProperty("AudioContext")||$l.hasOwnProperty("webkitAudioContext"));function Qa(C,u,g,v){var S,E=arguments.length,k=E<3?u:v===null?v=Object.getOwnPropertyDescriptor(u,g):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(C,u,g,v);else for(var M=C.length-1;M>=0;M--)(S=C[M])&&(k=(E<3?S(k):E>3?S(u,g,k):S(u,g))||k);return E>3&&k&&Object.defineProperty(u,g,k),k}function xr(C,u,g,v){return new(g||(g=Promise))(function(S,E){function k(V){try{L(v.next(V))}catch(W){E(W)}}function M(V){try{L(v.throw(V))}catch(W){E(W)}}function L(V){var W;V.done?S(V.value):(W=V.value,W instanceof g?W:new g(function(X){X(W)})).then(k,M)}L((v=v.apply(C,u||[])).next())})}typeof SuppressedError=="function"&&SuppressedError;class Uxe{constructor(u,g,v,S){this._callback=u,this._type=g,this._minimumUpdateInterval=Math.max(128/(S||44100),.001),this.updateInterval=v,this._createClock()}_createWorker(){let u=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),g=URL.createObjectURL(u),v=new Worker(g);v.onmessage=this._callback.bind(this),this._worker=v}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},1e3*this._updateInterval)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(u){var g;this._updateInterval=Math.max(u,this._minimumUpdateInterval),this._type==="worker"&&((g=this._worker)===null||g===void 0||g.postMessage(1e3*this._updateInterval))}get type(){return this._type}set type(u){this._disposeClock(),this._type=u,this._createClock()}dispose(){this._disposeClock()}}function gd(C){return Lxe(C)}function Oh(C){return $xe(C)}function rC(C){return zxe(C)}function Xg(C){return Fxe(C)}function jxe(C,u){return C==="value"||gd(u)||Oh(u)||function(g){return g instanceof aV}(u)}function oa(C,...u){if(!u.length)return C;let g=u.shift();if(Fl(C)&&Fl(g))for(let v in g)jxe(v,g[v])?C[v]=g[v]:Fl(g[v])?(C[v]||Object.assign(C,{[v]:{}}),oa(C[v],g[v])):Object.assign(C,{[v]:g[v]});return oa(C,...u)}function ge(C,u,g=[],v){let S={},E=Array.from(u);if(Fl(E[0])&&v&&!Reflect.has(E[0],v)&&(Object.keys(E[0]).some(k=>Reflect.has(C,k))||(oa(S,{[v]:E[0]}),g.splice(g.indexOf(v),1),E.shift())),E.length===1&&Fl(E[0]))oa(S,E[0]);else for(let k=0;k<g.length;k++)ln(E[k])&&(S[g[k]]=E[k]);return oa(C,S)}function sa(C,u){return ui(C)?u:C}function ls(C,u){return u.forEach(g=>{Reflect.has(C,g)&&delete C[g]}),C}let Mh=(()=>{class C{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...g){(this.debug||$l&&this.toString()===$l.TONE_DEBUG_CLASS)&&NV(this,...g)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}return C.version=i,C})(),uA=1e-6;function Qg(C,u){return C>u+uA}function lA(C,u){return Qg(C,u)||Ya(C,u)}function oC(C,u){return C+uA<u}function Ya(C,u){return Math.abs(C-u)<uA}function yd(C,u,g){return Math.max(Math.min(C,g),u)}class Di extends Mh{constructor(){super(),this.name="Timeline",this._timeline=[];let u=ge(Di.getDefaults(),arguments,["memory"]);this.memory=u.memory,this.increasing=u.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(u){if(Ot(Reflect.has(u,"time"),"Timeline: events must have a time attribute"),u.time=u.time.valueOf(),this.increasing&&this.length){let g=this._timeline[this.length-1];Ot(lA(u.time,g.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(u)}else{let g=this._search(u.time);this._timeline.splice(g+1,0,u)}if(this.length>this.memory){let g=this.length-this.memory;this._timeline.splice(0,g)}return this}remove(u){let g=this._timeline.indexOf(u);return g!==-1&&this._timeline.splice(g,1),this}get(u,g="time"){let v=this._search(u,g);return v!==-1?this._timeline[v]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(u,g="time"){let v=this._search(u,g);return v+1<this._timeline.length?this._timeline[v+1]:null}getBefore(u){let g=this._timeline.length;if(g>0&&this._timeline[g-1].time<u)return this._timeline[g-1];let v=this._search(u);return v-1>=0?this._timeline[v-1]:null}cancel(u){if(this._timeline.length>1){let g=this._search(u);if(g>=0)if(Ya(this._timeline[g].time,u)){for(let v=g;v>=0&&Ya(this._timeline[v].time,u);v--)g=v;this._timeline=this._timeline.slice(0,g)}else this._timeline=this._timeline.slice(0,g+1);else this._timeline=[]}else this._timeline.length===1&&lA(this._timeline[0].time,u)&&(this._timeline=[]);return this}cancelBefore(u){let g=this._search(u);return g>=0&&(this._timeline=this._timeline.slice(g+1)),this}previousEvent(u){let g=this._timeline.indexOf(u);return g>0?this._timeline[g-1]:null}_search(u,g="time"){if(this._timeline.length===0)return-1;let v=0,S=this._timeline.length,E=S;if(S>0&&this._timeline[S-1][g]<=u)return S-1;for(;v<E;){let k=Math.floor(v+(E-v)/2),M=this._timeline[k],L=this._timeline[k+1];if(Ya(M[g],u)){for(let V=k;V<this._timeline.length&&Ya(this._timeline[V][g],u);V++)k=V;return k}if(oC(M[g],u)&&Qg(L[g],u))return k;Qg(M[g],u)?E=k:v=k+1}return-1}_iterate(u,g=0,v=this._timeline.length-1){this._timeline.slice(g,v+1).forEach(u)}forEach(u){return this._iterate(u),this}forEachBefore(u,g){let v=this._search(u);return v!==-1&&this._iterate(g,0,v),this}forEachAfter(u,g){let v=this._search(u);return this._iterate(g,v+1),this}forEachBetween(u,g,v){let S=this._search(u),E=this._search(g);return S!==-1&&E!==-1?(this._timeline[S].time!==u&&(S+=1),this._timeline[E].time===g&&(E-=1),this._iterate(v,S,E)):S===-1&&this._iterate(v,0,E),this}forEachFrom(u,g){let v=this._search(u);for(;v>=0&&this._timeline[v].time>=u;)v--;return this._iterate(g,v+1),this}forEachAtTime(u,g){let v=this._search(u);if(v!==-1&&Ya(this._timeline[v].time,u)){let S=v;for(let E=v;E>=0&&Ya(this._timeline[E].time,u);E--)S=E;this._iterate(E=>{g(E)},S,v)}return this}dispose(){return super.dispose(),this._timeline=[],this}}let DV=[];function sC(C){DV.push(C)}let kV=[];function iC(C){kV.push(C)}class Yg extends Mh{constructor(){super(...arguments),this.name="Emitter"}on(u,g){return u.split(/\W+/).forEach(v=>{ui(this._events)&&(this._events={}),this._events.hasOwnProperty(v)||(this._events[v]=[]),this._events[v].push(g)}),this}once(u,g){let v=(...S)=>{g(...S),this.off(u,v)};return this.on(u,v),this}off(u,g){return u.split(/\W+/).forEach(v=>{if(ui(this._events)&&(this._events={}),this._events.hasOwnProperty(v))if(ui(g))this._events[v]=[];else{let S=this._events[v];for(let E=S.length-1;E>=0;E--)S[E]===g&&S.splice(E,1)}}),this}emit(u,...g){if(this._events&&this._events.hasOwnProperty(u)){let v=this._events[u].slice(0);for(let S=0,E=v.length;S<E;S++)v[S].apply(this,g)}return this}static mixin(u){["on","once","off","emit"].forEach(g=>{let v=Object.getOwnPropertyDescriptor(Yg.prototype,g);Object.defineProperty(u.prototype,g,v)})}dispose(){return super.dispose(),this._events=void 0,this}}class pA extends Yg{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class Zg extends pA{constructor(){var u,g;super(),this.name="Context",this._constants=new Map,this._timeouts=new Di,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;let v=ge(Zg.getDefaults(),arguments,["context"]);v.context?(this._context=v.context,this._latencyHint=((u=arguments[0])===null||u===void 0?void 0:u.latencyHint)||""):(this._context=function(S){return new _xe(S)}({latencyHint:v.latencyHint}),this._latencyHint=v.latencyHint),this._ticker=new Uxe(this.emit.bind(this,"tick"),v.clockSource,v.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((g=arguments[0])===null||g===void 0)&&g.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=v.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var u;return this._initialized||(u=this,DV.forEach(g=>g(u)),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(u,g,v){return this._context.createBuffer(u,g,v)}createChannelMerger(u){return this._context.createChannelMerger(u)}createChannelSplitter(u){return this._context.createChannelSplitter(u)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(u){return this._context.createDelay(u)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(u,g){return this._context.createIIRFilter(u,g)}createPanner(){return this._context.createPanner()}createPeriodicWave(u,g,v){return this._context.createPeriodicWave(u,g,v)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(u){return Ot(Xg(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(u)}createMediaElementSource(u){return Ot(Xg(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(u)}createMediaStreamDestination(){return Ot(Xg(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(u){return this._context.decodeAudioData(u)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(u){Ot(!this._initialized,"The listener cannot be set after initialization."),this._listener=u}get transport(){return this.initialize(),this._transport}set transport(u){Ot(!this._initialized,"The transport cannot be set after initialization."),this._transport=u}get draw(){return this.initialize(),this._draw}set draw(u){Ot(!this._initialized,"Draw cannot be set after initialization."),this._draw=u}get destination(){return this.initialize(),this._destination}set destination(u){Ot(!this._initialized,"The destination cannot be set after initialization."),this._destination=u}createAudioWorkletNode(u,g){return function(v,S,E){return Ot(ln(CV),"This node only works in a secure context (https or localhost)"),new CV(v,S,E)}(this.rawContext,u,g)}addAudioWorkletModule(u){return xr(this,void 0,void 0,function*(){Ot(ln(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(u)),yield this._workletPromise})}workletsAreReady(){return xr(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(u){this._ticker.updateInterval=u}get clockSource(){return this._ticker.type}set clockSource(u){this._ticker.type=u}get lookAhead(){return this._lookAhead}set lookAhead(u){this._lookAhead=u,this.updateInterval=u?u/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return Xg(this._context)?this._context.resume():Promise.resolve()}close(){return xr(this,void 0,void 0,function*(){var u;Xg(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&(u=this,kV.forEach(g=>g(u)))})}getConstant(u){if(this._constants.has(u))return this._constants.get(u);{let g=this._context.createBuffer(1,128,this._context.sampleRate),v=g.getChannelData(0);for(let E=0;E<v.length;E++)v[E]=u;let S=this._context.createBufferSource();return S.channelCount=1,S.channelCountMode="explicit",S.buffer=g,S.loop=!0,S.start(0),this._constants.set(u,S),S}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(u=>this._constants[u].disconnect()),this.close(),this}_timeoutLoop(){let u=this.now(),g=this._timeouts.peek();for(;this._timeouts.length&&g&&g.time<=u;)g.callback(),this._timeouts.shift(),g=this._timeouts.peek()}setTimeout(u,g){this._timeoutIds++;let v=this.now();return this._timeouts.add({callback:u,id:this._timeoutIds,time:v+g}),this._timeoutIds}clearTimeout(u){return this._timeouts.forEach(g=>{g.id===u&&this._timeouts.remove(g)}),this}clearInterval(u){return this.clearTimeout(u)}setInterval(u,g){let v=++this._timeoutIds,S=()=>{let E=this.now();this._timeouts.add({callback:()=>{u(),S()},id:v,time:E+g})};return S(),v}}function Lt(C,u){cs(u)?u.forEach(g=>Lt(C,g)):Object.defineProperty(C,u,{enumerable:!0,writable:!1})}function Lb(C,u){cs(u)?u.forEach(g=>Lb(C,g)):Object.defineProperty(C,u,{writable:!0})}let Cn=()=>{};class Mn extends Mh{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Cn;let u=ge(Mn.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=u.reverse,this.onload=u.onload,Xa(u.url)?this.load(u.url).catch(u.onerror):u.url&&this.set(u.url)}static getDefaults(){return{onerror:Cn,onload:Cn,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Or().sampleRate}set(u){return u instanceof Mn?u.loaded?this._buffer=u.get():u.onload=()=>{this.set(u),this.onload(this)}:this._buffer=u,this._reversed&&this._reverse(),this}get(){return this._buffer}load(u){return xr(this,void 0,void 0,function*(){let g=Mn.load(u).then(v=>{this.set(v),this.onload(this)});Mn.downloads.push(g);try{yield g}finally{let v=Mn.downloads.indexOf(g);Mn.downloads.splice(v,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(u){let g=cs(u)&&u[0].length>0,v=g?u.length:1,S=g?u[0].length:u.length,E=Or(),k=E.createBuffer(v,S,E.sampleRate),M=g||v!==1?u:[u];for(let L=0;L<v;L++)k.copyToChannel(M[L],L);return this._buffer=k,this}toMono(u){if(Ni(u))this.fromArray(this.toArray(u));else{let g=new Float32Array(this.length),v=this.numberOfChannels;for(let S=0;S<v;S++){let E=this.toArray(S);for(let k=0;k<E.length;k++)g[k]+=E[k]}g=g.map(S=>S/v),this.fromArray(g)}return this}toArray(u){if(Ni(u))return this.getChannelData(u);if(this.numberOfChannels===1)return this.toArray(0);{let g=[];for(let v=0;v<this.numberOfChannels;v++)g[v]=this.getChannelData(v);return g}}getChannelData(u){return this._buffer?this._buffer.getChannelData(u):new Float32Array(0)}slice(u,g=this.duration){Ot(this.loaded,"Buffer is not loaded");let v=Math.floor(u*this.sampleRate),S=Math.floor(g*this.sampleRate);Ot(v<S,"The start time must be less than the end time");let E=S-v,k=Or().createBuffer(this.numberOfChannels,E,this.sampleRate);for(let M=0;M<this.numberOfChannels;M++)k.copyToChannel(this.getChannelData(M).subarray(v,S),M);return new Mn(k)}_reverse(){if(this.loaded)for(let u=0;u<this.numberOfChannels;u++)this.getChannelData(u).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(u){this._reversed!==u&&(this._reversed=u,this._reverse())}static fromArray(u){return new Mn().fromArray(u)}static fromUrl(u){return xr(this,void 0,void 0,function*(){return yield new Mn().load(u)})}static load(u){return xr(this,void 0,void 0,function*(){let g=u.match(/\[([^\]\[]+\|.+)\]$/);if(g){let M=g[1].split("|"),L=M[0];for(let V of M)if(Mn.supportsType(V)){L=V;break}u=u.replace(g[0],L)}let v=Mn.baseUrl===""||Mn.baseUrl.endsWith("/")?Mn.baseUrl:Mn.baseUrl+"/",S=document.createElement("a");S.href=v+u,S.pathname=(S.pathname+S.hash).split("/").map(encodeURIComponent).join("/");let E=yield fetch(S.href);if(!E.ok)throw new Error(`could not load url: ${u}`);let k=yield E.arrayBuffer();return yield Or().decodeAudioData(k)})}static supportsType(u){let g=u.split("."),v=g[g.length-1];return document.createElement("audio").canPlayType("audio/"+v)!==""}static loaded(){return xr(this,void 0,void 0,function*(){for(yield Promise.resolve();Mn.downloads.length;)yield Mn.downloads[0]})}}Mn.baseUrl="",Mn.downloads=[];class Jg extends Zg{constructor(){var u,g,v;super({clockSource:"offline",context:rC(arguments[0])?arguments[0]:(u=arguments[0],g=arguments[1]*arguments[2],v=arguments[2],new Pxe(u,g,v)),lookAhead:0,updateInterval:rC(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=rC(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(u){return xr(this,void 0,void 0,function*(){let g=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,g++;let v=Math.floor(this.sampleRate/128);u&&g%v==0&&(yield new Promise(S=>setTimeout(S,1)))}})}render(u=!0){return xr(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(u);let g=yield this._context.startRendering();return new Mn(g)})}close(){return Promise.resolve()}}let AV=new class extends pA{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(C,u,g){return{}}createChannelMerger(C){return{}}createChannelSplitter(C){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(C){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(C,u){return{}}createPanner(){return{}}createPeriodicWave(C,u,g){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(C){return{}}createMediaElementSource(C){return{}}createMediaStreamDestination(){return{}}decodeAudioData(C){return Promise.resolve({})}createAudioWorkletNode(C,u){return{}}get rawContext(){return{}}addAudioWorkletModule(C){return xr(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(C,u){return 0}clearTimeout(C){return this}setInterval(C,u){return 0}clearInterval(C){return this}getConstant(C){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(C){}get destination(){return{}}set destination(C){}now(){return 0}immediate(){return 0}},zb=AV;function Or(){return zb===AV&&qxe&&aC(new Zg),zb}function aC(C,u=!1){u&&zb.dispose(),zb=Xg(C)?new Zg(C):rC(C)?new Jg(C):C}function Gxe(){return zb.resume()}if($l&&!$l.TONE_SILENCE_LOGGING){let C="v";i==="dev"&&(C="");let u=` * Tone.js ${C}${i} * `;console.log(`%c${u}`,"background: #000; color: #fff")}function ey(C){return Math.pow(10,C/20)}function Bb(C){return Math.log(C)/Math.LN10*20}function ty(C){return Math.pow(2,C/12)}let cC=440;function Rh(C){return Math.round(OV(C))}function OV(C){return 69+12*Math.log2(C/cC)}function hA(C){return cC*Math.pow(2,(C-69)/12)}class fA extends Mh{constructor(u,g,v){super(),this.defaultUnits="s",this._val=g,this._units=v,this.context=u,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:u=>this._frequencyToUnits(parseFloat(u)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:u=>this._ticksToUnits(parseInt(u,10)),regexp:/^(\d+)i$/i},m:{method:u=>this._beatsToUnits(parseInt(u,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(u,g)=>{let v=parseInt(u,10),S=g==="."?1.5:1;return v===1?this._beatsToUnits(this._getTimeSignature())*S:this._beatsToUnits(4/v)*S},regexp:/^(\d+)n(\.?)$/i},number:{method:u=>this._expressions[this.defaultUnits].method.call(this,u),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:u=>this._secondsToUnits(parseFloat(u)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:u=>parseInt(u,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:u=>{let g=parseInt(u,10);return this._beatsToUnits(8/(3*Math.floor(g)))},regexp:/^(\d+)t$/i},tr:{method:(u,g,v)=>{let S=0;return u&&u!=="0"&&(S+=this._beatsToUnits(this._getTimeSignature()*parseFloat(u))),g&&g!=="0"&&(S+=this._beatsToUnits(parseFloat(g))),v&&v!=="0"&&(S+=this._beatsToUnits(parseFloat(v)/4)),S},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof fA&&this.fromType(this._val),ui(this._val))return this._noArg();if(Xa(this._val)&&ui(this._units)){for(let u in this._expressions)if(this._expressions[u].regexp.test(this._val.trim())){this._units=u;break}}else if(Fl(this._val)){let u=0;for(let g in this._val)if(ln(this._val[g])){let v=this._val[g];u+=new this.constructor(this.context,g).valueOf()*v}return u}if(ln(this._units)){let u=this._expressions[this._units],g=this._val.toString().trim().match(u.regexp);return g?u.method.apply(this,g.slice(1)):u.method.call(this,this._val)}return Xa(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(u){return 1/u}_beatsToUnits(u){return 60/this._getBpm()*u}_secondsToUnits(u){return u}_ticksToUnits(u){return u*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(u){switch(this._units=void 0,this.defaultUnits){case"s":this._val=u.toSeconds();break;case"i":this._val=u.toTicks();break;case"hz":this._val=u.toFrequency();break;case"midi":this._val=u.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class ki extends fA{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:u=>this._now()+new this.constructor(this.context,u).valueOf(),regexp:/^\+(.+)/},quantize:{method:u=>{let g=new ki(this.context,u).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(g))},regexp:/^@(.+)/}})}quantize(u,g=1){let v=new this.constructor(this.context,u).valueOf(),S=this.valueOf();return S+(Math.round(S/v)*v-S)*g}toNotation(){let u=this.toSeconds(),g=["1m"];for(let E=1;E<9;E++){let k=Math.pow(2,E);g.push(k+"n."),g.push(k+"n"),g.push(k+"t")}g.push("0");let v=g[0],S=new ki(this.context,g[0]).toSeconds();return g.forEach(E=>{let k=new ki(this.context,E).toSeconds();Math.abs(k-u)<Math.abs(S-u)&&(v=E,S=k)}),v}toBarsBeatsSixteenths(){let u=this._beatsToUnits(1),g=this.valueOf()/u;g=parseFloat(g.toFixed(4));let v=Math.floor(g/this._getTimeSignature()),S=g%1*4;g=Math.floor(g)%this._getTimeSignature();let E=S.toString();return E.length>3&&(S=parseFloat(parseFloat(E).toFixed(3))),[v,g,S].join(":")}toTicks(){let u=this._beatsToUnits(1);return this.valueOf()/u*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return Rh(this.toFrequency())}_now(){return this.context.now()}}function Wxe(C,u){return new ki(Or(),C,u)}class Ws extends ki{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return cC}static set A4(u){(function(g){cC=g})(u)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(u){return this.defaultUnits==="midi"?u:Ws.mtof(u)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(u,g){let v=Hxe[u.toLowerCase()]+12*(parseInt(g,10)+1);return this.defaultUnits==="midi"?v:Ws.mtof(v)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(u,g,v){let S=1;return u&&u!=="0"&&(S*=this._beatsToUnits(this._getTimeSignature()*parseFloat(u))),g&&g!=="0"&&(S*=this._beatsToUnits(parseFloat(g))),v&&v!=="0"&&(S*=this._beatsToUnits(parseFloat(v)/4)),S}}})}transpose(u){return new Ws(this.context,this.valueOf()*ty(u))}harmonize(u){return u.map(g=>this.transpose(g))}toMidi(){return Rh(this.valueOf())}toNote(){let u=this.toFrequency(),g=Math.log2(u/Ws.A4),v=Math.round(12*g)+57,S=Math.floor(v/12);return S<0&&(v+=-12*S),Kxe[v%12]+S.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){let u=this._beatsToUnits(1),g=this.valueOf()/u;return Math.floor(g*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(u){return u}_ticksToUnits(u){return 1/(60*u/(this._getBpm()*this._getPPQ()))}_beatsToUnits(u){return 1/super._beatsToUnits(u)}_secondsToUnits(u){return 1/u}static mtof(u){return hA(u)}static ftom(u){return Rh(u)}}let Hxe={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},Kxe=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function Xxe(C,u){return new Ws(Or(),C,u)}class Co extends ki{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}function Qxe(C,u){return new Co(Or(),C,u)}class jo extends Mh{constructor(){super();let u=ge(jo.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=u.context}static getDefaults(){return{context:Or()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(u){return EV(u),new ki(this.context,u).toSeconds()}toFrequency(u){return new Ws(this.context,u).toFrequency()}toTicks(u){return new Co(this.context,u).toTicks()}_getPartialProperties(u){let g=this.get();return Object.keys(g).forEach(v=>{ui(u[v])&&delete g[v]}),g}get(){let u=this.constructor.getDefaults();return Object.keys(u).forEach(g=>{if(Reflect.has(this,g)){let v=this[g];ln(v)&&ln(v.value)&&ln(v.setValueAtTime)?u[g]=v.value:v instanceof jo?u[g]=v._getPartialProperties(u[g]):cs(v)||Ni(v)||Xa(v)||sA(v)?u[g]=v:delete u[g]}}),u}set(u){return Object.keys(u).forEach(g=>{Reflect.has(this,g)&&ln(this[g])&&(this[g]&&ln(this[g].value)&&ln(this[g].setValueAtTime)?this[g].value!==u[g]&&(this[g].value=u[g]):this[g]instanceof jo?this[g].set(u[g]):this[g]=u[g])}),this}}class ny extends Di{constructor(u="stopped"){super(),this.name="StateTimeline",this._initial=u,this.setStateAtTime(this._initial,0)}getValueAtTime(u){let g=this.get(u);return g!==null?g.state:this._initial}setStateAtTime(u,g,v){return us(g,0),this.add(Object.assign({},v,{state:u,time:g})),this}getLastState(u,g){for(let v=this._search(g);v>=0;v--){let S=this._timeline[v];if(S.state===u)return S}}getNextState(u,g){let v=this._search(g);if(v!==-1)for(let S=v;S<this._timeline.length;S++){let E=this._timeline[S];if(E.state===u)return E}}}class Yt extends jo{constructor(){super(ge(Yt.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;let u=ge(Yt.getDefaults(),arguments,["param","units","convert"]);for(Ot(ln(u.param)&&(gd(u.param)||u.param instanceof Yt),"param must be an AudioParam");!gd(u.param);)u.param=u.param._param;this._swappable=!!ln(u.swappable)&&u.swappable,this._swappable?(this.input=this.context.createGain(),this._param=u.param,this.input.connect(this._param)):this._param=this.input=u.param,this._events=new Di(1e3),this._initialValue=this._param.defaultValue,this.units=u.units,this.convert=u.convert,this._minValue=u.minValue,this._maxValue=u.maxValue,ln(u.value)&&u.value!==this._toType(this._initialValue)&&this.setValueAtTime(u.value,0)}static getDefaults(){return Object.assign(jo.getDefaults(),{convert:!0,units:"number"})}get value(){let u=this.now();return this.getValueAtTime(u)}set value(u){this.cancelScheduledValues(this.now()),this.setValueAtTime(u,this.now())}get minValue(){return ln(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return ln(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(u,g){return this.units===g}_assertRange(u){return ln(this.maxValue)&&ln(this.minValue)&&us(u,this._fromType(this.minValue),this._fromType(this.maxValue)),u}_fromType(u){return this.convert&&!this.overridden?this._is(u,"time")?this.toSeconds(u):this._is(u,"decibels")?ey(u):this._is(u,"frequency")?this.toFrequency(u):u:this.overridden?0:u}_toType(u){return this.convert&&this.units==="decibels"?Bb(u):u}setValueAtTime(u,g){let v=this.toSeconds(g),S=this._fromType(u);return Ot(isFinite(S)&&isFinite(v),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(u)}, ${JSON.stringify(g)}`),this._assertRange(S),this.log(this.units,"setValueAtTime",u,v),this._events.add({time:v,type:"setValueAtTime",value:S}),this._param.setValueAtTime(S,v),this}getValueAtTime(u){let g=Math.max(this.toSeconds(u),0),v=this._events.getAfter(g),S=this._events.get(g),E=this._initialValue;if(S===null)E=this._initialValue;else if(S.type!=="setTargetAtTime"||v!==null&&v.type!=="setValueAtTime")if(v===null)E=S.value;else if(v.type==="linearRampToValueAtTime"||v.type==="exponentialRampToValueAtTime"){let k=S.value;if(S.type==="setTargetAtTime"){let M=this._events.getBefore(S.time);k=M===null?this._initialValue:M.value}E=v.type==="linearRampToValueAtTime"?this._linearInterpolate(S.time,k,v.time,v.value,g):this._exponentialInterpolate(S.time,k,v.time,v.value,g)}else E=S.value;else{let k=this._events.getBefore(S.time),M;M=k===null?this._initialValue:k.value,S.type==="setTargetAtTime"&&(E=this._exponentialApproach(S.time,M,S.value,S.constant,g))}return this._toType(E)}setRampPoint(u){u=this.toSeconds(u);let g=this.getValueAtTime(u);return this.cancelAndHoldAtTime(u),this._fromType(g)===0&&(g=this._toType(this._minOutput)),this.setValueAtTime(g,u),this}linearRampToValueAtTime(u,g){let v=this._fromType(u),S=this.toSeconds(g);return Ot(isFinite(v)&&isFinite(S),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(u)}, ${JSON.stringify(g)}`),this._assertRange(v),this._events.add({time:S,type:"linearRampToValueAtTime",value:v}),this.log(this.units,"linearRampToValueAtTime",u,S),this._param.linearRampToValueAtTime(v,S),this}exponentialRampToValueAtTime(u,g){let v=this._fromType(u);v=Ya(v,0)?this._minOutput:v,this._assertRange(v);let S=this.toSeconds(g);return Ot(isFinite(v)&&isFinite(S),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(u)}, ${JSON.stringify(g)}`),this._events.add({time:S,type:"exponentialRampToValueAtTime",value:v}),this.log(this.units,"exponentialRampToValueAtTime",u,S),this._param.exponentialRampToValueAtTime(v,S),this}exponentialRampTo(u,g,v){return v=this.toSeconds(v),this.setRampPoint(v),this.exponentialRampToValueAtTime(u,v+this.toSeconds(g)),this}linearRampTo(u,g,v){return v=this.toSeconds(v),this.setRampPoint(v),this.linearRampToValueAtTime(u,v+this.toSeconds(g)),this}targetRampTo(u,g,v){return v=this.toSeconds(v),this.setRampPoint(v),this.exponentialApproachValueAtTime(u,v,g),this}exponentialApproachValueAtTime(u,g,v){g=this.toSeconds(g),v=this.toSeconds(v);let S=Math.log(v+1)/Math.log(200);return this.setTargetAtTime(u,g,S),this.cancelAndHoldAtTime(g+.9*v),this.linearRampToValueAtTime(u,g+v),this}setTargetAtTime(u,g,v){let S=this._fromType(u);Ot(isFinite(v)&&v>0,"timeConstant must be a number greater than 0");let E=this.toSeconds(g);return this._assertRange(S),Ot(isFinite(S)&&isFinite(E),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(u)}, ${JSON.stringify(g)}`),this._events.add({constant:v,time:E,type:"setTargetAtTime",value:S}),this.log(this.units,"setTargetAtTime",u,E,v),this._param.setTargetAtTime(S,E,v),this}setValueCurveAtTime(u,g,v,S=1){v=this.toSeconds(v),g=this.toSeconds(g);let E=this._fromType(u[0])*S;this.setValueAtTime(this._toType(E),g);let k=v/(u.length-1);for(let M=1;M<u.length;M++){let L=this._fromType(u[M])*S;this.linearRampToValueAtTime(this._toType(L),g+M*k)}return this}cancelScheduledValues(u){let g=this.toSeconds(u);return Ot(isFinite(g),`Invalid argument to cancelScheduledValues: ${JSON.stringify(u)}`),this._events.cancel(g),this._param.cancelScheduledValues(g),this.log(this.units,"cancelScheduledValues",g),this}cancelAndHoldAtTime(u){let g=this.toSeconds(u),v=this._fromType(this.getValueAtTime(g));Ot(isFinite(g),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(u)}`),this.log(this.units,"cancelAndHoldAtTime",g,"value="+v);let S=this._events.get(g),E=this._events.getAfter(g);return S&&Ya(S.time,g)?E?(this._param.cancelScheduledValues(E.time),this._events.cancel(E.time)):(this._param.cancelAndHoldAtTime(g),this._events.cancel(g+this.sampleTime)):E&&(this._param.cancelScheduledValues(E.time),this._events.cancel(E.time),E.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(v),g):E.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(v),g)),this._events.add({time:g,type:"setValueAtTime",value:v}),this._param.setValueAtTime(v,g),this}rampTo(u,g=.1,v){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(u,g,v):this.linearRampTo(u,g,v),this}apply(u){let g=this.context.currentTime;u.setValueAtTime(this.getValueAtTime(g),g);let v=this._events.get(g);if(v&&v.type==="setTargetAtTime"){let S=this._events.getAfter(v.time),E=S?S.time:g+2,k=(E-g)/10;for(let M=g;M<E;M+=k)u.linearRampToValueAtTime(this.getValueAtTime(M),M)}return this._events.forEachAfter(this.context.currentTime,S=>{S.type==="cancelScheduledValues"?u.cancelScheduledValues(S.time):S.type==="setTargetAtTime"?u.setTargetAtTime(S.value,S.time,S.constant):u[S.type](S.value,S.time)}),this}setParam(u){Ot(this._swappable,"The Param must be assigned as 'swappable' in the constructor");let g=this.input;return g.disconnect(this._param),this.apply(u),this._param=u,g.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(u,g,v,S,E){return v+(g-v)*Math.exp(-(E-u)/S)}_linearInterpolate(u,g,v,S,E){return g+(E-u)/(v-u)*(S-g)}_exponentialInterpolate(u,g,v,S,E){return g*Math.pow(S/g,(E-u)/(v-u))}}class st extends jo{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return ln(this.input)?gd(this.input)||this.input instanceof Yt?1:this.input.numberOfInputs:0}get numberOfOutputs(){return ln(this.output)?this.output.numberOfOutputs:0}_isAudioNode(u){return ln(u)&&(u instanceof st||Oh(u))}_getInternalNodes(){let u=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&u.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&u.push(this.output),u}_setChannelProperties(u){this._getInternalNodes().forEach(g=>{g.channelCount=u.channelCount,g.channelCountMode=u.channelCountMode,g.channelInterpretation=u.channelInterpretation})}_getChannelProperties(){let u=this._getInternalNodes();Ot(u.length>0,"ToneAudioNode does not have any internal nodes");let g=u[0];return{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(u){let g=this._getChannelProperties();this._setChannelProperties(Object.assign(g,{channelCount:u}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(u){let g=this._getChannelProperties();this._setChannelProperties(Object.assign(g,{channelCountMode:u}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(u){let g=this._getChannelProperties();this._setChannelProperties(Object.assign(g,{channelInterpretation:u}))}connect(u,g=0,v=0){return Hs(this,u,g,v),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return Kg("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(u,g=0,v=0){return dA(this,u,g,v),this}chain(...u){return Ai(this,...u),this}fan(...u){return u.forEach(g=>this.connect(g)),this}dispose(){return super.dispose(),ln(this.input)&&(this.input instanceof st?this.input.dispose():Oh(this.input)&&this.input.disconnect()),ln(this.output)&&(this.output instanceof st?this.output.dispose():Oh(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Ai(...C){let u=C.shift();C.reduce((g,v)=>(g instanceof st?g.connect(v):Oh(g)&&Hs(g,v),v),u)}function Hs(C,u,g=0,v=0){for(Ot(ln(C),"Cannot connect from undefined node"),Ot(ln(u),"Cannot connect to undefined node"),(u instanceof st||Oh(u))&&Ot(u.numberOfInputs>0,"Cannot connect to node with no inputs"),Ot(C.numberOfOutputs>0,"Cannot connect from node with no outputs");u instanceof st||u instanceof Yt;)ln(u.input)&&(u=u.input);for(;C instanceof st;)ln(C.output)&&(C=C.output);gd(u)?C.connect(u,g):C.connect(u,g,v)}function dA(C,u,g=0,v=0){if(ln(u))for(;u instanceof st;)u=u.input;for(;!Oh(C);)ln(C.output)&&(C=C.output);gd(u)?C.disconnect(u,g):Oh(u)?C.disconnect(u,g,v):C.disconnect()}function Yxe(...C){let u=C.pop();ln(u)&&C.forEach(g=>Hs(g,u))}class Dt extends st{constructor(){super(ge(Dt.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;let u=ge(Dt.getDefaults(),arguments,["gain","units"]);this.gain=new Yt({context:this.context,convert:u.convert,param:this._gainNode.gain,units:u.units,value:u.gain,minValue:u.minValue,maxValue:u.maxValue}),Lt(this,"gain")}static getDefaults(){return Object.assign(st.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class ry extends st{constructor(u){super(u),this.onended=Cn,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Dt({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(g){let v=this.toSeconds(g);return this._startTime!==-1&&v>=this._startTime&&(this._stopTime===-1||v<=this._stopTime)?"started":"stopped"},this._fadeIn=u.fadeIn,this._fadeOut=u.fadeOut,this._curve=u.curve,this.onended=u.onended}static getDefaults(){return Object.assign(st.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Cn})}_startGain(u,g=1){Ot(this._startTime===-1,"Source cannot be started more than once");let v=this.toSeconds(this._fadeIn);return this._startTime=u+v,this._startTime=Math.max(this._startTime,this.context.currentTime),v>0?(this._gainNode.gain.setValueAtTime(0,u),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(g,u+v):this._gainNode.gain.exponentialApproachValueAtTime(g,u,v)):this._gainNode.gain.setValueAtTime(g,u),this}stop(u){return this.log("stop",u),this._stopGain(this.toSeconds(u)),this}_stopGain(u){Ot(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();let g=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(u)+g,this._stopTime=Math.max(this._stopTime,this.now()),g>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,g,u):this._gainNode.gain.targetRampTo(0,g,u):(this._gainNode.gain.cancelAndHoldAtTime(u),this._gainNode.gain.setValueAtTime(0,u)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{let v=this._curve==="exponential"?2*g:0;this._stopSource(this.now()+v),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Cn&&(this.onended(this),this.onended=Cn,!this.context.isOffline)){let u=()=>this.dispose();window.requestIdleCallback!==void 0?window.requestIdleCallback(u):setTimeout(u,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Ot(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=Cn,this}}class Vb extends ry{constructor(){super(ge(Vb.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();let u=ge(Vb.getDefaults(),arguments,["offset"]);Hs(this._source,this._gainNode),this.offset=new Yt({context:this.context,convert:u.convert,param:this._source.offset,units:u.units,value:u.offset,minValue:u.minValue,maxValue:u.maxValue})}static getDefaults(){return Object.assign(ry.getDefaults(),{convert:!0,offset:1,units:"number"})}start(u){let g=this.toSeconds(u);return this.log("start",g),this._startGain(g),this._source.start(g),this}_stopSource(u){this._source.stop(u)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class zt extends st{constructor(){super(ge(zt.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;let u=ge(zt.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new Vb({context:this.context,convert:u.convert,offset:u.value,units:u.units,minValue:u.minValue,maxValue:u.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(st.getDefaults(),{convert:!0,units:"number",value:0})}connect(u,g=0,v=0){return qb(this,u,g,v),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(u,g){return this._param.setValueAtTime(u,g),this}getValueAtTime(u){return this._param.getValueAtTime(u)}setRampPoint(u){return this._param.setRampPoint(u),this}linearRampToValueAtTime(u,g){return this._param.linearRampToValueAtTime(u,g),this}exponentialRampToValueAtTime(u,g){return this._param.exponentialRampToValueAtTime(u,g),this}exponentialRampTo(u,g,v){return this._param.exponentialRampTo(u,g,v),this}linearRampTo(u,g,v){return this._param.linearRampTo(u,g,v),this}targetRampTo(u,g,v){return this._param.targetRampTo(u,g,v),this}exponentialApproachValueAtTime(u,g,v){return this._param.exponentialApproachValueAtTime(u,g,v),this}setTargetAtTime(u,g,v){return this._param.setTargetAtTime(u,g,v),this}setValueCurveAtTime(u,g,v,S){return this._param.setValueCurveAtTime(u,g,v,S),this}cancelScheduledValues(u){return this._param.cancelScheduledValues(u),this}cancelAndHoldAtTime(u){return this._param.cancelAndHoldAtTime(u),this}rampTo(u,g,v){return this._param.rampTo(u,g,v),this}get value(){return this._param.value}set value(u){this._param.value=u}get convert(){return this._param.convert}set convert(u){this._param.convert=u}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(u){this._param.overridden=u}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(u){return this._param.apply(u),this}}function qb(C,u,g,v){(u instanceof Yt||gd(u)||u instanceof zt&&u.override)&&(u.cancelScheduledValues(0),u.setValueAtTime(0,0),u instanceof zt&&(u.overridden=!0)),Hs(C,u,g,v)}class uC extends Yt{constructor(){super(ge(uC.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new Di(1/0),this._multiplier=1;let u=ge(uC.getDefaults(),arguments,["value"]);this._multiplier=u.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(u.value)}),this.setValueAtTime(u.value,0)}static getDefaults(){return Object.assign(Yt.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(u,g,v){g=this.toSeconds(g),this.setRampPoint(g);let S=this._fromType(u),E=this._events.get(g),k=Math.round(Math.max(1/v,1));for(let M=0;M<=k;M++){let L=v*M+g,V=this._exponentialApproach(E.time,E.value,S,v,L);this.linearRampToValueAtTime(this._toType(V),L)}return this}setValueAtTime(u,g){let v=this.toSeconds(g);super.setValueAtTime(u,g);let S=this._events.get(v),E=this._events.previousEvent(S),k=this._getTicksUntilEvent(E,v);return S.ticks=Math.max(k,0),this}linearRampToValueAtTime(u,g){let v=this.toSeconds(g);super.linearRampToValueAtTime(u,g);let S=this._events.get(v),E=this._events.previousEvent(S),k=this._getTicksUntilEvent(E,v);return S.ticks=Math.max(k,0),this}exponentialRampToValueAtTime(u,g){g=this.toSeconds(g);let v=this._fromType(u),S=this._events.get(g),E=Math.round(Math.max(10*(g-S.time),1)),k=(g-S.time)/E;for(let M=0;M<=E;M++){let L=k*M+S.time,V=this._exponentialInterpolate(S.time,S.value,g,v,L);this.linearRampToValueAtTime(this._toType(V),L)}return this}_getTicksUntilEvent(u,g){if(u===null)u={ticks:0,time:0,type:"setValueAtTime",value:0};else if(ui(u.ticks)){let k=this._events.previousEvent(u);u.ticks=this._getTicksUntilEvent(k,u.time)}let v=this._fromType(this.getValueAtTime(u.time)),S=this._fromType(this.getValueAtTime(g)),E=this._events.get(g);return E&&E.time===g&&E.type==="setValueAtTime"&&(S=this._fromType(this.getValueAtTime(g-this.sampleTime))),.5*(g-u.time)*(v+S)+u.ticks}getTicksAtTime(u){let g=this.toSeconds(u),v=this._events.get(g);return Math.max(this._getTicksUntilEvent(v,g),0)}getDurationOfTicks(u,g){let v=this.toSeconds(g),S=this.getTicksAtTime(g);return this.getTimeOfTick(S+u)-v}getTimeOfTick(u){let g=this._events.get(u,"ticks"),v=this._events.getAfter(u,"ticks");if(g&&g.ticks===u)return g.time;if(g&&v&&v.type==="linearRampToValueAtTime"&&g.value!==v.value){let S=this._fromType(this.getValueAtTime(g.time)),E=(this._fromType(this.getValueAtTime(v.time))-S)/(v.time-g.time),k=Math.sqrt(Math.pow(S,2)-2*E*(g.ticks-u)),M=(-S+k)/E,L=(-S-k)/E;return(M>0?M:L)+g.time}return g?g.value===0?1/0:g.time+(u-g.ticks)/g.value:u/this._initialValue}ticksToTime(u,g){return this.getDurationOfTicks(u,g)}timeToTicks(u,g){let v=this.toSeconds(g),S=this.toSeconds(u),E=this.getTicksAtTime(v);return this.getTicksAtTime(v+S)-E}_fromType(u){return this.units==="bpm"&&this.multiplier?1/(60/u/this.multiplier):super._fromType(u)}_toType(u){return this.units==="bpm"&&this.multiplier?u/this.multiplier*60:super._toType(u)}get multiplier(){return this._multiplier}set multiplier(u){let g=this.value;this._multiplier=u,this.cancelScheduledValues(0),this.setValueAtTime(g,0)}}class lC extends zt{constructor(){super(ge(lC.getDefaults(),arguments,["value"])),this.name="TickSignal";let u=ge(lC.getDefaults(),arguments,["value"]);this.input=this._param=new uC({context:this.context,convert:u.convert,multiplier:u.multiplier,param:this._constantSource.offset,units:u.units,value:u.value})}static getDefaults(){return Object.assign(zt.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(u,g){return this._param.ticksToTime(u,g)}timeToTicks(u,g){return this._param.timeToTicks(u,g)}getTimeOfTick(u){return this._param.getTimeOfTick(u)}getDurationOfTicks(u,g){return this._param.getDurationOfTicks(u,g)}getTicksAtTime(u){return this._param.getTicksAtTime(u)}get multiplier(){return this._param.multiplier}set multiplier(u){this._param.multiplier=u}dispose(){return super.dispose(),this._param.dispose(),this}}class pC extends jo{constructor(){super(ge(pC.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new ny,this._tickOffset=new Di,this._ticksAtTime=new Di,this._secondsAtTime=new Di;let u=ge(pC.getDefaults(),arguments,["frequency"]);this.frequency=new lC({context:this.context,units:u.units,value:u.frequency}),Lt(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},jo.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(u,g){let v=this.toSeconds(u);return this._state.getValueAtTime(v)!=="started"&&(this._state.setStateAtTime("started",v),ln(g)&&this.setTicksAtTime(g,v),this._ticksAtTime.cancel(v),this._secondsAtTime.cancel(v)),this}stop(u){let g=this.toSeconds(u);if(this._state.getValueAtTime(g)==="stopped"){let v=this._state.get(g);v&&v.time>0&&(this._tickOffset.cancel(v.time),this._state.cancel(v.time))}return this._state.cancel(g),this._state.setStateAtTime("stopped",g),this.setTicksAtTime(0,g),this._ticksAtTime.cancel(g),this._secondsAtTime.cancel(g),this}pause(u){let g=this.toSeconds(u);return this._state.getValueAtTime(g)==="started"&&(this._state.setStateAtTime("paused",g),this._ticksAtTime.cancel(g),this._secondsAtTime.cancel(g)),this}cancel(u){return u=this.toSeconds(u),this._state.cancel(u),this._tickOffset.cancel(u),this._ticksAtTime.cancel(u),this._secondsAtTime.cancel(u),this}getTicksAtTime(u){let g=this.toSeconds(u),v=this._state.getLastState("stopped",g),S=this._ticksAtTime.get(g),E={state:"paused",time:g};this._state.add(E);let k=S||v,M=S?S.ticks:0,L=null;return this._state.forEachBetween(k.time,g+this.sampleTime,V=>{let W=k.time,X=this._tickOffset.get(V.time);X&&X.time>=k.time&&(M=X.ticks,W=X.time),k.state==="started"&&V.state!=="started"&&(M+=this.frequency.getTicksAtTime(V.time)-this.frequency.getTicksAtTime(W),V.time!==E.time&&(L={state:V.state,time:V.time,ticks:M})),k=V}),this._state.remove(E),L&&this._ticksAtTime.add(L),M}get ticks(){return this.getTicksAtTime(this.now())}set ticks(u){this.setTicksAtTime(u,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(u){let g=this.now(),v=this.frequency.timeToTicks(u,g);this.setTicksAtTime(v,g)}getSecondsAtTime(u){u=this.toSeconds(u);let g=this._state.getLastState("stopped",u),v={state:"paused",time:u};this._state.add(v);let S=this._secondsAtTime.get(u),E=S||g,k=S?S.seconds:0,M=null;return this._state.forEachBetween(E.time,u+this.sampleTime,L=>{let V=E.time,W=this._tickOffset.get(L.time);W&&W.time>=E.time&&(k=W.seconds,V=W.time),E.state==="started"&&L.state!=="started"&&(k+=L.time-V,L.time!==v.time&&(M={state:L.state,time:L.time,seconds:k})),E=L}),this._state.remove(v),M&&this._secondsAtTime.add(M),k}setTicksAtTime(u,g){return g=this.toSeconds(g),this._tickOffset.cancel(g),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(u,g),ticks:u,time:g}),this._ticksAtTime.cancel(g),this._secondsAtTime.cancel(g),this}getStateAtTime(u){return u=this.toSeconds(u),this._state.getValueAtTime(u)}getTimeOfTick(u,g=this.now()){let v=this._tickOffset.get(g),S=this._state.get(g),E=Math.max(v.time,S.time),k=this.frequency.getTicksAtTime(E)+u-v.ticks;return this.frequency.getTimeOfTick(k)}forEachTickBetween(u,g,v){let S=this._state.get(u);this._state.forEachBetween(u,g,k=>{S&&S.state==="started"&&k.state!=="started"&&this.forEachTickBetween(Math.max(S.time,u),k.time-this.sampleTime,v),S=k});let E=null;if(S&&S.state==="started"){let k=Math.max(S.time,u),M=this.frequency.getTicksAtTime(k),L=M-this.frequency.getTicksAtTime(S.time),V=Math.ceil(L)-L;V=Ya(V,1)?0:V;let W=this.frequency.getTimeOfTick(M+V);for(;W<g;){try{v(W,Math.round(this.getTicksAtTime(W)))}catch(X){E=X;break}W+=this.frequency.getDurationOfTicks(1,W)}}if(E)throw E;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class xd extends jo{constructor(){super(ge(xd.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=Cn,this._lastUpdate=0,this._state=new ny("stopped"),this._boundLoop=this._loop.bind(this);let u=ge(xd.getDefaults(),arguments,["callback","frequency"]);this.callback=u.callback,this._tickSource=new pC({context:this.context,frequency:u.frequency,units:u.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Lt(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(jo.getDefaults(),{callback:Cn,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(u,g){iA(this.context);let v=this.toSeconds(u);return this.log("start",v),this._state.getValueAtTime(v)!=="started"&&(this._state.setStateAtTime("started",v),this._tickSource.start(v,g),v<this._lastUpdate&&this.emit("start",v,g)),this}stop(u){let g=this.toSeconds(u);return this.log("stop",g),this._state.cancel(g),this._state.setStateAtTime("stopped",g),this._tickSource.stop(g),g<this._lastUpdate&&this.emit("stop",g),this}pause(u){let g=this.toSeconds(u);return this._state.getValueAtTime(g)==="started"&&(this._state.setStateAtTime("paused",g),this._tickSource.pause(g),g<this._lastUpdate&&this.emit("pause",g)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(u){this._tickSource.ticks=u}get seconds(){return this._tickSource.seconds}set seconds(u){this._tickSource.seconds=u}getSecondsAtTime(u){return this._tickSource.getSecondsAtTime(u)}setTicksAtTime(u,g){return this._tickSource.setTicksAtTime(u,g),this}getTimeOfTick(u,g=this.now()){return this._tickSource.getTimeOfTick(u,g)}getTicksAtTime(u){return this._tickSource.getTicksAtTime(u)}nextTickTime(u,g){let v=this.toSeconds(g),S=this.getTicksAtTime(v);return this._tickSource.getTimeOfTick(S+u,v)}_loop(){let u=this._lastUpdate,g=this.now();this._lastUpdate=g,this.log("loop",u,g),u!==g&&(this._state.forEachBetween(u,g,v=>{switch(v.state){case"started":let S=this._tickSource.getTicksAtTime(v.time);this.emit("start",v.time,S);break;case"stopped":v.time!==0&&this.emit("stop",v.time);break;case"paused":this.emit("pause",v.time)}}),this._tickSource.forEachTickBetween(u,g,(v,S)=>{this.callback(v,S)}))}getStateAtTime(u){let g=this.toSeconds(u);return this._state.getValueAtTime(g)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Yg.mixin(xd);class li extends st{constructor(){super(ge(li.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";let u=ge(li.getDefaults(),arguments,["delayTime","maxDelay"]),g=this.toSeconds(u.maxDelay);this._maxDelay=Math.max(g,this.toSeconds(u.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(g),this.delayTime=new Yt({context:this.context,param:this._delayNode.delayTime,units:"time",value:u.delayTime,minValue:0,maxValue:this.maxDelay}),Lt(this,"delayTime")}static getDefaults(){return Object.assign(st.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}function Zxe(C,u,g=2,v=Or().sampleRate){return xr(this,void 0,void 0,function*(){let S=Or(),E=new Jg(g,u,v);aC(E),yield C(E);let k=E.render();aC(S);let M=yield k;return new Mn(M)})}class oy extends Mh{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;let u=ge(oy.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=u.baseUrl,Object.keys(u.urls).forEach(g=>{this._loadingCount++;let v=u.urls[g];this.add(g,v,this._bufferLoaded.bind(this,u.onload),u.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Cn,onload:Cn,urls:{}}}has(u){return this._buffers.has(u.toString())}get(u){return Ot(this.has(u),`ToneAudioBuffers has no buffer named: ${u}`),this._buffers.get(u.toString())}_bufferLoaded(u){this._loadingCount--,this._loadingCount===0&&u&&u()}get loaded(){return Array.from(this._buffers).every(([u,g])=>g.loaded)}add(u,g,v=Cn,S=Cn){return Xa(g)?(this.baseUrl&&g.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(u.toString(),new Mn(this.baseUrl+g,v,S))):this._buffers.set(u.toString(),new Mn(g,v,S)),this}dispose(){return super.dispose(),this._buffers.forEach(u=>u.dispose()),this._buffers.clear(),this}}class sy extends Ws{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(u){return Rh(super._frequencyToUnits(u))}_ticksToUnits(u){return Rh(super._ticksToUnits(u))}_beatsToUnits(u){return Rh(super._beatsToUnits(u))}_secondsToUnits(u){return Rh(super._secondsToUnits(u))}toMidi(){return this.valueOf()}toFrequency(){return hA(this.toMidi())}transpose(u){return new sy(this.context,this.toMidi()+u)}}function Jxe(C,u){return new sy(Or(),C,u)}class Ur extends Co{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(u){return this._getPPQ()*u}_secondsToUnits(u){return Math.floor(u/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(u){return u}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}function eve(C,u){return new Ur(Or(),C,u)}class tve extends jo{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Di,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(u,g){return this._events.add({callback:u,time:this.toSeconds(g)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(u){return this._events.cancel(this.toSeconds(u)),this}_drawLoop(){let u=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=u;){let g=this._events.shift();g&&u-g.time<=this.expiration&&g.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}sC(C=>{C.draw=new tve({context:C})}),iC(C=>{C.draw.dispose()});class MV extends Mh{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(u){Ot(ln(u.time),"Events must have a time property"),Ot(ln(u.duration),"Events must have a duration parameter"),u.time=u.time.valueOf();let g=new nve(u.time,u.time+u.duration,u);for(this._root===null?this._root=g:this._root.insert(g),this._length++;g!==null;)g.updateHeight(),g.updateMax(),this._rebalance(g),g=g.parent;return this}remove(u){if(this._root!==null){let g=[];this._root.search(u.time,g);for(let v of g)if(v.event===u){this._removeNode(v),this._length--;break}}return this}get length(){return this._length}cancel(u){return this.forEachFrom(u,g=>this.remove(g)),this}_setRoot(u){this._root=u,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(u,g){u.parent!==null?(u.isLeftChild()?u.parent.left=g:u.parent.right=g,this._rebalance(u.parent)):this._setRoot(g)}_removeNode(u){if(u.left===null&&u.right===null)this._replaceNodeInParent(u,null);else if(u.right===null)this._replaceNodeInParent(u,u.left);else if(u.left===null)this._replaceNodeInParent(u,u.right);else{let g,v=null;if(u.getBalance()>0)if(u.left.right===null)g=u.left,g.right=u.right,v=g;else{for(g=u.left.right;g.right!==null;)g=g.right;g.parent&&(g.parent.right=g.left,v=g.parent,g.left=u.left,g.right=u.right)}else if(u.right.left===null)g=u.right,g.left=u.left,v=g;else{for(g=u.right.left;g.left!==null;)g=g.left;g.parent&&(g.parent.left=g.right,v=g.parent,g.left=u.left,g.right=u.right)}u.parent!==null?u.isLeftChild()?u.parent.left=g:u.parent.right=g:this._setRoot(g),v&&this._rebalance(v)}u.dispose()}_rotateLeft(u){let g=u.parent,v=u.isLeftChild(),S=u.right;S&&(u.right=S.left,S.left=u),g!==null?v?g.left=S:g.right=S:this._setRoot(S)}_rotateRight(u){let g=u.parent,v=u.isLeftChild(),S=u.left;S&&(u.left=S.right,S.right=u),g!==null?v?g.left=S:g.right=S:this._setRoot(S)}_rebalance(u){let g=u.getBalance();g>1&&u.left?u.left.getBalance()<0?this._rotateLeft(u.left):this._rotateRight(u):g<-1&&u.right&&(u.right.getBalance()>0?this._rotateRight(u.right):this._rotateLeft(u))}get(u){if(this._root!==null){let g=[];if(this._root.search(u,g),g.length>0){let v=g[0];for(let S=1;S<g.length;S++)g[S].low>v.low&&(v=g[S]);return v.event}}return null}forEach(u){if(this._root!==null){let g=[];this._root.traverse(v=>g.push(v)),g.forEach(v=>{v.event&&u(v.event)})}return this}forEachAtTime(u,g){if(this._root!==null){let v=[];this._root.search(u,v),v.forEach(S=>{S.event&&g(S.event)})}return this}forEachFrom(u,g){if(this._root!==null){let v=[];this._root.searchAfter(u,v),v.forEach(S=>{S.event&&g(S.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(u=>u.dispose()),this._root=null,this}}class nve{constructor(u,g,v){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=v,this.low=u,this.high=g,this.max=this.high}insert(u){u.low<=this.low?this.left===null?this.left=u:this.left.insert(u):this.right===null?this.right=u:this.right.insert(u)}search(u,g){u>this.max||(this.left!==null&&this.left.search(u,g),this.low<=u&&this.high>u&&g.push(this),this.low>u||this.right!==null&&this.right.search(u,g))}searchAfter(u,g){this.low>=u&&(g.push(this),this.left!==null&&this.left.searchAfter(u,g)),this.right!==null&&this.right.searchAfter(u,g)}traverse(u){u(this),this.left!==null&&this.left.traverse(u),this.right!==null&&this.right.traverse(u)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let u=0;return this.left!==null&&this.right!==null?u=this.left.height-this.right.height:this.left!==null?u=this.left.height+1:this.right!==null&&(u=-(this.right.height+1)),u}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(u){this._left=u,u!==null&&(u.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(u){this._right=u,u!==null&&(u.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class $c extends st{constructor(){super(ge($c.getDefaults(),arguments,["volume"])),this.name="Volume";let u=ge($c.getDefaults(),arguments,["volume"]);this.input=this.output=new Dt({context:this.context,gain:u.volume,units:"decibels"}),this.volume=this.output.gain,Lt(this,"volume"),this._unmutedVolume=u.volume,this.mute=u.mute}static getDefaults(){return Object.assign(st.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(u){!this.mute&&u?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!u&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class hC extends st{constructor(){super(ge(hC.getDefaults(),arguments)),this.name="Destination",this.input=new $c({context:this.context}),this.output=new Dt({context:this.context}),this.volume=this.input.volume;let u=ge(hC.getDefaults(),arguments);Ai(this.input,this.output,this.context.rawContext.destination),this.mute=u.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(st.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(u){this.input.mute=u}chain(...u){return this.input.disconnect(),u.unshift(this.input),u.push(this.output),Ai(...u),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}sC(C=>{C.destination=new hC({context:C})}),iC(C=>{C.destination.dispose()});class rve extends Mh{constructor(u){super(),this.name="TimelineValue",this._timeline=new Di({memory:10}),this._initialValue=u}set(u,g){return this._timeline.add({value:u,time:g}),this}get(u){let g=this._timeline.get(u);return g?g.value:this._initialValue}}class Oi extends st{constructor(){super(Object.assign(ge(Oi.getDefaults(),arguments,["context"])))}connect(u,g=0,v=0){return qb(this,u,g,v),this}}class ia extends Oi{constructor(){super(Object.assign(ge(ia.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;let u=ge(ia.getDefaults(),arguments,["mapping","length"]);cs(u.mapping)||u.mapping instanceof Float32Array?this.curve=Float32Array.from(u.mapping):_V(u.mapping)&&this.setMap(u.mapping,u.length)}static getDefaults(){return Object.assign(zt.getDefaults(),{length:1024})}setMap(u,g=1024){let v=new Float32Array(g);for(let S=0,E=g;S<E;S++){let k=S/(E-1)*2-1;v[S]=u(k,S)}return this.curve=v,this}get curve(){return this._shaper.curve}set curve(u){this._shaper.curve=u}get oversample(){return this._shaper.oversample}set oversample(u){Ot(["none","2x","4x"].some(g=>g.includes(u)),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=u}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class vd extends Oi{constructor(){super(Object.assign(ge(vd.getDefaults(),arguments,["value"]))),this.name="Pow";let u=ge(vd.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new ia({context:this.context,mapping:this._expFunc(u.value),length:8192}),this._exponent=u.value}static getDefaults(){return Object.assign(Oi.getDefaults(),{value:1})}_expFunc(u){return g=>Math.pow(Math.abs(g),u)}get value(){return this._exponent}set value(u){this._exponent=u,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}let fC=(()=>{class C{constructor(g,v){this.id=C._eventId++,this._remainderTime=0;let S=Object.assign(C.getDefaults(),v);this.transport=g,this.callback=S.callback,this._once=S.once,this.time=Math.floor(S.time),this._remainderTime=S.time-this.time}static getDefaults(){return{callback:Cn,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(g){if(this.callback){let v=this.transport.bpm.getDurationOfTicks(1,g);this.callback(g+this._remainderTime*v),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}return C._eventId=0,C})();class mA extends fC{constructor(u,g){super(u,g),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);let v=Object.assign(mA.getDefaults(),g);this.duration=v.duration,this._interval=v.interval,this._nextTick=v.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},fC.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(u){this._createEvents(u),super.invoke(u)}_createEvent(){return oC(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new Ur(this.context,this._nextTick).toSeconds()):-1}_createEvents(u){oC(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Ur(this.context,this._nextTick).toSeconds()))}_restart(u){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;let g=this.transport.getTicksAtTime(u);Qg(g,this.time)&&(this._nextTick=this.floatTime+Math.ceil((g-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class Ub extends jo{constructor(){super(ge(Ub.getDefaults(),arguments)),this.name="Transport",this._loop=new rve(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Di,this._repeatedEvents=new MV,this._syncedSignals=[],this._swingAmount=0;let u=ge(Ub.getDefaults(),arguments);this._ppq=u.ppq,this._clock=new xd({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=u.ppq,this.bpm.setValueAtTime(u.bpm,0),Lt(this,"bpm"),this._timeSignature=u.timeSignature,this._swingTicks=u.ppq/2}static getDefaults(){return Object.assign(jo.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(u,g){if(this._loop.get(u)&&g>=this._loopEnd&&(this.emit("loopEnd",u),this._clock.setTicksAtTime(this._loopStart,u),g=this._loopStart,this.emit("loopStart",u,this._clock.getSecondsAtTime(u)),this.emit("loop",u)),this._swingAmount>0&&g%this._ppq!=0&&g%(2*this._swingTicks)!=0){let v=g%(2*this._swingTicks)/(2*this._swingTicks),S=Math.sin(v*Math.PI)*this._swingAmount;u+=new Ur(this.context,2*this._swingTicks/3).toSeconds()*S}aA(!0),this._timeline.forEachAtTime(g,v=>v.invoke(u)),aA(!1)}schedule(u,g){let v=new fC(this,{callback:u,time:new Co(this.context,g).toTicks()});return this._addEvent(v,this._timeline)}scheduleRepeat(u,g,v,S=1/0){let E=new mA(this,{callback:u,duration:new ki(this.context,S).toTicks(),interval:new ki(this.context,g).toTicks(),time:new Co(this.context,v).toTicks()});return this._addEvent(E,this._repeatedEvents)}scheduleOnce(u,g){let v=new fC(this,{callback:u,once:!0,time:new Co(this.context,g).toTicks()});return this._addEvent(v,this._timeline)}clear(u){if(this._scheduledEvents.hasOwnProperty(u)){let g=this._scheduledEvents[u.toString()];g.timeline.remove(g.event),g.event.dispose(),delete this._scheduledEvents[u.toString()]}return this}_addEvent(u,g){return this._scheduledEvents[u.id.toString()]={event:u,timeline:g},g.add(u),u.id}cancel(u=0){let g=this.toTicks(u);return this._timeline.forEachFrom(g,v=>this.clear(v.id)),this._repeatedEvents.forEachFrom(g,v=>this.clear(v.id)),this}_bindClockEvents(){this._clock.on("start",(u,g)=>{g=new Ur(this.context,g).toSeconds(),this.emit("start",u,g)}),this._clock.on("stop",u=>{this.emit("stop",u)}),this._clock.on("pause",u=>{this.emit("pause",u)})}get state(){return this._clock.getStateAtTime(this.now())}start(u,g){let v;return this.context.resume(),ln(g)&&(v=this.toTicks(g)),this._clock.start(u,v),this}stop(u){return this._clock.stop(u),this}pause(u){return this._clock.pause(u),this}toggle(u){return u=this.toSeconds(u),this._clock.getStateAtTime(u)!=="started"?this.start(u):this.stop(u),this}get timeSignature(){return this._timeSignature}set timeSignature(u){cs(u)&&(u=u[0]/u[1]*4),this._timeSignature=u}get loopStart(){return new ki(this.context,this._loopStart,"i").toSeconds()}set loopStart(u){this._loopStart=this.toTicks(u)}get loopEnd(){return new ki(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(u){this._loopEnd=this.toTicks(u)}get loop(){return this._loop.get(this.now())}set loop(u){this._loop.set(u,this.now())}setLoopPoints(u,g){return this.loopStart=u,this.loopEnd=g,this}get swing(){return this._swingAmount}set swing(u){this._swingAmount=u}get swingSubdivision(){return new Ur(this.context,this._swingTicks).toNotation()}set swingSubdivision(u){this._swingTicks=this.toTicks(u)}get position(){let u=this.now(),g=this._clock.getTicksAtTime(u);return new Ur(this.context,g).toBarsBeatsSixteenths()}set position(u){let g=this.toTicks(u);this.ticks=g}get seconds(){return this._clock.seconds}set seconds(u){let g=this.now(),v=this._clock.frequency.timeToTicks(u,g);this.ticks=v}get progress(){if(this.loop){let u=this.now();return(this._clock.getTicksAtTime(u)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(u){if(this._clock.ticks!==u){let g=this.now();if(this.state==="started"){let v=this._clock.getTicksAtTime(g),S=g+this._clock.frequency.getDurationOfTicks(Math.ceil(v)-v,g);this.emit("stop",S),this._clock.setTicksAtTime(u,S),this.emit("start",S,this._clock.getSecondsAtTime(S))}else this.emit("ticks",g),this._clock.setTicksAtTime(u,g)}}getTicksAtTime(u){return this._clock.getTicksAtTime(u)}getSecondsAtTime(u){return this._clock.getSecondsAtTime(u)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(u){this._clock.frequency.multiplier=u}nextSubdivision(u){if(u=this.toTicks(u),this.state!=="started")return 0;{let g=this.now(),v=u-this.getTicksAtTime(g)%u;return this._clock.nextTickTime(v,g)}}syncSignal(u,g){let v=this.now(),S=this.bpm,E=1/(60/S.getValueAtTime(v)/this.PPQ),k=[];if(u.units==="time"){let L=.015625/E,V=new Dt(L),W=new vd(-1),X=new Dt(L);S.chain(V,W,X),S=X,E=1/E,k=[V,W,X]}g||(g=u.getValueAtTime(v)!==0?u.getValueAtTime(v)/E:0);let M=new Dt(g);return S.connect(M),M.connect(u._param),k.push(M),this._syncedSignals.push({initial:u.value,nodes:k,signal:u}),u.value=0,this}unsyncSignal(u){for(let g=this._syncedSignals.length-1;g>=0;g--){let v=this._syncedSignals[g];v.signal===u&&(v.nodes.forEach(S=>S.dispose()),v.signal.value=v.initial,this._syncedSignals.splice(g,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Lb(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Yg.mixin(Ub),sC(C=>{C.transport=new Ub({context:C})}),iC(C=>{C.transport.dispose()});class Jr extends st{constructor(u){super(u),this.input=void 0,this._state=new ny("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Cn,this._syncedStop=Cn,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new $c({context:this.context,mute:u.mute,volume:u.volume}),this.volume=this._volume.volume,Lt(this,"volume"),this.onstop=u.onstop}static getDefaults(){return Object.assign(st.getDefaults(),{mute:!1,onstop:Cn,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(u){this._volume.mute=u}_clampToCurrentTime(u){return this._synced?u:Math.max(u,this.context.currentTime)}start(u,g,v){let S=ui(u)&&this._synced?this.context.transport.seconds:this.toSeconds(u);if(S=this._clampToCurrentTime(S),this._synced||this._state.getValueAtTime(S)!=="started")if(this.log("start",S),this._state.setStateAtTime("started",S),this._synced){let E=this._state.get(S);E&&(E.offset=this.toSeconds(sa(g,0)),E.duration=v?this.toSeconds(v):void 0);let k=this.context.transport.schedule(M=>{this._start(M,g,v)},S);this._scheduled.push(k),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>S&&this._syncedStart(this.now(),this.context.transport.seconds)}else iA(this.context),this._start(S,g,v);else Ot(Qg(S,this._state.get(S).time),"Start time must be strictly greater than previous start time"),this._state.cancel(S),this._state.setStateAtTime("started",S),this.log("restart",S),this.restart(S,g,v);return this}stop(u){let g=ui(u)&&this._synced?this.context.transport.seconds:this.toSeconds(u);if(g=this._clampToCurrentTime(g),this._state.getValueAtTime(g)==="started"||ln(this._state.getNextState("started",g))){if(this.log("stop",g),this._synced){let v=this.context.transport.schedule(this._stop.bind(this),g);this._scheduled.push(v)}else this._stop(g);this._state.cancel(g),this._state.setStateAtTime("stopped",g)}return this}restart(u,g,v){return u=this.toSeconds(u),this._state.getValueAtTime(u)==="started"&&(this._state.cancel(u),this._restart(u,g,v)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(u,g)=>{if(Qg(g,0)){let v=this._state.get(g);if(v&&v.state==="started"&&v.time!==g){let S=g-this.toSeconds(v.time),E;v.duration&&(E=this.toSeconds(v.duration)-S),this._start(u,this.toSeconds(v.offset)+S,E)}}},this._syncedStop=u=>{let g=this.context.transport.getSecondsAtTime(Math.max(u-this.sampleTime,0));this._state.getValueAtTime(g)==="started"&&this._stop(u)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(u=>this.context.transport.clear(u)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Cn,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class Ll extends ry{constructor(){super(ge(Ll.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;let u=ge(Ll.getDefaults(),arguments,["url","onload"]);Hs(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Yt({context:this.context,param:this._source.playbackRate,units:"positive",value:u.playbackRate}),this.loop=u.loop,this.loopStart=u.loopStart,this.loopEnd=u.loopEnd,this._buffer=new Mn(u.url,u.onload,u.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(ry.getDefaults(),{url:new Mn,loop:!1,loopEnd:0,loopStart:0,onload:Cn,onerror:Cn,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(u){this._fadeIn=u}get fadeOut(){return this._fadeOut}set fadeOut(u){this._fadeOut=u}get curve(){return this._curve}set curve(u){this._curve=u}start(u,g,v,S=1){Ot(this.buffer.loaded,"buffer is either not set or not loaded");let E=this.toSeconds(u);this._startGain(E,S),g=this.loop?sa(g,this.loopStart):sa(g,0);let k=Math.max(this.toSeconds(g),0);if(this.loop){let M=this.toSeconds(this.loopEnd)||this.buffer.duration,L=this.toSeconds(this.loopStart),V=M-L;lA(k,M)&&(k=(k-L)%V+L),Ya(k,this.buffer.duration)&&(k=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,oC(k,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(E,k)),ln(v)){let M=this.toSeconds(v);M=Math.max(M,0),this.stop(E+M)}return this}_stopSource(u){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(u)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(u){this._source.loopStart=this.toSeconds(u)}get loopEnd(){return this._source.loopEnd}set loopEnd(u){this._source.loopEnd=this.toSeconds(u)}get buffer(){return this._buffer}set buffer(u){this._buffer.set(u)}get loop(){return this._source.loop}set loop(u){this._source.loop=u,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class zl extends Jr{constructor(){super(ge(zl.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;let u=ge(zl.getDefaults(),arguments,["type"]);this._playbackRate=u.playbackRate,this.type=u.type,this._fadeIn=u.fadeIn,this._fadeOut=u.fadeOut}static getDefaults(){return Object.assign(Jr.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(u){if(Ot(u in RV,"Noise: invalid type: "+u),this._type!==u&&(this._type=u,this.state==="started")){let g=this.now();this._stop(g),this._start(g)}}get playbackRate(){return this._playbackRate}set playbackRate(u){this._playbackRate=u,this._source&&(this._source.playbackRate.value=u)}_start(u){let g=RV[this._type];this._source=new Ll({url:g,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(u),Math.random()*(g.duration-.001))}_stop(u){this._source&&(this._source.stop(this.toSeconds(u)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(u){this._fadeIn=u,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(u){this._fadeOut=u,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(u){this._stop(u),this._start(u)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}let iy=220500,Bl={brown:null,pink:null,white:null},RV={get brown(){if(!Bl.brown){let C=[];for(let u=0;u<2;u++){let g=new Float32Array(iy);C[u]=g;let v=0;for(let S=0;S<iy;S++){let E=2*Math.random()-1;g[S]=(v+.02*E)/1.02,v=g[S],g[S]*=3.5}}Bl.brown=new Mn().fromArray(C)}return Bl.brown},get pink(){if(!Bl.pink){let C=[];for(let u=0;u<2;u++){let g=new Float32Array(iy),v,S,E,k,M,L,V;C[u]=g,v=S=E=k=M=L=V=0;for(let W=0;W<iy;W++){let X=2*Math.random()-1;v=.99886*v+.0555179*X,S=.99332*S+.0750759*X,E=.969*E+.153852*X,k=.8665*k+.3104856*X,M=.55*M+.5329522*X,L=-.7616*L-.016898*X,g[W]=v+S+E+k+M+L+V+.5362*X,g[W]*=.11,V=.115926*X}}Bl.pink=new Mn().fromArray(C)}return Bl.pink},get white(){if(!Bl.white){let C=[];for(let u=0;u<2;u++){let g=new Float32Array(iy);C[u]=g;for(let v=0;v<iy;v++)g[v]=2*Math.random()-1}Bl.white=new Mn().fromArray(C)}return Bl.white}};class ay extends st{constructor(){super(ge(ay.getDefaults(),arguments,["volume"])),this.name="UserMedia";let u=ge(ay.getDefaults(),arguments,["volume"]);this._volume=this.output=new $c({context:this.context,volume:u.volume}),this.volume=this._volume.volume,Lt(this,"volume"),this.mute=u.mute}static getDefaults(){return Object.assign(st.getDefaults(),{mute:!1,volume:0})}open(u){return xr(this,void 0,void 0,function*(){Ot(ay.supported,"UserMedia is not supported"),this.state==="started"&&this.close();let g=yield ay.enumerateDevices();Ni(u)?this._device=g[u]:(this._device=g.find(E=>E.label===u||E.deviceId===u),!this._device&&g.length>0&&(this._device=g[0]),Ot(ln(this._device),`No matching device ${u}`));let v={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(v.audio.deviceId=this._device.deviceId);let S=yield navigator.mediaDevices.getUserMedia(v);if(!this._stream){this._stream=S;let E=this.context.createMediaStreamSource(S);Hs(E,this.output),this._mediaStream=E}return this})}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach(u=>{u.stop()}),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return xr(this,void 0,void 0,function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(u=>u.kind==="audioinput")})}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){return this._device?this._device.deviceId:void 0}get groupId(){return this._device?this._device.groupId:void 0}get label(){return this._device?this._device.label:void 0}get mute(){return this._volume.mute}set mute(u){this._volume.mute=u}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return ln(navigator.mediaDevices)&&ln(navigator.mediaDevices.getUserMedia)}}function bd(C,u){return xr(this,void 0,void 0,function*(){let g=u/C.context.sampleRate,v=new Jg(1,g,C.context.sampleRate);return new C.constructor(Object.assign(C.get(),{frequency:2/g,detune:0,context:v})).toDestination().start(0),(yield v.render()).getChannelData(0)})}class cy extends ry{constructor(){super(ge(cy.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];let u=ge(cy.getDefaults(),arguments,["frequency","type"]);Hs(this._oscillator,this._gainNode),this.type=u.type,this.frequency=new Yt({context:this.context,param:this._oscillator.frequency,units:"frequency",value:u.frequency}),this.detune=new Yt({context:this.context,param:this._oscillator.detune,units:"cents",value:u.detune}),Lt(this,["frequency","detune"])}static getDefaults(){return Object.assign(ry.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(u){let g=this.toSeconds(u);return this.log("start",g),this._startGain(g),this._oscillator.start(g),this}_stopSource(u){this._oscillator.stop(u)}setPeriodicWave(u){return this._oscillator.setPeriodicWave(u),this}get type(){return this._oscillator.type}set type(u){this._oscillator.type=u}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}let Ns=(()=>{class C extends Jr{constructor(){super(ge(C.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;let g=ge(C.getDefaults(),arguments,["frequency","type"]);this.frequency=new zt({context:this.context,units:"frequency",value:g.frequency}),Lt(this,"frequency"),this.detune=new zt({context:this.context,units:"cents",value:g.detune}),Lt(this,"detune"),this._partials=g.partials,this._partialCount=g.partialCount,this._type=g.type,g.partialCount&&g.type!=="custom"&&(this._type=this.baseType+g.partialCount.toString()),this.phase=g.phase}static getDefaults(){return Object.assign(Jr.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(g){let v=this.toSeconds(g),S=new cy({context:this.context,onended:()=>this.onstop(this)});this._oscillator=S,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(v)}_stop(g){let v=this.toSeconds(g);this._oscillator&&this._oscillator.stop(v)}_restart(g){let v=this.toSeconds(g);return this.log("restart",v),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(v),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return C._periodicWaveCache.find(g=>{return g.phase===this._phase&&(v=g.partials,S=this._partials,v.length===S.length&&v.every((E,k)=>S[k]===E));var v,S});{let g=C._periodicWaveCache.find(v=>v.type===this._type&&v.phase===this._phase);return this._partialCount=g?g.partialCount:this._partialCount,g}}get type(){return this._type}set type(g){this._type=g;let v=["sine","square","sawtooth","triangle"].indexOf(g)!==-1;if(this._phase===0&&v)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=g);else{let S=this._getCachedPeriodicWave();if(ln(S)){let{partials:E,wave:k}=S;this._wave=k,this._partials=E,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{let[E,k]=this._getRealImaginary(g,this._phase),M=this.context.createPeriodicWave(E,k);this._wave=M,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),C._periodicWaveCache.push({imag:k,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:E,type:this._type,wave:this._wave}),C._periodicWaveCache.length>100&&C._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(g){this.partialCount&&this._type!=="custom"&&g!=="custom"?this.type=g+this.partialCount:this.type=g}get partialCount(){return this._partialCount}set partialCount(g){us(g,0);let v=this._type,S=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(S&&(v=S[1]),this._type!=="custom")this.type=g===0?v:v+g.toString();else{let E=new Float32Array(g);this._partials.forEach((k,M)=>E[M]=k),this._partials=Array.from(E),this.type=this._type}}_getRealImaginary(g,v){let S=2048,E=new Float32Array(S),k=new Float32Array(S),M=1;if(g==="custom"){if(M=this._partials.length+1,this._partialCount=this._partials.length,S=M,this._partials.length===0)return[E,k]}else{let L=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(g);L?(M=parseInt(L[2],10)+1,this._partialCount=parseInt(L[2],10),g=L[1],M=Math.max(M,2),S=M):this._partialCount=0,this._partials=[]}for(let L=1;L<S;++L){let V=2/(L*Math.PI),W;switch(g){case"sine":W=L<=M?1:0,this._partials[L-1]=W;break;case"square":W=1&L?2*V:0,this._partials[L-1]=W;break;case"sawtooth":W=V*(1&L?1:-1),this._partials[L-1]=W;break;case"triangle":W=1&L?V*V*2*(L-1>>1&1?-1:1):0,this._partials[L-1]=W;break;case"custom":W=this._partials[L-1];break;default:throw new TypeError("Oscillator: invalid type: "+g)}W!==0?(E[L]=-W*Math.sin(v*L),k[L]=W*Math.cos(v*L)):(E[L]=0,k[L]=0)}return[E,k]}_inverseFFT(g,v,S){let E=0,k=g.length;for(let M=0;M<k;M++)E+=g[M]*Math.cos(M*S)+v[M]*Math.sin(M*S);return E}getInitialValue(){let[g,v]=this._getRealImaginary(this._type,0),S=0,E=2*Math.PI;for(let k=0;k<32;k++)S=Math.max(this._inverseFFT(g,v,k/32*E),S);return yd(-this._inverseFFT(g,v,this._phase)/S,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(g){this._partials=g,this._partialCount=this._partials.length,g.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(g){this._phase=g*Math.PI/180,this.type=this._type}asArray(g=1024){return xr(this,void 0,void 0,function*(){return bd(this,g)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}return C._periodicWaveCache=[],C})();class dC extends Oi{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new ia({context:this.context,mapping:u=>(u+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Mr extends zt{constructor(){super(Object.assign(ge(Mr.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;let u=ge(Mr.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Dt({context:this.context,minValue:u.minValue,maxValue:u.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(u.value,0)}static getDefaults(){return Object.assign(zt.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class uy extends Jr{constructor(){super(ge(uy.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new dC({context:this.context}),this._modulationNode=new Dt({context:this.context});let u=ge(uy.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Ns({context:this.context,detune:u.detune,frequency:u.frequency,onstop:()=>this.onstop(this),phase:u.phase,type:u.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Ns({context:this.context,phase:u.phase,type:u.modulationType}),this.harmonicity=new Mr({context:this.context,units:"positive",value:u.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Lt(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Ns.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(u){this._modulator.start(u),this._carrier.start(u)}_stop(u){this._modulator.stop(u),this._carrier.stop(u)}_restart(u){this._modulator.restart(u),this._carrier.restart(u)}get type(){return this._carrier.type}set type(u){this._carrier.type=u}get baseType(){return this._carrier.baseType}set baseType(u){this._carrier.baseType=u}get partialCount(){return this._carrier.partialCount}set partialCount(u){this._carrier.partialCount=u}get modulationType(){return this._modulator.type}set modulationType(u){this._modulator.type=u}get phase(){return this._carrier.phase}set phase(u){this._carrier.phase=u,this._modulator.phase=u}get partials(){return this._carrier.partials}set partials(u){this._carrier.partials=u}asArray(u=1024){return xr(this,void 0,void 0,function*(){return bd(this,u)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class wd extends Jr{constructor(){super(ge(wd.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Dt({context:this.context,gain:0});let u=ge(wd.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Ns({context:this.context,detune:u.detune,frequency:0,onstop:()=>this.onstop(this),phase:u.phase,type:u.type}),this.detune=this._carrier.detune,this.frequency=new zt({context:this.context,units:"frequency",value:u.frequency}),this._modulator=new Ns({context:this.context,phase:u.phase,type:u.modulationType}),this.harmonicity=new Mr({context:this.context,units:"positive",value:u.harmonicity}),this.modulationIndex=new Mr({context:this.context,units:"positive",value:u.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Lt(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Ns.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(u){this._modulator.start(u),this._carrier.start(u)}_stop(u){this._modulator.stop(u),this._carrier.stop(u)}_restart(u){return this._modulator.restart(u),this._carrier.restart(u),this}get type(){return this._carrier.type}set type(u){this._carrier.type=u}get baseType(){return this._carrier.baseType}set baseType(u){this._carrier.baseType=u}get partialCount(){return this._carrier.partialCount}set partialCount(u){this._carrier.partialCount=u}get modulationType(){return this._modulator.type}set modulationType(u){this._modulator.type=u}get phase(){return this._carrier.phase}set phase(u){this._carrier.phase=u,this._modulator.phase=u}get partials(){return this._carrier.partials}set partials(u){this._carrier.partials=u}asArray(u=1024){return xr(this,void 0,void 0,function*(){return bd(this,u)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class Sd extends Jr{constructor(){super(ge(Sd.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Dt({context:this.context,gain:0}),this._thresh=new ia({context:this.context,mapping:g=>g<=0?-1:1});let u=ge(Sd.getDefaults(),arguments,["frequency","width"]);this.width=new zt({context:this.context,units:"audioRange",value:u.width}),this._triangle=new Ns({context:this.context,detune:u.detune,frequency:u.frequency,onstop:()=>this.onstop(this),phase:u.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Lt(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Jr.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(u){u=this.toSeconds(u),this._triangle.start(u),this._widthGate.gain.setValueAtTime(1,u)}_stop(u){u=this.toSeconds(u),this._triangle.stop(u),this._widthGate.gain.cancelScheduledValues(u),this._widthGate.gain.setValueAtTime(0,u)}_restart(u){this._triangle.restart(u),this._widthGate.gain.cancelScheduledValues(u),this._widthGate.gain.setValueAtTime(1,u)}get phase(){return this._triangle.phase}set phase(u){this._triangle.phase=u}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(u){this._triangle.type=u}asArray(u=1024){return xr(this,void 0,void 0,function*(){return bd(this,u)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class ly extends Jr{constructor(){super(ge(ly.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];let u=ge(ly.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new zt({context:this.context,units:"frequency",value:u.frequency}),this.detune=new zt({context:this.context,units:"cents",value:u.detune}),this._spread=u.spread,this._type=u.type,this._phase=u.phase,this._partials=u.partials,this._partialCount=u.partialCount,this.count=u.count,Lt(this,["frequency","detune"])}static getDefaults(){return Object.assign(Ns.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(u){u=this.toSeconds(u),this._forEach(g=>g.start(u))}_stop(u){u=this.toSeconds(u),this._forEach(g=>g.stop(u))}_restart(u){this._forEach(g=>g.restart(u))}_forEach(u){for(let g=0;g<this._oscillators.length;g++)u(this._oscillators[g],g)}get type(){return this._type}set type(u){this._type=u,this._forEach(g=>g.type=u)}get spread(){return this._spread}set spread(u){if(this._spread=u,this._oscillators.length>1){let g=-u/2,v=u/(this._oscillators.length-1);this._forEach((S,E)=>S.detune.value=g+v*E)}}get count(){return this._oscillators.length}set count(u){if(us(u,1),this._oscillators.length!==u){this._forEach(g=>g.dispose()),this._oscillators=[];for(let g=0;g<u;g++){let v=new Ns({context:this.context,volume:-6-1.1*u,type:this._type,phase:this._phase+g/u*360,partialCount:this._partialCount,onstop:g===0?()=>this.onstop(this):Cn});this.type==="custom"&&(v.partials=this._partials),this.frequency.connect(v.frequency),this.detune.connect(v.detune),v.detune.overridden=!1,v.connect(this.output),this._oscillators[g]=v}this.spread=this._spread,this.state==="started"&&this._forEach(g=>g.start())}}get phase(){return this._phase}set phase(u){this._phase=u,this._forEach((g,v)=>g.phase=this._phase+v/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(u){this._forEach(g=>g.baseType=u),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(u){this._partials=u,this._partialCount=this._partials.length,u.length&&(this._type="custom",this._forEach(g=>g.partials=u))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(u){this._partialCount=u,this._forEach(g=>g.partialCount=u),this._type=this._oscillators[0].type}asArray(u=1024){return xr(this,void 0,void 0,function*(){return bd(this,u)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(u=>u.dispose()),this}}class py extends Jr{constructor(){super(ge(py.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Mr({context:this.context,value:2});let u=ge(py.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new Sd({context:this.context,frequency:u.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Ns({context:this.context,detune:u.detune,frequency:u.frequency,onstop:()=>this.onstop(this),phase:u.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Lt(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Jr.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(u){u=this.toSeconds(u),this._modulator.start(u),this._pulse.start(u)}_stop(u){u=this.toSeconds(u),this._modulator.stop(u),this._pulse.stop(u)}_restart(u){this._modulator.restart(u),this._pulse.restart(u)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(u){this._modulator.phase=u}asArray(u=1024){return xr(this,void 0,void 0,function*(){return bd(this,u)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}let PV={am:uy,fat:ly,fm:wd,oscillator:Ns,pulse:Sd,pwm:py};class Lc extends Jr{constructor(){super(ge(Lc.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";let u=ge(Lc.getDefaults(),arguments,["frequency","type"]);this.frequency=new zt({context:this.context,units:"frequency",value:u.frequency}),this.detune=new zt({context:this.context,units:"cents",value:u.detune}),Lt(this,["frequency","detune"]),this.set(u)}static getDefaults(){return Object.assign(Ns.getDefaults(),wd.getDefaults(),uy.getDefaults(),ly.getDefaults(),Sd.getDefaults(),py.getDefaults())}_start(u){this._oscillator.start(u)}_stop(u){this._oscillator.stop(u)}_restart(u){return this._oscillator.restart(u),this}get type(){let u="";return["am","fm","fat"].some(g=>this._sourceType===g)&&(u=this._sourceType),u+this._oscillator.type}set type(u){u.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=u.substr(2)):u.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=u.substr(2)):u.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=u.substr(3)):u==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):u==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=u)}get partials(){return this._oscillator.partials}set partials(u){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=u)}get partialCount(){return this._oscillator.partialCount}set partialCount(u){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=u)}set(u){return Reflect.has(u,"type")&&u.type&&(this.type=u.type),super.set(u),this}_createNewOscillator(u){if(u!==this._sourceType){this._sourceType=u;let g=PV[u],v=this.now();if(this._oscillator){let S=this._oscillator;S.stop(v),this.context.setTimeout(()=>S.dispose(),this.blockTime)}this._oscillator=new g({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(v)}}get phase(){return this._oscillator.phase}set phase(u){this._oscillator.phase=u}get sourceType(){return this._sourceType}set sourceType(u){let g="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(g=this._oscillator.type),u==="fm"?this.type="fm"+g:u==="am"?this.type="am"+g:u==="fat"?this.type="fat"+g:u==="oscillator"?this.type=g:u==="pulse"?this.type="pulse":u==="pwm"&&(this.type="pwm")}_getOscType(u,g){return u instanceof PV[g]}get baseType(){return this._oscillator.baseType}set baseType(u){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||u==="pulse"||u==="pwm"||(this._oscillator.baseType=u)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(u){this._getOscType(this._oscillator,"fat")&&Ni(u)&&(this._oscillator.count=u)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(u){this._getOscType(this._oscillator,"fat")&&Ni(u)&&(this._oscillator.spread=u)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(u){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Xa(u)&&(this._oscillator.modulationType=u)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(u=1024){return xr(this,void 0,void 0,function*(){return bd(this,u)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class Cd extends zt{constructor(){super(Object.assign(ge(Cd.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new Dt({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,Ai(this._constantSource,this._sum)}static getDefaults(){return Object.assign(zt.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class zc extends Oi{constructor(){super(Object.assign(ge(zc.getDefaults(),arguments,["min","max"]))),this.name="Scale";let u=ge(zc.getDefaults(),arguments,["min","max"]);this._mult=this.input=new Mr({context:this.context,value:u.max-u.min}),this._add=this.output=new Cd({context:this.context,value:u.min}),this._min=u.min,this._max=u.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(Oi.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(u){this._min=u,this._setRange()}get max(){return this._max}set max(u){this._max=u,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class mC extends Oi{constructor(){super(Object.assign(ge(mC.getDefaults(),arguments))),this.name="Zero",this._gain=new Dt({context:this.context}),this.output=this._gain,this.input=void 0,Hs(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),dA(this.context.getConstant(0),this._gain),this}}class Ds extends st{constructor(){super(ge(Ds.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=Yt.prototype._fromType,this._toType=Yt.prototype._toType,this._is=Yt.prototype._is,this._clampValue=Yt.prototype._clampValue;let u=ge(Ds.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new Ns(u),this.frequency=this._oscillator.frequency,this._amplitudeGain=new Dt({context:this.context,gain:u.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new zt({context:this.context,units:"audioRange",value:0}),this._zeros=new mC({context:this.context}),this._a2g=new dC({context:this.context}),this._scaler=this.output=new zc({context:this.context,max:u.max,min:u.min}),this.units=u.units,this.min=u.min,this.max=u.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),Lt(this,["amplitude","frequency"]),this.phase=u.phase}static getDefaults(){return Object.assign(Ns.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(u){return u=this.toSeconds(u),this._stoppedSignal.setValueAtTime(0,u),this._oscillator.start(u),this}stop(u){return u=this.toSeconds(u),this._stoppedSignal.setValueAtTime(this._stoppedValue,u),this._oscillator.stop(u),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(u){u=this._fromType(u),this._scaler.min=u}get max(){return this._toType(this._scaler.max)}set max(u){u=this._fromType(u),this._scaler.max=u}get type(){return this._oscillator.type}set type(u){this._oscillator.type=u,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(u){this._oscillator.partials=u,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(u){this._oscillator.phase=u,this._setStoppedValue()}get units(){return this._units}set units(u){let g=this.min,v=this.max;this._units=u,this.min=g,this.max=v}get state(){return this._oscillator.state}connect(u,g,v){return(u instanceof Yt||u instanceof zt)&&(this.convert=u.convert,this.units=u.units),qb(this,u,g,v),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function FV(C,u=1/0){let g=new WeakMap;return function(v,S){Reflect.defineProperty(v,S,{configurable:!0,enumerable:!0,get:function(){return g.get(this)},set:function(E){us(E,C,u),g.set(this,E)}})}}function Vl(C,u=1/0){let g=new WeakMap;return function(v,S){Reflect.defineProperty(v,S,{configurable:!0,enumerable:!0,get:function(){return g.get(this)},set:function(E){us(this.toSeconds(E),C,u),g.set(this,E)}})}}class _d extends Jr{constructor(){super(ge(_d.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;let u=ge(_d.getDefaults(),arguments,["url","onload"]);this._buffer=new Mn({onload:this._onload.bind(this,u.onload),onerror:u.onerror,reverse:u.reverse,url:u.url}),this.autostart=u.autostart,this._loop=u.loop,this._loopStart=u.loopStart,this._loopEnd=u.loopEnd,this._playbackRate=u.playbackRate,this.fadeIn=u.fadeIn,this.fadeOut=u.fadeOut}static getDefaults(){return Object.assign(Jr.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Cn,onerror:Cn,playbackRate:1,reverse:!1})}load(u){return xr(this,void 0,void 0,function*(){return yield this._buffer.load(u),this._onload(),this})}_onload(u=Cn){u(),this.autostart&&this.start()}_onSourceEnd(u){this.onstop(this),this._activeSources.delete(u),this._activeSources.size!==0||this._synced||this._state.getValueAtTime(this.now())!=="started"||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(u,g,v){return super.start(u,g,v),this}_start(u,g,v){g=this._loop?sa(g,this._loopStart):sa(g,0);let S=this.toSeconds(g),E=v;v=sa(v,Math.max(this._buffer.duration-S,0));let k=this.toSeconds(v);k/=this._playbackRate,u=this.toSeconds(u);let M=new Ll({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(u+k),this._state.setStateAtTime("stopped",u+k,{implicitEnd:!0})),this._activeSources.add(M),this._loop&&ui(E)?M.start(u,S):M.start(u,S,k-this.toSeconds(this.fadeOut))}_stop(u){let g=this.toSeconds(u);this._activeSources.forEach(v=>v.stop(g))}restart(u,g,v){return super.restart(u,g,v),this}_restart(u,g,v){var S;(S=[...this._activeSources].pop())===null||S===void 0||S.stop(u),this._start(u,g,v)}seek(u,g){let v=this.toSeconds(g);if(this._state.getValueAtTime(v)==="started"){let S=this.toSeconds(u);this._stop(v),this._start(v,S)}return this}setLoopPoints(u,g){return this.loopStart=u,this.loopEnd=g,this}get loopStart(){return this._loopStart}set loopStart(u){this._loopStart=u,this.buffer.loaded&&us(this.toSeconds(u),0,this.buffer.duration),this._activeSources.forEach(g=>{g.loopStart=u})}get loopEnd(){return this._loopEnd}set loopEnd(u){this._loopEnd=u,this.buffer.loaded&&us(this.toSeconds(u),0,this.buffer.duration),this._activeSources.forEach(g=>{g.loopEnd=u})}get buffer(){return this._buffer}set buffer(u){this._buffer.set(u)}get loop(){return this._loop}set loop(u){if(this._loop!==u&&(this._loop=u,this._activeSources.forEach(g=>{g.loop=u}),u)){let g=this._state.getNextState("stopped",this.now());g&&this._state.cancel(g.time)}}get playbackRate(){return this._playbackRate}set playbackRate(u){this._playbackRate=u;let g=this.now(),v=this._state.getNextState("stopped",g);v&&v.implicitEnd&&(this._state.cancel(v.time),this._activeSources.forEach(S=>S.cancelStop())),this._activeSources.forEach(S=>{S.playbackRate.setValueAtTime(u,g)})}get reverse(){return this._buffer.reverse}set reverse(u){this._buffer.reverse=u}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(u=>u.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}Qa([Vl(0)],_d.prototype,"fadeIn",void 0),Qa([Vl(0)],_d.prototype,"fadeOut",void 0);class gC extends st{constructor(){super(ge(gC.getDefaults(),arguments,["urls","onload"],"urls")),this.name="Players",this.input=void 0,this._players=new Map;let u=ge(gC.getDefaults(),arguments,["urls","onload"],"urls");this._volume=this.output=new $c({context:this.context,volume:u.volume}),this.volume=this._volume.volume,Lt(this,"volume"),this._buffers=new oy({urls:u.urls,onload:u.onload,baseUrl:u.baseUrl,onerror:u.onerror}),this.mute=u.mute,this._fadeIn=u.fadeIn,this._fadeOut=u.fadeOut}static getDefaults(){return Object.assign(Jr.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:Cn,onerror:Cn,urls:{},volume:0})}get mute(){return this._volume.mute}set mute(u){this._volume.mute=u}get fadeIn(){return this._fadeIn}set fadeIn(u){this._fadeIn=u,this._players.forEach(g=>{g.fadeIn=u})}get fadeOut(){return this._fadeOut}set fadeOut(u){this._fadeOut=u,this._players.forEach(g=>{g.fadeOut=u})}get state(){return Array.from(this._players).some(([u,g])=>g.state==="started")?"started":"stopped"}has(u){return this._buffers.has(u)}player(u){if(Ot(this.has(u),`No Player with the name ${u} exists on this object`),!this._players.has(u)){let g=new _d({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(u)}).connect(this.output);this._players.set(u,g)}return this._players.get(u)}get loaded(){return this._buffers.loaded}add(u,g,v){return Ot(!this._buffers.has(u),"A buffer with that name already exists on this object"),this._buffers.add(u,g,v),this}stopAll(u){return this._players.forEach(g=>g.stop(u)),this}dispose(){return super.dispose(),this._volume.dispose(),this.volume.dispose(),this._players.forEach(u=>u.dispose()),this._buffers.dispose(),this}}class yC extends Jr{constructor(){super(ge(yC.getDefaults(),arguments,["url","onload"])),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[];let u=ge(yC.getDefaults(),arguments,["url","onload"]);this.buffer=new Mn({onload:u.onload,onerror:u.onerror,reverse:u.reverse,url:u.url}),this._clock=new xd({context:this.context,callback:this._tick.bind(this),frequency:1/u.grainSize}),this._playbackRate=u.playbackRate,this._grainSize=u.grainSize,this._overlap=u.overlap,this.detune=u.detune,this.overlap=u.overlap,this.loop=u.loop,this.playbackRate=u.playbackRate,this.grainSize=u.grainSize,this.loopStart=u.loopStart,this.loopEnd=u.loopEnd,this.reverse=u.reverse,this._clock.on("stop",this._onstop.bind(this))}static getDefaults(){return Object.assign(Jr.getDefaults(),{onload:Cn,onerror:Cn,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(u,g,v){g=sa(g,0),g=this.toSeconds(g),u=this.toSeconds(u);let S=1/this._clock.frequency.getValueAtTime(u);this._clock.start(u,g/S),v&&this.stop(u+this.toSeconds(v))}restart(u,g,v){return super.restart(u,g,v),this}_restart(u,g,v){this._stop(u),this._start(u,g,v)}_stop(u){this._clock.stop(u)}_onstop(u){this._activeSources.forEach(g=>{g.fadeOut=0,g.stop(u)}),this.onstop(this)}_tick(u){let g=this._clock.getTicksAtTime(u),v=g*this._grainSize;if(this.log("offset",v),!this.loop&&v>this.buffer.duration)return void this.stop(u);let S=v<this._overlap?0:this._overlap,E=new Ll({context:this.context,url:this.buffer,fadeIn:S,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:ty(this.detune/100)}).connect(this.output);E.start(u,this._grainSize*g),E.stop(u+this._grainSize/this.playbackRate),this._activeSources.push(E),E.onended=()=>{let k=this._activeSources.indexOf(E);k!==-1&&this._activeSources.splice(k,1)}}get playbackRate(){return this._playbackRate}set playbackRate(u){us(u,.001),this._playbackRate=u,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(u){this.buffer.loaded&&us(this.toSeconds(u),0,this.buffer.duration),this._loopStart=this.toSeconds(u)}get loopEnd(){return this._loopEnd}set loopEnd(u){this.buffer.loaded&&us(this.toSeconds(u),0,this.buffer.duration),this._loopEnd=this.toSeconds(u)}get reverse(){return this.buffer.reverse}set reverse(u){this.buffer.reverse=u}get grainSize(){return this._grainSize}set grainSize(u){this._grainSize=this.toSeconds(u),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(u){let g=this.toSeconds(u);us(g,0),this._overlap=g}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach(u=>u.dispose()),this}}class $V extends Oi{constructor(){super(...arguments),this.name="Abs",this._abs=new ia({context:this.context,mapping:u=>Math.abs(u)<.001?0:Math.abs(u)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}}class LV extends Oi{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new ia({context:this.context,mapping:u=>2*Math.abs(u)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class gA extends Oi{constructor(){super(...arguments),this.name="Negate",this._multiply=new Mr({context:this.context,value:-1}),this.input=this._multiply,this.output=this._multiply}dispose(){return super.dispose(),this._multiply.dispose(),this}}class Td extends zt{constructor(){super(Object.assign(ge(Td.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Subtract",this._sum=new Dt({context:this.context}),this.input=this._sum,this.output=this._sum,this._neg=new gA({context:this.context}),this.subtrahend=this._param,Ai(this._constantSource,this._neg,this._sum)}static getDefaults(){return Object.assign(zt.getDefaults(),{value:0})}dispose(){return super.dispose(),this._neg.dispose(),this._sum.dispose(),this}}class xC extends Oi{constructor(){super(Object.assign(ge(xC.getDefaults(),arguments))),this.name="GreaterThanZero",this._thresh=this.output=new ia({context:this.context,length:127,mapping:u=>u<=0?0:1}),this._scale=this.input=new Mr({context:this.context,value:1e4}),this._scale.connect(this._thresh)}dispose(){return super.dispose(),this._scale.dispose(),this._thresh.dispose(),this}}class jb extends zt{constructor(){super(Object.assign(ge(jb.getDefaults(),arguments,["value"]))),this.name="GreaterThan",this.override=!1;let u=ge(jb.getDefaults(),arguments,["value"]);this._subtract=this.input=new Td({context:this.context,value:u.value}),this._gtz=this.output=new xC({context:this.context}),this.comparator=this._param=this._subtract.subtrahend,Lt(this,"comparator"),this._subtract.connect(this._gtz)}static getDefaults(){return Object.assign(zt.getDefaults(),{value:0})}dispose(){return super.dispose(),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}}class Gb extends zc{constructor(){super(Object.assign(ge(Gb.getDefaults(),arguments,["min","max","exponent"]))),this.name="ScaleExp";let u=ge(Gb.getDefaults(),arguments,["min","max","exponent"]);this.input=this._exp=new vd({context:this.context,value:u.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(zc.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(u){this._exp.value=u}dispose(){return super.dispose(),this._exp.dispose(),this}}class ove extends zt{constructor(){super(ge(zt.getDefaults(),arguments,["value","units"])),this.name="SyncedSignal",this.override=!1;let u=ge(zt.getDefaults(),arguments,["value","units"]);this._lastVal=u.value,this._synced=this.context.transport.scheduleRepeat(this._onTick.bind(this),"1i"),this._syncedCallback=this._anchorValue.bind(this),this.context.transport.on("start",this._syncedCallback),this.context.transport.on("pause",this._syncedCallback),this.context.transport.on("stop",this._syncedCallback),this._constantSource.disconnect(),this._constantSource.stop(0),this._constantSource=this.output=new Vb({context:this.context,offset:u.value,units:u.units}).start(0),this.setValueAtTime(u.value,0)}_onTick(u){let g=super.getValueAtTime(this.context.transport.seconds);this._lastVal!==g&&(this._lastVal=g,this._constantSource.offset.setValueAtTime(g,u))}_anchorValue(u){let g=super.getValueAtTime(this.context.transport.seconds);this._lastVal=g,this._constantSource.offset.cancelAndHoldAtTime(u),this._constantSource.offset.setValueAtTime(g,u)}getValueAtTime(u){let g=new Co(this.context,u).toSeconds();return super.getValueAtTime(g)}setValueAtTime(u,g){let v=new Co(this.context,g).toSeconds();return super.setValueAtTime(u,v),this}linearRampToValueAtTime(u,g){let v=new Co(this.context,g).toSeconds();return super.linearRampToValueAtTime(u,v),this}exponentialRampToValueAtTime(u,g){let v=new Co(this.context,g).toSeconds();return super.exponentialRampToValueAtTime(u,v),this}setTargetAtTime(u,g,v){let S=new Co(this.context,g).toSeconds();return super.setTargetAtTime(u,S,v),this}cancelScheduledValues(u){let g=new Co(this.context,u).toSeconds();return super.cancelScheduledValues(g),this}setValueCurveAtTime(u,g,v,S){let E=new Co(this.context,g).toSeconds();return v=this.toSeconds(v),super.setValueCurveAtTime(u,E,v,S),this}cancelAndHoldAtTime(u){let g=new Co(this.context,u).toSeconds();return super.cancelAndHoldAtTime(g),this}setRampPoint(u){let g=new Co(this.context,u).toSeconds();return super.setRampPoint(g),this}exponentialRampTo(u,g,v){let S=new Co(this.context,v).toSeconds();return super.exponentialRampTo(u,g,S),this}linearRampTo(u,g,v){let S=new Co(this.context,v).toSeconds();return super.linearRampTo(u,g,S),this}targetRampTo(u,g,v){let S=new Co(this.context,v).toSeconds();return super.targetRampTo(u,g,S),this}dispose(){return super.dispose(),this.context.transport.clear(this._synced),this.context.transport.off("start",this._syncedCallback),this.context.transport.off("pause",this._syncedCallback),this.context.transport.off("stop",this._syncedCallback),this._constantSource.dispose(),this}}class Go extends st{constructor(){super(ge(Go.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new zt({context:this.context,value:0}),this.output=this._sig,this.input=void 0;let u=ge(Go.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=u.attack,this.decay=u.decay,this.sustain=u.sustain,this.release=u.release,this.attackCurve=u.attackCurve,this.releaseCurve=u.releaseCurve,this.decayCurve=u.decayCurve}static getDefaults(){return Object.assign(st.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(u,g){if(Xa(u))return u;{let v;for(v in vC)if(vC[v][g]===u)return v;return u}}_setCurve(u,g,v){if(Xa(v)&&Reflect.has(vC,v)){let S=vC[v];Fl(S)?u!=="_decayCurve"&&(this[u]=S[g]):this[u]=S}else{if(!cs(v)||u==="_decayCurve")throw new Error("Envelope: invalid curve: "+v);this[u]=v}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(u){this._setCurve("_attackCurve","In",u)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(u){this._setCurve("_releaseCurve","Out",u)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(u){this._setCurve("_decayCurve","Out",u)}triggerAttack(u,g=1){this.log("triggerAttack",u,g),u=this.toSeconds(u);let v=this.toSeconds(this.attack),S=this.toSeconds(this.decay),E=this.getValueAtTime(u);if(E>0&&(v=(1-E)/(1/v)),v<this.sampleTime)this._sig.cancelScheduledValues(u),this._sig.setValueAtTime(g,u);else if(this._attackCurve==="linear")this._sig.linearRampTo(g,v,u);else if(this._attackCurve==="exponential")this._sig.targetRampTo(g,v,u);else{this._sig.cancelAndHoldAtTime(u);let k=this._attackCurve;for(let M=1;M<k.length;M++)if(k[M-1]<=E&&E<=k[M]){k=this._attackCurve.slice(M),k[0]=E;break}this._sig.setValueCurveAtTime(k,u,v,g)}if(S&&this.sustain<1){let k=g*this.sustain,M=u+v;this.log("decay",M),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(k,S+M):this._sig.exponentialApproachValueAtTime(k,M,S)}return this}triggerRelease(u){this.log("triggerRelease",u),u=this.toSeconds(u);let g=this.getValueAtTime(u);if(g>0){let v=this.toSeconds(this.release);v<this.sampleTime?this._sig.setValueAtTime(0,u):this._releaseCurve==="linear"?this._sig.linearRampTo(0,v,u):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,v,u):(Ot(cs(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(u),this._sig.setValueCurveAtTime(this._releaseCurve,u,v,g))}return this}getValueAtTime(u){return this._sig.getValueAtTime(u)}triggerAttackRelease(u,g,v=1){return g=this.toSeconds(g),this.triggerAttack(g,v),this.triggerRelease(g+this.toSeconds(u)),this}cancel(u){return this._sig.cancelScheduledValues(this.toSeconds(u)),this}connect(u,g=0,v=0){return qb(this,u,g,v),this}asArray(u=1024){return xr(this,void 0,void 0,function*(){let g=u/this.context.sampleRate,v=new Jg(1,g,this.context.sampleRate),S=this.toSeconds(this.attack)+this.toSeconds(this.decay),E=S+this.toSeconds(this.release),k=.1*E,M=E+k,L=new this.constructor(Object.assign(this.get(),{attack:g*this.toSeconds(this.attack)/M,decay:g*this.toSeconds(this.decay)/M,release:g*this.toSeconds(this.release)/M,context:v}));return L._sig.toDestination(),L.triggerAttackRelease(g*(S+k)/M,0),(yield v.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}Qa([Vl(0)],Go.prototype,"attack",void 0),Qa([Vl(0)],Go.prototype,"decay",void 0),Qa([FV(0,1)],Go.prototype,"sustain",void 0),Qa([Vl(0)],Go.prototype,"release",void 0);let vC=(()=>{let u,g,v=[];for(u=0;u<128;u++)v[u]=Math.sin(u/127*(Math.PI/2));let S=[];for(u=0;u<127;u++){g=u/127;let W=Math.sin(g*(2*Math.PI)*6.4-Math.PI/2)+1;S[u]=W/10+.83*g}S[127]=1;let E=[];for(u=0;u<128;u++)E[u]=Math.ceil(u/127*5)/5;let k=[];for(u=0;u<128;u++)g=u/127,k[u]=.5*(1-Math.cos(Math.PI*g));let M=[];for(u=0;u<128;u++){g=u/127;let W=4*Math.pow(g,3)+.2,X=Math.cos(W*Math.PI*2*g);M[u]=Math.abs(X*(1-g))}function L(W){let X=new Array(W.length);for(let ce=0;ce<W.length;ce++)X[ce]=1-W[ce];return X}return{bounce:{In:L(M),Out:M},cosine:{In:v,Out:(V=v,V.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:S,Out:L(S)},sine:{In:k,Out:L(k)},step:{In:E,Out:L(E)}};var V})();class Mi extends st{constructor(){super(ge(Mi.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=g=>this._original_triggerRelease(g);let u=ge(Mi.getDefaults(),arguments);this._volume=this.output=new $c({context:this.context,volume:u.volume}),this.volume=this._volume.volume,Lt(this,"volume")}static getDefaults(){return Object.assign(st.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let u=!1;return this._synced||(this._synced=!0,u=!0),u}_syncMethod(u,g){let v=this["_original_"+u]=this[u];this[u]=(...S)=>{let E=S[g],k=this.context.transport.schedule(M=>{S[g]=M,v.apply(this,S)},E);this._scheduledEvents.push(k)}}unsync(){return this._scheduledEvents.forEach(u=>this.context.transport.clear(u)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(u,g,v,S){let E=this.toSeconds(v),k=this.toSeconds(g);return this.triggerAttack(u,E,S),this.triggerRelease(E+k),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Wo extends Mi{constructor(){super(ge(Wo.getDefaults(),arguments));let u=ge(Wo.getDefaults(),arguments);this.portamento=u.portamento,this.onsilence=u.onsilence}static getDefaults(){return Object.assign(Mi.getDefaults(),{detune:0,onsilence:Cn,portamento:0})}triggerAttack(u,g,v=1){this.log("triggerAttack",u,g,v);let S=this.toSeconds(g);return this._triggerEnvelopeAttack(S,v),this.setNote(u,S),this}triggerRelease(u){this.log("triggerRelease",u);let g=this.toSeconds(u);return this._triggerEnvelopeRelease(g),this}setNote(u,g){let v=this.toSeconds(g),S=u instanceof Ws?u.toFrequency():u;if(this.portamento>0&&this.getLevelAtTime(v)>.05){let E=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(S,E,v)}else this.frequency.setValueAtTime(S,v);return this}}Qa([Vl(0)],Wo.prototype,"portamento",void 0);class hy extends Go{constructor(){super(ge(hy.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Dt({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class ql extends Wo{constructor(){super(ge(ql.getDefaults(),arguments)),this.name="Synth";let u=ge(ql.getDefaults(),arguments);this.oscillator=new Lc(Object.assign({context:this.context,detune:u.detune,onstop:()=>this.onsilence(this)},u.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new hy(Object.assign({context:this.context},u.envelope)),this.oscillator.chain(this.envelope,this.output),Lt(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Wo.getDefaults(),{envelope:Object.assign(ls(Go.getDefaults(),Object.keys(st.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(ls(Lc.getDefaults(),[...Object.keys(Jr.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(u,g){if(this.envelope.triggerAttack(u,g),this.oscillator.start(u),this.envelope.sustain===0){let v=this.toSeconds(this.envelope.attack),S=this.toSeconds(this.envelope.decay);this.oscillator.stop(u+v+S)}}_triggerEnvelopeRelease(u){this.envelope.triggerRelease(u),this.oscillator.stop(u+this.toSeconds(this.envelope.release))}getLevelAtTime(u){return u=this.toSeconds(u),this.envelope.getValueAtTime(u)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class fy extends Wo{constructor(){super(ge(fy.getDefaults(),arguments)),this.name="ModulationSynth";let u=ge(fy.getDefaults(),arguments);this._carrier=new ql({context:this.context,oscillator:u.oscillator,envelope:u.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new ql({context:this.context,oscillator:u.modulation,envelope:u.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new zt({context:this.context,units:"frequency"}),this.detune=new zt({context:this.context,value:u.detune,units:"cents"}),this.harmonicity=new Mr({context:this.context,value:u.harmonicity,minValue:0}),this._modulationNode=new Dt({context:this.context,gain:0}),Lt(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(Wo.getDefaults(),{harmonicity:3,oscillator:Object.assign(ls(Lc.getDefaults(),[...Object.keys(Jr.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(ls(Go.getDefaults(),Object.keys(st.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(ls(Lc.getDefaults(),[...Object.keys(Jr.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(ls(Go.getDefaults(),Object.keys(st.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(u,g){this._carrier._triggerEnvelopeAttack(u,g),this._modulator._triggerEnvelopeAttack(u,g)}_triggerEnvelopeRelease(u){return this._carrier._triggerEnvelopeRelease(u),this._modulator._triggerEnvelopeRelease(u),this}getLevelAtTime(u){return u=this.toSeconds(u),this.envelope.getValueAtTime(u)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class yA extends fy{constructor(){super(ge(yA.getDefaults(),arguments)),this.name="AMSynth",this._modulationScale=new dC({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}}class dy extends st{constructor(){super(ge(dy.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";let u=ge(dy.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new Yt({context:this.context,units:"number",value:u.Q,param:this._filter.Q}),this.frequency=new Yt({context:this.context,units:"frequency",value:u.frequency,param:this._filter.frequency}),this.detune=new Yt({context:this.context,units:"cents",value:u.detune,param:this._filter.detune}),this.gain=new Yt({context:this.context,units:"decibels",convert:!1,value:u.gain,param:this._filter.gain}),this.type=u.type}static getDefaults(){return Object.assign(st.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(u){Ot(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(u)!==-1,`Invalid filter type: ${u}`),this._filter.type=u}getFrequencyResponse(u=128){let g=new Float32Array(u);for(let k=0;k<u;k++){let M=19980*Math.pow(k/u,2)+20;g[k]=M}let v=new Float32Array(u),S=new Float32Array(u),E=this.context.createBiquadFilter();return E.type=this.type,E.Q.value=this.Q.value,E.frequency.value=this.frequency.value,E.gain.value=this.gain.value,E.getFrequencyResponse(g,v,S),v}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class pi extends st{constructor(){super(ge(pi.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new Dt({context:this.context}),this.output=new Dt({context:this.context}),this._filters=[];let u=ge(pi.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new zt({context:this.context,units:"positive",value:u.Q}),this.frequency=new zt({context:this.context,units:"frequency",value:u.frequency}),this.detune=new zt({context:this.context,units:"cents",value:u.detune}),this.gain=new zt({context:this.context,units:"decibels",convert:!1,value:u.gain}),this._type=u.type,this.rolloff=u.rolloff,Lt(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(st.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(u){Ot(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(u)!==-1,`Invalid filter type: ${u}`),this._type=u,this._filters.forEach(g=>g.type=u)}get rolloff(){return this._rolloff}set rolloff(u){let g=Ni(u)?u:parseInt(u,10),v=[-12,-24,-48,-96],S=v.indexOf(g);Ot(S!==-1,`rolloff can only be ${v.join(", ")}`),S+=1,this._rolloff=g,this.input.disconnect(),this._filters.forEach(E=>E.disconnect()),this._filters=new Array(S);for(let E=0;E<S;E++){let k=new dy({context:this.context});k.type=this._type,this.frequency.connect(k.frequency),this.detune.connect(k.detune),this.Q.connect(k.Q),this.gain.connect(k.gain),this._filters[E]=k}this._internalChannels=this._filters,Ai(this.input,...this._internalChannels,this.output)}getFrequencyResponse(u=128){let g=new dy({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),v=new Float32Array(u).map(()=>1);return this._filters.forEach(()=>{g.getFrequencyResponse(u).forEach((S,E)=>v[E]*=S)}),g.dispose(),v}dispose(){return super.dispose(),this._filters.forEach(u=>{u.dispose()}),Lb(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class my extends Go{constructor(){super(ge(my.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="FrequencyEnvelope";let u=ge(my.getDefaults(),arguments,["attack","decay","sustain","release"]);this._octaves=u.octaves,this._baseFrequency=this.toFrequency(u.baseFrequency),this._exponent=this.input=new vd({context:this.context,value:u.exponent}),this._scale=this.output=new zc({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(Go.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(u){let g=this.toFrequency(u);us(g,0),this._baseFrequency=g,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(u){this._octaves=u,this._scale.max=this._baseFrequency*Math.pow(2,u)}get exponent(){return this._exponent.value}set exponent(u){this._exponent.value=u}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}}class Ph extends Wo{constructor(){super(ge(Ph.getDefaults(),arguments)),this.name="MonoSynth";let u=ge(Ph.getDefaults(),arguments);this.oscillator=new Lc(Object.assign(u.oscillator,{context:this.context,detune:u.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new pi(Object.assign(u.filter,{context:this.context})),this.filterEnvelope=new my(Object.assign(u.filterEnvelope,{context:this.context})),this.envelope=new hy(Object.assign(u.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),Lt(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(Wo.getDefaults(),{envelope:Object.assign(ls(Go.getDefaults(),Object.keys(st.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(ls(pi.getDefaults(),Object.keys(st.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(ls(my.getDefaults(),Object.keys(st.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(ls(Lc.getDefaults(),Object.keys(Jr.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(u,g=1){if(this.envelope.triggerAttack(u,g),this.filterEnvelope.triggerAttack(u),this.oscillator.start(u),this.envelope.sustain===0){let v=this.toSeconds(this.envelope.attack),S=this.toSeconds(this.envelope.decay);this.oscillator.stop(u+v+S)}}_triggerEnvelopeRelease(u){this.envelope.triggerRelease(u),this.filterEnvelope.triggerRelease(u),this.oscillator.stop(u+this.toSeconds(this.envelope.release))}getLevelAtTime(u){return u=this.toSeconds(u),this.envelope.getValueAtTime(u)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}class bC extends Wo{constructor(){super(ge(bC.getDefaults(),arguments)),this.name="DuoSynth";let u=ge(bC.getDefaults(),arguments);this.voice0=new Ph(Object.assign(u.voice0,{context:this.context,onsilence:()=>this.onsilence(this)})),this.voice1=new Ph(Object.assign(u.voice1,{context:this.context})),this.harmonicity=new Mr({context:this.context,units:"positive",value:u.harmonicity}),this._vibrato=new Ds({frequency:u.vibratoRate,context:this.context,min:-50,max:50}),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new Dt({context:this.context,units:"normalRange",gain:u.vibratoAmount}),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new zt({context:this.context,units:"frequency",value:440}),this.detune=new zt({context:this.context,units:"cents",value:u.detune}),this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.detune.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),Lt(this,["voice0","voice1","frequency","vibratoAmount","vibratoRate"])}getLevelAtTime(u){return u=this.toSeconds(u),this.voice0.envelope.getValueAtTime(u)+this.voice1.envelope.getValueAtTime(u)}static getDefaults(){return oa(Wo.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:oa(ls(Ph.getDefaults(),Object.keys(Wo.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:oa(ls(Ph.getDefaults(),Object.keys(Wo.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}_triggerEnvelopeAttack(u,g){this.voice0._triggerEnvelopeAttack(u,g),this.voice1._triggerEnvelopeAttack(u,g)}_triggerEnvelopeRelease(u){return this.voice0._triggerEnvelopeRelease(u),this.voice1._triggerEnvelopeRelease(u),this}dispose(){return super.dispose(),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}}class wC extends fy{constructor(){super(ge(wC.getDefaults(),arguments)),this.name="FMSynth";let u=ge(wC.getDefaults(),arguments);this.modulationIndex=new Mr({context:this.context,value:u.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(fy.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}let zV=[1,1.483,1.932,2.546,2.63,3.897];class SC extends Wo{constructor(){super(ge(SC.getDefaults(),arguments)),this.name="MetalSynth",this._oscillators=[],this._freqMultipliers=[];let u=ge(SC.getDefaults(),arguments);this.detune=new zt({context:this.context,units:"cents",value:u.detune}),this.frequency=new zt({context:this.context,units:"frequency"}),this._amplitude=new Dt({context:this.context,gain:0}).connect(this.output),this._highpass=new pi({Q:0,context:this.context,type:"highpass"}).connect(this._amplitude);for(let g=0;g<zV.length;g++){let v=new wd({context:this.context,harmonicity:u.harmonicity,modulationIndex:u.modulationIndex,modulationType:"square",onstop:g===0?()=>this.onsilence(this):Cn,type:"square"});v.connect(this._highpass),this._oscillators[g]=v;let S=new Mr({context:this.context,value:zV[g]});this._freqMultipliers[g]=S,this.frequency.chain(S,v.frequency),this.detune.connect(v.detune)}this._filterFreqScaler=new zc({context:this.context,max:7e3,min:this.toFrequency(u.resonance)}),this.envelope=new Go({attack:u.envelope.attack,attackCurve:"linear",context:this.context,decay:u.envelope.decay,release:u.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=u.octaves,this.octaves=u.octaves}static getDefaults(){return oa(Wo.getDefaults(),{envelope:Object.assign(ls(Go.getDefaults(),Object.keys(st.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(u,g=1){return this.envelope.triggerAttack(u,g),this._oscillators.forEach(v=>v.start(u)),this.envelope.sustain===0&&this._oscillators.forEach(v=>{v.stop(u+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))}),this}_triggerEnvelopeRelease(u){return this.envelope.triggerRelease(u),this._oscillators.forEach(g=>g.stop(u+this.toSeconds(this.envelope.release))),this}getLevelAtTime(u){return u=this.toSeconds(u),this.envelope.getValueAtTime(u)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(u){this._oscillators.forEach(g=>g.modulationIndex.value=u)}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(u){this._oscillators.forEach(g=>g.harmonicity.value=u)}get resonance(){return this._filterFreqScaler.min}set resonance(u){this._filterFreqScaler.min=this.toFrequency(u),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(u){this._octaves=u,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,u)}dispose(){return super.dispose(),this._oscillators.forEach(u=>u.dispose()),this._freqMultipliers.forEach(u=>u.dispose()),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}class gy extends ql{constructor(){super(ge(gy.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;let u=ge(gy.getDefaults(),arguments);this.pitchDecay=u.pitchDecay,this.octaves=u.octaves,Lt(this,["oscillator","envelope"])}static getDefaults(){return oa(Wo.getDefaults(),ql.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(u,g){let v=this.toSeconds(g),S=this.toFrequency(u instanceof Ws?u.toFrequency():u),E=S*this.octaves;return this.oscillator.frequency.setValueAtTime(E,v),this.oscillator.frequency.exponentialRampToValueAtTime(S,v+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}Qa([FV(0)],gy.prototype,"octaves",void 0),Qa([Vl(0)],gy.prototype,"pitchDecay",void 0);class CC extends Mi{constructor(){super(ge(CC.getDefaults(),arguments)),this.name="NoiseSynth";let u=ge(CC.getDefaults(),arguments);this.noise=new zl(Object.assign({context:this.context},u.noise)),this.envelope=new hy(Object.assign({context:this.context},u.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(Mi.getDefaults(),{envelope:Object.assign(ls(Go.getDefaults(),Object.keys(st.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(ls(zl.getDefaults(),Object.keys(Jr.getDefaults())),{type:"white"})})}triggerAttack(u,g=1){return u=this.toSeconds(u),this.envelope.triggerAttack(u,g),this.noise.start(u),this.envelope.sustain===0&&this.noise.stop(u+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(u){return u=this.toSeconds(u),this.envelope.triggerRelease(u),this.noise.stop(u+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(u,g,v=1){return g=this.toSeconds(g),u=this.toSeconds(u),this.triggerAttack(g,v),this.triggerRelease(g+u),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}let xA=new Set;function vA(C){xA.add(C)}function BV(C,u){let g=`registerProcessor("${C}", ${u})`;xA.add(g)}class bA extends st{constructor(u){super(u),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=Cn;let g=URL.createObjectURL(new Blob([Array.from(xA).join(`
`)],{type:"text/javascript"})),v=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(g).then(()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(v,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))})}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}vA(`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`),vA(`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`),vA(`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`);let VV="feedback-comb-filter";BV(VV,`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`);class yy extends bA{constructor(){super(ge(yy.getDefaults(),arguments,["delayTime","resonance"])),this.name="FeedbackCombFilter";let u=ge(yy.getDefaults(),arguments,["delayTime","resonance"]);this.input=new Dt({context:this.context}),this.output=new Dt({context:this.context}),this.delayTime=new Yt({context:this.context,value:u.delayTime,units:"time",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new Yt({context:this.context,value:u.resonance,units:"normalRange",param:this._dummyParam,swappable:!0}),Lt(this,["resonance","delayTime"])}_audioWorkletName(){return VV}static getDefaults(){return Object.assign(st.getDefaults(),{delayTime:.1,resonance:.5})}onReady(u){Ai(this.input,u,this.output);let g=u.parameters.get("delayTime");this.delayTime.setParam(g);let v=u.parameters.get("feedback");this.resonance.setParam(v)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}class xy extends st{constructor(){super(ge(xy.getDefaults(),arguments,["frequency","type"])),this.name="OnePoleFilter";let u=ge(xy.getDefaults(),arguments,["frequency","type"]);this._frequency=u.frequency,this._type=u.type,this.input=new Dt({context:this.context}),this.output=new Dt({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(st.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){let u=this._filter,g=this.toFrequency(this._frequency),v=1/(2*Math.PI*g);if(this._type==="lowpass"){let S=1/(v*this.context.sampleRate),E=S-1;this._filter=this.context.createIIRFilter([S,0],[1,E])}else{let S=1/(v*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,S])}this.input.chain(this._filter,this.output),u&&this.context.setTimeout(()=>{this.disposed||(this.input.disconnect(u),u.disconnect())},this.blockTime)}get frequency(){return this._frequency}set frequency(u){this._frequency=u,this._createFilter()}get type(){return this._type}set type(u){this._type=u,this._createFilter()}getFrequencyResponse(u=128){let g=new Float32Array(u);for(let E=0;E<u;E++){let k=19980*Math.pow(E/u,2)+20;g[E]=k}let v=new Float32Array(u),S=new Float32Array(u);return this._filter.getFrequencyResponse(g,v,S),v}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class vy extends st{constructor(){super(ge(vy.getDefaults(),arguments,["delayTime","resonance","dampening"])),this.name="LowpassCombFilter";let u=ge(vy.getDefaults(),arguments,["delayTime","resonance","dampening"]);this._combFilter=this.output=new yy({context:this.context,delayTime:u.delayTime,resonance:u.resonance}),this.delayTime=this._combFilter.delayTime,this.resonance=this._combFilter.resonance,this._lowpass=this.input=new xy({context:this.context,frequency:u.dampening,type:"lowpass"}),this._lowpass.connect(this._combFilter)}static getDefaults(){return Object.assign(st.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}get dampening(){return this._lowpass.frequency}set dampening(u){this._lowpass.frequency=u}dispose(){return super.dispose(),this._combFilter.dispose(),this._lowpass.dispose(),this}}class _C extends Mi{constructor(){super(ge(_C.getDefaults(),arguments)),this.name="PluckSynth";let u=ge(_C.getDefaults(),arguments);this._noise=new zl({context:this.context,type:"pink"}),this.attackNoise=u.attackNoise,this._lfcf=new vy({context:this.context,dampening:u.dampening,resonance:u.resonance}),this.resonance=u.resonance,this.release=u.release,this._noise.connect(this._lfcf),this._lfcf.connect(this.output)}static getDefaults(){return oa(Mi.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}get dampening(){return this._lfcf.dampening}set dampening(u){this._lfcf.dampening=u}triggerAttack(u,g){let v=this.toFrequency(u);g=this.toSeconds(g);let S=1/v;return this._lfcf.delayTime.setValueAtTime(S,g),this._noise.start(g),this._noise.stop(g+S*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(g),this._lfcf.resonance.setValueAtTime(this.resonance,g),this}triggerRelease(u){return this._lfcf.resonance.linearRampTo(0,this.release,u),this}dispose(){return super.dispose(),this._noise.dispose(),this._lfcf.dispose(),this}}class TC extends Mi{constructor(){super(ge(TC.getDefaults(),arguments,["voice","options"])),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0,this._syncedRelease=S=>this.releaseAll(S);let u=ge(TC.getDefaults(),arguments,["voice","options"]);Ot(!Ni(u.voice),"DEPRECATED: The polyphony count is no longer the first argument.");let g=u.voice.getDefaults();this.options=Object.assign(g,u.options),this.voice=u.voice,this.maxPolyphony=u.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();let v=this._voices.indexOf(this._dummyVoice);this._voices.splice(v,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Mi.getDefaults(),{maxPolyphony:32,options:{},voice:ql})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(u){this._availableVoices.push(u);let g=this._activeVoices.findIndex(v=>v.voice===u);this._activeVoices.splice(g,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){let u=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return Ot(u instanceof Wo,"Voice must extend Monophonic class"),u.connect(this.output),this._voices.push(u),u}Kg("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){let u=this._availableVoices.shift(),g=this._voices.indexOf(u);this._voices.splice(g,1),this.context.isOffline||u.dispose()}}_triggerAttack(u,g,v){u.forEach(S=>{let E=new sy(this.context,S).toMidi(),k=this._getNextAvailableVoice();k&&(k.triggerAttack(S,g,v),this._activeVoices.push({midi:E,voice:k,released:!1}),this.log("triggerAttack",S,g))})}_triggerRelease(u,g){u.forEach(v=>{let S=new sy(this.context,v).toMidi(),E=this._activeVoices.find(({midi:k,released:M})=>k===S&&!M);E&&(E.voice.triggerRelease(g),E.released=!0,this.log("triggerRelease",v,g))})}_scheduleEvent(u,g,v,S){Ot(!this.disposed,"Synth was already disposed"),v<=this.now()?u==="attack"?this._triggerAttack(g,v,S):this._triggerRelease(g,v):this.context.setTimeout(()=>{this.disposed||this._scheduleEvent(u,g,v,S)},v-this.now())}triggerAttack(u,g,v){Array.isArray(u)||(u=[u]);let S=this.toSeconds(g);return this._scheduleEvent("attack",u,S,v),this}triggerRelease(u,g){Array.isArray(u)||(u=[u]);let v=this.toSeconds(g);return this._scheduleEvent("release",u,v),this}triggerAttackRelease(u,g,v,S){let E=this.toSeconds(v);if(this.triggerAttack(u,E,S),cs(g)){Ot(cs(u),"If the duration is an array, the notes must also be an array");for(let k=0;k<u.length;k++){let M=g[Math.min(k,g.length-1)],L=this.toSeconds(M);Ot(L>0,"The duration must be greater than 0"),this.triggerRelease(u[k],E+L)}}else{let k=this.toSeconds(g);Ot(k>0,"The duration must be greater than 0"),this.triggerRelease(u,E+k)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}set(u){let g=ls(u,["onsilence","context"]);return this.options=oa(this.options,g),this._voices.forEach(v=>v.set(g)),this._dummyVoice.set(g),this}get(){return this._dummyVoice.get()}releaseAll(u){let g=this.toSeconds(u);return this._activeVoices.forEach(({voice:v})=>{v.triggerRelease(g)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(u=>u.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class by extends Mi{constructor(){super(ge(by.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;let u=ge(by.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),g={};Object.keys(u.urls).forEach(v=>{let S=parseInt(v,10);if(Ot($b(v)||Ni(S)&&isFinite(S),`url key is neither a note or midi pitch: ${v}`),$b(v)){let E=new Ws(this.context,v).toMidi();g[E]=u.urls[v]}else Ni(S)&&isFinite(S)&&(g[S]=u.urls[S])}),this._buffers=new oy({urls:g,onload:u.onload,baseUrl:u.baseUrl,onerror:u.onerror}),this.attack=u.attack,this.release=u.release,this.curve=u.curve,this._buffers.loaded&&Promise.resolve().then(u.onload)}static getDefaults(){return Object.assign(Mi.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Cn,onerror:Cn,release:.1,urls:{}})}_findClosest(u){let g=0;for(;g<96;){if(this._buffers.has(u+g))return-g;if(this._buffers.has(u-g))return g;g++}throw new Error(`No available buffers for note: ${u}`)}triggerAttack(u,g,v=1){return this.log("triggerAttack",u,g,v),Array.isArray(u)||(u=[u]),u.forEach(S=>{let E=OV(new Ws(this.context,S).toFrequency()),k=Math.round(E),M=E-k,L=this._findClosest(k),V=k-L,W=this._buffers.get(V),X=ty(L+M),ce=new Ll({url:W,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:X}).connect(this.output);ce.start(g,0,W.duration/X,v),cs(this._activeSources.get(k))||this._activeSources.set(k,[]),this._activeSources.get(k).push(ce),ce.onended=()=>{if(this._activeSources&&this._activeSources.has(k)){let re=this._activeSources.get(k),ve=re.indexOf(ce);ve!==-1&&re.splice(ve,1)}}}),this}triggerRelease(u,g){return this.log("triggerRelease",u,g),Array.isArray(u)||(u=[u]),u.forEach(v=>{let S=new Ws(this.context,v).toMidi();if(this._activeSources.has(S)&&this._activeSources.get(S).length){let E=this._activeSources.get(S);g=this.toSeconds(g),E.forEach(k=>{k.stop(g)}),this._activeSources.set(S,[])}}),this}releaseAll(u){let g=this.toSeconds(u);return this._activeSources.forEach(v=>{for(;v.length;)v.shift().stop(g)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(u,g,v,S=1){let E=this.toSeconds(v);return this.triggerAttack(u,E,S),cs(g)?(Ot(cs(u),"notes must be an array when duration is array"),u.forEach((k,M)=>{let L=g[Math.min(M,g.length-1)];this.triggerRelease(k,E+this.toSeconds(L))})):this.triggerRelease(u,E+this.toSeconds(g)),this}add(u,g,v){if(Ot($b(u)||isFinite(u),`note must be a pitch or midi: ${u}`),$b(u)){let S=new Ws(this.context,u).toMidi();this._buffers.add(S,g,v)}else this._buffers.add(u,g,v);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(u=>{u.forEach(g=>g.dispose())}),this._activeSources.clear(),this}}Qa([Vl(0)],by.prototype,"attack",void 0),Qa([Vl(0)],by.prototype,"release",void 0);class Za extends jo{constructor(){super(ge(Za.getDefaults(),arguments,["callback","value"])),this.name="ToneEvent",this._state=new ny("stopped"),this._startOffset=0;let u=ge(Za.getDefaults(),arguments,["callback","value"]);this._loop=u.loop,this.callback=u.callback,this.value=u.value,this._loopStart=this.toTicks(u.loopStart),this._loopEnd=this.toTicks(u.loopEnd),this._playbackRate=u.playbackRate,this._probability=u.probability,this._humanize=u.humanize,this.mute=u.mute,this._playbackRate=u.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(jo.getDefaults(),{callback:Cn,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(u=-1){this._state.forEachFrom(u,g=>{let v;if(g.state==="started"){g.id!==-1&&this.context.transport.clear(g.id);let S=g.time+Math.round(this.startOffset/this._playbackRate);if(this._loop===!0||Ni(this._loop)&&this._loop>1){v=1/0,Ni(this._loop)&&(v=this._loop*this._getLoopDuration());let E=this._state.getAfter(S);E!==null&&(v=Math.min(v,E.time-S)),v!==1/0&&(v=new Ur(this.context,v));let k=new Ur(this.context,this._getLoopDuration());g.id=this.context.transport.scheduleRepeat(this._tick.bind(this),k,new Ur(this.context,S),v)}else g.id=this.context.transport.schedule(this._tick.bind(this),new Ur(this.context,S))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(u){this._startOffset=u}get probability(){return this._probability}set probability(u){this._probability=u}get humanize(){return this._humanize}set humanize(u){this._humanize=u}start(u){let g=this.toTicks(u);return this._state.getValueAtTime(g)==="stopped"&&(this._state.add({id:-1,state:"started",time:g}),this._rescheduleEvents(g)),this}stop(u){this.cancel(u);let g=this.toTicks(u);if(this._state.getValueAtTime(g)==="started"){this._state.setStateAtTime("stopped",g,{id:-1});let v=this._state.getBefore(g),S=g;v!==null&&(S=v.time),this._rescheduleEvents(S)}return this}cancel(u){u=sa(u,-1/0);let g=this.toTicks(u);return this._state.forEachFrom(g,v=>{this.context.transport.clear(v.id)}),this._state.cancel(g),this}_tick(u){let g=this.context.transport.getTicksAtTime(u);if(!this.mute&&this._state.getValueAtTime(g)==="started"){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let v=.02;sA(this.humanize)||(v=this.toSeconds(this.humanize)),u+=(2*Math.random()-1)*v}this.callback(u,this.value)}}_getLoopDuration(){return(this._loopEnd-this._loopStart)/this._playbackRate}get loop(){return this._loop}set loop(u){this._loop=u,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(u){this._playbackRate=u,this._rescheduleEvents()}get loopEnd(){return new Ur(this.context,this._loopEnd).toSeconds()}set loopEnd(u){this._loopEnd=this.toTicks(u),this._loop&&this._rescheduleEvents()}get loopStart(){return new Ur(this.context,this._loopStart).toSeconds()}set loopStart(u){this._loopStart=this.toTicks(u),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){let u=this.context.transport.ticks,g=this._state.get(u);if(g!==null&&g.state==="started"){let v=this._getLoopDuration();return(u-g.time)%v/v}return 0}return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class wy extends jo{constructor(){super(ge(wy.getDefaults(),arguments,["callback","interval"])),this.name="Loop";let u=ge(wy.getDefaults(),arguments,["callback","interval"]);this._event=new Za({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:u.interval,playbackRate:u.playbackRate,probability:u.probability,humanize:u.humanize}),this.callback=u.callback,this.iterations=u.iterations}static getDefaults(){return Object.assign(jo.getDefaults(),{interval:"4n",callback:Cn,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(u){return this._event.start(u),this}stop(u){return this._event.stop(u),this}cancel(u){return this._event.cancel(u),this}_tick(u){this.callback(u)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(u){this._event.loopEnd=u}get playbackRate(){return this._event.playbackRate}set playbackRate(u){this._event.playbackRate=u}get humanize(){return this._event.humanize}set humanize(u){this._event.humanize=u}get probability(){return this._event.probability}set probability(u){this._event.probability=u}get mute(){return this._event.mute}set mute(u){this._event.mute=u}get iterations(){return this._event.loop===!0?1/0:this._event.loop}set iterations(u){this._event.loop=u===1/0||u}dispose(){return super.dispose(),this._event.dispose(),this}}class Sy extends Za{constructor(){super(ge(Sy.getDefaults(),arguments,["callback","events"])),this.name="Part",this._state=new ny("stopped"),this._events=new Set;let u=ge(Sy.getDefaults(),arguments,["callback","events"]);this._state.increasing=!0,u.events.forEach(g=>{cs(g)?this.add(g[0],g[1]):this.add(g)})}static getDefaults(){return Object.assign(Za.getDefaults(),{events:[]})}start(u,g){let v=this.toTicks(u);if(this._state.getValueAtTime(v)!=="started"){g=sa(g,this._loop?this._loopStart:0),g=this._loop?sa(g,this._loopStart):sa(g,0);let S=this.toTicks(g);this._state.add({id:-1,offset:S,state:"started",time:v}),this._forEach(E=>{this._startNote(E,v,S)})}return this}_startNote(u,g,v){g-=v,this._loop?u.startOffset>=this._loopStart&&u.startOffset<this._loopEnd?(u.startOffset<v&&(g+=this._getLoopDuration()),u.start(new Ur(this.context,g))):u.startOffset<this._loopStart&&u.startOffset>=v&&(u.loop=!1,u.start(new Ur(this.context,g))):u.startOffset>=v&&u.start(new Ur(this.context,g))}get startOffset(){return this._startOffset}set startOffset(u){this._startOffset=u,this._forEach(g=>{g.startOffset+=this._startOffset})}stop(u){let g=this.toTicks(u);return this._state.cancel(g),this._state.setStateAtTime("stopped",g),this._forEach(v=>{v.stop(u)}),this}at(u,g){let v=new Co(this.context,u).toTicks(),S=new Ur(this.context,1).toSeconds(),E=this._events.values(),k=E.next();for(;!k.done;){let M=k.value;if(Math.abs(v-M.startOffset)<S)return ln(g)&&(M.value=g),M;k=E.next()}return ln(g)?(this.add(u,g),this.at(u)):null}add(u,g){u instanceof Object&&Reflect.has(u,"time")&&(u=(g=u).time);let v=this.toTicks(u),S;return g instanceof Za?(S=g,S.callback=this._tick.bind(this)):S=new Za({callback:this._tick.bind(this),context:this.context,value:g}),S.startOffset=v,S.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(S),this._restartEvent(S),this}_restartEvent(u){this._state.forEach(g=>{g.state==="started"?this._startNote(u,g.time,g.offset):u.stop(new Ur(this.context,g.time))})}remove(u,g){return Fl(u)&&u.hasOwnProperty("time")&&(u=(g=u).time),u=this.toTicks(u),this._events.forEach(v=>{v.startOffset===u&&(ui(g)||ln(g)&&v.value===g)&&(this._events.delete(v),v.dispose())}),this}clear(){return this._forEach(u=>u.dispose()),this._events.clear(),this}cancel(u){return this._forEach(g=>g.cancel(u)),this._state.cancel(this.toTicks(u)),this}_forEach(u){return this._events&&this._events.forEach(g=>{g instanceof Sy?g._forEach(u):u(g)}),this}_setAll(u,g){this._forEach(v=>{v[u]=g})}_tick(u,g){this.mute||this.callback(u,g)}_testLoopBoundries(u){this._loop&&(u.startOffset<this._loopStart||u.startOffset>=this._loopEnd)?u.cancel(0):u.state==="stopped"&&this._restartEvent(u)}get probability(){return this._probability}set probability(u){this._probability=u,this._setAll("probability",u)}get humanize(){return this._humanize}set humanize(u){this._humanize=u,this._setAll("humanize",u)}get loop(){return this._loop}set loop(u){this._loop=u,this._forEach(g=>{g.loopStart=this.loopStart,g.loopEnd=this.loopEnd,g.loop=u,this._testLoopBoundries(g)})}get loopEnd(){return new Ur(this.context,this._loopEnd).toSeconds()}set loopEnd(u){this._loopEnd=this.toTicks(u),this._loop&&this._forEach(g=>{g.loopEnd=u,this._testLoopBoundries(g)})}get loopStart(){return new Ur(this.context,this._loopStart).toSeconds()}set loopStart(u){this._loopStart=this.toTicks(u),this._loop&&this._forEach(g=>{g.loopStart=this.loopStart,this._testLoopBoundries(g)})}get playbackRate(){return this._playbackRate}set playbackRate(u){this._playbackRate=u,this._setAll("playbackRate",u)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}function*sve(C){let u=0;for(;u<C;)u=yd(u,0,C-1),yield u,u++}function*ive(C){let u=C-1;for(;u>=0;)u=yd(u,0,C-1),yield u,u--}function*Wb(C,u){for(;;)yield*Ja(u(C))}function*qV(C,u){let g=u?0:C-1;for(;;)g=yd(g,0,C-1),yield g,u?(g++,g>=C-1&&(u=!1)):(g--,g<=0&&(u=!0))}function*ave(C){let u=0,g=0;for(;u<C;)u=yd(u,0,C-1),yield u,g++,u+=g%2?2:-1}function*cve(C){let u=C-1,g=0;for(;u>=0;)u=yd(u,0,C-1),yield u,g++,u+=g%2?-2:1}function*uve(C){let u=[];for(let g=0;g<C;g++)u.push(g);for(;u.length>0;)yield yd(u.splice(Math.floor(u.length*Math.random()),1)[0],0,C-1)}function*UV(C,u="up",g=0){switch(Ot(C>=1,"The number of values must be at least one"),u){case"up":yield*Ja(Wb(C,sve));case"down":yield*Ja(Wb(C,ive));case"upDown":yield*Ja(qV(C,!0));case"downUp":yield*Ja(qV(C,!1));case"alternateUp":yield*Ja(Wb(C,ave));case"alternateDown":yield*Ja(Wb(C,cve));case"random":yield*Ja(function*(v){for(;;)yield Math.floor(Math.random()*v)}(C));case"randomOnce":yield*Ja(Wb(C,uve));case"randomWalk":yield*Ja(function*(v){let S=Math.floor(Math.random()*v);for(;;)S===0?S++:S===v-1||Math.random()<.5?S--:S++,yield S}(C))}}class IC extends wy{constructor(){super(ge(IC.getDefaults(),arguments,["callback","values","pattern"])),this.name="Pattern";let u=ge(IC.getDefaults(),arguments,["callback","values","pattern"]);this.callback=u.callback,this._values=u.values,this._pattern=UV(u.values.length,u.pattern),this._type=u.pattern}static getDefaults(){return Object.assign(wy.getDefaults(),{pattern:"up",values:[],callback:Cn})}_tick(u){let g=this._pattern.next();this._index=g.value,this._value=this._values[g.value],this.callback(u,this._value)}get values(){return this._values}set values(u){this._values=u,this.pattern=this._type}get value(){return this._value}get index(){return this._index}get pattern(){return this._type}set pattern(u){this._type=u,this._pattern=UV(this._values.length,this._type)}}class EC extends Za{constructor(){super(ge(EC.getDefaults(),arguments,["callback","events","subdivision"])),this.name="Sequence",this._part=new Sy({callback:this._seqCallback.bind(this),context:this.context}),this._events=[],this._eventsArray=[];let u=ge(EC.getDefaults(),arguments,["callback","events","subdivision"]);this._subdivision=this.toTicks(u.subdivision),this.events=u.events,this.loop=u.loop,this.loopStart=u.loopStart,this.loopEnd=u.loopEnd,this.playbackRate=u.playbackRate,this.probability=u.probability,this.humanize=u.humanize,this.mute=u.mute,this.playbackRate=u.playbackRate}static getDefaults(){return Object.assign(ls(Za.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})}_seqCallback(u,g){g===null||this.mute||this.callback(u,g)}get events(){return this._events}set events(u){this.clear(),this._eventsArray=u,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}start(u,g){return this._part.start(u,g&&this._indexTime(g)),this}stop(u){return this._part.stop(u),this}get subdivision(){return new Ur(this.context,this._subdivision).toSeconds()}_createSequence(u){return new Proxy(u,{get:(g,v)=>g[v],set:(g,v,S)=>(Xa(v)&&isFinite(parseInt(v,10))&&cs(S)?g[v]=this._createSequence(S):g[v]=S,this._eventsUpdated(),!0)})}_eventsUpdated(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}_rescheduleSequence(u,g,v){u.forEach((S,E)=>{let k=E*g+v;if(cs(S))this._rescheduleSequence(S,g/S.length,k);else{let M=new Ur(this.context,k,"i").toSeconds();this._part.add(M,S)}})}_indexTime(u){return new Ur(this.context,u*this._subdivision+this.startOffset).toSeconds()}clear(){return this._part.clear(),this}dispose(){return super.dispose(),this._part.dispose(),this}get loop(){return this._part.loop}set loop(u){this._part.loop=u}get loopStart(){return this._loopStart}set loopStart(u){this._loopStart=u,this._part.loopStart=this._indexTime(u)}get loopEnd(){return this._loopEnd}set loopEnd(u){this._loopEnd=u,this._part.loopEnd=u===0?this._indexTime(this._eventsArray.length):this._indexTime(u)}get startOffset(){return this._part.startOffset}set startOffset(u){this._part.startOffset=u}get playbackRate(){return this._part.playbackRate}set playbackRate(u){this._part.playbackRate=u}get probability(){return this._part.probability}set probability(u){this._part.probability=u}get progress(){return this._part.progress}get humanize(){return this._part.humanize}set humanize(u){this._part.humanize=u}get length(){return this._part.length}}class Id extends st{constructor(){super(Object.assign(ge(Id.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new LV({context:this.context}),this.a=new Dt({context:this.context,gain:0}),this.b=new Dt({context:this.context,gain:0}),this.output=new Dt({context:this.context}),this._internalChannels=[this.a,this.b];let u=ge(Id.getDefaults(),arguments,["fade"]);this.fade=new zt({context:this.context,units:"normalRange",value:u.fade}),Lt(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",Hs(this._split,this.a.gain,0),Hs(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(st.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class Oo extends st{constructor(u){super(u),this.name="Effect",this._dryWet=new Id({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new Dt({context:this.context}),this.effectReturn=new Dt({context:this.context}),this.input=new Dt({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(u.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],Lt(this,"wet")}static getDefaults(){return Object.assign(st.getDefaults(),{wet:1})}connectEffect(u){return this._internalChannels.push(u),this.effectSend.chain(u,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class NC extends Oo{constructor(u){super(u),this.name="LFOEffect",this._lfo=new Ds({context:this.context,frequency:u.frequency,amplitude:u.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.type=u.type,Lt(this,["frequency","depth"])}static getDefaults(){return Object.assign(Oo.getDefaults(),{frequency:1,type:"sine",depth:1})}start(u){return this._lfo.start(u),this}stop(u){return this._lfo.stop(u),this}sync(){return this._lfo.sync(),this}unsync(){return this._lfo.unsync(),this}get type(){return this._lfo.type}set type(u){this._lfo.type=u}dispose(){return super.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class DC extends NC{constructor(){super(ge(DC.getDefaults(),arguments,["frequency","baseFrequency","octaves"])),this.name="AutoFilter";let u=ge(DC.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);this.filter=new pi(Object.assign(u.filter,{context:this.context})),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.octaves=u.octaves,this.baseFrequency=u.baseFrequency}static getDefaults(){return Object.assign(NC.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}get baseFrequency(){return this._lfo.min}set baseFrequency(u){this._lfo.min=this.toFrequency(u),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(u){this._octaves=u,this._lfo.max=this._lfo.min*Math.pow(2,u)}dispose(){return super.dispose(),this.filter.dispose(),this}}class Cy extends st{constructor(){super(Object.assign(ge(Cy.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;let u=ge(Cy.getDefaults(),arguments,["pan"]);this.pan=new Yt({context:this.context,param:this._panner.pan,value:u.pan,minValue:-1,maxValue:1}),this._panner.channelCount=u.channelCount,this._panner.channelCountMode="explicit",Lt(this,"pan")}static getDefaults(){return Object.assign(st.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}class kC extends NC{constructor(){super(ge(kC.getDefaults(),arguments,["frequency"])),this.name="AutoPanner";let u=ge(kC.getDefaults(),arguments,["frequency"]);this._panner=new Cy({context:this.context,channelCount:u.channelCount}),this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this._lfo.min=-1,this._lfo.max=1}static getDefaults(){return Object.assign(NC.getDefaults(),{channelCount:1})}dispose(){return super.dispose(),this._panner.dispose(),this}}class _y extends st{constructor(){super(ge(_y.getDefaults(),arguments,["smoothing"])),this.name="Follower";let u=ge(_y.getDefaults(),arguments,["smoothing"]);this._abs=this.input=new $V({context:this.context}),this._lowpass=this.output=new xy({context:this.context,frequency:1/this.toSeconds(u.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=u.smoothing}static getDefaults(){return Object.assign(st.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(u){this._smoothing=u,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}}class AC extends Oo{constructor(){super(ge(AC.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"])),this.name="AutoWah";let u=ge(AC.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);this._follower=new _y({context:this.context,smoothing:u.follower}),this._sweepRange=new Gb({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(u.baseFrequency),this._octaves=u.octaves,this._inputBoost=new Dt({context:this.context}),this._bandpass=new pi({context:this.context,rolloff:-48,frequency:0,Q:u.Q}),this._peaking=new pi({context:this.context,type:"peaking"}),this._peaking.gain.value=u.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=u.sensitivity,Lt(this,["gain","Q"])}static getDefaults(){return Object.assign(Oo.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(u){this._octaves=u,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(u){this._follower.smoothing=u}get baseFrequency(){return this._baseFrequency}set baseFrequency(u){this._baseFrequency=this.toFrequency(u),this._setSweepRange()}get sensitivity(){return Bb(1/this._inputBoost.gain.value)}set sensitivity(u){this._inputBoost.gain.value=1/ey(u)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}let jV="bit-crusher";BV(jV,`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`);class OC extends Oo{constructor(){super(ge(OC.getDefaults(),arguments,["bits"])),this.name="BitCrusher";let u=ge(OC.getDefaults(),arguments,["bits"]);this._bitCrusherWorklet=new MC({context:this.context,bits:u.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(Oo.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}}class MC extends bA{constructor(){super(ge(MC.getDefaults(),arguments)),this.name="BitCrusherWorklet";let u=ge(MC.getDefaults(),arguments);this.input=new Dt({context:this.context}),this.output=new Dt({context:this.context}),this.bits=new Yt({context:this.context,value:u.bits,units:"positive",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(bA.getDefaults(),{bits:12})}_audioWorkletName(){return jV}onReady(u){Ai(this.input,u,this.output);let g=u.parameters.get("bits");this.bits.setParam(g)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}class RC extends Oo{constructor(){super(ge(RC.getDefaults(),arguments,["order"])),this.name="Chebyshev";let u=ge(RC.getDefaults(),arguments,["order"]);this._shaper=new ia({context:this.context,length:4096}),this._order=u.order,this.connectEffect(this._shaper),this.order=u.order,this.oversample=u.oversample}static getDefaults(){return Object.assign(Oo.getDefaults(),{order:1,oversample:"none"})}_getCoefficient(u,g,v){return v.has(g)||(g===0?v.set(g,0):g===1?v.set(g,u):v.set(g,2*u*this._getCoefficient(u,g-1,v)-this._getCoefficient(u,g-2,v))),v.get(g)}get order(){return this._order}set order(u){Ot(Number.isInteger(u),"'order' must be an integer"),this._order=u,this._shaper.setMap(g=>this._getCoefficient(g,u,new Map))}get oversample(){return this._shaper.oversample}set oversample(u){this._shaper.oversample=u}dispose(){return super.dispose(),this._shaper.dispose(),this}}class Fh extends st{constructor(){super(ge(Fh.getDefaults(),arguments,["channels"])),this.name="Split";let u=ge(Fh.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(u.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(st.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class Ul extends st{constructor(){super(ge(Ul.getDefaults(),arguments,["channels"])),this.name="Merge";let u=ge(Ul.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(u.channels)}static getDefaults(){return Object.assign(st.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class Bc extends st{constructor(u){super(u),this.name="StereoEffect",this.input=new Dt({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new Id({context:this.context,fade:u.wet}),this.wet=this._dryWet.fade,this._split=new Fh({context:this.context,channels:2}),this._merge=new Ul({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),Lt(this,["wet"])}connectEffectLeft(...u){this._split.connect(u[0],0,0),Ai(...u),Hs(u[u.length-1],this._merge,0,0)}connectEffectRight(...u){this._split.connect(u[0],1,0),Ai(...u),Hs(u[u.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(st.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class wA extends Bc{constructor(u){super(u),this.feedback=new zt({context:this.context,value:u.feedback,units:"normalRange"}),this._feedbackL=new Dt({context:this.context}),this._feedbackR=new Dt({context:this.context}),this._feedbackSplit=new Fh({context:this.context,channels:2}),this._feedbackMerge=new Ul({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),Lt(this,["feedback"])}static getDefaults(){return Object.assign(Bc.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class PC extends wA{constructor(){super(ge(PC.getDefaults(),arguments,["frequency","delayTime","depth"])),this.name="Chorus";let u=ge(PC.getDefaults(),arguments,["frequency","delayTime","depth"]);this._depth=u.depth,this._delayTime=u.delayTime/1e3,this._lfoL=new Ds({context:this.context,frequency:u.frequency,min:0,max:1}),this._lfoR=new Ds({context:this.context,frequency:u.frequency,min:0,max:1,phase:180}),this._delayNodeL=new li({context:this.context}),this._delayNodeR=new li({context:this.context}),this.frequency=this._lfoL.frequency,Lt(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=u.type,this.spread=u.spread}static getDefaults(){return Object.assign(wA.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(u){this._depth=u;let g=this._delayTime*u;this._lfoL.min=Math.max(this._delayTime-g,0),this._lfoL.max=this._delayTime+g,this._lfoR.min=Math.max(this._delayTime-g,0),this._lfoR.max=this._delayTime+g}get delayTime(){return 1e3*this._delayTime}set delayTime(u){this._delayTime=u/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(u){this._lfoL.type=u,this._lfoR.type=u}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(u){this._lfoL.phase=90-u/2,this._lfoR.phase=u/2+90}start(u){return this._lfoL.start(u),this._lfoR.start(u),this}stop(u){return this._lfoL.stop(u),this._lfoR.stop(u),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class FC extends Oo{constructor(){super(ge(FC.getDefaults(),arguments,["distortion"])),this.name="Distortion";let u=ge(FC.getDefaults(),arguments,["distortion"]);this._shaper=new ia({context:this.context,length:4096}),this._distortion=u.distortion,this.connectEffect(this._shaper),this.distortion=u.distortion,this.oversample=u.oversample}static getDefaults(){return Object.assign(Oo.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(u){this._distortion=u;let g=100*u,v=Math.PI/180;this._shaper.setMap(S=>Math.abs(S)<.001?0:(3+g)*S*20*v/(Math.PI+g*Math.abs(S)))}get oversample(){return this._shaper.oversample}set oversample(u){this._shaper.oversample=u}dispose(){return super.dispose(),this._shaper.dispose(),this}}class $C extends Oo{constructor(u){super(u),this.name="FeedbackEffect",this._feedbackGain=new Dt({context:this.context,gain:u.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,Lt(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(Oo.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class LC extends $C{constructor(){super(ge(LC.getDefaults(),arguments,["delayTime","feedback"])),this.name="FeedbackDelay";let u=ge(LC.getDefaults(),arguments,["delayTime","feedback"]);this._delayNode=new li({context:this.context,delayTime:u.delayTime,maxDelay:u.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),Lt(this,"delayTime")}static getDefaults(){return Object.assign($C.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class lve extends st{constructor(u){super(u),this.name="PhaseShiftAllpass",this.input=new Dt({context:this.context}),this.output=new Dt({context:this.context}),this.offset90=new Dt({context:this.context}),this._bank0=this._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),this._bank1=this._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),this._oneSampleDelay=this.context.createIIRFilter([0,1],[1,0]),Ai(this.input,...this._bank0,this._oneSampleDelay,this.output),Ai(this.input,...this._bank1,this.offset90)}_createAllPassFilterBank(u){return u.map(g=>{let v=[[g*g,0,-1],[1,0,-g*g]];return this.context.createIIRFilter(v[0],v[1])})}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach(u=>u.disconnect()),this._bank1.forEach(u=>u.disconnect()),this._oneSampleDelay.disconnect(),this}}class zC extends Oo{constructor(){super(ge(zC.getDefaults(),arguments,["frequency"])),this.name="FrequencyShifter";let u=ge(zC.getDefaults(),arguments,["frequency"]);this.frequency=new zt({context:this.context,units:"frequency",value:u.frequency,minValue:-this.context.sampleRate/2,maxValue:this.context.sampleRate/2}),this._sine=new cy({context:this.context,type:"sine"}),this._cosine=new Ns({context:this.context,phase:-90,type:"sine"}),this._sineMultiply=new Mr({context:this.context}),this._cosineMultiply=new Mr({context:this.context}),this._negate=new gA({context:this.context}),this._add=new Cd({context:this.context}),this._phaseShifter=new lve({context:this.context}),this.effectSend.connect(this._phaseShifter),this.frequency.fan(this._sine.frequency,this._cosine.frequency),this._phaseShifter.offset90.connect(this._cosineMultiply),this._cosine.connect(this._cosineMultiply.factor),this._phaseShifter.connect(this._sineMultiply),this._sine.connect(this._sineMultiply.factor),this._sineMultiply.connect(this._negate),this._cosineMultiply.connect(this._add),this._negate.connect(this._add.addend),this._add.connect(this.effectReturn);let g=this.immediate();this._sine.start(g),this._cosine.start(g)}static getDefaults(){return Object.assign(Oo.getDefaults(),{frequency:0})}dispose(){return super.dispose(),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}}let GV=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],WV=[225,556,441,341];class BC extends Bc{constructor(){super(ge(BC.getDefaults(),arguments,["roomSize","dampening"])),this.name="Freeverb",this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];let u=ge(BC.getDefaults(),arguments,["roomSize","dampening"]);this.roomSize=new zt({context:this.context,value:u.roomSize,units:"normalRange"}),this._allpassFiltersL=WV.map(g=>{let v=this.context.createBiquadFilter();return v.type="allpass",v.frequency.value=g,v}),this._allpassFiltersR=WV.map(g=>{let v=this.context.createBiquadFilter();return v.type="allpass",v.frequency.value=g,v}),this._combFilters=GV.map((g,v)=>{let S=new vy({context:this.context,dampening:u.dampening,delayTime:g});return v<GV.length/2?this.connectEffectLeft(S,...this._allpassFiltersL):this.connectEffectRight(S,...this._allpassFiltersR),this.roomSize.connect(S.resonance),S}),Lt(this,["roomSize"])}static getDefaults(){return Object.assign(Bc.getDefaults(),{roomSize:.7,dampening:3e3})}get dampening(){return this._combFilters[0].dampening}set dampening(u){this._combFilters.forEach(g=>g.dampening=u)}dispose(){return super.dispose(),this._allpassFiltersL.forEach(u=>u.disconnect()),this._allpassFiltersR.forEach(u=>u.disconnect()),this._combFilters.forEach(u=>u.dispose()),this.roomSize.dispose(),this}}let HV=[.06748,.06404,.08212,.09004],pve=[.773,.802,.753,.733],hve=[347,113,37];class VC extends Bc{constructor(){super(ge(VC.getDefaults(),arguments,["roomSize"])),this.name="JCReverb",this._allpassFilters=[],this._feedbackCombFilters=[];let u=ge(VC.getDefaults(),arguments,["roomSize"]);this.roomSize=new zt({context:this.context,value:u.roomSize,units:"normalRange"}),this._scaleRoomSize=new zc({context:this.context,min:-.733,max:.197}),this._allpassFilters=hve.map(g=>{let v=this.context.createBiquadFilter();return v.type="allpass",v.frequency.value=g,v}),this._feedbackCombFilters=HV.map((g,v)=>{let S=new yy({context:this.context,delayTime:g});return this._scaleRoomSize.connect(S.resonance),S.resonance.value=pve[v],v<HV.length/2?this.connectEffectLeft(...this._allpassFilters,S):this.connectEffectRight(...this._allpassFilters,S),S}),this.roomSize.connect(this._scaleRoomSize),Lt(this,["roomSize"])}static getDefaults(){return Object.assign(Bc.getDefaults(),{roomSize:.5})}dispose(){return super.dispose(),this._allpassFilters.forEach(u=>u.disconnect()),this._feedbackCombFilters.forEach(u=>u.dispose()),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}}class KV extends wA{constructor(u){super(u),this._feedbackL.disconnect(),this._feedbackL.connect(this._feedbackMerge,0,1),this._feedbackR.disconnect(),this._feedbackR.connect(this._feedbackMerge,0,0),Lt(this,["feedback"])}}class qC extends KV{constructor(){super(ge(qC.getDefaults(),arguments,["delayTime","feedback"])),this.name="PingPongDelay";let u=ge(qC.getDefaults(),arguments,["delayTime","feedback"]);this._leftDelay=new li({context:this.context,maxDelay:u.maxDelay}),this._rightDelay=new li({context:this.context,maxDelay:u.maxDelay}),this._rightPreDelay=new li({context:this.context,maxDelay:u.maxDelay}),this.delayTime=new zt({context:this.context,units:"time",value:u.delayTime}),this.connectEffectLeft(this._leftDelay),this.connectEffectRight(this._rightPreDelay,this._rightDelay),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackL.disconnect(),this._feedbackL.connect(this._rightDelay),Lt(this,["delayTime"])}static getDefaults(){return Object.assign(KV.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}}class UC extends $C{constructor(){super(ge(UC.getDefaults(),arguments,["pitch"])),this.name="PitchShift";let u=ge(UC.getDefaults(),arguments,["pitch"]);this._frequency=new zt({context:this.context}),this._delayA=new li({maxDelay:1,context:this.context}),this._lfoA=new Ds({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new li({maxDelay:1,context:this.context}),this._lfoB=new Ds({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new Id({context:this.context}),this._crossFadeLFO=new Ds({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new li({delayTime:u.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,Lt(this,"delayTime"),this._pitch=u.pitch,this._windowSize=u.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);let g=this.now();this._lfoA.start(g),this._lfoB.start(g),this._crossFadeLFO.start(g),this.windowSize=this._windowSize}static getDefaults(){return Object.assign($C.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(u){this._pitch=u;let g=0;u<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,g=ty(u-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,g=ty(u)-1),this._frequency.value=g*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(u){this._windowSize=this.toSeconds(u),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}class jC extends Bc{constructor(){super(ge(jC.getDefaults(),arguments,["frequency","octaves","baseFrequency"])),this.name="Phaser";let u=ge(jC.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);this._lfoL=new Ds({context:this.context,frequency:u.frequency,min:0,max:1}),this._lfoR=new Ds({context:this.context,frequency:u.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(u.baseFrequency),this._octaves=u.octaves,this.Q=new zt({context:this.context,value:u.Q,units:"positive"}),this._filtersL=this._makeFilters(u.stages,this._lfoL),this._filtersR=this._makeFilters(u.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=u.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=u.baseFrequency,this.octaves=u.octaves,this._lfoL.start(),this._lfoR.start(),Lt(this,["frequency","Q"])}static getDefaults(){return Object.assign(Bc.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(u,g){let v=[];for(let S=0;S<u;S++){let E=this.context.createBiquadFilter();E.type="allpass",this.Q.connect(E.Q),g.connect(E.frequency),v.push(E)}return v}get octaves(){return this._octaves}set octaves(u){this._octaves=u;let g=this._baseFrequency*Math.pow(2,u);this._lfoL.max=g,this._lfoR.max=g}get baseFrequency(){return this._baseFrequency}set baseFrequency(u){this._baseFrequency=this.toFrequency(u),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach(u=>u.disconnect()),this._filtersR.forEach(u=>u.disconnect()),this.frequency.dispose(),this}}class GC extends Oo{constructor(){super(ge(GC.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();let u=ge(GC.getDefaults(),arguments,["decay"]);this._decay=u.decay,this._preDelay=u.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(Oo.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(u){us(u=this.toSeconds(u),.001),this._decay=u,this.generate()}get preDelay(){return this._preDelay}set preDelay(u){us(u=this.toSeconds(u),0),this._preDelay=u,this.generate()}generate(){return xr(this,void 0,void 0,function*(){let u=this.ready,g=new Jg(2,this._decay+this._preDelay,this.context.sampleRate),v=new zl({context:g}),S=new zl({context:g}),E=new Ul({context:g});v.connect(E,0,0),S.connect(E,0,1);let k=new Dt({context:g}).toDestination();E.connect(k),v.start(0),S.start(0),k.gain.setValueAtTime(0,0),k.gain.setValueAtTime(1,this._preDelay),k.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);let M=g.render();return this.ready=M.then(Cn),yield u,this._convolver.buffer=(yield M).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class Hb extends st{constructor(){super(ge(Hb.getDefaults(),arguments)),this.name="MidSideSplit",this._split=this.input=new Fh({channels:2,context:this.context}),this._midAdd=new Cd({context:this.context}),this.mid=new Mr({context:this.context,value:Math.SQRT1_2}),this._sideSubtract=new Td({context:this.context}),this.side=new Mr({context:this.context,value:Math.SQRT1_2}),this._split.connect(this._midAdd,0),this._split.connect(this._midAdd.addend,1),this._split.connect(this._sideSubtract,0),this._split.connect(this._sideSubtract.subtrahend,1),this._midAdd.connect(this.mid),this._sideSubtract.connect(this.side)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}}class Kb extends st{constructor(){super(ge(Kb.getDefaults(),arguments)),this.name="MidSideMerge",this.mid=new Dt({context:this.context}),this.side=new Dt({context:this.context}),this._left=new Cd({context:this.context}),this._leftMult=new Mr({context:this.context,value:Math.SQRT1_2}),this._right=new Td({context:this.context}),this._rightMult=new Mr({context:this.context,value:Math.SQRT1_2}),this._merge=this.output=new Ul({context:this.context}),this.mid.fan(this._left),this.side.connect(this._left.addend),this.mid.connect(this._right),this.side.connect(this._right.subtrahend),this._left.connect(this._leftMult),this._right.connect(this._rightMult),this._leftMult.connect(this._merge,0,0),this._rightMult.connect(this._merge,0,1)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}}class XV extends Oo{constructor(u){super(u),this.name="MidSideEffect",this._midSideMerge=new Kb({context:this.context}),this._midSideSplit=new Hb({context:this.context}),this._midSend=this._midSideSplit.mid,this._sideSend=this._midSideSplit.side,this._midReturn=this._midSideMerge.mid,this._sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)}connectEffectMid(...u){this._midSend.chain(...u,this._midReturn)}connectEffectSide(...u){this._sideSend.chain(...u,this._sideReturn)}dispose(){return super.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}}class WC extends XV{constructor(){super(ge(WC.getDefaults(),arguments,["width"])),this.name="StereoWidener";let u=ge(WC.getDefaults(),arguments,["width"]);this.width=new zt({context:this.context,value:u.width,units:"normalRange"}),Lt(this,["width"]),this._twoTimesWidthMid=new Mr({context:this.context,value:2}),this._twoTimesWidthSide=new Mr({context:this.context,value:2}),this._midMult=new Mr({context:this.context}),this._twoTimesWidthMid.connect(this._midMult.factor),this.connectEffectMid(this._midMult),this._oneMinusWidth=new Td({context:this.context}),this._oneMinusWidth.connect(this._twoTimesWidthMid),Hs(this.context.getConstant(1),this._oneMinusWidth),this.width.connect(this._oneMinusWidth.subtrahend),this._sideMult=new Mr({context:this.context}),this.width.connect(this._twoTimesWidthSide),this._twoTimesWidthSide.connect(this._sideMult.factor),this.connectEffectSide(this._sideMult)}static getDefaults(){return Object.assign(XV.getDefaults(),{width:.5})}dispose(){return super.dispose(),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}}class HC extends Bc{constructor(){super(ge(HC.getDefaults(),arguments,["frequency","depth"])),this.name="Tremolo";let u=ge(HC.getDefaults(),arguments,["frequency","depth"]);this._lfoL=new Ds({context:this.context,type:u.type,min:1,max:0}),this._lfoR=new Ds({context:this.context,type:u.type,min:1,max:0}),this._amplitudeL=new Dt({context:this.context}),this._amplitudeR=new Dt({context:this.context}),this.frequency=new zt({context:this.context,value:u.frequency,units:"frequency"}),this.depth=new zt({context:this.context,value:u.depth,units:"normalRange"}),Lt(this,["frequency","depth"]),this.connectEffectLeft(this._amplitudeL),this.connectEffectRight(this._amplitudeR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.spread=u.spread}static getDefaults(){return Object.assign(Bc.getDefaults(),{frequency:10,type:"sine",depth:.5,spread:180})}start(u){return this._lfoL.start(u),this._lfoR.start(u),this}stop(u){return this._lfoL.stop(u),this._lfoR.stop(u),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}get type(){return this._lfoL.type}set type(u){this._lfoL.type=u,this._lfoR.type=u}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(u){this._lfoL.phase=90-u/2,this._lfoR.phase=u/2+90}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class KC extends Oo{constructor(){super(ge(KC.getDefaults(),arguments,["frequency","depth"])),this.name="Vibrato";let u=ge(KC.getDefaults(),arguments,["frequency","depth"]);this._delayNode=new li({context:this.context,delayTime:0,maxDelay:u.maxDelay}),this._lfo=new Ds({context:this.context,type:u.type,min:0,max:u.maxDelay,frequency:u.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=u.depth,Lt(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(Oo.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(u){this._lfo.type=u}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class Ty extends st{constructor(){super(ge(Ty.getDefaults(),arguments,["type","size"])),this.name="Analyser",this._analysers=[],this._buffers=[];let u=ge(Ty.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new Dt({context:this.context}),this._split=new Fh({context:this.context,channels:u.channels}),this.input.connect(this._split),us(u.channels,1);for(let g=0;g<u.channels;g++)this._analysers[g]=this.context.createAnalyser(),this._split.connect(this._analysers[g],g,0);this.size=u.size,this.type=u.type,this.smoothing=u.smoothing}static getDefaults(){return Object.assign(st.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach((u,g)=>{let v=this._buffers[g];this._type==="fft"?u.getFloatFrequencyData(v):this._type==="waveform"&&u.getFloatTimeDomainData(v)}),this.channels===1?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(u){this._analysers.forEach((g,v)=>{g.fftSize=2*u,this._buffers[v]=new Float32Array(u)})}get channels(){return this._analysers.length}get type(){return this._type}set type(u){Ot(u==="waveform"||u==="fft",`Analyser: invalid type: ${u}`),this._type=u}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(u){this._analysers.forEach(g=>g.smoothingTimeConstant=u)}dispose(){return super.dispose(),this._analysers.forEach(u=>u.disconnect()),this._split.dispose(),this._gain.dispose(),this}}class $h extends st{constructor(){super(ge($h.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new Ty({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}}class XC extends $h{constructor(){super(ge(XC.getDefaults(),arguments,["smoothing"])),this.name="Meter";let u=ge(XC.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new Ty({context:this.context,size:256,type:"waveform",channels:u.channelCount}),this.smoothing=u.smoothing,this.normalRange=u.normalRange,this._rms=new Array(u.channelCount),this._rms.fill(0)}static getDefaults(){return Object.assign($h.getDefaults(),{smoothing:.8,normalRange:!1,channelCount:1})}getLevel(){return Kg("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){let u=this._analyser.getValue(),g=(this.channels===1?[u]:u).map((v,S)=>{let E=v.reduce((M,L)=>M+L*L,0),k=Math.sqrt(E/v.length);return this._rms[S]=Math.max(k,this._rms[S]*this.smoothing),this.normalRange?this._rms[S]:Bb(this._rms[S])});return this.channels===1?g[0]:g}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}}class QC extends $h{constructor(){super(ge(QC.getDefaults(),arguments,["size"])),this.name="FFT";let u=ge(QC.getDefaults(),arguments,["size"]);this.normalRange=u.normalRange,this._analyser.type="fft",this.size=u.size}static getDefaults(){return Object.assign(st.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map(u=>this.normalRange?ey(u):u)}get size(){return this._analyser.size}set size(u){this._analyser.size=u}get smoothing(){return this._analyser.smoothing}set smoothing(u){this._analyser.smoothing=u}getFrequencyOfIndex(u){return Ot(0<=u&&u<this.size,`index must be greater than or equal to 0 and less than ${this.size}`),u*this.context.sampleRate/(2*this.size)}}class SA extends $h{constructor(){super(ge(SA.getDefaults(),arguments)),this.name="DCMeter",this._analyser.type="waveform",this._analyser.size=256}getValue(){return this._analyser.getValue()[0]}}class YC extends $h{constructor(){super(ge(YC.getDefaults(),arguments,["size"])),this.name="Waveform";let u=ge(YC.getDefaults(),arguments,["size"]);this._analyser.type="waveform",this.size=u.size}static getDefaults(){return Object.assign($h.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(u){this._analyser.size=u}}class eo extends st{constructor(){super(ge(eo.getDefaults(),arguments,["solo"])),this.name="Solo";let u=ge(eo.getDefaults(),arguments,["solo"]);this.input=this.output=new Dt({context:this.context}),eo._allSolos.has(this.context)||eo._allSolos.set(this.context,new Set),eo._allSolos.get(this.context).add(this),this.solo=u.solo}static getDefaults(){return Object.assign(st.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(u){u?this._addSolo():this._removeSolo(),eo._allSolos.get(this.context).forEach(g=>g._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){eo._soloed.has(this.context)||eo._soloed.set(this.context,new Set),eo._soloed.get(this.context).add(this)}_removeSolo(){eo._soloed.has(this.context)&&eo._soloed.get(this.context).delete(this)}_isSoloed(){return eo._soloed.has(this.context)&&eo._soloed.get(this.context).has(this)}_noSolos(){return!eo._soloed.has(this.context)||eo._soloed.has(this.context)&&eo._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),eo._allSolos.get(this.context).delete(this),this._removeSolo(),this}}eo._allSolos=new Map,eo._soloed=new Map;class Xb extends st{constructor(){super(ge(Xb.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";let u=ge(Xb.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Cy({context:this.context,pan:u.pan,channelCount:u.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new $c({context:this.context,volume:u.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=u.mute,Lt(this,["pan","volume"])}static getDefaults(){return Object.assign(st.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(u){this._volume.mute=u}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class Lh extends st{constructor(){super(ge(Lh.getDefaults(),arguments,["volume","pan"])),this.name="Channel";let u=ge(Lh.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new eo({solo:u.solo,context:this.context}),this._panVol=this.output=new Xb({context:this.context,pan:u.pan,volume:u.volume,mute:u.mute,channelCount:u.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Lt(this,["pan","volume"])}static getDefaults(){return Object.assign(st.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(u){this._solo.solo=u}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(u){this._panVol.mute=u}_getBus(u){return Lh.buses.has(u)||Lh.buses.set(u,new Dt({context:this.context})),Lh.buses.get(u)}send(u,g=0){let v=this._getBus(u),S=new Dt({context:this.context,units:"decibels",gain:g});return this.connect(S),S.connect(v),S}receive(u){return this._getBus(u).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}Lh.buses=new Map;class CA extends st{constructor(){super(ge(CA.getDefaults(),arguments)),this.name="Mono",this.input=new Dt({context:this.context}),this._merge=this.output=new Ul({channels:2,context:this.context}),this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1)}dispose(){return super.dispose(),this._merge.dispose(),this.input.dispose(),this}}class Iy extends st{constructor(){super(ge(Iy.getDefaults(),arguments,["lowFrequency","highFrequency"])),this.name="MultibandSplit",this.input=new Dt({context:this.context}),this.output=void 0,this.low=new pi({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new pi({context:this.context,frequency:0,type:"highpass"}),this.mid=new pi({context:this.context,frequency:0,type:"lowpass"}),this.high=new pi({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high];let u=ge(Iy.getDefaults(),arguments,["lowFrequency","highFrequency"]);this.lowFrequency=new zt({context:this.context,units:"frequency",value:u.lowFrequency}),this.highFrequency=new zt({context:this.context,units:"frequency",value:u.highFrequency}),this.Q=new zt({context:this.context,units:"positive",value:u.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),Lt(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(st.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),Lb(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class fve extends st{constructor(){super(...arguments),this.name="Listener",this.positionX=new Yt({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Yt({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Yt({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Yt({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Yt({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Yt({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Yt({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Yt({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Yt({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(st.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}sC(C=>{C.listener=new fve({context:C})}),iC(C=>{C.listener.dispose()});class ZC extends st{constructor(){super(ge(ZC.getDefaults(),arguments,["positionX","positionY","positionZ"])),this.name="Panner3D";let u=ge(ZC.getDefaults(),arguments,["positionX","positionY","positionZ"]);this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=u.panningModel,this.maxDistance=u.maxDistance,this.distanceModel=u.distanceModel,this.coneOuterGain=u.coneOuterGain,this.coneOuterAngle=u.coneOuterAngle,this.coneInnerAngle=u.coneInnerAngle,this.refDistance=u.refDistance,this.rolloffFactor=u.rolloffFactor,this.positionX=new Yt({context:this.context,param:this._panner.positionX,value:u.positionX}),this.positionY=new Yt({context:this.context,param:this._panner.positionY,value:u.positionY}),this.positionZ=new Yt({context:this.context,param:this._panner.positionZ,value:u.positionZ}),this.orientationX=new Yt({context:this.context,param:this._panner.orientationX,value:u.orientationX}),this.orientationY=new Yt({context:this.context,param:this._panner.orientationY,value:u.orientationY}),this.orientationZ=new Yt({context:this.context,param:this._panner.orientationZ,value:u.orientationZ})}static getDefaults(){return Object.assign(st.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(u,g,v){return this.positionX.value=u,this.positionY.value=g,this.positionZ.value=v,this}setOrientation(u,g,v){return this.orientationX.value=u,this.orientationY.value=g,this.orientationZ.value=v,this}get panningModel(){return this._panner.panningModel}set panningModel(u){this._panner.panningModel=u}get refDistance(){return this._panner.refDistance}set refDistance(u){this._panner.refDistance=u}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(u){this._panner.rolloffFactor=u}get distanceModel(){return this._panner.distanceModel}set distanceModel(u){this._panner.distanceModel=u}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(u){this._panner.coneInnerAngle=u}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(u){this._panner.coneOuterAngle=u}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(u){this._panner.coneOuterGain=u}get maxDistance(){return this._panner.maxDistance}set maxDistance(u){this._panner.maxDistance=u}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}}class Qb extends st{constructor(){super(ge(Qb.getDefaults(),arguments)),this.name="Recorder";let u=ge(Qb.getDefaults(),arguments);this.input=new Dt({context:this.context}),Ot(Qb.supported,"Media Recorder API is not available"),this._stream=this.context.createMediaStreamDestination(),this.input.connect(this._stream),this._recorder=new MediaRecorder(this._stream.stream,{mimeType:u.mimeType})}static getDefaults(){return st.getDefaults()}get mimeType(){return this._recorder.mimeType}static get supported(){return $l!==null&&Reflect.has($l,"MediaRecorder")}get state(){return this._recorder.state==="inactive"?"stopped":this._recorder.state==="paused"?"paused":"started"}start(){return xr(this,void 0,void 0,function*(){Ot(this.state!=="started","Recorder is already started");let u=new Promise(g=>{let v=()=>{this._recorder.removeEventListener("start",v,!1),g()};this._recorder.addEventListener("start",v,!1)});return this._recorder.start(),yield u})}stop(){return xr(this,void 0,void 0,function*(){Ot(this.state!=="stopped","Recorder is not started");let u=new Promise(g=>{let v=S=>{this._recorder.removeEventListener("dataavailable",v,!1),g(S.data)};this._recorder.addEventListener("dataavailable",v,!1)});return this._recorder.stop(),yield u})}pause(){return Ot(this.state==="started","Recorder must be started"),this._recorder.pause(),this}dispose(){return super.dispose(),this.input.dispose(),this._stream.disconnect(),this}}class Vc extends st{constructor(){super(ge(Vc.getDefaults(),arguments,["threshold","ratio"])),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor;let u=ge(Vc.getDefaults(),arguments,["threshold","ratio"]);this.threshold=new Yt({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:u.threshold}),this.attack=new Yt({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:u.attack}),this.release=new Yt({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:u.release}),this.knee=new Yt({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:u.knee}),this.ratio=new Yt({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:u.ratio}),Lt(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(st.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class JC extends st{constructor(){super(Object.assign(ge(JC.getDefaults(),arguments,["threshold","smoothing"]))),this.name="Gate";let u=ge(JC.getDefaults(),arguments,["threshold","smoothing"]);this._follower=new _y({context:this.context,smoothing:u.smoothing}),this._gt=new jb({context:this.context,value:ey(u.threshold)}),this.input=new Dt({context:this.context}),this._gate=this.output=new Dt({context:this.context}),this.input.connect(this._gate),this.input.chain(this._follower,this._gt,this._gate.gain)}static getDefaults(){return Object.assign(st.getDefaults(),{smoothing:.1,threshold:-40})}get threshold(){return Bb(this._gt.value)}set threshold(u){this._gt.value=ey(u)}get smoothing(){return this._follower.smoothing}set smoothing(u){this._follower.smoothing=u}dispose(){return super.dispose(),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}}class e_ extends st{constructor(){super(Object.assign(ge(e_.getDefaults(),arguments,["threshold"]))),this.name="Limiter";let u=ge(e_.getDefaults(),arguments,["threshold"]);this._compressor=this.input=this.output=new Vc({context:this.context,ratio:20,attack:.003,release:.01,threshold:u.threshold}),this.threshold=this._compressor.threshold,Lt(this,"threshold")}static getDefaults(){return Object.assign(st.getDefaults(),{threshold:-12})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.dispose(),this.threshold.dispose(),this}}class t_ extends st{constructor(){super(Object.assign(ge(t_.getDefaults(),arguments))),this.name="MidSideCompressor";let u=ge(t_.getDefaults(),arguments);this._midSideSplit=this.input=new Hb({context:this.context}),this._midSideMerge=this.output=new Kb({context:this.context}),this.mid=new Vc(Object.assign(u.mid,{context:this.context})),this.side=new Vc(Object.assign(u.side,{context:this.context})),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),Lt(this,["mid","side"])}static getDefaults(){return Object.assign(st.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}}class n_ extends st{constructor(){super(Object.assign(ge(n_.getDefaults(),arguments))),this.name="MultibandCompressor";let u=ge(n_.getDefaults(),arguments);this._splitter=this.input=new Iy({context:this.context,lowFrequency:u.lowFrequency,highFrequency:u.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new Dt({context:this.context}),this.low=new Vc(Object.assign(u.low,{context:this.context})),this.mid=new Vc(Object.assign(u.mid,{context:this.context})),this.high=new Vc(Object.assign(u.high,{context:this.context})),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),Lt(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(st.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}dispose(){return super.dispose(),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}}class r_ extends st{constructor(){super(ge(r_.getDefaults(),arguments,["low","mid","high"])),this.name="EQ3",this.output=new Dt({context:this.context}),this._internalChannels=[];let u=ge(r_.getDefaults(),arguments,["low","mid","high"]);this.input=this._multibandSplit=new Iy({context:this.context,highFrequency:u.highFrequency,lowFrequency:u.lowFrequency}),this._lowGain=new Dt({context:this.context,gain:u.low,units:"decibels"}),this._midGain=new Dt({context:this.context,gain:u.mid,units:"decibels"}),this._highGain=new Dt({context:this.context,gain:u.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),Lt(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(st.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),Lb(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}class o_ extends st{constructor(){super(ge(o_.getDefaults(),arguments,["url","onload"])),this.name="Convolver",this._convolver=this.context.createConvolver();let u=ge(o_.getDefaults(),arguments,["url","onload"]);this._buffer=new Mn(u.url,g=>{this.buffer=g,u.onload()}),this.input=new Dt({context:this.context}),this.output=new Dt({context:this.context}),this._buffer.loaded&&(this.buffer=this._buffer),this.normalize=u.normalize,this.input.chain(this._convolver,this.output)}static getDefaults(){return Object.assign(st.getDefaults(),{normalize:!0,onload:Cn})}load(u){return xr(this,void 0,void 0,function*(){this.buffer=yield this._buffer.load(u)})}get buffer(){return this._buffer.length?this._buffer:null}set buffer(u){u&&this._buffer.set(u),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));let g=this._buffer.get();this._convolver.buffer=g||null}get normalize(){return this._convolver.normalize}set normalize(u){this._convolver.normalize=u}dispose(){return super.dispose(),this._buffer.dispose(),this._convolver.disconnect(),this}}function dve(){return Or().now()}function mve(){return Or().immediate()}let gve=Or().transport;function yve(){return Or().transport}let xve=Or().destination,vve=Or().destination;function bve(){return Or().destination}let wve=Or().listener;function Sve(){return Or().listener}let Cve=Or().draw;function _ve(){return Or().draw}let Tve=Or();function Ive(){return Mn.loaded()}let Eve=Mn,Nve=oy,Dve=Ll})(),r})())});var pye=Pn((exports,module)=>{"use strict";(function(n,t){typeof exports=="object"&&typeof module=="object"?module.exports=t((UB(),a_(qB)),(jB(),a_(lye))):typeof define=="function"&&define.amd?define(["tf","Tone"],t):typeof exports=="object"?exports.core=t((UB(),a_(qB)),(jB(),a_(lye))):n.core=t(n.tf,n.Tone)})(self,function(__WEBPACK_EXTERNAL_MODULE__2__,__WEBPACK_EXTERNAL_MODULE__9__){return function(n){var t={};function e(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=n,e.c=t,e.d=function(r,o,s){e.o(r,o)||Object.defineProperty(r,o,{enumerable:!0,get:s})},e.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,o){if(1&o&&(r=e(r)),8&o||4&o&&typeof r=="object"&&r&&r.__esModule)return r;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:r}),2&o&&typeof r!="string")for(var i in r)e.d(s,i,function(a){return r[a]}.bind(null,i));return s},e.n=function(r){var o=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(o,"a",o),o},e.o=function(r,o){return Object.prototype.hasOwnProperty.call(r,o)},e.p="",e(e.s=73)}([,,function(n,t){n.exports=__WEBPACK_EXTERNAL_MODULE__2__},,,,,,function(n,t,e){"use strict";e.r(t),e.d(t,"DEFAULT_QUARTERS_PER_MINUTE",function(){return r}),e.d(t,"DEFAULT_STEPS_PER_BAR",function(){return o}),e.d(t,"DEFAULT_STEPS_PER_QUARTER",function(){return s}),e.d(t,"DEFAULT_STEPS_PER_SECOND",function(){return i}),e.d(t,"DEFAULT_VELOCITY",function(){return a}),e.d(t,"DEFAULT_PROGRAM",function(){return c}),e.d(t,"DEFAULT_TICKS_PER_QUARTER",function(){return l}),e.d(t,"DEFAULT_CHANNEL",function(){return p}),e.d(t,"DRUM_CHANNEL",function(){return f}),e.d(t,"NON_DRUM_CHANNELS",function(){return y}),e.d(t,"DEFAULT_DRUM_PITCH_CLASSES",function(){return d}),e.d(t,"MIN_MIDI_VELOCITY",function(){return h}),e.d(t,"MAX_MIDI_VELOCITY",function(){return m}),e.d(t,"MIDI_VELOCITIES",function(){return x}),e.d(t,"NO_CHORD",function(){return w}),e.d(t,"NUM_PITCH_CLASSES",function(){return _}),e.d(t,"MIN_MIDI_PITCH",function(){return I}),e.d(t,"MAX_MIDI_PITCH",function(){return T}),e.d(t,"MIDI_PITCHES",function(){return D}),e.d(t,"MIN_PIANO_PITCH",function(){return O}),e.d(t,"MAX_PIANO_PITCH",function(){return R}),e.d(t,"MIN_DRUM_PITCH",function(){return P}),e.d(t,"MAX_DRUM_PITCH",function(){return j}),e.d(t,"MIN_MIDI_PROGRAM",function(){return G}),e.d(t,"MAX_MIDI_PROGRAM",function(){return Q}),e.d(t,"LO_CLICK_PITCH",function(){return ie}),e.d(t,"HI_CLICK_PITCH",function(){return pe}),e.d(t,"LO_CLICK_CLASS",function(){return xe}),e.d(t,"HI_CLICK_CLASS",function(){return ne});let r=120,o=16,s=4,i=100,a=80,c=0,l=220,p=0,f=9,y=[0,1,2,3,4,5,6,7,8,10,11,12,13,14,15],d=[[36,35],[38,27,28,31,32,33,34,37,39,40,56,65,66,75,85],[42,44,54,68,69,70,71,73,78,80],[46,67,72,74,79,81],[45,29,41,61,64,84],[48,47,60,63,77,86,87],[50,30,43,62,76,83],[49,55,57,58],[51,52,53,59,82]],h=0,m=127,x=m-h+1,w="N.C.",_=12,I=0,T=127,D=T-I+1,O=21,R=108,P=35,j=81,G=0,Q=127,ie=89,pe=90,xe=9,ne=10},function(n,t){n.exports=__WEBPACK_EXTERNAL_MODULE__9__},function(n,t,e){"use strict";e.d(t,"a",function(){return o});var r=e(35),o=r.tensorflow.magenta.NoteSequence},,function(n,t,e){"use strict";e.r(t),e.d(t,"Level",function(){return r}),e.d(t,"verbosity",function(){return s}),e.d(t,"setVerbosity",function(){return i}),e.d(t,"log",function(){return a}),e.d(t,"logWithDuration",function(){return c});var r,o=e(15);(function(l){l[l.NONE=0]="NONE",l[l.WARN=5]="WARN",l[l.INFO=10]="INFO",l[l.DEBUG=20]="DEBUG"})(r||(r={}));let s=10;function i(l){l=l}function a(l,p="Magenta.js",f=10){if(f===0)throw Error("Logging level cannot be NONE.");s>=f&&(f===5?console.warn:console.log)(`%c ${p} `,"background:magenta; color:white",l)}function c(l,p,f="Magenta.js",y=10){a(`${l} in ${((o.d.now()-p)/1e3).toPrecision(3)}s`,f,y)}},function(n,t,e){"use strict";e.r(t),e.d(t,"MultipleTimeSignatureException",function(){return s}),e.d(t,"BadTimeSignatureException",function(){return i}),e.d(t,"NegativeTimeException",function(){return a}),e.d(t,"MultipleTempoException",function(){return c}),e.d(t,"QuantizationStatusException",function(){return l}),e.d(t,"clone",function(){return p}),e.d(t,"stepsPerQuarterToStepsPerSecond",function(){return f}),e.d(t,"quantizeToStep",function(){return y}),e.d(t,"quantizeNoteSequence",function(){return m}),e.d(t,"isQuantizedSequence",function(){return x}),e.d(t,"assertIsQuantizedSequence",function(){return w}),e.d(t,"isRelativeQuantizedSequence",function(){return _}),e.d(t,"assertIsRelativeQuantizedSequence",function(){return I}),e.d(t,"isAbsoluteQuantizedSequence",function(){return T}),e.d(t,"assertIsAbsoluteQuantizedSequence",function(){return D}),e.d(t,"unquantizeSequence",function(){return O}),e.d(t,"createQuantizedNoteSequence",function(){return R}),e.d(t,"mergeInstruments",function(){return P}),e.d(t,"replaceInstruments",function(){return j}),e.d(t,"mergeConsecutiveNotes",function(){return G}),e.d(t,"applySustainControlChanges",function(){return Q}),e.d(t,"concatenate",function(){return ie}),e.d(t,"trim",function(){return pe}),e.d(t,"split",function(){return fe});var r=e(10),o=e(8);class s extends Error{constructor(se){super(se),Object.setPrototypeOf(this,new.target.prototype)}}class i extends Error{constructor(se){super(se),Object.setPrototypeOf(this,new.target.prototype)}}class a extends Error{constructor(se){super(se),Object.setPrototypeOf(this,new.target.prototype)}}class c extends Error{constructor(se){super(se),Object.setPrototypeOf(this,new.target.prototype)}}class l extends Error{constructor(se){super(se),Object.setPrototypeOf(this,new.target.prototype)}}function p(te){return r.a.decode(r.a.encode(te).finish())}function f(te,se){return te*se/60}function y(te,se,ee=.5){let we=te*se;return Math.floor(we+(1-ee))}function d(te){return te.controlChanges.concat(te.textAnnotations)}function h(te){if(te.tempos&&te.tempos.length!==0){if(te.tempos.sort((se,ee)=>se.time-ee.time),te.tempos[0].time!==0&&te.tempos[0].qpm!==o.DEFAULT_QUARTERS_PER_MINUTE)throw new c("NoteSequence has an implicit tempo change from initial "+o.DEFAULT_QUARTERS_PER_MINUTE+` qpm to ${te.tempos[0].qpm} qpm at ${te.tempos[0].time} seconds.`);for(let se=1;se<te.tempos.length;se++)if(te.tempos[se].qpm!==te.tempos[0].qpm)throw new c(`NoteSequence has at least one tempo change from ${te.tempos[0].qpm} qpm to ${te.tempos[se].qpm}qpm at ${te.tempos[se].time} seconds.`)}}function m(te,se){let ee=p(te);if(ee.quantizationInfo=r.a.QuantizationInfo.create({stepsPerQuarter:se}),ee.timeSignatures.length>0){if(ee.timeSignatures.sort((De,Re)=>De.time-Re.time),ee.timeSignatures[0].time!==0&&(ee.timeSignatures[0].numerator!==4||ee.timeSignatures[0].denominator!==4))throw new s(`NoteSequence has an implicit change from initial 4/4 time signature to ${ee.timeSignatures[0].numerator}/`+ee.timeSignatures[0].denominator+" at "+ee.timeSignatures[0].time+" seconds.");for(let De=1;De<ee.timeSignatures.length;De++){let Re=ee.timeSignatures[De];if(Re.numerator!==ee.timeSignatures[0].numerator||Re.denominator!==ee.timeSignatures[0].denominator)throw new s("NoteSequence has at least one time signature change from "+ee.timeSignatures[0].numerator+"/"+ee.timeSignatures[0].denominator+` to ${Re.numerator}/${Re.denominator} at ${Re.time} seconds`)}ee.timeSignatures[0].time=0,ee.timeSignatures=[ee.timeSignatures[0]]}else{let De=r.a.TimeSignature.create({numerator:4,denominator:4,time:0});ee.timeSignatures.push(De)}let we=ee.timeSignatures[0];if(!(be=we.denominator)||(be&be-1)!=0)throw new i(`Denominator is not a power of 2. Time signature: ${we.numerator}/${we.denominator}`);var be;if(we.numerator===0)throw new i(`Numerator is 0. Time signature: ${we.numerator}/${we.denominator}`);if(ee.tempos.length>0)h(ee),ee.tempos[0].time=0,ee.tempos=[ee.tempos[0]];else{let De=r.a.Tempo.create({qpm:o.DEFAULT_QUARTERS_PER_MINUTE,time:0});ee.tempos.push(De)}let ke=f(se,ee.tempos[0].qpm);return ee.totalQuantizedSteps=y(te.totalTime,ke),function(De,Re){for(let Ce of De.notes){if(Ce.quantizedStartStep=y(Ce.startTime,Re),Ce.quantizedEndStep=y(Ce.endTime,Re),Ce.quantizedEndStep===Ce.quantizedStartStep&&(Ce.quantizedEndStep+=1),Ce.quantizedStartStep<0||Ce.quantizedEndStep<0)throw new a("Got negative note time: start_step = "+Ce.quantizedStartStep+", end_step = "+Ce.quantizedEndStep);Ce.quantizedEndStep>De.totalQuantizedSteps&&(De.totalQuantizedSteps=Ce.quantizedEndStep)}d(De).forEach(Ce=>{if(Ce.quantizedStep=y(Ce.time,Re),Ce.quantizedStep<0)throw new a("Got negative event time: step = "+Ce.quantizedStep)})}(ee,ke),ee}function x(te){return te.quantizationInfo&&(te.quantizationInfo.stepsPerQuarter>0||te.quantizationInfo.stepsPerSecond>0)}function w(te){if(!x(te))throw new l(`NoteSequence ${te.id} is not quantized (missing quantizationInfo)`)}function _(te){return te.quantizationInfo&&te.quantizationInfo.stepsPerQuarter>0}function I(te){if(!_(te))throw new l(`NoteSequence ${te.id} is not quantized or is quantized based on absolute timing`)}function T(te){return te.quantizationInfo&&te.quantizationInfo.stepsPerSecond>0}function D(te){if(!T(te))throw new l(`NoteSequence ${te.id} is not quantized or is quantized based on relative timing`)}function O(te,se){I(te),h(te);let ee=p(te);se?ee.tempos&&ee.tempos.length>0?ee.tempos[0].qpm=se:ee.tempos.push(r.a.Tempo.create({time:0,qpm:se})):se=te.tempos&&te.tempos.length>0?ee.tempos[0].qpm:o.DEFAULT_QUARTERS_PER_MINUTE;let we=be=>be/ee.quantizationInfo.stepsPerQuarter*(60/se);return ee.totalTime=we(ee.totalQuantizedSteps),ee.notes.forEach(be=>{be.startTime=we(be.quantizedStartStep),be.endTime=we(be.quantizedEndStep),ee.totalTime=Math.max(ee.totalTime,be.endTime),delete be.quantizedStartStep,delete be.quantizedEndStep}),d(ee).forEach(be=>{be.time=we(be.time)}),delete ee.totalQuantizedSteps,delete ee.quantizationInfo,ee}function R(te=o.DEFAULT_STEPS_PER_QUARTER,se=o.DEFAULT_QUARTERS_PER_MINUTE){return r.a.create({quantizationInfo:{stepsPerQuarter:te},tempos:[{qpm:se}]})}function P(te){let se=p(te),ee=se.notes.concat(se.pitchBends).concat(se.controlChanges),we=Array.from(new Set(ee.filter(be=>!be.isDrum).map(be=>be.program)));return ee.forEach(be=>{be.isDrum?(be.program=0,be.instrument=we.length):be.instrument=we.indexOf(be.program)}),se}function j(te,se){let ee=new Set(te.notes.map(De=>De.instrument)),we=new Set(se.notes.map(De=>De.instrument)),be=[];te.notes.forEach(De=>{we.has(De.instrument)||be.push(r.a.Note.create(De))}),se.notes.forEach(De=>{ee.has(De.instrument)&&be.push(r.a.Note.create(De))});let ke=p(te);return ke.notes=be.sort((De,Re)=>De.instrument-Re.instrument||De.quantizedStartStep-Re.quantizedStartStep),ke}function G(te){w(te);let se=p(te);se.notes=[];let ee=te.notes.sort((ke,De)=>ke.instrument-De.instrument||ke.quantizedStartStep-De.quantizedStartStep),we=new r.a.Note;we.pitch=ee[0].pitch,we.instrument=ee[0].instrument,we.quantizedStartStep=ee[0].quantizedStartStep,we.quantizedEndStep=ee[0].quantizedEndStep,se.notes.push(we);let be=0;for(let ke=1;ke<ee.length;ke++){let De=ee[ke],Re=se.notes[be];if(Re.instrument===De.instrument&&Re.pitch===De.pitch&&De.quantizedStartStep===Re.quantizedEndStep&&De.quantizedStartStep%16!=0)se.notes[be].quantizedEndStep+=De.quantizedEndStep-De.quantizedStartStep;else{let Ce=new r.a.Note;Ce.pitch=ee[ke].pitch,Ce.instrument=ee[ke].instrument,Ce.quantizedStartStep=ee[ke].quantizedStartStep,Ce.quantizedEndStep=ee[ke].quantizedEndStep,se.notes.push(Ce),be++}}return se}function Q(te,se=64){let ee;if(function(Ce){Ce[Ce.SUSTAIN_ON=0]="SUSTAIN_ON",Ce[Ce.SUSTAIN_OFF=1]="SUSTAIN_OFF",Ce[Ce.NOTE_ON=2]="NOTE_ON",Ce[Ce.NOTE_OFF=3]="NOTE_OFF"}(ee||(ee={})),x(te))throw new Error("Can only apply sustain to unquantized NoteSequence.");let we=p(te),be=[];for(let Ce of we.notes)Ce.isDrum===!1&&(Ce.startTime!==null&&be.push({time:Ce.startTime,type:ee.NOTE_ON,event:Ce}),Ce.endTime!==null&&be.push({time:Ce.endTime,type:ee.NOTE_OFF,event:Ce}));for(let Ce of we.controlChanges)if(Ce.controlNumber===se){let Je=Ce.controlValue;Je>=64?be.push({time:Ce.time,type:ee.SUSTAIN_ON,event:Ce}):Je<64&&be.push({time:Ce.time,type:ee.SUSTAIN_OFF,event:Ce})}be.sort((Ce,Je)=>Ce.time-Je.time);let ke={},De={},Re=0;for(let Ce of be){Re=Ce.time;let Je=Ce.type,rt=Ce.event;if(Je===ee.SUSTAIN_ON)De[rt.instrument]=!0;else if(Je===ee.SUSTAIN_OFF){De[rt.instrument]=!1;let qe=[];rt.instrument in ke||(ke[rt.instrument]=[]);for(let B of ke[rt.instrument])B.endTime<Re?(B.endTime=Re,Re>we.totalTime&&(we.totalTime=Re)):qe.push(B);ke[rt.instrument]=qe}else if(Je===ee.NOTE_ON){if(De[rt.instrument]===!0){let qe=[];rt.instrument in ke||(ke[rt.instrument]=[]);for(let B of ke[rt.instrument])B.pitch===rt.pitch?(B.endTime=Re,B.startTime===B.endTime&&we.notes.push(B)):qe.push(B);ke[rt.instrument]=qe}rt.instrument in ke||(ke[rt.instrument]=[]),ke[rt.instrument].push(rt)}else if(Je===ee.NOTE_OFF&&De[rt.instrument]!==!0){let qe=ke[rt.instrument].indexOf(rt);qe>-1&&ke[rt.instrument].splice(qe,1)}}for(let Ce of Object.values(ke))for(let Je of Ce)Je.endTime=Re,we.totalTime=Re;return we}function ie(te,se){if(se&&se.length!==te.length)throw new Error(`Number of sequences to concatenate and their individual
 durations does not match.`);if(x(te[0])){for(let ee=0;ee<te.length;++ee)if(w(te[ee]),te[ee].quantizationInfo.stepsPerQuarter!==te[0].quantizationInfo.stepsPerQuarter)throw new Error("Not all sequences have the same quantizationInfo");return xe(te,"totalQuantizedSteps","quantizedStartStep","quantizedEndStep",se)}return xe(te,"totalTime","startTime","endTime",se)}function pe(te,se,ee,we){return x(te)?ne(te,se,ee,"totalQuantizedSteps","quantizedStartStep","quantizedEndStep",we):ne(te,se,ee,"totalTime","startTime","endTime",we)}function xe(te,se,ee,we,be){let ke,De=0;for(let Re=0;Re<te.length;++Re){let Ce=be?be[Re]:te[Re][se];if(Ce===0)throw Error(`Sequence ${te[Re].id} has no ${se}, and no individual duration was provided.`);Re===0?ke=p(te[0]):Array.prototype.push.apply(ke.notes,te[Re].notes.map(Je=>{let rt=r.a.Note.create(Je);return rt[ee]+=De,rt[we]+=De,rt})),De+=Ce}return ke[se]=De,ke}function ne(te,se,ee,we,be,ke,De){let Re=p(te);Re[we]=ee,Re.notes=Re.notes.filter(Ce=>Ce[be]>=se&&Ce[be]<=ee&&(De||Ce[ke]<=ee)),Re[we]-=se;for(let Ce=0;Ce<Re.notes.length;Ce++)Re.notes[Ce][be]-=se,Re.notes[Ce][ke]-=se,De&&(Re.notes[Ce][ke]=Math.min(Re.notes[Ce][ke],Re[we]));return Re}function fe(te,se){w(te);let ee=p(te),we=ee.notes.sort((Re,Ce)=>Re.quantizedStartStep-Ce.quantizedStartStep),be=[],ke=0,De=[];for(let Re=0;Re<we.length;Re++){let Ce=we[Re],Je=Ce.quantizedStartStep,rt=Ce.quantizedEndStep;if(Ce.quantizedStartStep-=ke,Ce.quantizedEndStep-=ke,!(Ce.quantizedStartStep<0))if(Ce.quantizedEndStep<=se)De.push(Ce);else{if(Ce.quantizedStartStep<se){let qe=r.a.Note.create(Ce);qe.quantizedEndStep=se,qe.startTime=qe.endTime=void 0,De.push(qe),Ce.quantizedStartStep=ke+se,Ce.quantizedEndStep=rt}else Ce.quantizedStartStep=Je,Ce.quantizedEndStep=rt;if((Ce.quantizedEndStep>se||Ce.quantizedStartStep>se)&&(Re-=1),De.length!==0){let qe=p(ee);qe.notes=De,qe.totalQuantizedSteps=se,be.push(qe)}De=[],ke+=se}}if(De.length!==0){let Re=p(ee);Re.notes=De,Re.totalQuantizedSteps=se,be.push(Re)}return be}},,function(n,t,e){"use strict";(function(r){e.d(t,"a",function(){return s}),e.d(t,"d",function(){return i}),e.d(t,"c",function(){return a}),e.d(t,"b",function(){return l});let o=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(r!==void 0)return r;throw new Error("cannot find the global object")}(),s=o.fetch.bind(o),i=o.performance,a=(o.navigator,!!o.webkitOfflineAudioContext),c=o.WorkerGlobalScope!==void 0;function l(p){if(p=a?44100:p,c)throw new Error("Cannot use offline audio context in a web worker.");let f=o.webkitOfflineAudioContext;return a?new f(1,p,p):new o.OfflineAudioContext(1,p,p)}}).call(this,e(21))},,,function(n,t,e){"use strict";(function(r){var o=t;function s(a,c,l){for(var p=Object.keys(c),f=0;f<p.length;++f)a[p[f]]!==void 0&&l||(a[p[f]]=c[p[f]]);return a}function i(a){function c(l,p){if(!(this instanceof c))return new c(l,p);Object.defineProperty(this,"message",{get:function(){return l}}),Error.captureStackTrace?Error.captureStackTrace(this,c):Object.defineProperty(this,"stack",{value:new Error().stack||""}),p&&s(this,p)}return(c.prototype=Object.create(Error.prototype)).constructor=c,Object.defineProperty(c.prototype,"name",{get:function(){return a}}),c.prototype.toString=function(){return this.name+": "+this.message},c}o.asPromise=e(51),o.base64=e(52),o.EventEmitter=e(53),o.float=e(54),o.inquire=e(55),o.utf8=e(56),o.pool=e(57),o.LongBits=e(58),o.isNode=!!(r!==void 0&&r&&r.process&&r.process.versions&&r.process.versions.node),o.global=o.isNode&&r||typeof window<"u"&&window||typeof self<"u"&&self||this,o.emptyArray=Object.freeze?Object.freeze([]):[],o.emptyObject=Object.freeze?Object.freeze({}):{},o.isInteger=Number.isInteger||function(a){return typeof a=="number"&&isFinite(a)&&Math.floor(a)===a},o.isString=function(a){return typeof a=="string"||a instanceof String},o.isObject=function(a){return a&&typeof a=="object"},o.isset=o.isSet=function(a,c){var l=a[c];return!(l==null||!a.hasOwnProperty(c))&&(typeof l!="object"||(Array.isArray(l)?l.length:Object.keys(l).length)>0)},o.Buffer=function(){try{var a=o.inquire("buffer").Buffer;return a.prototype.utf8Write?a:null}catch{return null}}(),o._Buffer_from=null,o._Buffer_allocUnsafe=null,o.newBuffer=function(a){return typeof a=="number"?o.Buffer?o._Buffer_allocUnsafe(a):new o.Array(a):o.Buffer?o._Buffer_from(a):typeof Uint8Array>"u"?a:new Uint8Array(a)},o.Array=typeof Uint8Array<"u"?Uint8Array:Array,o.Long=o.global.dcodeIO&&o.global.dcodeIO.Long||o.global.Long||o.inquire("long"),o.key2Re=/^true|false|0|1$/,o.key32Re=/^-?(?:0|[1-9][0-9]*)$/,o.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,o.longToHash=function(a){return a?o.LongBits.from(a).toHash():o.LongBits.zeroHash},o.longFromHash=function(a,c){var l=o.LongBits.fromHash(a);return o.Long?o.Long.fromBits(l.lo,l.hi,c):l.toNumber(!!c)},o.merge=s,o.lcFirst=function(a){return a.charAt(0).toLowerCase()+a.substring(1)},o.newError=i,o.ProtocolError=i("ProtocolError"),o.oneOfGetter=function(a){for(var c={},l=0;l<a.length;++l)c[a[l]]=1;return function(){for(var p=Object.keys(this),f=p.length-1;f>-1;--f)if(c[p[f]]===1&&this[p[f]]!==void 0&&this[p[f]]!==null)return p[f]}},o.oneOfSetter=function(a){return function(c){for(var l=0;l<a.length;++l)a[l]!==c&&delete this[a[l]]}},o.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},o._configure=function(){var a=o.Buffer;a?(o._Buffer_from=a.from!==Uint8Array.from&&a.from||function(c,l){return new a(c,l)},o._Buffer_allocUnsafe=a.allocUnsafe||function(c){return new a(c)}):o._Buffer_from=o._Buffer_allocUnsafe=null}}).call(this,e(21))},,,function(n,t){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch{typeof window=="object"&&(e=window)}n.exports=e},,function(n,t,e){"use strict";e.r(t),e.d(t,"NO_EVENT",function(){return i}),e.d(t,"NOTE_OFF",function(){return a}),e.d(t,"Melody",function(){return c}),e.d(t,"MelodyRhythm",function(){return l}),e.d(t,"MelodyShape",function(){return p}),e.d(t,"MelodyRegister",function(){return f});var r=e(2),o=e(10),s=e(13);let i=0,a=1;class c{constructor(d,h,m){this.events=d,this.minPitch=h,this.maxPitch=m}static fromNoteSequence(d,h,m,x=!0,w){s.assertIsQuantizedSequence(d);let _=d.notes.sort((D,O)=>D.quantizedStartStep===O.quantizedStartStep?O.pitch-D.pitch:D.quantizedStartStep-O.quantizedStartStep),I=new Int32Array(w||d.totalQuantizedSteps),T=-1;return _.forEach(D=>{if(D.quantizedStartStep===T){if(x)return;throw new Error("`NoteSequence` is not monophonic.")}if(D.pitch<h||D.pitch>m)throw Error("`NoteSequence` has a pitch outside of the valid range: "+D.pitch);I[D.quantizedStartStep]=D.pitch-h+2,I[D.quantizedEndStep]=a,T=D.quantizedStartStep}),new c(I,h,m)}toNoteSequence(d,h){let m=s.createQuantizedNoteSequence(d,h),x=null;for(let w=0;w<this.events.length;++w){let _=this.events[w];switch(_){case i:break;case a:x&&(x.quantizedEndStep=w,m.notes.push(x),x=null);break;default:x&&(x.quantizedEndStep=w,m.notes.push(x)),x=o.a.Note.create({pitch:_-2+this.minPitch,quantizedStartStep:w})}}return x&&(x.quantizedEndStep=this.events.length,m.notes.push(x)),m.totalQuantizedSteps=this.events.length,m}}class l{constructor(){this.depth=1}extract(d){let h=d.events.length,m=r.buffer([h,1]);for(let x=0;x<h;++x)m.set(d.events[x]>=2?1:0,x,0);return m.toTensor().as2D(h,1)}}class p{constructor(){this.depth=3}extract(d){let h=d.events.length,m=r.buffer([h,3]),x=null,w=null;for(let _=0;_<h;++_)if(d.events[_]>=2){if(x!==null){let I;m.get(x,0)===0&&m.get(x,1)===0&&m.get(x,2)===0&&(x=-1),I=d.events[_]<w?0:d.events[_]>w?2:1;for(let T=_;T>x;--T)m.set(1,T,I)}x=_,w=d.events[_]}if(x!==h-1)if(x===null||m.get(x,0)===0&&m.get(x,1)===0&&m.get(x,2)===0)for(let _=0;_<h;++_)m.set(1,_,1);else for(let _=h-1;_>x;--_)for(let I=0;I<3;I++)m.set(m.get(x,I),_,I);return m.toTensor().as2D(h,3)}}class f{constructor(d){this.boundaryPitches=d,this.depth=d.length+1}meanMelodyPitch(d){let h=0,m=0,x=null;for(let w=0;w<d.events.length;++w)d.events[w]===a?x=null:d.events[w]>=2&&(x=d.minPitch+d.events[w]-2),x!==null&&(h+=x,m+=1);return m?h/m:null}extract(d){let h=d.events.length,m=this.meanMelodyPitch(d);if(m===null)return r.zeros([h,this.depth]);let x=0;for(;x<this.boundaryPitches.length&&m>=this.boundaryPitches[x];)x++;let w=r.buffer([h,this.depth]);for(let _=0;_<h;++_)w.set(1,_,x);return w.toTensor().as2D(h,this.depth)}}},,,,,,function(n,t,e){"use strict";e.r(t),e.d(t,"Performance",function(){return a});var r=e(10),o=e(8),s=e(13),i=e(12);class a{constructor(l,p,f,y,d){this.events=l,this.maxShiftSteps=p,this.numVelocityBins=f,this.program=y,this.isDrum=d}static fromNoteSequence(l,p,f,y){s.assertIsQuantizedSequence(l);let d=l.notes.filter((G,Q)=>y===void 0||G.instrument===y),h=d.sort((G,Q)=>G.startTime===Q.startTime?G.pitch-Q.pitch:G.startTime-Q.startTime),m=h.map((G,Q)=>({step:G.quantizedStartStep,index:Q,isOffset:0})),x=h.map((G,Q)=>({step:G.quantizedEndStep,index:Q,isOffset:1})),w=m.concat(x).sort((G,Q)=>G.step===Q.step?G.index===Q.index?G.isOffset-Q.isOffset:G.index-Q.index:G.step-Q.step),_=f?Math.ceil((o.MIDI_VELOCITIES-1)/f):void 0,I=[],T=0,D=f;for(let G of w){if(G.step>T){for(;G.step>T+p;)I.push({type:"time-shift",steps:p}),T+=p;I.push({type:"time-shift",steps:G.step-T}),T=G.step}if(G.isOffset)I.push({type:"note-off",pitch:h[G.index].pitch});else{if(_){let Q=Math.floor((h[G.index].velocity-o.MIN_MIDI_VELOCITY-1)/_)+1;Q!==D&&(I.push({type:"velocity-change",velocityBin:Q}),D=Q)}I.push({type:"note-on",pitch:h[G.index].pitch})}}let O=!!d.some(G=>G.isDrum)&&(!d.some(G=>!G.isDrum)||void 0),R=Array.from(new Set(d.map(G=>G.program))),P=O||R.length!==1?void 0:R[0],j=new a(I,p,f,P,O);return j.setNumSteps(l.totalQuantizedSteps),j}getNumSteps(){return this.events.filter(l=>l.type==="time-shift").map(l=>l.steps).reduce((l,p)=>l+p,0)}setNumSteps(l){let p=this.getNumSteps();if(p<l){if(this.events.length){let f=this.events[this.events.length-1];if(f.type==="time-shift"){let y=Math.min(l-p,this.maxShiftSteps-f.steps);f.steps+=y,p+=y}}for(;p<l;)p+this.maxShiftSteps>l?(this.events.push({type:"time-shift",steps:l-p}),p=l):(this.events.push({type:"time-shift",steps:this.maxShiftSteps}),p+=this.maxShiftSteps)}else if(p>l)for(;this.events.length&&p>l;){let f=this.events[this.events.length-1];f.type==="time-shift"?p-f.steps<l?(f.steps-=p-l,p=l):(this.events.pop(),p-=f.steps):this.events.pop()}}toNoteSequence(l){let p=this.numVelocityBins?Math.ceil((o.MIDI_VELOCITIES-1)/this.numVelocityBins):void 0,f=r.a.create(),y=0,d,h=new Map;for(let m=o.MIN_MIDI_PITCH;m<=o.MAX_MIDI_PITCH;++m)h.set(m,[]);for(let m of this.events)switch(m.type){case"note-on":h.get(m.pitch).push([y,d]);break;case"note-off":let x=h.get(m.pitch);if(x.length){let[w,_]=x.shift();y>w?f.notes.push(r.a.Note.create({pitch:m.pitch,velocity:_,instrument:l,quantizedStartStep:w,quantizedEndStep:y,program:this.program,isDrum:this.isDrum})):i.log(`Ignoring zero-length note: (pitch = ${m.pitch}, step = ${y})`,"Performance")}else i.log(`Ignoring note-off with no previous note-on:(pitch = ${m.pitch}, step = ${y})`,"Performance");break;case"time-shift":y+=m.steps;break;case"velocity-change":if(!p)throw new Error("Unexpected velocity change event: "+m);d=o.MIN_MIDI_VELOCITY+(m.velocityBin-1)*p+1;break;default:throw new Error("Unrecognized performance event: "+m)}return h.forEach((m,x)=>{for(let[w,_]of m)y>w?f.notes.push(r.a.Note.create({pitch:x,velocity:_,instrument:l,quantizedStartStep:w,quantizedEndStep:y,program:this.program,isDrum:this.isDrum})):i.log(`Ignoring zero-length note: (pitch = ${x}, step = ${y})`,"Performance")}),f.totalQuantizedSteps=y,f}}},,,,function(n,t,e){"use strict";n.exports=f;var r,o=e(18),s=o.LongBits,i=o.base64,a=o.utf8;function c(_,I,T){this.fn=_,this.len=I,this.next=void 0,this.val=T}function l(){}function p(_){this.head=_.head,this.tail=_.tail,this.len=_.len,this.next=_.states}function f(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}var y=function(){return o.Buffer?function(){return(f.create=function(){return new r})()}:function(){return new f}};function d(_,I,T){I[T]=255&_}function h(_,I){this.len=_,this.next=void 0,this.val=I}function m(_,I,T){for(;_.hi;)I[T++]=127&_.lo|128,_.lo=(_.lo>>>7|_.hi<<25)>>>0,_.hi>>>=7;for(;_.lo>127;)I[T++]=127&_.lo|128,_.lo=_.lo>>>7;I[T++]=_.lo}function x(_,I,T){I[T]=255&_,I[T+1]=_>>>8&255,I[T+2]=_>>>16&255,I[T+3]=_>>>24}f.create=y(),f.alloc=function(_){return new o.Array(_)},o.Array!==Array&&(f.alloc=o.pool(f.alloc,o.Array.prototype.subarray)),f.prototype._push=function(_,I,T){return this.tail=this.tail.next=new c(_,I,T),this.len+=I,this},h.prototype=Object.create(c.prototype),h.prototype.fn=function(_,I,T){for(;_>127;)I[T++]=127&_|128,_>>>=7;I[T]=_},f.prototype.uint32=function(_){return this.len+=(this.tail=this.tail.next=new h((_>>>=0)<128?1:_<16384?2:_<2097152?3:_<268435456?4:5,_)).len,this},f.prototype.int32=function(_){return _<0?this._push(m,10,s.fromNumber(_)):this.uint32(_)},f.prototype.sint32=function(_){return this.uint32((_<<1^_>>31)>>>0)},f.prototype.uint64=function(_){var I=s.from(_);return this._push(m,I.length(),I)},f.prototype.int64=f.prototype.uint64,f.prototype.sint64=function(_){var I=s.from(_).zzEncode();return this._push(m,I.length(),I)},f.prototype.bool=function(_){return this._push(d,1,_?1:0)},f.prototype.fixed32=function(_){return this._push(x,4,_>>>0)},f.prototype.sfixed32=f.prototype.fixed32,f.prototype.fixed64=function(_){var I=s.from(_);return this._push(x,4,I.lo)._push(x,4,I.hi)},f.prototype.sfixed64=f.prototype.fixed64,f.prototype.float=function(_){return this._push(o.float.writeFloatLE,4,_)},f.prototype.double=function(_){return this._push(o.float.writeDoubleLE,8,_)};var w=o.Array.prototype.set?function(_,I,T){I.set(_,T)}:function(_,I,T){for(var D=0;D<_.length;++D)I[T+D]=_[D]};f.prototype.bytes=function(_){var I=_.length>>>0;if(!I)return this._push(d,1,0);if(o.isString(_)){var T=f.alloc(I=i.length(_));i.decode(_,T,0),_=T}return this.uint32(I)._push(w,I,_)},f.prototype.string=function(_){var I=a.length(_);return I?this.uint32(I)._push(a.write,I,_):this._push(d,1,0)},f.prototype.fork=function(){return this.states=new p(this),this.head=this.tail=new c(l,0,0),this.len=0,this},f.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},f.prototype.ldelim=function(){var _=this.head,I=this.tail,T=this.len;return this.reset().uint32(T),T&&(this.tail.next=_.next,this.tail=I,this.len+=T),this},f.prototype.finish=function(){for(var _=this.head.next,I=this.constructor.alloc(this.len),T=0;_;)_.fn(_.val,I,T),T+=_.len,_=_.next;return I},f._configure=function(_){r=_,f.create=y(),r._configure()}},function(n,t,e){"use strict";n.exports=c;var r,o=e(18),s=o.LongBits,i=o.utf8;function a(m,x){return RangeError("index out of range: "+m.pos+" + "+(x||1)+" > "+m.len)}function c(m){this.buf=m,this.pos=0,this.len=m.length}var l,p=typeof Uint8Array<"u"?function(m){if(m instanceof Uint8Array||Array.isArray(m))return new c(m);throw Error("illegal buffer")}:function(m){if(Array.isArray(m))return new c(m);throw Error("illegal buffer")},f=function(){return o.Buffer?function(m){return(c.create=function(x){return o.Buffer.isBuffer(x)?new r(x):p(x)})(m)}:p};function y(){var m=new s(0,0),x=0;if(!(this.len-this.pos>4)){for(;x<3;++x){if(this.pos>=this.len)throw a(this);if(m.lo=(m.lo|(127&this.buf[this.pos])<<7*x)>>>0,this.buf[this.pos++]<128)return m}return m.lo=(m.lo|(127&this.buf[this.pos++])<<7*x)>>>0,m}for(;x<4;++x)if(m.lo=(m.lo|(127&this.buf[this.pos])<<7*x)>>>0,this.buf[this.pos++]<128)return m;if(m.lo=(m.lo|(127&this.buf[this.pos])<<28)>>>0,m.hi=(m.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return m;if(x=0,this.len-this.pos>4){for(;x<5;++x)if(m.hi=(m.hi|(127&this.buf[this.pos])<<7*x+3)>>>0,this.buf[this.pos++]<128)return m}else for(;x<5;++x){if(this.pos>=this.len)throw a(this);if(m.hi=(m.hi|(127&this.buf[this.pos])<<7*x+3)>>>0,this.buf[this.pos++]<128)return m}throw Error("invalid varint encoding")}function d(m,x){return(m[x-4]|m[x-3]<<8|m[x-2]<<16|m[x-1]<<24)>>>0}function h(){if(this.pos+8>this.len)throw a(this,8);return new s(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}c.create=f(),c.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,c.prototype.uint32=(l=4294967295,function(){if(l=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(l=(l|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(l=(l|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(l=(l|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(l=(l|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return l;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return l}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var m=this.uint32();return m>>>1^-(1&m)|0},c.prototype.bool=function(){return this.uint32()!==0},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return d(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|d(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var m=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,m},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var m=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,m},c.prototype.bytes=function(){var m=this.uint32(),x=this.pos,w=this.pos+m;if(w>this.len)throw a(this,m);return this.pos+=m,Array.isArray(this.buf)?this.buf.slice(x,w):x===w?new this.buf.constructor(0):this._slice.call(this.buf,x,w)},c.prototype.string=function(){var m=this.bytes();return i.read(m,0,m.length)},c.prototype.skip=function(m){if(typeof m=="number"){if(this.pos+m>this.len)throw a(this,m);this.pos+=m}else do if(this.pos>=this.len)throw a(this);while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(m){switch(m){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(m=7&this.uint32())!=4;)this.skipType(m);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+m+" at offset "+this.pos)}return this},c._configure=function(m){r=m,c.create=f(),r._configure();var x=o.Long?"toLong":"toNumber";o.merge(c.prototype,{int64:function(){return y.call(this)[x](!1)},uint64:function(){return y.call(this)[x](!0)},sint64:function(){return y.call(this).zzDecode()[x](!1)},fixed64:function(){return h.call(this)[x](!0)},sfixed64:function(){return h.call(this)[x](!1)}})}},function(n,t,e){"use strict";var r,o,s=e(49),i=s.Reader,a=s.Writer,c=s.util,l=s.roots.default||(s.roots.default={});l.tensorflow=((o={}).magenta=((r={}).NoteSequence=function(){function p(d){if(this.timeSignatures=[],this.keySignatures=[],this.tempos=[],this.notes=[],this.pitchBends=[],this.controlChanges=[],this.partInfos=[],this.textAnnotations=[],this.sectionAnnotations=[],this.sectionGroups=[],d)for(var h=Object.keys(d),m=0;m<h.length;++m)d[h[m]]!=null&&(this[h[m]]=d[h[m]])}var f,y;return p.prototype.id="",p.prototype.filename="",p.prototype.referenceNumber=c.Long?c.Long.fromBits(0,0,!1):0,p.prototype.collectionName="",p.prototype.ticksPerQuarter=0,p.prototype.timeSignatures=c.emptyArray,p.prototype.keySignatures=c.emptyArray,p.prototype.tempos=c.emptyArray,p.prototype.notes=c.emptyArray,p.prototype.totalTime=0,p.prototype.totalQuantizedSteps=c.Long?c.Long.fromBits(0,0,!1):0,p.prototype.pitchBends=c.emptyArray,p.prototype.controlChanges=c.emptyArray,p.prototype.partInfos=c.emptyArray,p.prototype.sourceInfo=null,p.prototype.textAnnotations=c.emptyArray,p.prototype.sectionAnnotations=c.emptyArray,p.prototype.sectionGroups=c.emptyArray,p.prototype.quantizationInfo=null,p.prototype.subsequenceInfo=null,p.prototype.sequenceMetadata=null,p.create=function(d){return new p(d)},p.encode=function(d,h){if(h||(h=a.create()),d.id!=null&&d.hasOwnProperty("id")&&h.uint32(10).string(d.id),d.filename!=null&&d.hasOwnProperty("filename")&&h.uint32(18).string(d.filename),d.collectionName!=null&&d.hasOwnProperty("collectionName")&&h.uint32(26).string(d.collectionName),d.ticksPerQuarter!=null&&d.hasOwnProperty("ticksPerQuarter")&&h.uint32(32).int32(d.ticksPerQuarter),d.timeSignatures!=null&&d.timeSignatures.length)for(var m=0;m<d.timeSignatures.length;++m)l.tensorflow.magenta.NoteSequence.TimeSignature.encode(d.timeSignatures[m],h.uint32(42).fork()).ldelim();if(d.keySignatures!=null&&d.keySignatures.length)for(m=0;m<d.keySignatures.length;++m)l.tensorflow.magenta.NoteSequence.KeySignature.encode(d.keySignatures[m],h.uint32(50).fork()).ldelim();if(d.tempos!=null&&d.tempos.length)for(m=0;m<d.tempos.length;++m)l.tensorflow.magenta.NoteSequence.Tempo.encode(d.tempos[m],h.uint32(58).fork()).ldelim();if(d.notes!=null&&d.notes.length)for(m=0;m<d.notes.length;++m)l.tensorflow.magenta.NoteSequence.Note.encode(d.notes[m],h.uint32(66).fork()).ldelim();if(d.totalTime!=null&&d.hasOwnProperty("totalTime")&&h.uint32(73).double(d.totalTime),d.pitchBends!=null&&d.pitchBends.length)for(m=0;m<d.pitchBends.length;++m)l.tensorflow.magenta.NoteSequence.PitchBend.encode(d.pitchBends[m],h.uint32(82).fork()).ldelim();if(d.controlChanges!=null&&d.controlChanges.length)for(m=0;m<d.controlChanges.length;++m)l.tensorflow.magenta.NoteSequence.ControlChange.encode(d.controlChanges[m],h.uint32(90).fork()).ldelim();if(d.partInfos!=null&&d.partInfos.length)for(m=0;m<d.partInfos.length;++m)l.tensorflow.magenta.NoteSequence.PartInfo.encode(d.partInfos[m],h.uint32(98).fork()).ldelim();if(d.sourceInfo!=null&&d.hasOwnProperty("sourceInfo")&&l.tensorflow.magenta.NoteSequence.SourceInfo.encode(d.sourceInfo,h.uint32(106).fork()).ldelim(),d.textAnnotations!=null&&d.textAnnotations.length)for(m=0;m<d.textAnnotations.length;++m)l.tensorflow.magenta.NoteSequence.TextAnnotation.encode(d.textAnnotations[m],h.uint32(114).fork()).ldelim();if(d.quantizationInfo!=null&&d.hasOwnProperty("quantizationInfo")&&l.tensorflow.magenta.NoteSequence.QuantizationInfo.encode(d.quantizationInfo,h.uint32(122).fork()).ldelim(),d.totalQuantizedSteps!=null&&d.hasOwnProperty("totalQuantizedSteps")&&h.uint32(128).int64(d.totalQuantizedSteps),d.subsequenceInfo!=null&&d.hasOwnProperty("subsequenceInfo")&&l.tensorflow.magenta.NoteSequence.SubsequenceInfo.encode(d.subsequenceInfo,h.uint32(138).fork()).ldelim(),d.referenceNumber!=null&&d.hasOwnProperty("referenceNumber")&&h.uint32(144).int64(d.referenceNumber),d.sequenceMetadata!=null&&d.hasOwnProperty("sequenceMetadata")&&l.tensorflow.magenta.SequenceMetadata.encode(d.sequenceMetadata,h.uint32(154).fork()).ldelim(),d.sectionAnnotations!=null&&d.sectionAnnotations.length)for(m=0;m<d.sectionAnnotations.length;++m)l.tensorflow.magenta.NoteSequence.SectionAnnotation.encode(d.sectionAnnotations[m],h.uint32(162).fork()).ldelim();if(d.sectionGroups!=null&&d.sectionGroups.length)for(m=0;m<d.sectionGroups.length;++m)l.tensorflow.magenta.NoteSequence.SectionGroup.encode(d.sectionGroups[m],h.uint32(170).fork()).ldelim();return h},p.encodeDelimited=function(d,h){return this.encode(d,h).ldelim()},p.decode=function(d,h){d instanceof i||(d=i.create(d));for(var m=h===void 0?d.len:d.pos+h,x=new l.tensorflow.magenta.NoteSequence;d.pos<m;){var w=d.uint32();switch(w>>>3){case 1:x.id=d.string();break;case 2:x.filename=d.string();break;case 18:x.referenceNumber=c.Long?d.int64().toNumber():d.int64();break;case 3:x.collectionName=d.string();break;case 4:x.ticksPerQuarter=d.int32();break;case 5:x.timeSignatures&&x.timeSignatures.length||(x.timeSignatures=[]),x.timeSignatures.push(l.tensorflow.magenta.NoteSequence.TimeSignature.decode(d,d.uint32()));break;case 6:x.keySignatures&&x.keySignatures.length||(x.keySignatures=[]),x.keySignatures.push(l.tensorflow.magenta.NoteSequence.KeySignature.decode(d,d.uint32()));break;case 7:x.tempos&&x.tempos.length||(x.tempos=[]),x.tempos.push(l.tensorflow.magenta.NoteSequence.Tempo.decode(d,d.uint32()));break;case 8:x.notes&&x.notes.length||(x.notes=[]),x.notes.push(l.tensorflow.magenta.NoteSequence.Note.decode(d,d.uint32()));break;case 9:x.totalTime=d.double();break;case 16:x.totalQuantizedSteps=c.Long?d.int64().toNumber():d.int64();break;case 10:x.pitchBends&&x.pitchBends.length||(x.pitchBends=[]),x.pitchBends.push(l.tensorflow.magenta.NoteSequence.PitchBend.decode(d,d.uint32()));break;case 11:x.controlChanges&&x.controlChanges.length||(x.controlChanges=[]),x.controlChanges.push(l.tensorflow.magenta.NoteSequence.ControlChange.decode(d,d.uint32()));break;case 12:x.partInfos&&x.partInfos.length||(x.partInfos=[]),x.partInfos.push(l.tensorflow.magenta.NoteSequence.PartInfo.decode(d,d.uint32()));break;case 13:x.sourceInfo=l.tensorflow.magenta.NoteSequence.SourceInfo.decode(d,d.uint32());break;case 14:x.textAnnotations&&x.textAnnotations.length||(x.textAnnotations=[]),x.textAnnotations.push(l.tensorflow.magenta.NoteSequence.TextAnnotation.decode(d,d.uint32()));break;case 20:x.sectionAnnotations&&x.sectionAnnotations.length||(x.sectionAnnotations=[]),x.sectionAnnotations.push(l.tensorflow.magenta.NoteSequence.SectionAnnotation.decode(d,d.uint32()));break;case 21:x.sectionGroups&&x.sectionGroups.length||(x.sectionGroups=[]),x.sectionGroups.push(l.tensorflow.magenta.NoteSequence.SectionGroup.decode(d,d.uint32()));break;case 15:x.quantizationInfo=l.tensorflow.magenta.NoteSequence.QuantizationInfo.decode(d,d.uint32());break;case 17:x.subsequenceInfo=l.tensorflow.magenta.NoteSequence.SubsequenceInfo.decode(d,d.uint32());break;case 19:x.sequenceMetadata=l.tensorflow.magenta.SequenceMetadata.decode(d,d.uint32());break;default:d.skipType(7&w)}}return x},p.decodeDelimited=function(d){return d instanceof i||(d=new i(d)),this.decode(d,d.uint32())},p.verify=function(d){if(typeof d!="object"||d===null)return"object expected";if(d.id!=null&&d.hasOwnProperty("id")&&!c.isString(d.id))return"id: string expected";if(d.filename!=null&&d.hasOwnProperty("filename")&&!c.isString(d.filename))return"filename: string expected";if(d.referenceNumber!=null&&d.hasOwnProperty("referenceNumber")&&!(c.isInteger(d.referenceNumber)||d.referenceNumber&&c.isInteger(d.referenceNumber.low)&&c.isInteger(d.referenceNumber.high)))return"referenceNumber: integer|Long expected";if(d.collectionName!=null&&d.hasOwnProperty("collectionName")&&!c.isString(d.collectionName))return"collectionName: string expected";if(d.ticksPerQuarter!=null&&d.hasOwnProperty("ticksPerQuarter")&&!c.isInteger(d.ticksPerQuarter))return"ticksPerQuarter: integer expected";if(d.timeSignatures!=null&&d.hasOwnProperty("timeSignatures")){if(!Array.isArray(d.timeSignatures))return"timeSignatures: array expected";for(var h=0;h<d.timeSignatures.length;++h)if(m=l.tensorflow.magenta.NoteSequence.TimeSignature.verify(d.timeSignatures[h]))return"timeSignatures."+m}if(d.keySignatures!=null&&d.hasOwnProperty("keySignatures")){if(!Array.isArray(d.keySignatures))return"keySignatures: array expected";for(h=0;h<d.keySignatures.length;++h)if(m=l.tensorflow.magenta.NoteSequence.KeySignature.verify(d.keySignatures[h]))return"keySignatures."+m}if(d.tempos!=null&&d.hasOwnProperty("tempos")){if(!Array.isArray(d.tempos))return"tempos: array expected";for(h=0;h<d.tempos.length;++h)if(m=l.tensorflow.magenta.NoteSequence.Tempo.verify(d.tempos[h]))return"tempos."+m}if(d.notes!=null&&d.hasOwnProperty("notes")){if(!Array.isArray(d.notes))return"notes: array expected";for(h=0;h<d.notes.length;++h)if(m=l.tensorflow.magenta.NoteSequence.Note.verify(d.notes[h]))return"notes."+m}if(d.totalTime!=null&&d.hasOwnProperty("totalTime")&&typeof d.totalTime!="number")return"totalTime: number expected";if(d.totalQuantizedSteps!=null&&d.hasOwnProperty("totalQuantizedSteps")&&!(c.isInteger(d.totalQuantizedSteps)||d.totalQuantizedSteps&&c.isInteger(d.totalQuantizedSteps.low)&&c.isInteger(d.totalQuantizedSteps.high)))return"totalQuantizedSteps: integer|Long expected";if(d.pitchBends!=null&&d.hasOwnProperty("pitchBends")){if(!Array.isArray(d.pitchBends))return"pitchBends: array expected";for(h=0;h<d.pitchBends.length;++h)if(m=l.tensorflow.magenta.NoteSequence.PitchBend.verify(d.pitchBends[h]))return"pitchBends."+m}if(d.controlChanges!=null&&d.hasOwnProperty("controlChanges")){if(!Array.isArray(d.controlChanges))return"controlChanges: array expected";for(h=0;h<d.controlChanges.length;++h)if(m=l.tensorflow.magenta.NoteSequence.ControlChange.verify(d.controlChanges[h]))return"controlChanges."+m}if(d.partInfos!=null&&d.hasOwnProperty("partInfos")){if(!Array.isArray(d.partInfos))return"partInfos: array expected";for(h=0;h<d.partInfos.length;++h)if(m=l.tensorflow.magenta.NoteSequence.PartInfo.verify(d.partInfos[h]))return"partInfos."+m}if(d.sourceInfo!=null&&d.hasOwnProperty("sourceInfo")&&(m=l.tensorflow.magenta.NoteSequence.SourceInfo.verify(d.sourceInfo)))return"sourceInfo."+m;if(d.textAnnotations!=null&&d.hasOwnProperty("textAnnotations")){if(!Array.isArray(d.textAnnotations))return"textAnnotations: array expected";for(h=0;h<d.textAnnotations.length;++h)if(m=l.tensorflow.magenta.NoteSequence.TextAnnotation.verify(d.textAnnotations[h]))return"textAnnotations."+m}if(d.sectionAnnotations!=null&&d.hasOwnProperty("sectionAnnotations")){if(!Array.isArray(d.sectionAnnotations))return"sectionAnnotations: array expected";for(h=0;h<d.sectionAnnotations.length;++h)if(m=l.tensorflow.magenta.NoteSequence.SectionAnnotation.verify(d.sectionAnnotations[h]))return"sectionAnnotations."+m}if(d.sectionGroups!=null&&d.hasOwnProperty("sectionGroups")){if(!Array.isArray(d.sectionGroups))return"sectionGroups: array expected";for(h=0;h<d.sectionGroups.length;++h){var m;if(m=l.tensorflow.magenta.NoteSequence.SectionGroup.verify(d.sectionGroups[h]))return"sectionGroups."+m}}return d.quantizationInfo!=null&&d.hasOwnProperty("quantizationInfo")&&(m=l.tensorflow.magenta.NoteSequence.QuantizationInfo.verify(d.quantizationInfo))?"quantizationInfo."+m:d.subsequenceInfo!=null&&d.hasOwnProperty("subsequenceInfo")&&(m=l.tensorflow.magenta.NoteSequence.SubsequenceInfo.verify(d.subsequenceInfo))?"subsequenceInfo."+m:d.sequenceMetadata!=null&&d.hasOwnProperty("sequenceMetadata")&&(m=l.tensorflow.magenta.SequenceMetadata.verify(d.sequenceMetadata))?"sequenceMetadata."+m:null},p.fromObject=function(d){if(d instanceof l.tensorflow.magenta.NoteSequence)return d;var h=new l.tensorflow.magenta.NoteSequence;if(d.id!=null&&(h.id=String(d.id)),d.filename!=null&&(h.filename=String(d.filename)),d.referenceNumber!=null&&(c.Long?(h.referenceNumber=c.Long.fromValue(d.referenceNumber)).unsigned=!1:typeof d.referenceNumber=="string"?h.referenceNumber=parseInt(d.referenceNumber,10):typeof d.referenceNumber=="number"?h.referenceNumber=d.referenceNumber:typeof d.referenceNumber=="object"&&(h.referenceNumber=new c.LongBits(d.referenceNumber.low>>>0,d.referenceNumber.high>>>0).toNumber())),d.collectionName!=null&&(h.collectionName=String(d.collectionName)),d.ticksPerQuarter!=null&&(h.ticksPerQuarter=0|d.ticksPerQuarter),d.timeSignatures){if(!Array.isArray(d.timeSignatures))throw TypeError(".tensorflow.magenta.NoteSequence.timeSignatures: array expected");h.timeSignatures=[];for(var m=0;m<d.timeSignatures.length;++m){if(typeof d.timeSignatures[m]!="object")throw TypeError(".tensorflow.magenta.NoteSequence.timeSignatures: object expected");h.timeSignatures[m]=l.tensorflow.magenta.NoteSequence.TimeSignature.fromObject(d.timeSignatures[m])}}if(d.keySignatures){if(!Array.isArray(d.keySignatures))throw TypeError(".tensorflow.magenta.NoteSequence.keySignatures: array expected");for(h.keySignatures=[],m=0;m<d.keySignatures.length;++m){if(typeof d.keySignatures[m]!="object")throw TypeError(".tensorflow.magenta.NoteSequence.keySignatures: object expected");h.keySignatures[m]=l.tensorflow.magenta.NoteSequence.KeySignature.fromObject(d.keySignatures[m])}}if(d.tempos){if(!Array.isArray(d.tempos))throw TypeError(".tensorflow.magenta.NoteSequence.tempos: array expected");for(h.tempos=[],m=0;m<d.tempos.length;++m){if(typeof d.tempos[m]!="object")throw TypeError(".tensorflow.magenta.NoteSequence.tempos: object expected");h.tempos[m]=l.tensorflow.magenta.NoteSequence.Tempo.fromObject(d.tempos[m])}}if(d.notes){if(!Array.isArray(d.notes))throw TypeError(".tensorflow.magenta.NoteSequence.notes: array expected");for(h.notes=[],m=0;m<d.notes.length;++m){if(typeof d.notes[m]!="object")throw TypeError(".tensorflow.magenta.NoteSequence.notes: object expected");h.notes[m]=l.tensorflow.magenta.NoteSequence.Note.fromObject(d.notes[m])}}if(d.totalTime!=null&&(h.totalTime=Number(d.totalTime)),d.totalQuantizedSteps!=null&&(c.Long?(h.totalQuantizedSteps=c.Long.fromValue(d.totalQuantizedSteps)).unsigned=!1:typeof d.totalQuantizedSteps=="string"?h.totalQuantizedSteps=parseInt(d.totalQuantizedSteps,10):typeof d.totalQuantizedSteps=="number"?h.totalQuantizedSteps=d.totalQuantizedSteps:typeof d.totalQuantizedSteps=="object"&&(h.totalQuantizedSteps=new c.LongBits(d.totalQuantizedSteps.low>>>0,d.totalQuantizedSteps.high>>>0).toNumber())),d.pitchBends){if(!Array.isArray(d.pitchBends))throw TypeError(".tensorflow.magenta.NoteSequence.pitchBends: array expected");for(h.pitchBends=[],m=0;m<d.pitchBends.length;++m){if(typeof d.pitchBends[m]!="object")throw TypeError(".tensorflow.magenta.NoteSequence.pitchBends: object expected");h.pitchBends[m]=l.tensorflow.magenta.NoteSequence.PitchBend.fromObject(d.pitchBends[m])}}if(d.controlChanges){if(!Array.isArray(d.controlChanges))throw TypeError(".tensorflow.magenta.NoteSequence.controlChanges: array expected");for(h.controlChanges=[],m=0;m<d.controlChanges.length;++m){if(typeof d.controlChanges[m]!="object")throw TypeError(".tensorflow.magenta.NoteSequence.controlChanges: object expected");h.controlChanges[m]=l.tensorflow.magenta.NoteSequence.ControlChange.fromObject(d.controlChanges[m])}}if(d.partInfos){if(!Array.isArray(d.partInfos))throw TypeError(".tensorflow.magenta.NoteSequence.partInfos: array expected");for(h.partInfos=[],m=0;m<d.partInfos.length;++m){if(typeof d.partInfos[m]!="object")throw TypeError(".tensorflow.magenta.NoteSequence.partInfos: object expected");h.partInfos[m]=l.tensorflow.magenta.NoteSequence.PartInfo.fromObject(d.partInfos[m])}}if(d.sourceInfo!=null){if(typeof d.sourceInfo!="object")throw TypeError(".tensorflow.magenta.NoteSequence.sourceInfo: object expected");h.sourceInfo=l.tensorflow.magenta.NoteSequence.SourceInfo.fromObject(d.sourceInfo)}if(d.textAnnotations){if(!Array.isArray(d.textAnnotations))throw TypeError(".tensorflow.magenta.NoteSequence.textAnnotations: array expected");for(h.textAnnotations=[],m=0;m<d.textAnnotations.length;++m){if(typeof d.textAnnotations[m]!="object")throw TypeError(".tensorflow.magenta.NoteSequence.textAnnotations: object expected");h.textAnnotations[m]=l.tensorflow.magenta.NoteSequence.TextAnnotation.fromObject(d.textAnnotations[m])}}if(d.sectionAnnotations){if(!Array.isArray(d.sectionAnnotations))throw TypeError(".tensorflow.magenta.NoteSequence.sectionAnnotations: array expected");for(h.sectionAnnotations=[],m=0;m<d.sectionAnnotations.length;++m){if(typeof d.sectionAnnotations[m]!="object")throw TypeError(".tensorflow.magenta.NoteSequence.sectionAnnotations: object expected");h.sectionAnnotations[m]=l.tensorflow.magenta.NoteSequence.SectionAnnotation.fromObject(d.sectionAnnotations[m])}}if(d.sectionGroups){if(!Array.isArray(d.sectionGroups))throw TypeError(".tensorflow.magenta.NoteSequence.sectionGroups: array expected");for(h.sectionGroups=[],m=0;m<d.sectionGroups.length;++m){if(typeof d.sectionGroups[m]!="object")throw TypeError(".tensorflow.magenta.NoteSequence.sectionGroups: object expected");h.sectionGroups[m]=l.tensorflow.magenta.NoteSequence.SectionGroup.fromObject(d.sectionGroups[m])}}if(d.quantizationInfo!=null){if(typeof d.quantizationInfo!="object")throw TypeError(".tensorflow.magenta.NoteSequence.quantizationInfo: object expected");h.quantizationInfo=l.tensorflow.magenta.NoteSequence.QuantizationInfo.fromObject(d.quantizationInfo)}if(d.subsequenceInfo!=null){if(typeof d.subsequenceInfo!="object")throw TypeError(".tensorflow.magenta.NoteSequence.subsequenceInfo: object expected");h.subsequenceInfo=l.tensorflow.magenta.NoteSequence.SubsequenceInfo.fromObject(d.subsequenceInfo)}if(d.sequenceMetadata!=null){if(typeof d.sequenceMetadata!="object")throw TypeError(".tensorflow.magenta.NoteSequence.sequenceMetadata: object expected");h.sequenceMetadata=l.tensorflow.magenta.SequenceMetadata.fromObject(d.sequenceMetadata)}return h},p.toObject=function(d,h){h||(h={});var m={};if((h.arrays||h.defaults)&&(m.timeSignatures=[],m.keySignatures=[],m.tempos=[],m.notes=[],m.pitchBends=[],m.controlChanges=[],m.partInfos=[],m.textAnnotations=[],m.sectionAnnotations=[],m.sectionGroups=[]),h.defaults){if(m.id="",m.filename="",m.collectionName="",m.ticksPerQuarter=0,m.totalTime=0,m.sourceInfo=null,m.quantizationInfo=null,c.Long){var x=new c.Long(0,0,!1);m.totalQuantizedSteps=h.longs===String?x.toString():h.longs===Number?x.toNumber():x}else m.totalQuantizedSteps=h.longs===String?"0":0;m.subsequenceInfo=null,c.Long?(x=new c.Long(0,0,!1),m.referenceNumber=h.longs===String?x.toString():h.longs===Number?x.toNumber():x):m.referenceNumber=h.longs===String?"0":0,m.sequenceMetadata=null}if(d.id!=null&&d.hasOwnProperty("id")&&(m.id=d.id),d.filename!=null&&d.hasOwnProperty("filename")&&(m.filename=d.filename),d.collectionName!=null&&d.hasOwnProperty("collectionName")&&(m.collectionName=d.collectionName),d.ticksPerQuarter!=null&&d.hasOwnProperty("ticksPerQuarter")&&(m.ticksPerQuarter=d.ticksPerQuarter),d.timeSignatures&&d.timeSignatures.length){m.timeSignatures=[];for(var w=0;w<d.timeSignatures.length;++w)m.timeSignatures[w]=l.tensorflow.magenta.NoteSequence.TimeSignature.toObject(d.timeSignatures[w],h)}if(d.keySignatures&&d.keySignatures.length)for(m.keySignatures=[],w=0;w<d.keySignatures.length;++w)m.keySignatures[w]=l.tensorflow.magenta.NoteSequence.KeySignature.toObject(d.keySignatures[w],h);if(d.tempos&&d.tempos.length)for(m.tempos=[],w=0;w<d.tempos.length;++w)m.tempos[w]=l.tensorflow.magenta.NoteSequence.Tempo.toObject(d.tempos[w],h);if(d.notes&&d.notes.length)for(m.notes=[],w=0;w<d.notes.length;++w)m.notes[w]=l.tensorflow.magenta.NoteSequence.Note.toObject(d.notes[w],h);if(d.totalTime!=null&&d.hasOwnProperty("totalTime")&&(m.totalTime=h.json&&!isFinite(d.totalTime)?String(d.totalTime):d.totalTime),d.pitchBends&&d.pitchBends.length)for(m.pitchBends=[],w=0;w<d.pitchBends.length;++w)m.pitchBends[w]=l.tensorflow.magenta.NoteSequence.PitchBend.toObject(d.pitchBends[w],h);if(d.controlChanges&&d.controlChanges.length)for(m.controlChanges=[],w=0;w<d.controlChanges.length;++w)m.controlChanges[w]=l.tensorflow.magenta.NoteSequence.ControlChange.toObject(d.controlChanges[w],h);if(d.partInfos&&d.partInfos.length)for(m.partInfos=[],w=0;w<d.partInfos.length;++w)m.partInfos[w]=l.tensorflow.magenta.NoteSequence.PartInfo.toObject(d.partInfos[w],h);if(d.sourceInfo!=null&&d.hasOwnProperty("sourceInfo")&&(m.sourceInfo=l.tensorflow.magenta.NoteSequence.SourceInfo.toObject(d.sourceInfo,h)),d.textAnnotations&&d.textAnnotations.length)for(m.textAnnotations=[],w=0;w<d.textAnnotations.length;++w)m.textAnnotations[w]=l.tensorflow.magenta.NoteSequence.TextAnnotation.toObject(d.textAnnotations[w],h);if(d.quantizationInfo!=null&&d.hasOwnProperty("quantizationInfo")&&(m.quantizationInfo=l.tensorflow.magenta.NoteSequence.QuantizationInfo.toObject(d.quantizationInfo,h)),d.totalQuantizedSteps!=null&&d.hasOwnProperty("totalQuantizedSteps")&&(typeof d.totalQuantizedSteps=="number"?m.totalQuantizedSteps=h.longs===String?String(d.totalQuantizedSteps):d.totalQuantizedSteps:m.totalQuantizedSteps=h.longs===String?c.Long.prototype.toString.call(d.totalQuantizedSteps):h.longs===Number?new c.LongBits(d.totalQuantizedSteps.low>>>0,d.totalQuantizedSteps.high>>>0).toNumber():d.totalQuantizedSteps),d.subsequenceInfo!=null&&d.hasOwnProperty("subsequenceInfo")&&(m.subsequenceInfo=l.tensorflow.magenta.NoteSequence.SubsequenceInfo.toObject(d.subsequenceInfo,h)),d.referenceNumber!=null&&d.hasOwnProperty("referenceNumber")&&(typeof d.referenceNumber=="number"?m.referenceNumber=h.longs===String?String(d.referenceNumber):d.referenceNumber:m.referenceNumber=h.longs===String?c.Long.prototype.toString.call(d.referenceNumber):h.longs===Number?new c.LongBits(d.referenceNumber.low>>>0,d.referenceNumber.high>>>0).toNumber():d.referenceNumber),d.sequenceMetadata!=null&&d.hasOwnProperty("sequenceMetadata")&&(m.sequenceMetadata=l.tensorflow.magenta.SequenceMetadata.toObject(d.sequenceMetadata,h)),d.sectionAnnotations&&d.sectionAnnotations.length)for(m.sectionAnnotations=[],w=0;w<d.sectionAnnotations.length;++w)m.sectionAnnotations[w]=l.tensorflow.magenta.NoteSequence.SectionAnnotation.toObject(d.sectionAnnotations[w],h);if(d.sectionGroups&&d.sectionGroups.length)for(m.sectionGroups=[],w=0;w<d.sectionGroups.length;++w)m.sectionGroups[w]=l.tensorflow.magenta.NoteSequence.SectionGroup.toObject(d.sectionGroups[w],h);return m},p.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},p.Note=function(){function d(h){if(h)for(var m=Object.keys(h),x=0;x<m.length;++x)h[m[x]]!=null&&(this[m[x]]=h[m[x]])}return d.prototype.pitch=0,d.prototype.pitchName=0,d.prototype.velocity=0,d.prototype.startTime=0,d.prototype.quantizedStartStep=c.Long?c.Long.fromBits(0,0,!1):0,d.prototype.endTime=0,d.prototype.quantizedEndStep=c.Long?c.Long.fromBits(0,0,!1):0,d.prototype.numerator=0,d.prototype.denominator=0,d.prototype.instrument=0,d.prototype.program=0,d.prototype.isDrum=!1,d.prototype.part=0,d.prototype.voice=0,d.create=function(h){return new d(h)},d.encode=function(h,m){return m||(m=a.create()),h.pitch!=null&&h.hasOwnProperty("pitch")&&m.uint32(8).int32(h.pitch),h.velocity!=null&&h.hasOwnProperty("velocity")&&m.uint32(16).int32(h.velocity),h.startTime!=null&&h.hasOwnProperty("startTime")&&m.uint32(25).double(h.startTime),h.endTime!=null&&h.hasOwnProperty("endTime")&&m.uint32(33).double(h.endTime),h.numerator!=null&&h.hasOwnProperty("numerator")&&m.uint32(40).int32(h.numerator),h.denominator!=null&&h.hasOwnProperty("denominator")&&m.uint32(48).int32(h.denominator),h.instrument!=null&&h.hasOwnProperty("instrument")&&m.uint32(56).int32(h.instrument),h.program!=null&&h.hasOwnProperty("program")&&m.uint32(64).int32(h.program),h.isDrum!=null&&h.hasOwnProperty("isDrum")&&m.uint32(72).bool(h.isDrum),h.part!=null&&h.hasOwnProperty("part")&&m.uint32(80).int32(h.part),h.pitchName!=null&&h.hasOwnProperty("pitchName")&&m.uint32(88).int32(h.pitchName),h.voice!=null&&h.hasOwnProperty("voice")&&m.uint32(96).int32(h.voice),h.quantizedStartStep!=null&&h.hasOwnProperty("quantizedStartStep")&&m.uint32(104).int64(h.quantizedStartStep),h.quantizedEndStep!=null&&h.hasOwnProperty("quantizedEndStep")&&m.uint32(112).int64(h.quantizedEndStep),m},d.encodeDelimited=function(h,m){return this.encode(h,m).ldelim()},d.decode=function(h,m){h instanceof i||(h=i.create(h));for(var x=m===void 0?h.len:h.pos+m,w=new l.tensorflow.magenta.NoteSequence.Note;h.pos<x;){var _=h.uint32();switch(_>>>3){case 1:w.pitch=h.int32();break;case 11:w.pitchName=h.int32();break;case 2:w.velocity=h.int32();break;case 3:w.startTime=h.double();break;case 13:w.quantizedStartStep=c.Long?h.int64().toNumber():h.int64();break;case 4:w.endTime=h.double();break;case 14:w.quantizedEndStep=c.Long?h.int64().toNumber():h.int64();break;case 5:w.numerator=h.int32();break;case 6:w.denominator=h.int32();break;case 7:w.instrument=h.int32();break;case 8:w.program=h.int32();break;case 9:w.isDrum=h.bool();break;case 10:w.part=h.int32();break;case 12:w.voice=h.int32();break;default:h.skipType(7&_)}}return w},d.decodeDelimited=function(h){return h instanceof i||(h=new i(h)),this.decode(h,h.uint32())},d.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.pitch!=null&&h.hasOwnProperty("pitch")&&!c.isInteger(h.pitch))return"pitch: integer expected";if(h.pitchName!=null&&h.hasOwnProperty("pitchName"))switch(h.pitchName){default:return"pitchName: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:case 32:case 33:case 34:case 35:}return h.velocity!=null&&h.hasOwnProperty("velocity")&&!c.isInteger(h.velocity)?"velocity: integer expected":h.startTime!=null&&h.hasOwnProperty("startTime")&&typeof h.startTime!="number"?"startTime: number expected":h.quantizedStartStep!=null&&h.hasOwnProperty("quantizedStartStep")&&!(c.isInteger(h.quantizedStartStep)||h.quantizedStartStep&&c.isInteger(h.quantizedStartStep.low)&&c.isInteger(h.quantizedStartStep.high))?"quantizedStartStep: integer|Long expected":h.endTime!=null&&h.hasOwnProperty("endTime")&&typeof h.endTime!="number"?"endTime: number expected":h.quantizedEndStep!=null&&h.hasOwnProperty("quantizedEndStep")&&!(c.isInteger(h.quantizedEndStep)||h.quantizedEndStep&&c.isInteger(h.quantizedEndStep.low)&&c.isInteger(h.quantizedEndStep.high))?"quantizedEndStep: integer|Long expected":h.numerator!=null&&h.hasOwnProperty("numerator")&&!c.isInteger(h.numerator)?"numerator: integer expected":h.denominator!=null&&h.hasOwnProperty("denominator")&&!c.isInteger(h.denominator)?"denominator: integer expected":h.instrument!=null&&h.hasOwnProperty("instrument")&&!c.isInteger(h.instrument)?"instrument: integer expected":h.program!=null&&h.hasOwnProperty("program")&&!c.isInteger(h.program)?"program: integer expected":h.isDrum!=null&&h.hasOwnProperty("isDrum")&&typeof h.isDrum!="boolean"?"isDrum: boolean expected":h.part!=null&&h.hasOwnProperty("part")&&!c.isInteger(h.part)?"part: integer expected":h.voice!=null&&h.hasOwnProperty("voice")&&!c.isInteger(h.voice)?"voice: integer expected":null},d.fromObject=function(h){if(h instanceof l.tensorflow.magenta.NoteSequence.Note)return h;var m=new l.tensorflow.magenta.NoteSequence.Note;switch(h.pitch!=null&&(m.pitch=0|h.pitch),h.pitchName){case"UNKNOWN_PITCH_NAME":case 0:m.pitchName=0;break;case"F_FLAT_FLAT":case 1:m.pitchName=1;break;case"C_FLAT_FLAT":case 2:m.pitchName=2;break;case"G_FLAT_FLAT":case 3:m.pitchName=3;break;case"D_FLAT_FLAT":case 4:m.pitchName=4;break;case"A_FLAT_FLAT":case 5:m.pitchName=5;break;case"E_FLAT_FLAT":case 6:m.pitchName=6;break;case"B_FLAT_FLAT":case 7:m.pitchName=7;break;case"F_FLAT":case 8:m.pitchName=8;break;case"C_FLAT":case 9:m.pitchName=9;break;case"G_FLAT":case 10:m.pitchName=10;break;case"D_FLAT":case 11:m.pitchName=11;break;case"A_FLAT":case 12:m.pitchName=12;break;case"E_FLAT":case 13:m.pitchName=13;break;case"B_FLAT":case 14:m.pitchName=14;break;case"F":case 15:m.pitchName=15;break;case"C":case 16:m.pitchName=16;break;case"G":case 17:m.pitchName=17;break;case"D":case 18:m.pitchName=18;break;case"A":case 19:m.pitchName=19;break;case"E":case 20:m.pitchName=20;break;case"B":case 21:m.pitchName=21;break;case"F_SHARP":case 22:m.pitchName=22;break;case"C_SHARP":case 23:m.pitchName=23;break;case"G_SHARP":case 24:m.pitchName=24;break;case"D_SHARP":case 25:m.pitchName=25;break;case"A_SHARP":case 26:m.pitchName=26;break;case"E_SHARP":case 27:m.pitchName=27;break;case"B_SHARP":case 28:m.pitchName=28;break;case"F_SHARP_SHARP":case 29:m.pitchName=29;break;case"C_SHARP_SHARP":case 30:m.pitchName=30;break;case"G_SHARP_SHARP":case 31:m.pitchName=31;break;case"D_SHARP_SHARP":case 32:m.pitchName=32;break;case"A_SHARP_SHARP":case 33:m.pitchName=33;break;case"E_SHARP_SHARP":case 34:m.pitchName=34;break;case"B_SHARP_SHARP":case 35:m.pitchName=35}return h.velocity!=null&&(m.velocity=0|h.velocity),h.startTime!=null&&(m.startTime=Number(h.startTime)),h.quantizedStartStep!=null&&(c.Long?(m.quantizedStartStep=c.Long.fromValue(h.quantizedStartStep)).unsigned=!1:typeof h.quantizedStartStep=="string"?m.quantizedStartStep=parseInt(h.quantizedStartStep,10):typeof h.quantizedStartStep=="number"?m.quantizedStartStep=h.quantizedStartStep:typeof h.quantizedStartStep=="object"&&(m.quantizedStartStep=new c.LongBits(h.quantizedStartStep.low>>>0,h.quantizedStartStep.high>>>0).toNumber())),h.endTime!=null&&(m.endTime=Number(h.endTime)),h.quantizedEndStep!=null&&(c.Long?(m.quantizedEndStep=c.Long.fromValue(h.quantizedEndStep)).unsigned=!1:typeof h.quantizedEndStep=="string"?m.quantizedEndStep=parseInt(h.quantizedEndStep,10):typeof h.quantizedEndStep=="number"?m.quantizedEndStep=h.quantizedEndStep:typeof h.quantizedEndStep=="object"&&(m.quantizedEndStep=new c.LongBits(h.quantizedEndStep.low>>>0,h.quantizedEndStep.high>>>0).toNumber())),h.numerator!=null&&(m.numerator=0|h.numerator),h.denominator!=null&&(m.denominator=0|h.denominator),h.instrument!=null&&(m.instrument=0|h.instrument),h.program!=null&&(m.program=0|h.program),h.isDrum!=null&&(m.isDrum=!!h.isDrum),h.part!=null&&(m.part=0|h.part),h.voice!=null&&(m.voice=0|h.voice),m},d.toObject=function(h,m){m||(m={});var x={};if(m.defaults){if(x.pitch=0,x.velocity=0,x.startTime=0,x.endTime=0,x.numerator=0,x.denominator=0,x.instrument=0,x.program=0,x.isDrum=!1,x.part=0,x.pitchName=m.enums===String?"UNKNOWN_PITCH_NAME":0,x.voice=0,c.Long){var w=new c.Long(0,0,!1);x.quantizedStartStep=m.longs===String?w.toString():m.longs===Number?w.toNumber():w}else x.quantizedStartStep=m.longs===String?"0":0;c.Long?(w=new c.Long(0,0,!1),x.quantizedEndStep=m.longs===String?w.toString():m.longs===Number?w.toNumber():w):x.quantizedEndStep=m.longs===String?"0":0}return h.pitch!=null&&h.hasOwnProperty("pitch")&&(x.pitch=h.pitch),h.velocity!=null&&h.hasOwnProperty("velocity")&&(x.velocity=h.velocity),h.startTime!=null&&h.hasOwnProperty("startTime")&&(x.startTime=m.json&&!isFinite(h.startTime)?String(h.startTime):h.startTime),h.endTime!=null&&h.hasOwnProperty("endTime")&&(x.endTime=m.json&&!isFinite(h.endTime)?String(h.endTime):h.endTime),h.numerator!=null&&h.hasOwnProperty("numerator")&&(x.numerator=h.numerator),h.denominator!=null&&h.hasOwnProperty("denominator")&&(x.denominator=h.denominator),h.instrument!=null&&h.hasOwnProperty("instrument")&&(x.instrument=h.instrument),h.program!=null&&h.hasOwnProperty("program")&&(x.program=h.program),h.isDrum!=null&&h.hasOwnProperty("isDrum")&&(x.isDrum=h.isDrum),h.part!=null&&h.hasOwnProperty("part")&&(x.part=h.part),h.pitchName!=null&&h.hasOwnProperty("pitchName")&&(x.pitchName=m.enums===String?l.tensorflow.magenta.NoteSequence.PitchName[h.pitchName]:h.pitchName),h.voice!=null&&h.hasOwnProperty("voice")&&(x.voice=h.voice),h.quantizedStartStep!=null&&h.hasOwnProperty("quantizedStartStep")&&(typeof h.quantizedStartStep=="number"?x.quantizedStartStep=m.longs===String?String(h.quantizedStartStep):h.quantizedStartStep:x.quantizedStartStep=m.longs===String?c.Long.prototype.toString.call(h.quantizedStartStep):m.longs===Number?new c.LongBits(h.quantizedStartStep.low>>>0,h.quantizedStartStep.high>>>0).toNumber():h.quantizedStartStep),h.quantizedEndStep!=null&&h.hasOwnProperty("quantizedEndStep")&&(typeof h.quantizedEndStep=="number"?x.quantizedEndStep=m.longs===String?String(h.quantizedEndStep):h.quantizedEndStep:x.quantizedEndStep=m.longs===String?c.Long.prototype.toString.call(h.quantizedEndStep):m.longs===Number?new c.LongBits(h.quantizedEndStep.low>>>0,h.quantizedEndStep.high>>>0).toNumber():h.quantizedEndStep),x},d.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},d}(),p.PitchName=(f={},(y=Object.create(f))[f[0]="UNKNOWN_PITCH_NAME"]=0,y[f[1]="F_FLAT_FLAT"]=1,y[f[2]="C_FLAT_FLAT"]=2,y[f[3]="G_FLAT_FLAT"]=3,y[f[4]="D_FLAT_FLAT"]=4,y[f[5]="A_FLAT_FLAT"]=5,y[f[6]="E_FLAT_FLAT"]=6,y[f[7]="B_FLAT_FLAT"]=7,y[f[8]="F_FLAT"]=8,y[f[9]="C_FLAT"]=9,y[f[10]="G_FLAT"]=10,y[f[11]="D_FLAT"]=11,y[f[12]="A_FLAT"]=12,y[f[13]="E_FLAT"]=13,y[f[14]="B_FLAT"]=14,y[f[15]="F"]=15,y[f[16]="C"]=16,y[f[17]="G"]=17,y[f[18]="D"]=18,y[f[19]="A"]=19,y[f[20]="E"]=20,y[f[21]="B"]=21,y[f[22]="F_SHARP"]=22,y[f[23]="C_SHARP"]=23,y[f[24]="G_SHARP"]=24,y[f[25]="D_SHARP"]=25,y[f[26]="A_SHARP"]=26,y[f[27]="E_SHARP"]=27,y[f[28]="B_SHARP"]=28,y[f[29]="F_SHARP_SHARP"]=29,y[f[30]="C_SHARP_SHARP"]=30,y[f[31]="G_SHARP_SHARP"]=31,y[f[32]="D_SHARP_SHARP"]=32,y[f[33]="A_SHARP_SHARP"]=33,y[f[34]="E_SHARP_SHARP"]=34,y[f[35]="B_SHARP_SHARP"]=35,y),p.TimeSignature=function(){function d(h){if(h)for(var m=Object.keys(h),x=0;x<m.length;++x)h[m[x]]!=null&&(this[m[x]]=h[m[x]])}return d.prototype.time=0,d.prototype.numerator=0,d.prototype.denominator=0,d.create=function(h){return new d(h)},d.encode=function(h,m){return m||(m=a.create()),h.time!=null&&h.hasOwnProperty("time")&&m.uint32(9).double(h.time),h.numerator!=null&&h.hasOwnProperty("numerator")&&m.uint32(16).int32(h.numerator),h.denominator!=null&&h.hasOwnProperty("denominator")&&m.uint32(24).int32(h.denominator),m},d.encodeDelimited=function(h,m){return this.encode(h,m).ldelim()},d.decode=function(h,m){h instanceof i||(h=i.create(h));for(var x=m===void 0?h.len:h.pos+m,w=new l.tensorflow.magenta.NoteSequence.TimeSignature;h.pos<x;){var _=h.uint32();switch(_>>>3){case 1:w.time=h.double();break;case 2:w.numerator=h.int32();break;case 3:w.denominator=h.int32();break;default:h.skipType(7&_)}}return w},d.decodeDelimited=function(h){return h instanceof i||(h=new i(h)),this.decode(h,h.uint32())},d.verify=function(h){return typeof h!="object"||h===null?"object expected":h.time!=null&&h.hasOwnProperty("time")&&typeof h.time!="number"?"time: number expected":h.numerator!=null&&h.hasOwnProperty("numerator")&&!c.isInteger(h.numerator)?"numerator: integer expected":h.denominator!=null&&h.hasOwnProperty("denominator")&&!c.isInteger(h.denominator)?"denominator: integer expected":null},d.fromObject=function(h){if(h instanceof l.tensorflow.magenta.NoteSequence.TimeSignature)return h;var m=new l.tensorflow.magenta.NoteSequence.TimeSignature;return h.time!=null&&(m.time=Number(h.time)),h.numerator!=null&&(m.numerator=0|h.numerator),h.denominator!=null&&(m.denominator=0|h.denominator),m},d.toObject=function(h,m){m||(m={});var x={};return m.defaults&&(x.time=0,x.numerator=0,x.denominator=0),h.time!=null&&h.hasOwnProperty("time")&&(x.time=m.json&&!isFinite(h.time)?String(h.time):h.time),h.numerator!=null&&h.hasOwnProperty("numerator")&&(x.numerator=h.numerator),h.denominator!=null&&h.hasOwnProperty("denominator")&&(x.denominator=h.denominator),x},d.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},d}(),p.KeySignature=function(){function d(h){if(h)for(var m=Object.keys(h),x=0;x<m.length;++x)h[m[x]]!=null&&(this[m[x]]=h[m[x]])}return d.prototype.time=0,d.prototype.key=0,d.prototype.mode=0,d.create=function(h){return new d(h)},d.encode=function(h,m){return m||(m=a.create()),h.time!=null&&h.hasOwnProperty("time")&&m.uint32(9).double(h.time),h.key!=null&&h.hasOwnProperty("key")&&m.uint32(16).int32(h.key),h.mode!=null&&h.hasOwnProperty("mode")&&m.uint32(24).int32(h.mode),m},d.encodeDelimited=function(h,m){return this.encode(h,m).ldelim()},d.decode=function(h,m){h instanceof i||(h=i.create(h));for(var x=m===void 0?h.len:h.pos+m,w=new l.tensorflow.magenta.NoteSequence.KeySignature;h.pos<x;){var _=h.uint32();switch(_>>>3){case 1:w.time=h.double();break;case 2:w.key=h.int32();break;case 3:w.mode=h.int32();break;default:h.skipType(7&_)}}return w},d.decodeDelimited=function(h){return h instanceof i||(h=new i(h)),this.decode(h,h.uint32())},d.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.time!=null&&h.hasOwnProperty("time")&&typeof h.time!="number")return"time: number expected";if(h.key!=null&&h.hasOwnProperty("key"))switch(h.key){default:return"key: enum value expected";case 0:case 1:case 1:case 2:case 3:case 3:case 4:case 5:case 6:case 6:case 7:case 8:case 8:case 9:case 10:case 10:case 11:}if(h.mode!=null&&h.hasOwnProperty("mode"))switch(h.mode){default:return"mode: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:}return null},d.fromObject=function(h){if(h instanceof l.tensorflow.magenta.NoteSequence.KeySignature)return h;var m=new l.tensorflow.magenta.NoteSequence.KeySignature;switch(h.time!=null&&(m.time=Number(h.time)),h.key){case"C":case 0:m.key=0;break;case"C_SHARP":case 1:m.key=1;break;case"D_FLAT":case 1:m.key=1;break;case"D":case 2:m.key=2;break;case"D_SHARP":case 3:m.key=3;break;case"E_FLAT":case 3:m.key=3;break;case"E":case 4:m.key=4;break;case"F":case 5:m.key=5;break;case"F_SHARP":case 6:m.key=6;break;case"G_FLAT":case 6:m.key=6;break;case"G":case 7:m.key=7;break;case"G_SHARP":case 8:m.key=8;break;case"A_FLAT":case 8:m.key=8;break;case"A":case 9:m.key=9;break;case"A_SHARP":case 10:m.key=10;break;case"B_FLAT":case 10:m.key=10;break;case"B":case 11:m.key=11}switch(h.mode){case"MAJOR":case 0:m.mode=0;break;case"MINOR":case 1:m.mode=1;break;case"NOT_SPECIFIED":case 2:m.mode=2;break;case"MIXOLYDIAN":case 3:m.mode=3;break;case"DORIAN":case 4:m.mode=4;break;case"PHRYGIAN":case 5:m.mode=5;break;case"LYDIAN":case 6:m.mode=6;break;case"LOCRIAN":case 7:m.mode=7}return m},d.toObject=function(h,m){m||(m={});var x={};return m.defaults&&(x.time=0,x.key=m.enums===String?"C":0,x.mode=m.enums===String?"MAJOR":0),h.time!=null&&h.hasOwnProperty("time")&&(x.time=m.json&&!isFinite(h.time)?String(h.time):h.time),h.key!=null&&h.hasOwnProperty("key")&&(x.key=m.enums===String?l.tensorflow.magenta.NoteSequence.KeySignature.Key[h.key]:h.key),h.mode!=null&&h.hasOwnProperty("mode")&&(x.mode=m.enums===String?l.tensorflow.magenta.NoteSequence.KeySignature.Mode[h.mode]:h.mode),x},d.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},d.Key=function(){var h={},m=Object.create(h);return m[h[0]="C"]=0,m[h[1]="C_SHARP"]=1,m.D_FLAT=1,m[h[2]="D"]=2,m[h[3]="D_SHARP"]=3,m.E_FLAT=3,m[h[4]="E"]=4,m[h[5]="F"]=5,m[h[6]="F_SHARP"]=6,m.G_FLAT=6,m[h[7]="G"]=7,m[h[8]="G_SHARP"]=8,m.A_FLAT=8,m[h[9]="A"]=9,m[h[10]="A_SHARP"]=10,m.B_FLAT=10,m[h[11]="B"]=11,m}(),d.Mode=function(){var h={},m=Object.create(h);return m[h[0]="MAJOR"]=0,m[h[1]="MINOR"]=1,m[h[2]="NOT_SPECIFIED"]=2,m[h[3]="MIXOLYDIAN"]=3,m[h[4]="DORIAN"]=4,m[h[5]="PHRYGIAN"]=5,m[h[6]="LYDIAN"]=6,m[h[7]="LOCRIAN"]=7,m}(),d}(),p.Tempo=function(){function d(h){if(h)for(var m=Object.keys(h),x=0;x<m.length;++x)h[m[x]]!=null&&(this[m[x]]=h[m[x]])}return d.prototype.time=0,d.prototype.qpm=0,d.create=function(h){return new d(h)},d.encode=function(h,m){return m||(m=a.create()),h.time!=null&&h.hasOwnProperty("time")&&m.uint32(9).double(h.time),h.qpm!=null&&h.hasOwnProperty("qpm")&&m.uint32(17).double(h.qpm),m},d.encodeDelimited=function(h,m){return this.encode(h,m).ldelim()},d.decode=function(h,m){h instanceof i||(h=i.create(h));for(var x=m===void 0?h.len:h.pos+m,w=new l.tensorflow.magenta.NoteSequence.Tempo;h.pos<x;){var _=h.uint32();switch(_>>>3){case 1:w.time=h.double();break;case 2:w.qpm=h.double();break;default:h.skipType(7&_)}}return w},d.decodeDelimited=function(h){return h instanceof i||(h=new i(h)),this.decode(h,h.uint32())},d.verify=function(h){return typeof h!="object"||h===null?"object expected":h.time!=null&&h.hasOwnProperty("time")&&typeof h.time!="number"?"time: number expected":h.qpm!=null&&h.hasOwnProperty("qpm")&&typeof h.qpm!="number"?"qpm: number expected":null},d.fromObject=function(h){if(h instanceof l.tensorflow.magenta.NoteSequence.Tempo)return h;var m=new l.tensorflow.magenta.NoteSequence.Tempo;return h.time!=null&&(m.time=Number(h.time)),h.qpm!=null&&(m.qpm=Number(h.qpm)),m},d.toObject=function(h,m){m||(m={});var x={};return m.defaults&&(x.time=0,x.qpm=0),h.time!=null&&h.hasOwnProperty("time")&&(x.time=m.json&&!isFinite(h.time)?String(h.time):h.time),h.qpm!=null&&h.hasOwnProperty("qpm")&&(x.qpm=m.json&&!isFinite(h.qpm)?String(h.qpm):h.qpm),x},d.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},d}(),p.PitchBend=function(){function d(h){if(h)for(var m=Object.keys(h),x=0;x<m.length;++x)h[m[x]]!=null&&(this[m[x]]=h[m[x]])}return d.prototype.time=0,d.prototype.bend=0,d.prototype.instrument=0,d.prototype.program=0,d.prototype.isDrum=!1,d.create=function(h){return new d(h)},d.encode=function(h,m){return m||(m=a.create()),h.time!=null&&h.hasOwnProperty("time")&&m.uint32(9).double(h.time),h.bend!=null&&h.hasOwnProperty("bend")&&m.uint32(16).int32(h.bend),h.instrument!=null&&h.hasOwnProperty("instrument")&&m.uint32(24).int32(h.instrument),h.program!=null&&h.hasOwnProperty("program")&&m.uint32(32).int32(h.program),h.isDrum!=null&&h.hasOwnProperty("isDrum")&&m.uint32(40).bool(h.isDrum),m},d.encodeDelimited=function(h,m){return this.encode(h,m).ldelim()},d.decode=function(h,m){h instanceof i||(h=i.create(h));for(var x=m===void 0?h.len:h.pos+m,w=new l.tensorflow.magenta.NoteSequence.PitchBend;h.pos<x;){var _=h.uint32();switch(_>>>3){case 1:w.time=h.double();break;case 2:w.bend=h.int32();break;case 3:w.instrument=h.int32();break;case 4:w.program=h.int32();break;case 5:w.isDrum=h.bool();break;default:h.skipType(7&_)}}return w},d.decodeDelimited=function(h){return h instanceof i||(h=new i(h)),this.decode(h,h.uint32())},d.verify=function(h){return typeof h!="object"||h===null?"object expected":h.time!=null&&h.hasOwnProperty("time")&&typeof h.time!="number"?"time: number expected":h.bend!=null&&h.hasOwnProperty("bend")&&!c.isInteger(h.bend)?"bend: integer expected":h.instrument!=null&&h.hasOwnProperty("instrument")&&!c.isInteger(h.instrument)?"instrument: integer expected":h.program!=null&&h.hasOwnProperty("program")&&!c.isInteger(h.program)?"program: integer expected":h.isDrum!=null&&h.hasOwnProperty("isDrum")&&typeof h.isDrum!="boolean"?"isDrum: boolean expected":null},d.fromObject=function(h){if(h instanceof l.tensorflow.magenta.NoteSequence.PitchBend)return h;var m=new l.tensorflow.magenta.NoteSequence.PitchBend;return h.time!=null&&(m.time=Number(h.time)),h.bend!=null&&(m.bend=0|h.bend),h.instrument!=null&&(m.instrument=0|h.instrument),h.program!=null&&(m.program=0|h.program),h.isDrum!=null&&(m.isDrum=!!h.isDrum),m},d.toObject=function(h,m){m||(m={});var x={};return m.defaults&&(x.time=0,x.bend=0,x.instrument=0,x.program=0,x.isDrum=!1),h.time!=null&&h.hasOwnProperty("time")&&(x.time=m.json&&!isFinite(h.time)?String(h.time):h.time),h.bend!=null&&h.hasOwnProperty("bend")&&(x.bend=h.bend),h.instrument!=null&&h.hasOwnProperty("instrument")&&(x.instrument=h.instrument),h.program!=null&&h.hasOwnProperty("program")&&(x.program=h.program),h.isDrum!=null&&h.hasOwnProperty("isDrum")&&(x.isDrum=h.isDrum),x},d.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},d}(),p.ControlChange=function(){function d(h){if(h)for(var m=Object.keys(h),x=0;x<m.length;++x)h[m[x]]!=null&&(this[m[x]]=h[m[x]])}return d.prototype.time=0,d.prototype.quantizedStep=c.Long?c.Long.fromBits(0,0,!1):0,d.prototype.controlNumber=0,d.prototype.controlValue=0,d.prototype.instrument=0,d.prototype.program=0,d.prototype.isDrum=!1,d.create=function(h){return new d(h)},d.encode=function(h,m){return m||(m=a.create()),h.time!=null&&h.hasOwnProperty("time")&&m.uint32(9).double(h.time),h.controlNumber!=null&&h.hasOwnProperty("controlNumber")&&m.uint32(16).int32(h.controlNumber),h.controlValue!=null&&h.hasOwnProperty("controlValue")&&m.uint32(24).int32(h.controlValue),h.instrument!=null&&h.hasOwnProperty("instrument")&&m.uint32(32).int32(h.instrument),h.program!=null&&h.hasOwnProperty("program")&&m.uint32(40).int32(h.program),h.isDrum!=null&&h.hasOwnProperty("isDrum")&&m.uint32(48).bool(h.isDrum),h.quantizedStep!=null&&h.hasOwnProperty("quantizedStep")&&m.uint32(56).int64(h.quantizedStep),m},d.encodeDelimited=function(h,m){return this.encode(h,m).ldelim()},d.decode=function(h,m){h instanceof i||(h=i.create(h));for(var x=m===void 0?h.len:h.pos+m,w=new l.tensorflow.magenta.NoteSequence.ControlChange;h.pos<x;){var _=h.uint32();switch(_>>>3){case 1:w.time=h.double();break;case 7:w.quantizedStep=c.Long?h.int64().toNumber():h.int64();break;case 2:w.controlNumber=h.int32();break;case 3:w.controlValue=h.int32();break;case 4:w.instrument=h.int32();break;case 5:w.program=h.int32();break;case 6:w.isDrum=h.bool();break;default:h.skipType(7&_)}}return w},d.decodeDelimited=function(h){return h instanceof i||(h=new i(h)),this.decode(h,h.uint32())},d.verify=function(h){return typeof h!="object"||h===null?"object expected":h.time!=null&&h.hasOwnProperty("time")&&typeof h.time!="number"?"time: number expected":h.quantizedStep!=null&&h.hasOwnProperty("quantizedStep")&&!(c.isInteger(h.quantizedStep)||h.quantizedStep&&c.isInteger(h.quantizedStep.low)&&c.isInteger(h.quantizedStep.high))?"quantizedStep: integer|Long expected":h.controlNumber!=null&&h.hasOwnProperty("controlNumber")&&!c.isInteger(h.controlNumber)?"controlNumber: integer expected":h.controlValue!=null&&h.hasOwnProperty("controlValue")&&!c.isInteger(h.controlValue)?"controlValue: integer expected":h.instrument!=null&&h.hasOwnProperty("instrument")&&!c.isInteger(h.instrument)?"instrument: integer expected":h.program!=null&&h.hasOwnProperty("program")&&!c.isInteger(h.program)?"program: integer expected":h.isDrum!=null&&h.hasOwnProperty("isDrum")&&typeof h.isDrum!="boolean"?"isDrum: boolean expected":null},d.fromObject=function(h){if(h instanceof l.tensorflow.magenta.NoteSequence.ControlChange)return h;var m=new l.tensorflow.magenta.NoteSequence.ControlChange;return h.time!=null&&(m.time=Number(h.time)),h.quantizedStep!=null&&(c.Long?(m.quantizedStep=c.Long.fromValue(h.quantizedStep)).unsigned=!1:typeof h.quantizedStep=="string"?m.quantizedStep=parseInt(h.quantizedStep,10):typeof h.quantizedStep=="number"?m.quantizedStep=h.quantizedStep:typeof h.quantizedStep=="object"&&(m.quantizedStep=new c.LongBits(h.quantizedStep.low>>>0,h.quantizedStep.high>>>0).toNumber())),h.controlNumber!=null&&(m.controlNumber=0|h.controlNumber),h.controlValue!=null&&(m.controlValue=0|h.controlValue),h.instrument!=null&&(m.instrument=0|h.instrument),h.program!=null&&(m.program=0|h.program),h.isDrum!=null&&(m.isDrum=!!h.isDrum),m},d.toObject=function(h,m){m||(m={});var x={};if(m.defaults)if(x.time=0,x.controlNumber=0,x.controlValue=0,x.instrument=0,x.program=0,x.isDrum=!1,c.Long){var w=new c.Long(0,0,!1);x.quantizedStep=m.longs===String?w.toString():m.longs===Number?w.toNumber():w}else x.quantizedStep=m.longs===String?"0":0;return h.time!=null&&h.hasOwnProperty("time")&&(x.time=m.json&&!isFinite(h.time)?String(h.time):h.time),h.controlNumber!=null&&h.hasOwnProperty("controlNumber")&&(x.controlNumber=h.controlNumber),h.controlValue!=null&&h.hasOwnProperty("controlValue")&&(x.controlValue=h.controlValue),h.instrument!=null&&h.hasOwnProperty("instrument")&&(x.instrument=h.instrument),h.program!=null&&h.hasOwnProperty("program")&&(x.program=h.program),h.isDrum!=null&&h.hasOwnProperty("isDrum")&&(x.isDrum=h.isDrum),h.quantizedStep!=null&&h.hasOwnProperty("quantizedStep")&&(typeof h.quantizedStep=="number"?x.quantizedStep=m.longs===String?String(h.quantizedStep):h.quantizedStep:x.quantizedStep=m.longs===String?c.Long.prototype.toString.call(h.quantizedStep):m.longs===Number?new c.LongBits(h.quantizedStep.low>>>0,h.quantizedStep.high>>>0).toNumber():h.quantizedStep),x},d.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},d}(),p.PartInfo=function(){function d(h){if(h)for(var m=Object.keys(h),x=0;x<m.length;++x)h[m[x]]!=null&&(this[m[x]]=h[m[x]])}return d.prototype.part=0,d.prototype.name="",d.create=function(h){return new d(h)},d.encode=function(h,m){return m||(m=a.create()),h.part!=null&&h.hasOwnProperty("part")&&m.uint32(8).int32(h.part),h.name!=null&&h.hasOwnProperty("name")&&m.uint32(18).string(h.name),m},d.encodeDelimited=function(h,m){return this.encode(h,m).ldelim()},d.decode=function(h,m){h instanceof i||(h=i.create(h));for(var x=m===void 0?h.len:h.pos+m,w=new l.tensorflow.magenta.NoteSequence.PartInfo;h.pos<x;){var _=h.uint32();switch(_>>>3){case 1:w.part=h.int32();break;case 2:w.name=h.string();break;default:h.skipType(7&_)}}return w},d.decodeDelimited=function(h){return h instanceof i||(h=new i(h)),this.decode(h,h.uint32())},d.verify=function(h){return typeof h!="object"||h===null?"object expected":h.part!=null&&h.hasOwnProperty("part")&&!c.isInteger(h.part)?"part: integer expected":h.name!=null&&h.hasOwnProperty("name")&&!c.isString(h.name)?"name: string expected":null},d.fromObject=function(h){if(h instanceof l.tensorflow.magenta.NoteSequence.PartInfo)return h;var m=new l.tensorflow.magenta.NoteSequence.PartInfo;return h.part!=null&&(m.part=0|h.part),h.name!=null&&(m.name=String(h.name)),m},d.toObject=function(h,m){m||(m={});var x={};return m.defaults&&(x.part=0,x.name=""),h.part!=null&&h.hasOwnProperty("part")&&(x.part=h.part),h.name!=null&&h.hasOwnProperty("name")&&(x.name=h.name),x},d.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},d}(),p.SourceInfo=function(){function d(h){if(h)for(var m=Object.keys(h),x=0;x<m.length;++x)h[m[x]]!=null&&(this[m[x]]=h[m[x]])}return d.prototype.sourceType=0,d.prototype.encodingType=0,d.prototype.parser=0,d.create=function(h){return new d(h)},d.encode=function(h,m){return m||(m=a.create()),h.sourceType!=null&&h.hasOwnProperty("sourceType")&&m.uint32(8).int32(h.sourceType),h.encodingType!=null&&h.hasOwnProperty("encodingType")&&m.uint32(16).int32(h.encodingType),h.parser!=null&&h.hasOwnProperty("parser")&&m.uint32(24).int32(h.parser),m},d.encodeDelimited=function(h,m){return this.encode(h,m).ldelim()},d.decode=function(h,m){h instanceof i||(h=i.create(h));for(var x=m===void 0?h.len:h.pos+m,w=new l.tensorflow.magenta.NoteSequence.SourceInfo;h.pos<x;){var _=h.uint32();switch(_>>>3){case 1:w.sourceType=h.int32();break;case 2:w.encodingType=h.int32();break;case 3:w.parser=h.int32();break;default:h.skipType(7&_)}}return w},d.decodeDelimited=function(h){return h instanceof i||(h=new i(h)),this.decode(h,h.uint32())},d.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.sourceType!=null&&h.hasOwnProperty("sourceType"))switch(h.sourceType){default:return"sourceType: enum value expected";case 0:case 1:case 2:}if(h.encodingType!=null&&h.hasOwnProperty("encodingType"))switch(h.encodingType){default:return"encodingType: enum value expected";case 0:case 1:case 2:case 3:case 4:}if(h.parser!=null&&h.hasOwnProperty("parser"))switch(h.parser){default:return"parser: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}return null},d.fromObject=function(h){if(h instanceof l.tensorflow.magenta.NoteSequence.SourceInfo)return h;var m=new l.tensorflow.magenta.NoteSequence.SourceInfo;switch(h.sourceType){case"UNKNOWN_SOURCE_TYPE":case 0:m.sourceType=0;break;case"SCORE_BASED":case 1:m.sourceType=1;break;case"PERFORMANCE_BASED":case 2:m.sourceType=2}switch(h.encodingType){case"UNKNOWN_ENCODING_TYPE":case 0:m.encodingType=0;break;case"MUSIC_XML":case 1:m.encodingType=1;break;case"ABC":case 2:m.encodingType=2;break;case"MIDI":case 3:m.encodingType=3;break;case"MUSICNET":case 4:m.encodingType=4}switch(h.parser){case"UNKNOWN_PARSER":case 0:m.parser=0;break;case"MUSIC21":case 1:m.parser=1;break;case"PRETTY_MIDI":case 2:m.parser=2;break;case"MAGENTA_MUSIC_XML":case 3:m.parser=3;break;case"MAGENTA_MUSICNET":case 4:m.parser=4;break;case"MAGENTA_ABC":case 5:m.parser=5;break;case"TONEJS_MIDI_CONVERT":case 6:m.parser=6}return m},d.toObject=function(h,m){m||(m={});var x={};return m.defaults&&(x.sourceType=m.enums===String?"UNKNOWN_SOURCE_TYPE":0,x.encodingType=m.enums===String?"UNKNOWN_ENCODING_TYPE":0,x.parser=m.enums===String?"UNKNOWN_PARSER":0),h.sourceType!=null&&h.hasOwnProperty("sourceType")&&(x.sourceType=m.enums===String?l.tensorflow.magenta.NoteSequence.SourceInfo.SourceType[h.sourceType]:h.sourceType),h.encodingType!=null&&h.hasOwnProperty("encodingType")&&(x.encodingType=m.enums===String?l.tensorflow.magenta.NoteSequence.SourceInfo.EncodingType[h.encodingType]:h.encodingType),h.parser!=null&&h.hasOwnProperty("parser")&&(x.parser=m.enums===String?l.tensorflow.magenta.NoteSequence.SourceInfo.Parser[h.parser]:h.parser),x},d.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},d.SourceType=function(){var h={},m=Object.create(h);return m[h[0]="UNKNOWN_SOURCE_TYPE"]=0,m[h[1]="SCORE_BASED"]=1,m[h[2]="PERFORMANCE_BASED"]=2,m}(),d.EncodingType=function(){var h={},m=Object.create(h);return m[h[0]="UNKNOWN_ENCODING_TYPE"]=0,m[h[1]="MUSIC_XML"]=1,m[h[2]="ABC"]=2,m[h[3]="MIDI"]=3,m[h[4]="MUSICNET"]=4,m}(),d.Parser=function(){var h={},m=Object.create(h);return m[h[0]="UNKNOWN_PARSER"]=0,m[h[1]="MUSIC21"]=1,m[h[2]="PRETTY_MIDI"]=2,m[h[3]="MAGENTA_MUSIC_XML"]=3,m[h[4]="MAGENTA_MUSICNET"]=4,m[h[5]="MAGENTA_ABC"]=5,m[h[6]="TONEJS_MIDI_CONVERT"]=6,m}(),d}(),p.TextAnnotation=function(){function d(h){if(h)for(var m=Object.keys(h),x=0;x<m.length;++x)h[m[x]]!=null&&(this[m[x]]=h[m[x]])}return d.prototype.time=0,d.prototype.quantizedStep=c.Long?c.Long.fromBits(0,0,!1):0,d.prototype.text="",d.prototype.annotationType=0,d.create=function(h){return new d(h)},d.encode=function(h,m){return m||(m=a.create()),h.time!=null&&h.hasOwnProperty("time")&&m.uint32(9).double(h.time),h.text!=null&&h.hasOwnProperty("text")&&m.uint32(18).string(h.text),h.annotationType!=null&&h.hasOwnProperty("annotationType")&&m.uint32(24).int32(h.annotationType),h.quantizedStep!=null&&h.hasOwnProperty("quantizedStep")&&m.uint32(32).int64(h.quantizedStep),m},d.encodeDelimited=function(h,m){return this.encode(h,m).ldelim()},d.decode=function(h,m){h instanceof i||(h=i.create(h));for(var x=m===void 0?h.len:h.pos+m,w=new l.tensorflow.magenta.NoteSequence.TextAnnotation;h.pos<x;){var _=h.uint32();switch(_>>>3){case 1:w.time=h.double();break;case 4:w.quantizedStep=c.Long?h.int64().toNumber():h.int64();break;case 2:w.text=h.string();break;case 3:w.annotationType=h.int32();break;default:h.skipType(7&_)}}return w},d.decodeDelimited=function(h){return h instanceof i||(h=new i(h)),this.decode(h,h.uint32())},d.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.time!=null&&h.hasOwnProperty("time")&&typeof h.time!="number")return"time: number expected";if(h.quantizedStep!=null&&h.hasOwnProperty("quantizedStep")&&!(c.isInteger(h.quantizedStep)||h.quantizedStep&&c.isInteger(h.quantizedStep.low)&&c.isInteger(h.quantizedStep.high)))return"quantizedStep: integer|Long expected";if(h.text!=null&&h.hasOwnProperty("text")&&!c.isString(h.text))return"text: string expected";if(h.annotationType!=null&&h.hasOwnProperty("annotationType"))switch(h.annotationType){default:return"annotationType: enum value expected";case 0:case 1:case 2:}return null},d.fromObject=function(h){if(h instanceof l.tensorflow.magenta.NoteSequence.TextAnnotation)return h;var m=new l.tensorflow.magenta.NoteSequence.TextAnnotation;switch(h.time!=null&&(m.time=Number(h.time)),h.quantizedStep!=null&&(c.Long?(m.quantizedStep=c.Long.fromValue(h.quantizedStep)).unsigned=!1:typeof h.quantizedStep=="string"?m.quantizedStep=parseInt(h.quantizedStep,10):typeof h.quantizedStep=="number"?m.quantizedStep=h.quantizedStep:typeof h.quantizedStep=="object"&&(m.quantizedStep=new c.LongBits(h.quantizedStep.low>>>0,h.quantizedStep.high>>>0).toNumber())),h.text!=null&&(m.text=String(h.text)),h.annotationType){case"UNKNOWN":case 0:m.annotationType=0;break;case"CHORD_SYMBOL":case 1:m.annotationType=1;break;case"BEAT":case 2:m.annotationType=2}return m},d.toObject=function(h,m){m||(m={});var x={};if(m.defaults)if(x.time=0,x.text="",x.annotationType=m.enums===String?"UNKNOWN":0,c.Long){var w=new c.Long(0,0,!1);x.quantizedStep=m.longs===String?w.toString():m.longs===Number?w.toNumber():w}else x.quantizedStep=m.longs===String?"0":0;return h.time!=null&&h.hasOwnProperty("time")&&(x.time=m.json&&!isFinite(h.time)?String(h.time):h.time),h.text!=null&&h.hasOwnProperty("text")&&(x.text=h.text),h.annotationType!=null&&h.hasOwnProperty("annotationType")&&(x.annotationType=m.enums===String?l.tensorflow.magenta.NoteSequence.TextAnnotation.TextAnnotationType[h.annotationType]:h.annotationType),h.quantizedStep!=null&&h.hasOwnProperty("quantizedStep")&&(typeof h.quantizedStep=="number"?x.quantizedStep=m.longs===String?String(h.quantizedStep):h.quantizedStep:x.quantizedStep=m.longs===String?c.Long.prototype.toString.call(h.quantizedStep):m.longs===Number?new c.LongBits(h.quantizedStep.low>>>0,h.quantizedStep.high>>>0).toNumber():h.quantizedStep),x},d.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},d.TextAnnotationType=function(){var h={},m=Object.create(h);return m[h[0]="UNKNOWN"]=0,m[h[1]="CHORD_SYMBOL"]=1,m[h[2]="BEAT"]=2,m}(),d}(),p.QuantizationInfo=function(){function d(m){if(m)for(var x=Object.keys(m),w=0;w<x.length;++w)m[x[w]]!=null&&(this[x[w]]=m[x[w]])}var h;return d.prototype.stepsPerQuarter=0,d.prototype.stepsPerSecond=0,Object.defineProperty(d.prototype,"resolution",{get:c.oneOfGetter(h=["stepsPerQuarter","stepsPerSecond"]),set:c.oneOfSetter(h)}),d.create=function(m){return new d(m)},d.encode=function(m,x){return x||(x=a.create()),m.stepsPerQuarter!=null&&m.hasOwnProperty("stepsPerQuarter")&&x.uint32(8).int32(m.stepsPerQuarter),m.stepsPerSecond!=null&&m.hasOwnProperty("stepsPerSecond")&&x.uint32(16).int32(m.stepsPerSecond),x},d.encodeDelimited=function(m,x){return this.encode(m,x).ldelim()},d.decode=function(m,x){m instanceof i||(m=i.create(m));for(var w=x===void 0?m.len:m.pos+x,_=new l.tensorflow.magenta.NoteSequence.QuantizationInfo;m.pos<w;){var I=m.uint32();switch(I>>>3){case 1:_.stepsPerQuarter=m.int32();break;case 2:_.stepsPerSecond=m.int32();break;default:m.skipType(7&I)}}return _},d.decodeDelimited=function(m){return m instanceof i||(m=new i(m)),this.decode(m,m.uint32())},d.verify=function(m){if(typeof m!="object"||m===null)return"object expected";var x={};if(m.stepsPerQuarter!=null&&m.hasOwnProperty("stepsPerQuarter")&&(x.resolution=1,!c.isInteger(m.stepsPerQuarter)))return"stepsPerQuarter: integer expected";if(m.stepsPerSecond!=null&&m.hasOwnProperty("stepsPerSecond")){if(x.resolution===1)return"resolution: multiple values";if(x.resolution=1,!c.isInteger(m.stepsPerSecond))return"stepsPerSecond: integer expected"}return null},d.fromObject=function(m){if(m instanceof l.tensorflow.magenta.NoteSequence.QuantizationInfo)return m;var x=new l.tensorflow.magenta.NoteSequence.QuantizationInfo;return m.stepsPerQuarter!=null&&(x.stepsPerQuarter=0|m.stepsPerQuarter),m.stepsPerSecond!=null&&(x.stepsPerSecond=0|m.stepsPerSecond),x},d.toObject=function(m,x){x||(x={});var w={};return m.stepsPerQuarter!=null&&m.hasOwnProperty("stepsPerQuarter")&&(w.stepsPerQuarter=m.stepsPerQuarter,x.oneofs&&(w.resolution="stepsPerQuarter")),m.stepsPerSecond!=null&&m.hasOwnProperty("stepsPerSecond")&&(w.stepsPerSecond=m.stepsPerSecond,x.oneofs&&(w.resolution="stepsPerSecond")),w},d.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},d}(),p.SubsequenceInfo=function(){function d(h){if(h)for(var m=Object.keys(h),x=0;x<m.length;++x)h[m[x]]!=null&&(this[m[x]]=h[m[x]])}return d.prototype.startTimeOffset=0,d.prototype.endTimeOffset=0,d.create=function(h){return new d(h)},d.encode=function(h,m){return m||(m=a.create()),h.startTimeOffset!=null&&h.hasOwnProperty("startTimeOffset")&&m.uint32(9).double(h.startTimeOffset),h.endTimeOffset!=null&&h.hasOwnProperty("endTimeOffset")&&m.uint32(17).double(h.endTimeOffset),m},d.encodeDelimited=function(h,m){return this.encode(h,m).ldelim()},d.decode=function(h,m){h instanceof i||(h=i.create(h));for(var x=m===void 0?h.len:h.pos+m,w=new l.tensorflow.magenta.NoteSequence.SubsequenceInfo;h.pos<x;){var _=h.uint32();switch(_>>>3){case 1:w.startTimeOffset=h.double();break;case 2:w.endTimeOffset=h.double();break;default:h.skipType(7&_)}}return w},d.decodeDelimited=function(h){return h instanceof i||(h=new i(h)),this.decode(h,h.uint32())},d.verify=function(h){return typeof h!="object"||h===null?"object expected":h.startTimeOffset!=null&&h.hasOwnProperty("startTimeOffset")&&typeof h.startTimeOffset!="number"?"startTimeOffset: number expected":h.endTimeOffset!=null&&h.hasOwnProperty("endTimeOffset")&&typeof h.endTimeOffset!="number"?"endTimeOffset: number expected":null},d.fromObject=function(h){if(h instanceof l.tensorflow.magenta.NoteSequence.SubsequenceInfo)return h;var m=new l.tensorflow.magenta.NoteSequence.SubsequenceInfo;return h.startTimeOffset!=null&&(m.startTimeOffset=Number(h.startTimeOffset)),h.endTimeOffset!=null&&(m.endTimeOffset=Number(h.endTimeOffset)),m},d.toObject=function(h,m){m||(m={});var x={};return m.defaults&&(x.startTimeOffset=0,x.endTimeOffset=0),h.startTimeOffset!=null&&h.hasOwnProperty("startTimeOffset")&&(x.startTimeOffset=m.json&&!isFinite(h.startTimeOffset)?String(h.startTimeOffset):h.startTimeOffset),h.endTimeOffset!=null&&h.hasOwnProperty("endTimeOffset")&&(x.endTimeOffset=m.json&&!isFinite(h.endTimeOffset)?String(h.endTimeOffset):h.endTimeOffset),x},d.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},d}(),p.SectionAnnotation=function(){function d(h){if(h)for(var m=Object.keys(h),x=0;x<m.length;++x)h[m[x]]!=null&&(this[m[x]]=h[m[x]])}return d.prototype.time=0,d.prototype.sectionId=c.Long?c.Long.fromBits(0,0,!1):0,d.create=function(h){return new d(h)},d.encode=function(h,m){return m||(m=a.create()),h.time!=null&&h.hasOwnProperty("time")&&m.uint32(9).double(h.time),h.sectionId!=null&&h.hasOwnProperty("sectionId")&&m.uint32(32).int64(h.sectionId),m},d.encodeDelimited=function(h,m){return this.encode(h,m).ldelim()},d.decode=function(h,m){h instanceof i||(h=i.create(h));for(var x=m===void 0?h.len:h.pos+m,w=new l.tensorflow.magenta.NoteSequence.SectionAnnotation;h.pos<x;){var _=h.uint32();switch(_>>>3){case 1:w.time=h.double();break;case 4:w.sectionId=c.Long?h.int64().toNumber():h.int64();break;default:h.skipType(7&_)}}return w},d.decodeDelimited=function(h){return h instanceof i||(h=new i(h)),this.decode(h,h.uint32())},d.verify=function(h){return typeof h!="object"||h===null?"object expected":h.time!=null&&h.hasOwnProperty("time")&&typeof h.time!="number"?"time: number expected":h.sectionId!=null&&h.hasOwnProperty("sectionId")&&!(c.isInteger(h.sectionId)||h.sectionId&&c.isInteger(h.sectionId.low)&&c.isInteger(h.sectionId.high))?"sectionId: integer|Long expected":null},d.fromObject=function(h){if(h instanceof l.tensorflow.magenta.NoteSequence.SectionAnnotation)return h;var m=new l.tensorflow.magenta.NoteSequence.SectionAnnotation;return h.time!=null&&(m.time=Number(h.time)),h.sectionId!=null&&(c.Long?(m.sectionId=c.Long.fromValue(h.sectionId)).unsigned=!1:typeof h.sectionId=="string"?m.sectionId=parseInt(h.sectionId,10):typeof h.sectionId=="number"?m.sectionId=h.sectionId:typeof h.sectionId=="object"&&(m.sectionId=new c.LongBits(h.sectionId.low>>>0,h.sectionId.high>>>0).toNumber())),m},d.toObject=function(h,m){m||(m={});var x={};if(m.defaults)if(x.time=0,c.Long){var w=new c.Long(0,0,!1);x.sectionId=m.longs===String?w.toString():m.longs===Number?w.toNumber():w}else x.sectionId=m.longs===String?"0":0;return h.time!=null&&h.hasOwnProperty("time")&&(x.time=m.json&&!isFinite(h.time)?String(h.time):h.time),h.sectionId!=null&&h.hasOwnProperty("sectionId")&&(typeof h.sectionId=="number"?x.sectionId=m.longs===String?String(h.sectionId):h.sectionId:x.sectionId=m.longs===String?c.Long.prototype.toString.call(h.sectionId):m.longs===Number?new c.LongBits(h.sectionId.low>>>0,h.sectionId.high>>>0).toNumber():h.sectionId),x},d.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},d}(),p.Section=function(){function d(m){if(m)for(var x=Object.keys(m),w=0;w<x.length;++w)m[x[w]]!=null&&(this[x[w]]=m[x[w]])}var h;return d.prototype.sectionId=c.Long?c.Long.fromBits(0,0,!1):0,d.prototype.sectionGroup=null,Object.defineProperty(d.prototype,"sectionType",{get:c.oneOfGetter(h=["sectionId","sectionGroup"]),set:c.oneOfSetter(h)}),d.create=function(m){return new d(m)},d.encode=function(m,x){return x||(x=a.create()),m.sectionId!=null&&m.hasOwnProperty("sectionId")&&x.uint32(8).int64(m.sectionId),m.sectionGroup!=null&&m.hasOwnProperty("sectionGroup")&&l.tensorflow.magenta.NoteSequence.SectionGroup.encode(m.sectionGroup,x.uint32(18).fork()).ldelim(),x},d.encodeDelimited=function(m,x){return this.encode(m,x).ldelim()},d.decode=function(m,x){m instanceof i||(m=i.create(m));for(var w=x===void 0?m.len:m.pos+x,_=new l.tensorflow.magenta.NoteSequence.Section;m.pos<w;){var I=m.uint32();switch(I>>>3){case 1:_.sectionId=c.Long?m.int64().toNumber():m.int64();break;case 2:_.sectionGroup=l.tensorflow.magenta.NoteSequence.SectionGroup.decode(m,m.uint32());break;default:m.skipType(7&I)}}return _},d.decodeDelimited=function(m){return m instanceof i||(m=new i(m)),this.decode(m,m.uint32())},d.verify=function(m){if(typeof m!="object"||m===null)return"object expected";var x={};if(m.sectionId!=null&&m.hasOwnProperty("sectionId")&&(x.sectionType=1,!(c.isInteger(m.sectionId)||m.sectionId&&c.isInteger(m.sectionId.low)&&c.isInteger(m.sectionId.high))))return"sectionId: integer|Long expected";if(m.sectionGroup!=null&&m.hasOwnProperty("sectionGroup")){if(x.sectionType===1)return"sectionType: multiple values";x.sectionType=1;var w=l.tensorflow.magenta.NoteSequence.SectionGroup.verify(m.sectionGroup);if(w)return"sectionGroup."+w}return null},d.fromObject=function(m){if(m instanceof l.tensorflow.magenta.NoteSequence.Section)return m;var x=new l.tensorflow.magenta.NoteSequence.Section;if(m.sectionId!=null&&(c.Long?(x.sectionId=c.Long.fromValue(m.sectionId)).unsigned=!1:typeof m.sectionId=="string"?x.sectionId=parseInt(m.sectionId,10):typeof m.sectionId=="number"?x.sectionId=m.sectionId:typeof m.sectionId=="object"&&(x.sectionId=new c.LongBits(m.sectionId.low>>>0,m.sectionId.high>>>0).toNumber())),m.sectionGroup!=null){if(typeof m.sectionGroup!="object")throw TypeError(".tensorflow.magenta.NoteSequence.Section.sectionGroup: object expected");x.sectionGroup=l.tensorflow.magenta.NoteSequence.SectionGroup.fromObject(m.sectionGroup)}return x},d.toObject=function(m,x){x||(x={});var w={};return m.sectionId!=null&&m.hasOwnProperty("sectionId")&&(typeof m.sectionId=="number"?w.sectionId=x.longs===String?String(m.sectionId):m.sectionId:w.sectionId=x.longs===String?c.Long.prototype.toString.call(m.sectionId):x.longs===Number?new c.LongBits(m.sectionId.low>>>0,m.sectionId.high>>>0).toNumber():m.sectionId,x.oneofs&&(w.sectionType="sectionId")),m.sectionGroup!=null&&m.hasOwnProperty("sectionGroup")&&(w.sectionGroup=l.tensorflow.magenta.NoteSequence.SectionGroup.toObject(m.sectionGroup,x),x.oneofs&&(w.sectionType="sectionGroup")),w},d.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},d}(),p.SectionGroup=function(){function d(h){if(this.sections=[],h)for(var m=Object.keys(h),x=0;x<m.length;++x)h[m[x]]!=null&&(this[m[x]]=h[m[x]])}return d.prototype.sections=c.emptyArray,d.prototype.numTimes=0,d.create=function(h){return new d(h)},d.encode=function(h,m){if(m||(m=a.create()),h.sections!=null&&h.sections.length)for(var x=0;x<h.sections.length;++x)l.tensorflow.magenta.NoteSequence.Section.encode(h.sections[x],m.uint32(10).fork()).ldelim();return h.numTimes!=null&&h.hasOwnProperty("numTimes")&&m.uint32(16).int32(h.numTimes),m},d.encodeDelimited=function(h,m){return this.encode(h,m).ldelim()},d.decode=function(h,m){h instanceof i||(h=i.create(h));for(var x=m===void 0?h.len:h.pos+m,w=new l.tensorflow.magenta.NoteSequence.SectionGroup;h.pos<x;){var _=h.uint32();switch(_>>>3){case 1:w.sections&&w.sections.length||(w.sections=[]),w.sections.push(l.tensorflow.magenta.NoteSequence.Section.decode(h,h.uint32()));break;case 2:w.numTimes=h.int32();break;default:h.skipType(7&_)}}return w},d.decodeDelimited=function(h){return h instanceof i||(h=new i(h)),this.decode(h,h.uint32())},d.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.sections!=null&&h.hasOwnProperty("sections")){if(!Array.isArray(h.sections))return"sections: array expected";for(var m=0;m<h.sections.length;++m){var x=l.tensorflow.magenta.NoteSequence.Section.verify(h.sections[m]);if(x)return"sections."+x}}return h.numTimes!=null&&h.hasOwnProperty("numTimes")&&!c.isInteger(h.numTimes)?"numTimes: integer expected":null},d.fromObject=function(h){if(h instanceof l.tensorflow.magenta.NoteSequence.SectionGroup)return h;var m=new l.tensorflow.magenta.NoteSequence.SectionGroup;if(h.sections){if(!Array.isArray(h.sections))throw TypeError(".tensorflow.magenta.NoteSequence.SectionGroup.sections: array expected");m.sections=[];for(var x=0;x<h.sections.length;++x){if(typeof h.sections[x]!="object")throw TypeError(".tensorflow.magenta.NoteSequence.SectionGroup.sections: object expected");m.sections[x]=l.tensorflow.magenta.NoteSequence.Section.fromObject(h.sections[x])}}return h.numTimes!=null&&(m.numTimes=0|h.numTimes),m},d.toObject=function(h,m){m||(m={});var x={};if((m.arrays||m.defaults)&&(x.sections=[]),m.defaults&&(x.numTimes=0),h.sections&&h.sections.length){x.sections=[];for(var w=0;w<h.sections.length;++w)x.sections[w]=l.tensorflow.magenta.NoteSequence.Section.toObject(h.sections[w],m)}return h.numTimes!=null&&h.hasOwnProperty("numTimes")&&(x.numTimes=h.numTimes),x},d.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},d}(),p}(),r.SequenceMetadata=function(){function p(f){if(this.genre=[],this.composers=[],f)for(var y=Object.keys(f),d=0;d<y.length;++d)f[y[d]]!=null&&(this[y[d]]=f[y[d]])}return p.prototype.title="",p.prototype.artist="",p.prototype.genre=c.emptyArray,p.prototype.composers=c.emptyArray,p.create=function(f){return new p(f)},p.encode=function(f,y){if(y||(y=a.create()),f.title!=null&&f.hasOwnProperty("title")&&y.uint32(10).string(f.title),f.artist!=null&&f.hasOwnProperty("artist")&&y.uint32(18).string(f.artist),f.genre!=null&&f.genre.length)for(var d=0;d<f.genre.length;++d)y.uint32(26).string(f.genre[d]);if(f.composers!=null&&f.composers.length)for(d=0;d<f.composers.length;++d)y.uint32(34).string(f.composers[d]);return y},p.encodeDelimited=function(f,y){return this.encode(f,y).ldelim()},p.decode=function(f,y){f instanceof i||(f=i.create(f));for(var d=y===void 0?f.len:f.pos+y,h=new l.tensorflow.magenta.SequenceMetadata;f.pos<d;){var m=f.uint32();switch(m>>>3){case 1:h.title=f.string();break;case 2:h.artist=f.string();break;case 3:h.genre&&h.genre.length||(h.genre=[]),h.genre.push(f.string());break;case 4:h.composers&&h.composers.length||(h.composers=[]),h.composers.push(f.string());break;default:f.skipType(7&m)}}return h},p.decodeDelimited=function(f){return f instanceof i||(f=new i(f)),this.decode(f,f.uint32())},p.verify=function(f){if(typeof f!="object"||f===null)return"object expected";if(f.title!=null&&f.hasOwnProperty("title")&&!c.isString(f.title))return"title: string expected";if(f.artist!=null&&f.hasOwnProperty("artist")&&!c.isString(f.artist))return"artist: string expected";if(f.genre!=null&&f.hasOwnProperty("genre")){if(!Array.isArray(f.genre))return"genre: array expected";for(var y=0;y<f.genre.length;++y)if(!c.isString(f.genre[y]))return"genre: string[] expected"}if(f.composers!=null&&f.hasOwnProperty("composers")){if(!Array.isArray(f.composers))return"composers: array expected";for(y=0;y<f.composers.length;++y)if(!c.isString(f.composers[y]))return"composers: string[] expected"}return null},p.fromObject=function(f){if(f instanceof l.tensorflow.magenta.SequenceMetadata)return f;var y=new l.tensorflow.magenta.SequenceMetadata;if(f.title!=null&&(y.title=String(f.title)),f.artist!=null&&(y.artist=String(f.artist)),f.genre){if(!Array.isArray(f.genre))throw TypeError(".tensorflow.magenta.SequenceMetadata.genre: array expected");y.genre=[];for(var d=0;d<f.genre.length;++d)y.genre[d]=String(f.genre[d])}if(f.composers){if(!Array.isArray(f.composers))throw TypeError(".tensorflow.magenta.SequenceMetadata.composers: array expected");for(y.composers=[],d=0;d<f.composers.length;++d)y.composers[d]=String(f.composers[d])}return y},p.toObject=function(f,y){y||(y={});var d={};if((y.arrays||y.defaults)&&(d.genre=[],d.composers=[]),y.defaults&&(d.title="",d.artist=""),f.title!=null&&f.hasOwnProperty("title")&&(d.title=f.title),f.artist!=null&&f.hasOwnProperty("artist")&&(d.artist=f.artist),f.genre&&f.genre.length){d.genre=[];for(var h=0;h<f.genre.length;++h)d.genre[h]=f.genre[h]}if(f.composers&&f.composers.length)for(d.composers=[],h=0;h<f.composers.length;++h)d.composers[h]=f.composers[h];return d},p.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},p}(),r.VelocityRange=function(){function p(f){if(f)for(var y=Object.keys(f),d=0;d<y.length;++d)f[y[d]]!=null&&(this[y[d]]=f[y[d]])}return p.prototype.min=0,p.prototype.max=0,p.create=function(f){return new p(f)},p.encode=function(f,y){return y||(y=a.create()),f.min!=null&&f.hasOwnProperty("min")&&y.uint32(8).int32(f.min),f.max!=null&&f.hasOwnProperty("max")&&y.uint32(16).int32(f.max),y},p.encodeDelimited=function(f,y){return this.encode(f,y).ldelim()},p.decode=function(f,y){f instanceof i||(f=i.create(f));for(var d=y===void 0?f.len:f.pos+y,h=new l.tensorflow.magenta.VelocityRange;f.pos<d;){var m=f.uint32();switch(m>>>3){case 1:h.min=f.int32();break;case 2:h.max=f.int32();break;default:f.skipType(7&m)}}return h},p.decodeDelimited=function(f){return f instanceof i||(f=new i(f)),this.decode(f,f.uint32())},p.verify=function(f){return typeof f!="object"||f===null?"object expected":f.min!=null&&f.hasOwnProperty("min")&&!c.isInteger(f.min)?"min: integer expected":f.max!=null&&f.hasOwnProperty("max")&&!c.isInteger(f.max)?"max: integer expected":null},p.fromObject=function(f){if(f instanceof l.tensorflow.magenta.VelocityRange)return f;var y=new l.tensorflow.magenta.VelocityRange;return f.min!=null&&(y.min=0|f.min),f.max!=null&&(y.max=0|f.max),y},p.toObject=function(f,y){y||(y={});var d={};return y.defaults&&(d.min=0,d.max=0),f.min!=null&&f.hasOwnProperty("min")&&(d.min=f.min),f.max!=null&&f.hasOwnProperty("max")&&(d.max=f.max),d},p.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},p}(),r),o),n.exports=l},function(n,t,e){"use strict";e.r(t),e.d(t,"converterFromSpec",function(){return p}),e.d(t,"DataConverter",function(){return f}),e.d(t,"DrumsConverter",function(){return y}),e.d(t,"DrumRollConverter",function(){return d}),e.d(t,"DrumsOneHotConverter",function(){return h}),e.d(t,"MelodyConverter",function(){return m}),e.d(t,"MelodyRhythmConverter",function(){return w}),e.d(t,"MelodyShapeConverter",function(){return _}),e.d(t,"TrioConverter",function(){return I}),e.d(t,"TrioRhythmConverter",function(){return T}),e.d(t,"MultitrackConverter",function(){return D}),e.d(t,"GrooveConverter",function(){return O});var r=e(2),o=e(10),s=e(8);e.d(t,"DEFAULT_DRUM_PITCH_CLASSES",function(){return s.DEFAULT_DRUM_PITCH_CLASSES});var i=e(12),a=e(23),c=e(29),l=e(13);function p(R){switch(R.type){case"MelodyConverter":return new m(R.args);case"MelodyRhythmConverter":return new w(R.args);case"MelodyShapeConverter":return new _(R.args);case"DrumsConverter":return new y(R.args);case"DrumRollConverter":return new d(R.args);case"TrioConverter":return new I(R.args);case"TrioRhythmConverter":return new T(R.args);case"DrumsOneHotConverter":return new h(R.args);case"MultitrackConverter":return new D(R.args);case"GrooveConverter":return new O(R.args);default:throw new Error("Unknown DataConverter type: "+R)}}class f{constructor(P){this.NUM_SPLITS=0,this.SEGMENTED_BY_TRACK=!1,this.numSteps=P.numSteps,this.numSegments=P.numSegments}tensorSteps(P){return r.scalar(P.shape[0],"int32")}}class y extends f{constructor(P){super(P),this.pitchClasses=P.pitchClasses||s.DEFAULT_DRUM_PITCH_CLASSES,this.pitchToClass=new Map;for(let j=0;j<this.pitchClasses.length;++j)this.pitchClasses[j].forEach(G=>{this.pitchToClass.set(G,j)});this.depth=this.pitchClasses.length+1}toTensor(P){l.assertIsQuantizedSequence(P);let j=this.numSteps||P.totalQuantizedSteps,G=r.buffer([j,this.pitchClasses.length+1],"int32");for(let Q=0;Q<j;++Q)G.set(1,Q,-1);return P.notes.forEach(Q=>{G.set(1,Q.quantizedStartStep,this.pitchToClass.get(Q.pitch)),G.set(0,Q.quantizedStartStep,-1)}),G.toTensor()}toNoteSequence(P,j,G){return Y(this,null,function*(){let Q=l.createQuantizedNoteSequence(j,G),ie=P.argMax(1),pe=yield ie.data();ie.dispose();for(let xe=0;xe<pe.length;++xe)for(let ne=0;ne<this.pitchClasses.length;ne++)pe[xe]>>ne&1&&Q.notes.push(o.a.Note.create({pitch:this.pitchClasses[ne][0],quantizedStartStep:xe,quantizedEndStep:xe+1,isDrum:!0}));return Q.totalQuantizedSteps=pe.length,Q})}}class d extends y{toNoteSequence(P,j,G){return Y(this,null,function*(){let Q=l.createQuantizedNoteSequence(j,G),ie=yield P.data();for(let pe=0;pe<P.shape[0];++pe){let xe=ie.slice(pe*this.pitchClasses.length,(pe+1)*this.pitchClasses.length);for(let ne=0;ne<xe.length;++ne)xe[ne]&&Q.notes.push(o.a.Note.create({pitch:this.pitchClasses[ne][0],quantizedStartStep:pe,quantizedEndStep:pe+1,isDrum:!0}))}return Q.totalQuantizedSteps=P.shape[0],Q})}}class h extends y{constructor(P){super(P),this.depth=Math.pow(2,this.pitchClasses.length)}toTensor(P){l.assertIsRelativeQuantizedSequence(P);let j=this.numSteps||P.totalQuantizedSteps,G=Array(j).fill(0);for(let{pitch:Q,quantizedStartStep:ie}of P.notes)G[ie]+=Math.pow(2,this.pitchToClass.get(Q));return r.tidy(()=>r.oneHot(r.tensor1d(G,"int32"),this.depth))}}class m extends f{constructor(P){super(P),this.NOTE_OFF=1,this.FIRST_PITCH=2,this.minPitch=P.minPitch,this.maxPitch=P.maxPitch,this.ignorePolyphony=P.ignorePolyphony,this.depth=P.maxPitch-P.minPitch+1+this.FIRST_PITCH}toTensor(P){let j=a.Melody.fromNoteSequence(P,this.minPitch,this.maxPitch,this.ignorePolyphony,this.numSteps);return r.tidy(()=>r.oneHot(r.tensor(j.events,[j.events.length],"int32"),this.depth))}toNoteSequence(P,j,G){return Y(this,null,function*(){let Q=P.argMax(1),ie=yield Q.data();return Q.dispose(),new a.Melody(ie,this.minPitch,this.maxPitch).toNoteSequence(j,G)})}}class x extends f{constructor(P,j){super(P),this.minPitch=P.minPitch,this.maxPitch=P.maxPitch,this.ignorePolyphony=P.ignorePolyphony,this.melodyControl=j,this.depth=j.depth}toTensor(P){let j=a.Melody.fromNoteSequence(P,this.minPitch,this.maxPitch,this.ignorePolyphony,this.numSteps);return this.melodyControl.extract(j)}}class w extends x{constructor(P){super(P,new a.MelodyRhythm)}toNoteSequence(P,j,G){return Y(this,null,function*(){let Q=l.createQuantizedNoteSequence(j,G),ie=yield P.data();for(let pe=0;pe<ie.length;++pe)ie[pe]&&Q.notes.push(o.a.Note.create({pitch:s.DEFAULT_DRUM_PITCH_CLASSES[1][0],quantizedStartStep:pe,quantizedEndStep:pe+1,isDrum:!0}));return Q.totalQuantizedSteps=ie.length,Q})}}class _ extends x{constructor(P){super(P,new a.MelodyShape)}toNoteSequence(P,j,G){return Y(this,null,function*(){let Q=l.createQuantizedNoteSequence(j,G),ie=P.argMax(1),pe=yield ie.data();ie.dispose();let xe=Math.round((this.maxPitch+this.minPitch)/2);for(let ne=0;ne<pe.length;++ne){switch(pe[ne]){case 0:xe-=1,xe<this.minPitch&&(xe=this.minPitch,i.log("Pitch range exceeded when creating NoteSequence from shape.","MelodyShapeConverter"));break;case 2:xe+=1,xe>this.maxPitch&&(xe=this.maxPitch,i.log("Pitch range exceeded when creating NoteSequence from shape.","MelodyShapeConverter"))}Q.notes.push(o.a.Note.create({pitch:xe,quantizedStartStep:ne,quantizedEndStep:ne+1}))}return Q.totalQuantizedSteps=pe.length,Q})}}class I extends f{constructor(P){super(P),this.NUM_SPLITS=3,this.MEL_PROG_RANGE=[0,31],this.BASS_PROG_RANGE=[32,39],P.melArgs.numSteps=P.numSteps,P.bassArgs.numSteps=P.numSteps,P.drumsArgs.numSteps=P.numSteps,this.melConverter=new m(P.melArgs),this.bassConverter=new m(P.bassArgs),this.drumsConverter=new h(P.drumsArgs),this.depth=this.melConverter.depth+this.bassConverter.depth+this.drumsConverter.depth}toTensor(P){l.assertIsQuantizedSequence(P);let j=l.clone(P),G=l.clone(P),Q=l.clone(P);return j.notes=P.notes.filter(ie=>!ie.isDrum&&ie.program>=this.MEL_PROG_RANGE[0]&&ie.program<=this.MEL_PROG_RANGE[1]),G.notes=P.notes.filter(ie=>!ie.isDrum&&ie.program>=this.BASS_PROG_RANGE[0]&&ie.program<=this.BASS_PROG_RANGE[1]),Q.notes=P.notes.filter(ie=>ie.isDrum),r.tidy(()=>r.concat([this.melConverter.toTensor(j),this.bassConverter.toTensor(G),this.drumsConverter.toTensor(Q)],-1))}toNoteSequence(P,j,G){return Y(this,null,function*(){let Q=r.split(P,[this.melConverter.depth,this.bassConverter.depth,this.drumsConverter.depth],-1),ie=yield this.melConverter.toNoteSequence(Q[0],j,G);ie.notes.forEach(ne=>{ne.instrument=0,ne.program=0});let pe=yield this.bassConverter.toNoteSequence(Q[1],j,G);ie.notes.push(...pe.notes.map(ne=>(ne.instrument=1,ne.program=this.BASS_PROG_RANGE[0],ne)));let xe=yield this.drumsConverter.toNoteSequence(Q[2],j,G);return ie.notes.push(...xe.notes.map(ne=>(ne.instrument=2,ne))),Q.forEach(ne=>ne.dispose()),ie})}}class T extends f{constructor(P){super(P),this.NUM_SPLITS=3,this.trioConverter=new I(P),this.depth=3}toTensor(P){return r.tidy(()=>{let j=this.trioConverter.toTensor(P),G=r.split(j,[this.trioConverter.melConverter.depth,this.trioConverter.bassConverter.depth,this.trioConverter.drumsConverter.depth],1),Q=r.argMax(G[0],1),ie=r.argMax(G[1],1),pe=r.argMax(G[2],1),xe=r.greater(Q,1),ne=r.greater(ie,1),fe=r.greater(pe,0);return r.stack([xe,ne,fe],1)})}toNoteSequence(P,j,G){return Y(this,null,function*(){let Q=r.split(P,3,1),ie=yield Promise.all(Q.map(xe=>xe.data())),pe=l.createQuantizedNoteSequence(j,G);for(let xe=0;xe<this.numSteps;++xe)ie[0][xe]&&pe.notes.push(o.a.Note.create({pitch:72,quantizedStartStep:xe,quantizedEndStep:xe+1,instrument:0,program:0})),ie[1][xe]&&pe.notes.push(o.a.Note.create({pitch:36,quantizedStartStep:xe,quantizedEndStep:xe+1,instrument:1,program:32})),ie[2][xe]&&pe.notes.push(o.a.Note.create({pitch:s.DEFAULT_DRUM_PITCH_CLASSES[1][0],quantizedStartStep:xe,quantizedEndStep:xe+1,instrument:2,isDrum:!0}));return pe.totalQuantizedSteps=this.numSteps,pe})}}class D extends f{constructor(P){super(P),this.SEGMENTED_BY_TRACK=!0,this.stepsPerQuarter=P.stepsPerQuarter,this.totalSteps=P.totalSteps,this.numVelocityBins=P.numVelocityBins,this.minPitch=P.minPitch?P.minPitch:s.MIN_MIDI_PITCH,this.maxPitch=P.maxPitch?P.maxPitch:s.MAX_MIDI_PITCH,this.numPitches=this.maxPitch-this.minPitch+1,this.performanceEventDepth=2*this.numPitches+this.totalSteps+this.numVelocityBins,this.numPrograms=s.MAX_MIDI_PROGRAM-s.MIN_MIDI_PROGRAM+2,this.endToken=this.performanceEventDepth+this.numPrograms,this.depth=this.endToken+1,this.endTensor=r.tidy(()=>r.oneHot(r.tensor1d([this.endToken],"int32"),this.depth).as1D())}trackToTensor(P){let j=this.numSteps/this.numSegments,G;if(P){for(;P.events.length>j-2;)P.events.pop();G=r.buffer([P.events.length+2],"int32"),G.set(this.performanceEventDepth+(P.isDrum?this.numPrograms-1:P.program),0),P.events.forEach((Q,ie)=>{switch(Q.type){case"note-on":G.set(Q.pitch-this.minPitch,ie+1);break;case"note-off":G.set(this.numPitches+Q.pitch-this.minPitch,ie+1);break;case"time-shift":G.set(2*this.numPitches+Q.steps-1,ie+1);break;case"velocity-change":G.set(2*this.numPitches+this.totalSteps+Q.velocityBin-1,ie+1);break;default:throw new Error("Unrecognized performance event: "+Q)}}),G.set(this.endToken,P.events.length+1)}else G=r.buffer([1],"int32",new Int32Array([this.endToken]));return r.tidy(()=>{let Q=r.oneHot(G.toTensor(),this.depth);return Q.pad([[0,j-Q.shape[0]],[0,0]])})}toTensor(P){if(l.assertIsRelativeQuantizedSequence(P),P.quantizationInfo.stepsPerQuarter!==this.stepsPerQuarter)throw new Error(`Steps per quarter note mismatch: ${P.quantizationInfo.stepsPerQuarter} != ${this.stepsPerQuarter}`);let j=l.clone(P);j.notes=P.notes.filter(ie=>ie.pitch>=this.minPitch&&ie.pitch<=this.maxPitch);let G=new Set(j.notes.map(ie=>ie.instrument)),Q=Array.from(G).map(ie=>c.Performance.fromNoteSequence(j,this.totalSteps,this.numVelocityBins,ie)).sort((ie,pe)=>pe.isDrum?-1:ie.isDrum?1:ie.program-pe.program);for(;Q.length>this.numSegments;)Q.pop();for(Q.forEach(ie=>ie.setNumSteps(this.totalSteps));Q.length<this.numSegments;)Q.push(void 0);return r.tidy(()=>r.concat(Q.map(ie=>this.trackToTensor(ie)),0))}tokensToTrack(P){let j=P.indexOf(this.endToken),G=j>=0?j:P.length,Q=P.slice(0,G),ie=Q.filter(te=>te<this.performanceEventDepth),pe=Q.filter(te=>te>=this.performanceEventDepth),[xe,ne]=pe.length?pe[0]-this.performanceEventDepth<this.numPrograms-1?[pe[0]-this.performanceEventDepth,!1]:[0,!0]:[0,!1],fe=Array.from(ie).map(te=>{if(te<this.numPitches)return{type:"note-on",pitch:this.minPitch+te};if(te<2*this.numPitches)return{type:"note-off",pitch:this.minPitch+te-this.numPitches};if(te<2*this.numPitches+this.totalSteps)return{type:"time-shift",steps:te-2*this.numPitches+1};if(te<2*this.numPitches+this.totalSteps+this.numVelocityBins)return{type:"velocity-change",velocityBin:te-2*this.numPitches-this.totalSteps+1};throw new Error("Invalid performance event token: "+te)});return new c.Performance(fe,this.totalSteps,this.numVelocityBins,xe,ne)}toNoteSequence(Q){return Y(this,arguments,function*(P,j=this.stepsPerQuarter,G){let ie=l.createQuantizedNoteSequence(j,G);ie.totalQuantizedSteps=this.totalSteps;let pe=r.tidy(()=>r.split(P.argMax(1),this.numSegments));return(yield Promise.all(pe.map(xe=>Y(this,null,function*(){let ne=yield xe.data(),fe=this.tokensToTrack(ne);return xe.dispose(),fe})))).forEach((xe,ne)=>{xe.setNumSteps(this.totalSteps),ie.notes.push(...xe.toNoteSequence(ne).notes)}),ie})}}class O extends f{constructor(P){super(P),this.TAPIFY_CHANNEL=3,this.stepsPerQuarter=P.stepsPerQuarter||s.DEFAULT_STEPS_PER_QUARTER,this.pitchClasses=P.pitchClasses||s.DEFAULT_DRUM_PITCH_CLASSES,this.pitchToClass=new Map;for(let j=0;j<this.pitchClasses.length;++j)this.pitchClasses[j].forEach(G=>{this.pitchToClass.set(G,j)});this.humanize=P.humanize||!1,this.tapify=P.tapify||!1,this.splitInstruments=P.splitInstruments||!1,this.depth=3}toTensor(P){let j=l.isRelativeQuantizedSequence(P)?P:l.quantizeNoteSequence(P,this.stepsPerQuarter),G=this.numSteps,Q=j.tempos&&j.tempos.length?j.tempos[0].qpm:s.DEFAULT_QUARTERS_PER_MINUTE,ie=60/Q/this.stepsPerQuarter,pe=[];for(let ee=0;ee<G;++ee)pe.push(new Map);j.notes.forEach(ee=>{if(!this.tapify&&!this.pitchToClass.has(ee.pitch))return;let we=ee.quantizedStartStep;if(we>=pe.length)throw Error(`Model does not support sequences with more than ${G} steps (${G*ie} seconds at qpm ${Q}).`);let be=this.tapify?this.TAPIFY_CHANNEL:this.pitchToClass.get(ee.pitch);(!pe[we].has(be)||pe[we].get(be).velocity<ee.velocity)&&pe[we].set(be,ee)});let xe=this.pitchClasses.length,ne=r.buffer([G,xe]),fe=r.buffer([G,xe]),te=r.buffer([G,xe]);function se(ee){if(ee.startTime===void 0)return 0;let we=ee.startTime;return 2*(ee.quantizedStartStep*ie-we)/ie}for(let ee=0;ee<G;++ee)for(let we=0;we<xe;++we){let be=pe[ee].get(we);ne.set(be?1:0,ee,we),this.humanize||this.tapify||fe.set(be?be.velocity/s.MAX_MIDI_VELOCITY:0,ee,we),this.humanize||te.set(be?se(be):0,ee,we)}return r.tidy(()=>{let ee=ne.toTensor(),we=fe.toTensor(),be=te.toTensor(),ke=this.splitInstruments?G*xe:G;return r.concat([ee.as2D(ke,-1),we.as2D(ke,-1),be.as2D(ke,-1)],1)})}toNoteSequence(Q,ie){return Y(this,arguments,function*(P,j,G=s.DEFAULT_QUARTERS_PER_MINUTE){if(j&&j!==this.stepsPerQuarter)throw Error("`stepsPerQuarter` is set by the model.");j=this.stepsPerQuarter;let pe=this.splitInstruments?P.shape[0]/this.pitchClasses.length:P.shape[0],xe=60/G/this.stepsPerQuarter,ne=o.a.create({totalTime:pe*xe,tempos:[{qpm:G}]}),fe=yield P.data();function te(ee,we,be){return Math.min(Math.max(ee,we),be)}let se=this.pitchClasses.length;for(let ee=0;ee<pe;++ee){let we=fe.slice(ee*se*this.depth,(ee+1)*se*this.depth);for(let be=0;be<se;++be){let ke=we[this.splitInstruments?be*this.depth:be],De=we[this.splitInstruments?be*this.depth+1:se+be],Re=we[this.splitInstruments?be*this.depth+2:2*se+be];if(ke>.5){let Ce=te(Math.round(De*s.MAX_MIDI_VELOCITY),s.MIN_MIDI_VELOCITY,s.MAX_MIDI_VELOCITY),Je=te(Re/2,-.5,.5);ne.notes.push(o.a.Note.create({pitch:this.pitchClasses[be][0],startTime:(ee-Je)*xe,endTime:(ee-Je+1)*xe,velocity:Ce,isDrum:!0}))}}}return ne})}}},function(n,t,e){"use strict";e.r(t),e.d(t,"ChordQuality",function(){return Vg}),e.d(t,"ChordSymbolException",function(){return hd}),e.d(t,"ChordEncodingException",function(){return Ob}),e.d(t,"ChordSymbols",function(){return ta}),e.d(t,"ChordEncoder",function(){return qg}),e.d(t,"chordEncoderFromType",function(){return Hk}),e.d(t,"MajorMinorChordEncoder",function(){return fo}),e.d(t,"TriadChordEncoder",function(){return fd}),e.d(t,"PitchChordEncoder",function(){return ZS});var r={};e.r(r),e.d(r,"names",function(){return a}),e.d(r,"tokenize",function(){return f}),e.d(r,"props",function(){return h}),e.d(r,"name",function(){return m}),e.d(r,"pc",function(){return x}),e.d(r,"midi",function(){return w}),e.d(r,"midiToFreq",function(){return _}),e.d(r,"freq",function(){return I}),e.d(r,"freqToMidi",function(){return O}),e.d(r,"chroma",function(){return R}),e.d(r,"oct",function(){return P}),e.d(r,"stepToLetter",function(){return j}),e.d(r,"altToAcc",function(){return Q}),e.d(r,"from",function(){return ie}),e.d(r,"build",function(){return pe}),e.d(r,"fromMidi",function(){return xe}),e.d(r,"simplify",function(){return ne}),e.d(r,"enharmonic",function(){return fe});var o={};e.r(o),e.d(o,"names",function(){return ai}),e.d(o,"props",function(){return Wa}),e.d(o,"intervals",function(){return Rc}),e.d(o,"notes",function(){return Eh}),e.d(o,"exists",function(){return Rl}),e.d(o,"supersets",function(){return Nh}),e.d(o,"subsets",function(){return Ab}),e.d(o,"tokenize",function(){return Bg});var s=e(2),i="C C# Db D D# Eb E F F# Gb G G# Ab A A# Bb B".split(" "),a=function($e){return typeof $e!="string"?i.slice():i.filter(function(Ve){var ot=Ve[1]||" ";return $e.indexOf(ot)!==-1})},c=a(" #"),l=a(" b"),p=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function f($e){typeof $e!="string"&&($e="");var Ve=p.exec($e);return[Ve[1].toUpperCase(),Ve[2].replace(/x/g,"##"),Ve[3],Ve[4]]}var y=Object.freeze({pc:null,name:null,step:null,alt:null,oct:null,octStr:null,chroma:null,midi:null,freq:null}),d=[0,2,4,5,7,9,11],h=function($e,Ve){return Ve===void 0&&(Ve={}),function(ot){return Ve[ot]||(Ve[ot]=$e(ot))}}(function($e){var Ve=f($e);if(Ve[0]===""||Ve[3]!=="")return y;var ot=Ve[0],ht=Ve[1],ft=Ve[2],dn={letter:ot,acc:ht,octStr:ft,pc:ot+ht,name:ot+ht+ft,step:(ot.charCodeAt(0)+3)%7,alt:ht[0]==="b"?-ht.length:ht.length,oct:ft.length?+ft:null,chroma:0,midi:null,freq:null};return dn.chroma=(d[dn.step]+dn.alt+120)%12,dn.midi=dn.oct!==null?d[dn.step]+dn.alt+12*(dn.oct+1):null,dn.freq=_(dn.midi),Object.freeze(dn)}),m=function($e){return h($e).name},x=function($e){return h($e).pc},w=function($e){if(typeof $e!="number"&&typeof $e!="string")return null;var Ve,ot=h($e).midi,ht=ot||ot===0?ot:+$e;return(Ve=ht)>=0&&Ve<=127?ht:null},_=function($e,Ve){return Ve===void 0&&(Ve=440),typeof $e=="number"?Math.pow(2,($e-69)/12)*Ve:null},I=function($e){return h($e).freq||_($e)},T=Math.log(2),D=Math.log(440),O=function($e){var Ve=12*(Math.log($e)-D)/T+69;return Math.round(100*Ve)/100},R=function($e){return h($e).chroma},P=function($e){return h($e).oct},j=function($e){return"CDEFGAB"[$e]},G=function($e,Ve){return Array(Ve+1).join($e)},Q=function($e){return function(Ve,ot){return typeof Ve!="number"?"":ot(Ve)}($e,function(Ve){return Ve<0?G("b",-Ve):G("#",Ve)})},ie=function($e,Ve){$e===void 0&&($e={}),Ve===void 0&&(Ve=null);var ot=Ve?Object.assign({},h(Ve),$e):$e,ht=ot.step,ft=ot.alt,dn=ot.oct;if(typeof ht!="number")return null;var Qt=j(ht);if(!Qt)return null;var ar=Qt+Q(ft);return dn||dn===0?ar+dn:ar},pe=ie;function xe($e,Ve){return Ve===void 0&&(Ve=!1),$e=Math.round($e),(Ve===!0?c:l)[$e%12]+(Math.floor($e/12)-1)}var ne=function($e,Ve){Ve===void 0&&(Ve=!0);var ot=h($e),ht=ot.alt,ft=ot.chroma,dn=ot.midi;if(ft===null)return null;var Qt=Ve===!1?ht<0:ht>0;return dn===null?x(xe(ft,Qt)):xe(dn,Qt)},fe=function($e){return ne($e,!1)},te=new RegExp("^([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})|(AA|A|P|M|m|d|dd)([-+]?\\d+)$"),se=[0,2,4,5,7,9,11],ee=("1P 2m 2M 3m 3M 4P 5P 6m 6M 7m 7M 8P".split(" "),Object.freeze({name:null,num:null,q:null,step:null,alt:null,dir:null,type:null,simple:null,semitones:null,chroma:null,oct:null})),we=function($e){return(Math.abs($e)-1)%7},be=function($e){var Ve=function(dn){var Qt=te.exec(""+dn);return Qt===null?null:Qt[1]?[Qt[1],Qt[2]]:[Qt[4],Qt[3]]}($e);if(Ve===null)return ee;var ot,ht,ft={num:0,q:"d",name:"",type:"M",step:0,dir:-1,simple:1,alt:0,oct:0,semitones:0,chroma:0,ic:0};return ft.num=+Ve[0],ft.q=Ve[1],ft.step=we(ft.num),ft.type="PMMPPMM"[ft.step],ft.type==="M"&&ft.q==="P"?ee:(ft.name=""+ft.num+ft.q,ft.dir=ft.num<0?-1:1,ft.simple=ft.num===8||ft.num===-8?ft.num:ft.dir*(ft.step+1),ft.alt=(ot=ft.type,(ht=ft.q)==="M"&&ot==="M"||ht==="P"&&ot==="P"?0:ht==="m"&&ot==="M"?-1:/^A+$/.test(ht)?ht.length:/^d+$/.test(ht)?ot==="P"?-ht.length:-ht.length-1:null),ft.oct=Math.floor((Math.abs(ft.num)-1)/7),ft.semitones=ft.dir*(se[ft.step]+ft.alt+12*ft.oct),ft.chroma=(ft.dir*(se[ft.step]+ft.alt)%12+12)%12,Object.freeze(ft))},ke={};function De($e){return typeof $e!="string"?ee:ke[$e]||(ke[$e]=be($e))}"P m M m M P d P m M m M".split(" ");var Re=[0,2,4,-1,1,3,5],Ce=Re.map(function($e){return Math.floor(7*$e/12)}),Je=[3,0,4,1,5,2,6],rt=function($e,Ve,ot){var ht=Je[function(dn){var Qt=(dn+1)%7;return Qt<0?7+Qt:Qt}($e)],ft=Math.floor(($e+1)/7);return Ve===void 0?{step:ht,alt:ft,dir:ot}:{step:ht,alt:ft,oct:Ve+4*ft+Ce[ht],dir:ot}},qe=function($e){return function(Ve,ot){return ot===void 0&&(ot={}),function(ht){return ot[ht]||(ot[ht]=Ve(ht))}}(function(Ve){var ot=$e(Ve);return ot.name===null?null:function(ht){var ft=ht.step,dn=ht.alt,Qt=ht.oct,ar=ht.dir;ar===void 0&&(ar=1);var na=Re[ft]+7*dn;return Qt===null?[ar*na]:[ar*na,ar*(Qt-Ce[ft]-4*dn)]}(ot)})},B=qe(h),J=qe(De);function Z($e,Ve){if(arguments.length===1)return function(dn){return Z($e,dn)};var ot=B($e),ht=J(Ve);if(ot===null||ht===null)return null;var ft=ot.length===1?[ot[0]+ht[0]]:[ot[0]+ht[0],ot[1]+ht[1]];return pe(rt(ft[0],ft[1]))}var le=e(64),Ge=e(65),Qe=function($e){return R($e)||function(Ve){return De(Ve).chroma}($e)||0},dt=function($e){return parseInt(yt($e),2)};function yt($e){if(En($e))return $e;if(!Array.isArray($e))return"";var Ve=[0,0,0,0,0,0,0,0,0,0,0,0];return $e.map(Qe).forEach(function(ot){Ve[ot]=1}),Ve.join("")}var Vt=/^[01]{12}$/;function En($e){return Vt.test($e)}"1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M".split(" ");function ss($e,Ve){return arguments.length>1?ss($e)(Ve):($e=dt($e),function(ot){return(ot=dt(ot))!==$e&&(ot&$e)===ot})}function tn($e,Ve){return arguments.length>1?tn($e)(Ve):($e=dt($e),function(ot){return(ot=dt(ot))!==$e&&(ot|$e)===ot})}var So,Ar,ii,is=function($e){var Ve=Object.keys($e).sort(),ot=[],ht=[],ft=function(ar,na,Pl){ot[ar]=na,ht[Pl]=ht[Pl]||[],ht[Pl].push(ar)};Ve.forEach(function(ar){var na=$e[ar][0].split(" "),Pl=$e[ar][1],Mb=yt(na);ft(ar,na,Mb),Pl&&Pl.forEach(function(dd){return ft(dd,na,Mb)})});var dn=Object.keys(ot).sort(),Qt=function(ar){return ot[ar]};return Qt.names=function(ar){return typeof ar=="string"?(ht[ar]||[]).slice():(ar===!0?dn:Ve).slice()},Qt},Es=is(le),Xr=is(Ge),ja=(So=Es,Ar=Xr,(ii=function($e){return So($e)||Ar($e)}).names=function($e){return So.names($e).concat(Ar.names($e))},Object.freeze({name:null,intervals:[],names:[],chroma:null,setnum:null}));Es.names;var ai=Xr.names,Ga=Object.freeze({name:null,names:[],intervals:[],chroma:null,setnum:null}),Wa=function($e,Ve){return Ve===void 0&&(Ve={}),function(ot){return Ve[ot]||(Ve[ot]=$e(ot))}}(function($e){var Ve=Xr($e);if(!Ve)return Ga;var ot={intervals:Ve,name:$e};return ot.chroma=yt(Ve),ot.setnum=parseInt(ot.chroma,2),ot.names=Xr.names(ot.chroma),ot}),Rc=function($e){return Wa(Bg($e)[1]).intervals};function Eh($e,Ve){if(Ve)return Wa(Ve).intervals.map(Z($e));var ot=Bg($e),ht=ot[0],ft=ot[1];return Wa(ft).intervals.map(Z(ht))}var Rl=function($e){return Xr(Bg($e)[1])!==void 0},Nh=function($e){if(!Rc($e).length)return[];var Ve=tn(Rc($e));return Xr.names().filter(function(ot){return Ve(Xr(ot))})},Ab=function($e){var Ve=ss(Rc($e));return Xr.names().filter(function(ot){return Ve(Xr(ot))})},Gk=/^(6|64|7|9|11|13)$/;function Bg($e){var Ve=f($e);return Ve[0]===""?["",$e]:Ve[0]==="A"&&Ve[3]==="ug"?["","aug"]:Gk.test(Ve[2])?[Ve[0]+Ve[1],Ve[2]+Ve[3]]:[Ve[0]+Ve[1]+Ve[2],Ve[3]]}var ea=e(8);let Wk=[["1P","3M","5P"],["1P","3m","5P"],["1P","3M","5A"],["1P","3m","5d"]];var Vg;(function($e){$e[$e.Major=0]="Major",$e[$e.Minor=1]="Minor",$e[$e.Augmented=2]="Augmented",$e[$e.Diminished=3]="Diminished",$e[$e.Other=4]="Other"})(Vg||(Vg={}));class hd extends Error{constructor(Ve){super(Ve),Object.setPrototypeOf(this,new.target.prototype)}}class Ob extends Error{constructor(Ve){super(Ve),Object.setPrototypeOf(this,new.target.prototype)}}class ta{static pitches(Ve){if(!o.tokenize(Ve)[0]||!o.exists(Ve))throw new hd("Unrecognized chord symbol: "+Ve);return o.notes(Ve).map(r.chroma)}static root(Ve){let ot=o.tokenize(Ve)[0];if(!ot)throw new hd("Chord symbol has unknown root: "+Ve);return r.chroma(ot)}static quality(Ve){if(!o.exists(Ve))throw new hd("Unrecognized chord symbol: "+Ve);let ot=o.intervals(Ve),ht=Wk.map(Qt=>Qt.every(ar=>ot.includes(ar))),ft=ht.indexOf(!0),dn=ht.lastIndexOf(!0);return ft>=0&&ft===dn?ft:Vg.Other}}class qg{encodeProgression(Ve,ot){let ht=Ve.map(dn=>this.encode(dn)),ft=Array.from(Array(ot).keys()).map(dn=>Math.floor(dn*ht.length/ot));return s.stack(ft.map(dn=>ht[dn]))}}function Hk($e){switch($e){case"MajorMinorChordEncoder":return new fo;case"TriadChordEncoder":return new fd;case"PitchChordEncoder":return new ZS;default:throw new Error("Unknown chord encoder type: "+$e)}}class fo extends qg{constructor(){super(...arguments),this.depth=1+2*ea.NUM_PITCH_CLASSES}index(Ve){if(Ve===ea.NO_CHORD)return 0;let ot=ta.root(Ve),ht=1+ta.quality(Ve)*ea.NUM_PITCH_CLASSES+ot;if(ht>=this.depth)throw new Ob("Chord is neither major nor minor: "+Ve);return ht}encode(Ve){return s.tidy(()=>s.oneHot(s.tensor1d([this.index(Ve)],"int32"),this.depth).as1D())}}class fd extends qg{constructor(){super(...arguments),this.depth=1+4*ea.NUM_PITCH_CLASSES}index(Ve){if(Ve===ea.NO_CHORD)return 0;let ot=ta.root(Ve),ht=1+ta.quality(Ve)*ea.NUM_PITCH_CLASSES+ot;if(ht>=this.depth)throw new Ob("Chord is not a standard triad: "+Ve);return ht}encode(Ve){return s.tidy(()=>s.oneHot(s.tensor1d([this.index(Ve)],"int32"),this.depth).as1D())}}class ZS extends qg{constructor(){super(...arguments),this.depth=1+3*ea.NUM_PITCH_CLASSES}encode(Ve){return s.tidy(()=>{if(Ve===ea.NO_CHORD)return s.oneHot(s.tensor1d([0],"int32"),this.depth).as1D();let ot=ta.root(Ve),ht=s.oneHot(s.tensor1d([ot],"int32"),ea.NUM_PITCH_CLASSES).as1D(),ft=s.buffer([ea.NUM_PITCH_CLASSES]);ta.pitches(Ve).forEach(ar=>ft.set(1,ar));let dn=ft.toTensor().as1D(),Qt=ht;return s.concat1d([s.tensor1d([0]),ht,dn,Qt])})}}},,,,,,,,,,,function(n,t,e){"use strict";e.r(t),e.d(t,"auxiliaryInputFromSpec",function(){return o}),e.d(t,"AuxiliaryInput",function(){return s}),e.d(t,"BinaryCounter",function(){return i});var r=e(2);function o(a){switch(a.type){case"BinaryCounter":return new i(a.args);default:throw new Error("Unknown auxiliary input: "+a)}}class s{constructor(c){this.depth=c}}class i extends s{constructor(c){super(c.numBits)}getTensors(c){let l=r.buffer([c,this.depth]);for(let p=0;p<c;++p)for(let f=0;f<this.depth;++f)l.set(Math.floor((p+1)/Math.pow(2,f))%2?1:-1,p,f);return l.toTensor().as2D(c,this.depth)}}},function(n,t,e){"use strict";n.exports=e(50)},function(n,t,e){"use strict";var r=t;function o(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=e(33),r.BufferWriter=e(59),r.Reader=e(34),r.BufferReader=e(60),r.util=e(18),r.rpc=e(61),r.roots=e(63),r.configure=o,o()},function(n,t,e){"use strict";n.exports=function(r,o){for(var s=new Array(arguments.length-1),i=0,a=2,c=!0;a<arguments.length;)s[i++]=arguments[a++];return new Promise(function(l,p){s[i]=function(f){if(c)if(c=!1,f)p(f);else{for(var y=new Array(arguments.length-1),d=0;d<y.length;)y[d++]=arguments[d];l.apply(null,y)}};try{r.apply(o||null,s)}catch(f){c&&(c=!1,p(f))}})}},function(n,t,e){"use strict";var r=t;r.length=function(a){var c=a.length;if(!c)return 0;for(var l=0;--c%4>1&&a.charAt(c)==="=";)++l;return Math.ceil(3*a.length)/4-l};for(var o=new Array(64),s=new Array(123),i=0;i<64;)s[o[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;r.encode=function(a,c,l){for(var p,f=null,y=[],d=0,h=0;c<l;){var m=a[c++];switch(h){case 0:y[d++]=o[m>>2],p=(3&m)<<4,h=1;break;case 1:y[d++]=o[p|m>>4],p=(15&m)<<2,h=2;break;case 2:y[d++]=o[p|m>>6],y[d++]=o[63&m],h=0}d>8191&&((f||(f=[])).push(String.fromCharCode.apply(String,y)),d=0)}return h&&(y[d++]=o[p],y[d++]=61,h===1&&(y[d++]=61)),f?(d&&f.push(String.fromCharCode.apply(String,y.slice(0,d))),f.join("")):String.fromCharCode.apply(String,y.slice(0,d))},r.decode=function(a,c,l){for(var p,f=l,y=0,d=0;d<a.length;){var h=a.charCodeAt(d++);if(h===61&&y>1)break;if((h=s[h])===void 0)throw Error("invalid encoding");switch(y){case 0:p=h,y=1;break;case 1:c[l++]=p<<2|(48&h)>>4,p=h,y=2;break;case 2:c[l++]=(15&p)<<4|(60&h)>>2,p=h,y=3;break;case 3:c[l++]=(3&p)<<6|h,y=0}}if(y===1)throw Error("invalid encoding");return l-f},r.test=function(a){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(a)}},function(n,t,e){"use strict";function r(){this._listeners={}}n.exports=r,r.prototype.on=function(o,s,i){return(this._listeners[o]||(this._listeners[o]=[])).push({fn:s,ctx:i||this}),this},r.prototype.off=function(o,s){if(o===void 0)this._listeners={};else if(s===void 0)this._listeners[o]=[];else for(var i=this._listeners[o],a=0;a<i.length;)i[a].fn===s?i.splice(a,1):++a;return this},r.prototype.emit=function(o){var s=this._listeners[o];if(s){for(var i=[],a=1;a<arguments.length;)i.push(arguments[a++]);for(a=0;a<s.length;)s[a].fn.apply(s[a++].ctx,i)}return this}},function(n,t,e){"use strict";function r(c){return typeof Float32Array<"u"?function(){var l=new Float32Array([-0]),p=new Uint8Array(l.buffer),f=p[3]===128;function y(x,w,_){l[0]=x,w[_]=p[0],w[_+1]=p[1],w[_+2]=p[2],w[_+3]=p[3]}function d(x,w,_){l[0]=x,w[_]=p[3],w[_+1]=p[2],w[_+2]=p[1],w[_+3]=p[0]}function h(x,w){return p[0]=x[w],p[1]=x[w+1],p[2]=x[w+2],p[3]=x[w+3],l[0]}function m(x,w){return p[3]=x[w],p[2]=x[w+1],p[1]=x[w+2],p[0]=x[w+3],l[0]}c.writeFloatLE=f?y:d,c.writeFloatBE=f?d:y,c.readFloatLE=f?h:m,c.readFloatBE=f?m:h}():function(){function l(f,y,d,h){var m=y<0?1:0;if(m&&(y=-y),y===0)f(1/y>0?0:2147483648,d,h);else if(isNaN(y))f(2143289344,d,h);else if(y>34028234663852886e22)f((m<<31|2139095040)>>>0,d,h);else if(y<11754943508222875e-54)f((m<<31|Math.round(y/1401298464324817e-60))>>>0,d,h);else{var x=Math.floor(Math.log(y)/Math.LN2);f((m<<31|x+127<<23|8388607&Math.round(y*Math.pow(2,-x)*8388608))>>>0,d,h)}}function p(f,y,d){var h=f(y,d),m=2*(h>>31)+1,x=h>>>23&255,w=8388607&h;return x===255?w?NaN:m*(1/0):x===0?1401298464324817e-60*m*w:m*Math.pow(2,x-150)*(w+8388608)}c.writeFloatLE=l.bind(null,o),c.writeFloatBE=l.bind(null,s),c.readFloatLE=p.bind(null,i),c.readFloatBE=p.bind(null,a)}(),typeof Float64Array<"u"?function(){var l=new Float64Array([-0]),p=new Uint8Array(l.buffer),f=p[7]===128;function y(x,w,_){l[0]=x,w[_]=p[0],w[_+1]=p[1],w[_+2]=p[2],w[_+3]=p[3],w[_+4]=p[4],w[_+5]=p[5],w[_+6]=p[6],w[_+7]=p[7]}function d(x,w,_){l[0]=x,w[_]=p[7],w[_+1]=p[6],w[_+2]=p[5],w[_+3]=p[4],w[_+4]=p[3],w[_+5]=p[2],w[_+6]=p[1],w[_+7]=p[0]}function h(x,w){return p[0]=x[w],p[1]=x[w+1],p[2]=x[w+2],p[3]=x[w+3],p[4]=x[w+4],p[5]=x[w+5],p[6]=x[w+6],p[7]=x[w+7],l[0]}function m(x,w){return p[7]=x[w],p[6]=x[w+1],p[5]=x[w+2],p[4]=x[w+3],p[3]=x[w+4],p[2]=x[w+5],p[1]=x[w+6],p[0]=x[w+7],l[0]}c.writeDoubleLE=f?y:d,c.writeDoubleBE=f?d:y,c.readDoubleLE=f?h:m,c.readDoubleBE=f?m:h}():function(){function l(f,y,d,h,m,x){var w=h<0?1:0;if(w&&(h=-h),h===0)f(0,m,x+y),f(1/h>0?0:2147483648,m,x+d);else if(isNaN(h))f(0,m,x+y),f(2146959360,m,x+d);else if(h>17976931348623157e292)f(0,m,x+y),f((w<<31|2146435072)>>>0,m,x+d);else{var _;if(h<22250738585072014e-324)f((_=h/5e-324)>>>0,m,x+y),f((w<<31|_/4294967296)>>>0,m,x+d);else{var I=Math.floor(Math.log(h)/Math.LN2);I===1024&&(I=1023),f(4503599627370496*(_=h*Math.pow(2,-I))>>>0,m,x+y),f((w<<31|I+1023<<20|1048576*_&1048575)>>>0,m,x+d)}}}function p(f,y,d,h,m){var x=f(h,m+y),w=f(h,m+d),_=2*(w>>31)+1,I=w>>>20&2047,T=4294967296*(1048575&w)+x;return I===2047?T?NaN:_*(1/0):I===0?5e-324*_*T:_*Math.pow(2,I-1075)*(T+4503599627370496)}c.writeDoubleLE=l.bind(null,o,0,4),c.writeDoubleBE=l.bind(null,s,4,0),c.readDoubleLE=p.bind(null,i,0,4),c.readDoubleBE=p.bind(null,a,4,0)}(),c}function o(c,l,p){l[p]=255&c,l[p+1]=c>>>8&255,l[p+2]=c>>>16&255,l[p+3]=c>>>24}function s(c,l,p){l[p]=c>>>24,l[p+1]=c>>>16&255,l[p+2]=c>>>8&255,l[p+3]=255&c}function i(c,l){return(c[l]|c[l+1]<<8|c[l+2]<<16|c[l+3]<<24)>>>0}function a(c,l){return(c[l]<<24|c[l+1]<<16|c[l+2]<<8|c[l+3])>>>0}n.exports=r(r)},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(n){}return null}module.exports=inquire},function(n,t,e){"use strict";var r=t;r.length=function(o){for(var s=0,i=0,a=0;a<o.length;++a)(i=o.charCodeAt(a))<128?s+=1:i<2048?s+=2:(64512&i)==55296&&(64512&o.charCodeAt(a+1))==56320?(++a,s+=4):s+=3;return s},r.read=function(o,s,i){if(i-s<1)return"";for(var a,c=null,l=[],p=0;s<i;)(a=o[s++])<128?l[p++]=a:a>191&&a<224?l[p++]=(31&a)<<6|63&o[s++]:a>239&&a<365?(a=((7&a)<<18|(63&o[s++])<<12|(63&o[s++])<<6|63&o[s++])-65536,l[p++]=55296+(a>>10),l[p++]=56320+(1023&a)):l[p++]=(15&a)<<12|(63&o[s++])<<6|63&o[s++],p>8191&&((c||(c=[])).push(String.fromCharCode.apply(String,l)),p=0);return c?(p&&c.push(String.fromCharCode.apply(String,l.slice(0,p))),c.join("")):String.fromCharCode.apply(String,l.slice(0,p))},r.write=function(o,s,i){for(var a,c,l=i,p=0;p<o.length;++p)(a=o.charCodeAt(p))<128?s[i++]=a:a<2048?(s[i++]=a>>6|192,s[i++]=63&a|128):(64512&a)==55296&&(64512&(c=o.charCodeAt(p+1)))==56320?(a=65536+((1023&a)<<10)+(1023&c),++p,s[i++]=a>>18|240,s[i++]=a>>12&63|128,s[i++]=a>>6&63|128,s[i++]=63&a|128):(s[i++]=a>>12|224,s[i++]=a>>6&63|128,s[i++]=63&a|128);return i-l}},function(n,t,e){"use strict";n.exports=function(r,o,s){var i=s||8192,a=i>>>1,c=null,l=i;return function(p){if(p<1||p>a)return r(p);l+p>i&&(c=r(i),l=0);var f=o.call(c,l,l+=p);return 7&l&&(l=1+(7|l)),f}}},function(n,t,e){"use strict";n.exports=o;var r=e(18);function o(c,l){this.lo=c>>>0,this.hi=l>>>0}var s=o.zero=new o(0,0);s.toNumber=function(){return 0},s.zzEncode=s.zzDecode=function(){return this},s.length=function(){return 1};var i=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(c){if(c===0)return s;var l=c<0;l&&(c=-c);var p=c>>>0,f=(c-p)/4294967296>>>0;return l&&(f=~f>>>0,p=~p>>>0,++p>4294967295&&(p=0,++f>4294967295&&(f=0))),new o(p,f)},o.from=function(c){if(typeof c=="number")return o.fromNumber(c);if(r.isString(c)){if(!r.Long)return o.fromNumber(parseInt(c,10));c=r.Long.fromString(c)}return c.low||c.high?new o(c.low>>>0,c.high>>>0):s},o.prototype.toNumber=function(c){if(!c&&this.hi>>>31){var l=1+~this.lo>>>0,p=~this.hi>>>0;return l||(p=p+1>>>0),-(l+4294967296*p)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(c){return r.Long?new r.Long(0|this.lo,0|this.hi,!!c):{low:0|this.lo,high:0|this.hi,unsigned:!!c}};var a=String.prototype.charCodeAt;o.fromHash=function(c){return c===i?s:new o((a.call(c,0)|a.call(c,1)<<8|a.call(c,2)<<16|a.call(c,3)<<24)>>>0,(a.call(c,4)|a.call(c,5)<<8|a.call(c,6)<<16|a.call(c,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var c=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^c)>>>0,this.lo=(this.lo<<1^c)>>>0,this},o.prototype.zzDecode=function(){var c=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^c)>>>0,this.hi=(this.hi>>>1^c)>>>0,this},o.prototype.length=function(){var c=this.lo,l=(this.lo>>>28|this.hi<<4)>>>0,p=this.hi>>>24;return p===0?l===0?c<16384?c<128?1:2:c<2097152?3:4:l<16384?l<128?5:6:l<2097152?7:8:p<128?9:10}},function(n,t,e){"use strict";n.exports=s;var r=e(33);(s.prototype=Object.create(r.prototype)).constructor=s;var o=e(18);function s(){r.call(this)}function i(a,c,l){a.length<40?o.utf8.write(a,c,l):c.utf8Write?c.utf8Write(a,l):c.write(a,l)}s._configure=function(){s.alloc=o._Buffer_allocUnsafe,s.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&o.Buffer.prototype.set.name==="set"?function(a,c,l){c.set(a,l)}:function(a,c,l){if(a.copy)a.copy(c,l,0,a.length);else for(var p=0;p<a.length;)c[l++]=a[p++]}},s.prototype.bytes=function(a){o.isString(a)&&(a=o._Buffer_from(a,"base64"));var c=a.length>>>0;return this.uint32(c),c&&this._push(s.writeBytesBuffer,c,a),this},s.prototype.string=function(a){var c=o.Buffer.byteLength(a);return this.uint32(c),c&&this._push(i,c,a),this},s._configure()},function(n,t,e){"use strict";n.exports=s;var r=e(34);(s.prototype=Object.create(r.prototype)).constructor=s;var o=e(18);function s(i){r.call(this,i)}s._configure=function(){o.Buffer&&(s.prototype._slice=o.Buffer.prototype.slice)},s.prototype.string=function(){var i=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+i,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+i,this.len))},s._configure()},function(n,t,e){"use strict";t.Service=e(62)},function(n,t,e){"use strict";n.exports=o;var r=e(18);function o(s,i,a){if(typeof s!="function")throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=s,this.requestDelimited=!!i,this.responseDelimited=!!a}(o.prototype=Object.create(r.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function s(i,a,c,l,p){if(!l)throw TypeError("request must be specified");var f=this;if(!p)return r.asPromise(s,f,i,a,c,l);if(f.rpcImpl)try{return f.rpcImpl(i,a[f.requestDelimited?"encodeDelimited":"encode"](l).finish(),function(y,d){if(y)return f.emit("error",y,i),p(y);if(d!==null){if(!(d instanceof c))try{d=c[f.responseDelimited?"decodeDelimited":"decode"](d)}catch(h){return f.emit("error",h,i),p(h)}return f.emit("data",d,i),p(null,d)}f.end(!0)})}catch(y){return f.emit("error",y,i),void setTimeout(function(){p(y)},0)}else setTimeout(function(){p(Error("already ended"))},0)},o.prototype.end=function(s){return this.rpcImpl&&(s||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(n,t,e){"use strict";n.exports={}},function(n){n.exports=JSON.parse('{"chromatic":["1P 2m 2M 3m 3M 4P 4A 5P 6m 6M 7m 7M"],"lydian":["1P 2M 3M 4A 5P 6M 7M"],"major":["1P 2M 3M 4P 5P 6M 7M",["ionian"]],"mixolydian":["1P 2M 3M 4P 5P 6M 7m",["dominant"]],"dorian":["1P 2M 3m 4P 5P 6M 7m"],"aeolian":["1P 2M 3m 4P 5P 6m 7m",["minor"]],"phrygian":["1P 2m 3m 4P 5P 6m 7m"],"locrian":["1P 2m 3m 4P 5d 6m 7m"],"melodic minor":["1P 2M 3m 4P 5P 6M 7M"],"melodic minor second mode":["1P 2m 3m 4P 5P 6M 7m"],"lydian augmented":["1P 2M 3M 4A 5A 6M 7M"],"lydian dominant":["1P 2M 3M 4A 5P 6M 7m",["lydian b7"]],"melodic minor fifth mode":["1P 2M 3M 4P 5P 6m 7m",["hindu","mixolydian b6M"]],"locrian #2":["1P 2M 3m 4P 5d 6m 7m",["half-diminished"]],"altered":["1P 2m 3m 3M 5d 6m 7m",["super locrian","diminished whole tone","pomeroy"]],"harmonic minor":["1P 2M 3m 4P 5P 6m 7M"],"phrygian dominant":["1P 2m 3M 4P 5P 6m 7m",["spanish","phrygian major"]],"half-whole diminished":["1P 2m 3m 3M 4A 5P 6M 7m",["dominant diminished"]],"diminished":["1P 2M 3m 4P 5d 6m 6M 7M",["whole-half diminished"]],"major pentatonic":["1P 2M 3M 5P 6M",["pentatonic"]],"lydian pentatonic":["1P 3M 4A 5P 7M",["chinese"]],"mixolydian pentatonic":["1P 3M 4P 5P 7m",["indian"]],"locrian pentatonic":["1P 3m 4P 5d 7m",["minor seven flat five pentatonic"]],"minor pentatonic":["1P 3m 4P 5P 7m"],"minor six pentatonic":["1P 3m 4P 5P 6M"],"minor hexatonic":["1P 2M 3m 4P 5P 7M"],"flat three pentatonic":["1P 2M 3m 5P 6M",["kumoi"]],"flat six pentatonic":["1P 2M 3M 5P 6m"],"major flat two pentatonic":["1P 2m 3M 5P 6M"],"whole tone pentatonic":["1P 3M 5d 6m 7m"],"ionian pentatonic":["1P 3M 4P 5P 7M"],"lydian #5P pentatonic":["1P 3M 4A 5A 7M"],"lydian dominant pentatonic":["1P 3M 4A 5P 7m"],"minor #7M pentatonic":["1P 3m 4P 5P 7M"],"super locrian pentatonic":["1P 3m 4d 5d 7m"],"in-sen":["1P 2m 4P 5P 7m"],"iwato":["1P 2m 4P 5d 7m"],"hirajoshi":["1P 2M 3m 5P 6m"],"kumoijoshi":["1P 2m 4P 5P 6m"],"pelog":["1P 2m 3m 5P 6m"],"vietnamese 1":["1P 3m 4P 5P 6m"],"vietnamese 2":["1P 3m 4P 5P 7m"],"prometheus":["1P 2M 3M 4A 6M 7m"],"prometheus neopolitan":["1P 2m 3M 4A 6M 7m"],"ritusen":["1P 2M 4P 5P 6M"],"scriabin":["1P 2m 3M 5P 6M"],"piongio":["1P 2M 4P 5P 6M 7m"],"major blues":["1P 2M 3m 3M 5P 6M"],"minor blues":["1P 3m 4P 5d 5P 7m",["blues"]],"composite blues":["1P 2M 3m 3M 4P 5d 5P 6M 7m"],"augmented":["1P 2A 3M 5P 5A 7M"],"augmented heptatonic":["1P 2A 3M 4P 5P 5A 7M"],"dorian #4":["1P 2M 3m 4A 5P 6M 7m"],"lydian diminished":["1P 2M 3m 4A 5P 6M 7M"],"whole tone":["1P 2M 3M 4A 5A 7m"],"leading whole tone":["1P 2M 3M 4A 5A 7m 7M"],"lydian minor":["1P 2M 3M 4A 5P 6m 7m"],"locrian major":["1P 2M 3M 4P 5d 6m 7m",["arabian"]],"neopolitan":["1P 2m 3m 4P 5P 6m 7M"],"neopolitan minor":["1P 2m 3m 4P 5P 6m 7M"],"neopolitan major":["1P 2m 3m 4P 5P 6M 7M",["dorian b2"]],"neopolitan major pentatonic":["1P 3M 4P 5d 7m"],"romanian minor":["1P 2M 3m 5d 5P 6M 7m"],"double harmonic lydian":["1P 2m 3M 4A 5P 6m 7M"],"harmonic major":["1P 2M 3M 4P 5P 6m 7M"],"double harmonic major":["1P 2m 3M 4P 5P 6m 7M",["gypsy"]],"egyptian":["1P 2M 4P 5P 7m"],"hungarian minor":["1P 2M 3m 4A 5P 6m 7M"],"hungarian major":["1P 2A 3M 4A 5P 6M 7m"],"oriental":["1P 2m 3M 4P 5d 6M 7m"],"spanish heptatonic":["1P 2m 3m 3M 4P 5P 6m 7m"],"flamenco":["1P 2m 3m 3M 4A 5P 7m"],"balinese":["1P 2m 3m 4P 5P 6m 7M"],"todi raga":["1P 2m 3m 4A 5P 6m 7M"],"malkos raga":["1P 3m 4P 6m 7m"],"kafi raga":["1P 3m 3M 4P 5P 6M 7m 7M"],"purvi raga":["1P 2m 3M 4P 4A 5P 6m 7M"],"persian":["1P 2m 3M 4P 5d 6m 7M"],"bebop":["1P 2M 3M 4P 5P 6M 7m 7M"],"bebop dominant":["1P 2M 3M 4P 5P 6M 7m 7M"],"bebop minor":["1P 2M 3m 3M 4P 5P 6M 7m"],"bebop major":["1P 2M 3M 4P 5P 5A 6M 7M"],"bebop locrian":["1P 2m 3m 4P 5d 5P 6m 7m"],"minor bebop":["1P 2M 3m 4P 5P 6m 7m 7M"],"mystery #1":["1P 2m 3M 5d 6m 7m"],"enigmatic":["1P 2m 3M 5d 6m 7m 7M"],"minor six diminished":["1P 2M 3m 4P 5P 6m 6M 7M"],"ionian augmented":["1P 2M 3M 4P 5A 6M 7M"],"lydian #9":["1P 2m 3M 4A 5P 6M 7M"],"ichikosucho":["1P 2M 3M 4P 5d 5P 6M 7M"],"six tone symmetric":["1P 2m 3M 4P 5A 6M"]}')},function(n){n.exports=JSON.parse('{"4":["1P 4P 7m 10m",["quartal"]],"5":["1P 5P"],"7":["1P 3M 5P 7m",["Dominant","Dom"]],"9":["1P 3M 5P 7m 9M",["79"]],"11":["1P 5P 7m 9M 11P"],"13":["1P 3M 5P 7m 9M 13M",["13_"]],"64":["5P 8P 10M"],"M":["1P 3M 5P",["Major",""]],"M#5":["1P 3M 5A",["augmented","maj#5","Maj#5","+","aug"]],"M#5add9":["1P 3M 5A 9M",["+add9"]],"M13":["1P 3M 5P 7M 9M 13M",["maj13","Maj13"]],"M13#11":["1P 3M 5P 7M 9M 11A 13M",["maj13#11","Maj13#11","M13+4","M13#4"]],"M6":["1P 3M 5P 13M",["6"]],"M6#11":["1P 3M 5P 6M 11A",["M6b5","6#11","6b5"]],"M69":["1P 3M 5P 6M 9M",["69"]],"M69#11":["1P 3M 5P 6M 9M 11A"],"M7#11":["1P 3M 5P 7M 11A",["maj7#11","Maj7#11","M7+4","M7#4"]],"M7#5":["1P 3M 5A 7M",["maj7#5","Maj7#5","maj9#5","M7+"]],"M7#5sus4":["1P 4P 5A 7M"],"M7#9#11":["1P 3M 5P 7M 9A 11A"],"M7add13":["1P 3M 5P 6M 7M 9M"],"M7b5":["1P 3M 5d 7M"],"M7b6":["1P 3M 6m 7M"],"M7b9":["1P 3M 5P 7M 9m"],"M7sus4":["1P 4P 5P 7M"],"M9":["1P 3M 5P 7M 9M",["maj9","Maj9"]],"M9#11":["1P 3M 5P 7M 9M 11A",["maj9#11","Maj9#11","M9+4","M9#4"]],"M9#5":["1P 3M 5A 7M 9M",["Maj9#5"]],"M9#5sus4":["1P 4P 5A 7M 9M"],"M9b5":["1P 3M 5d 7M 9M"],"M9sus4":["1P 4P 5P 7M 9M"],"Madd9":["1P 3M 5P 9M",["2","add9","add2"]],"Maj7":["1P 3M 5P 7M",["maj7","M7"]],"Mb5":["1P 3M 5d"],"Mb6":["1P 3M 13m"],"Msus2":["1P 2M 5P",["add9no3","sus2"]],"Msus4":["1P 4P 5P",["sus","sus4"]],"Maddb9":["1P 3M 5P 9m"],"11b9":["1P 5P 7m 9m 11P"],"13#11":["1P 3M 5P 7m 9M 11A 13M",["13+4","13#4"]],"13#9":["1P 3M 5P 7m 9A 13M",["13#9_"]],"13#9#11":["1P 3M 5P 7m 9A 11A 13M"],"13b5":["1P 3M 5d 6M 7m 9M"],"13b9":["1P 3M 5P 7m 9m 13M"],"13b9#11":["1P 3M 5P 7m 9m 11A 13M"],"13no5":["1P 3M 7m 9M 13M"],"13sus4":["1P 4P 5P 7m 9M 13M",["13sus"]],"69#11":["1P 3M 5P 6M 9M 11A"],"7#11":["1P 3M 5P 7m 11A",["7+4","7#4","7#11_","7#4_"]],"7#11b13":["1P 3M 5P 7m 11A 13m",["7b5b13"]],"7#5":["1P 3M 5A 7m",["+7","7aug","aug7"]],"7#5#9":["1P 3M 5A 7m 9A",["7alt","7#5#9_","7#9b13_"]],"7#5b9":["1P 3M 5A 7m 9m"],"7#5b9#11":["1P 3M 5A 7m 9m 11A"],"7#5sus4":["1P 4P 5A 7m"],"7#9":["1P 3M 5P 7m 9A",["7#9_"]],"7#9#11":["1P 3M 5P 7m 9A 11A",["7b5#9"]],"7#9#11b13":["1P 3M 5P 7m 9A 11A 13m"],"7#9b13":["1P 3M 5P 7m 9A 13m"],"7add6":["1P 3M 5P 7m 13M",["67","7add13"]],"7b13":["1P 3M 7m 13m"],"7b5":["1P 3M 5d 7m"],"7b6":["1P 3M 5P 6m 7m"],"7b9":["1P 3M 5P 7m 9m"],"7b9#11":["1P 3M 5P 7m 9m 11A",["7b5b9"]],"7b9#9":["1P 3M 5P 7m 9m 9A"],"7b9b13":["1P 3M 5P 7m 9m 13m"],"7b9b13#11":["1P 3M 5P 7m 9m 11A 13m",["7b9#11b13","7b5b9b13"]],"7no5":["1P 3M 7m"],"7sus4":["1P 4P 5P 7m",["7sus"]],"7sus4b9":["1P 4P 5P 7m 9m",["susb9","7susb9","7b9sus","7b9sus4","phryg"]],"7sus4b9b13":["1P 4P 5P 7m 9m 13m",["7b9b13sus4"]],"9#11":["1P 3M 5P 7m 9M 11A",["9+4","9#4","9#11_","9#4_"]],"9#11b13":["1P 3M 5P 7m 9M 11A 13m",["9b5b13"]],"9#5":["1P 3M 5A 7m 9M",["9+"]],"9#5#11":["1P 3M 5A 7m 9M 11A"],"9b13":["1P 3M 7m 9M 13m"],"9b5":["1P 3M 5d 7m 9M"],"9no5":["1P 3M 7m 9M"],"9sus4":["1P 4P 5P 7m 9M",["9sus"]],"m":["1P 3m 5P"],"m#5":["1P 3m 5A",["m+","mb6"]],"m11":["1P 3m 5P 7m 9M 11P",["_11"]],"m11A 5":["1P 3m 6m 7m 9M 11P"],"m11b5":["1P 3m 7m 12d 2M 4P",["h11","_11b5"]],"m13":["1P 3m 5P 7m 9M 11P 13M",["_13"]],"m6":["1P 3m 4P 5P 13M",["_6"]],"m69":["1P 3m 5P 6M 9M",["_69"]],"m7":["1P 3m 5P 7m",["minor7","_","_7"]],"m7#5":["1P 3m 6m 7m"],"m7add11":["1P 3m 5P 7m 11P",["m7add4"]],"m7b5":["1P 3m 5d 7m",["half-diminished","h7","_7b5"]],"m9":["1P 3m 5P 7m 9M",["_9"]],"m9#5":["1P 3m 6m 7m 9M"],"m9b5":["1P 3m 7m 12d 2M",["h9","-9b5"]],"mMaj7":["1P 3m 5P 7M",["mM7","_M7"]],"mMaj7b6":["1P 3m 5P 6m 7M",["mM7b6"]],"mM9":["1P 3m 5P 7M 9M",["mMaj9","-M9"]],"mM9b6":["1P 3m 5P 6m 7M 9M",["mMaj9b6"]],"mb6M7":["1P 3m 6m 7M"],"mb6b9":["1P 3m 6m 9m"],"o":["1P 3m 5d",["mb5","dim"]],"o7":["1P 3m 5d 13M",["diminished","m6b5","dim7"]],"o7M7":["1P 3m 5d 6M 7M"],"oM7":["1P 3m 5d 7M"],"sus24":["1P 2M 4P 5P",["sus4add9"]],"+add#9":["1P 3M 5A 9A"],"madd4":["1P 3m 4P 5P"],"madd9":["1P 3m 5P 9M"]}')},function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=e(80),o=new WeakMap;t.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var s=function(){function i(a){var c=this;this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",o.set(this,480),a&&(o.set(this,a.header.ticksPerBeat),a.tracks.forEach(function(l){return l.forEach(function(p){p.meta&&(p.type==="timeSignature"?c.timeSignatures.push({ticks:p.absoluteTime,timeSignature:[p.numerator,p.denominator]}):p.type==="setTempo"?c.tempos.push({bpm:6e7/p.microsecondsPerBeat,ticks:p.absoluteTime}):p.type==="keySignature"&&c.keySignatures.push({key:t.keySignatureKeys[p.key+7],scale:p.scale===0?"major":"minor",ticks:p.absoluteTime}))})}),a.tracks[0].forEach(function(l){l.meta&&(l.type==="trackName"?c.name=l.text:l.type!=="text"&&l.type!=="cuePoint"&&l.type!=="marker"&&l.type!=="lyrics"||c.meta.push({text:l.text,ticks:l.absoluteTime,type:l.type}))}),this.update())}return i.prototype.update=function(){var a=this,c=0,l=0;this.tempos.sort(function(p,f){return p.ticks-f.ticks}),this.tempos.forEach(function(p,f){var y=f>0?a.tempos[f-1].bpm:a.tempos[0].bpm,d=p.ticks/a.ppq-l,h=60/y*d;p.time=h+c,c=p.time,l+=d}),this.timeSignatures.sort(function(p,f){return p.ticks-f.ticks}),this.timeSignatures.forEach(function(p,f){var y=f>0?a.timeSignatures[f-1]:a.timeSignatures[0],d=(p.ticks-y.ticks)/a.ppq/y.timeSignature[0]/(y.timeSignature[1]/4);y.measures=y.measures||0,p.measures=d+y.measures})},i.prototype.ticksToSeconds=function(a){var c=r.search(this.tempos,a);if(c!==-1){var l=this.tempos[c],p=l.time,f=(a-l.ticks)/this.ppq;return p+60/l.bpm*f}return .5*(a/this.ppq)},i.prototype.ticksToMeasures=function(a){var c=r.search(this.timeSignatures,a);if(c!==-1){var l=this.timeSignatures[c],p=(a-l.ticks)/this.ppq;return l.measures+p/(l.timeSignature[0]/l.timeSignature[1])/4}return a/this.ppq/4},Object.defineProperty(i.prototype,"ppq",{get:function(){return o.get(this)},enumerable:!0,configurable:!0}),i.prototype.secondsToTicks=function(a){var c=r.search(this.tempos,a,"time");if(c!==-1){var l=this.tempos[c],p=(a-l.time)/(60/l.bpm);return Math.round(l.ticks+p*this.ppq)}var f=a/.5;return Math.round(f*this.ppq)},i.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(a){return{bpm:a.bpm,ticks:a.ticks}}),timeSignatures:this.timeSignatures}},i.prototype.fromJSON=function(a){this.name=a.name,this.tempos=a.tempos.map(function(c){return Object.assign({},c)}),this.timeSignatures=a.timeSignatures.map(function(c){return Object.assign({},c)}),this.keySignatures=a.keySignatures.map(function(c){return Object.assign({},c)}),this.meta=a.meta.map(function(c){return Object.assign({},c)}),o.set(this,a.ppq),this.update()},i.prototype.setTempo=function(a){this.tempos=[{bpm:a,ticks:0}],this.update()},i}();t.Header=s},function(n,t,e){"use strict";var r=this&&this.__awaiter||function(y,d,h,m){return new(h||(h=Promise))(function(x,w){function _(D){try{T(m.next(D))}catch(O){w(O)}}function I(D){try{T(m.throw(D))}catch(O){w(O)}}function T(D){var O;D.done?x(D.value):(O=D.value,O instanceof h?O:new h(function(R){R(O)})).then(_,I)}T((m=m.apply(y,d||[])).next())})},o=this&&this.__generator||function(y,d){var h,m,x,w,_={label:0,sent:function(){if(1&x[0])throw x[1];return x[1]},trys:[],ops:[]};return w={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function I(T){return function(D){return function(O){if(h)throw new TypeError("Generator is already executing.");for(;_;)try{if(h=1,m&&(x=2&O[0]?m.return:O[0]?m.throw||((x=m.return)&&x.call(m),0):m.next)&&!(x=x.call(m,O[1])).done)return x;switch(m=0,x&&(O=[2&O[0],x.value]),O[0]){case 0:case 1:x=O;break;case 4:return _.label++,{value:O[1],done:!1};case 5:_.label++,m=O[1],O=[0];continue;case 7:O=_.ops.pop(),_.trys.pop();continue;default:if(x=_.trys,!((x=x.length>0&&x[x.length-1])||O[0]!==6&&O[0]!==2)){_=0;continue}if(O[0]===3&&(!x||O[1]>x[0]&&O[1]<x[3])){_.label=O[1];break}if(O[0]===6&&_.label<x[1]){_.label=x[1],x=O;break}if(x&&_.label<x[2]){_.label=x[2],_.ops.push(O);break}x[2]&&_.ops.pop(),_.trys.pop();continue}O=d.call(y,_)}catch(R){O=[6,R],m=0}finally{h=x=0}if(5&O[0])throw O[1];return{value:O[0]?O[1]:void 0,done:!0}}([T,D])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=e(79),i=e(174),a=e(66),c=e(81),l=function(){function y(d){var h=this,m=null;d&&(d instanceof ArrayBuffer&&(d=new Uint8Array(d)),(m=s.parseMidi(d)).tracks.forEach(function(x){var w=0;x.forEach(function(_){w+=_.deltaTime,_.absoluteTime=w})}),m.tracks=function(x){for(var w=[],_=0;_<x.length;_++)for(var I=w.length,T=new Map,D=Array(16).fill(0),O=0,R=x[_];O<R.length;O++){var P=R[O],j=I,G=P.channel;if(G!==void 0){P.type==="programChange"&&(D[G]=P.programNumber);var Q=D[G]+" "+G;T.has(Q)?j=T.get(Q):(j=I+T.size,T.set(Q,j))}w[j]||w.push([]),w[j].push(P)}return w}(m.tracks)),this.header=new a.Header(m),this.tracks=[],d&&(this.tracks=m.tracks.map(function(x){return new c.Track(x,h.header)}),m.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return y.fromUrl=function(d){return r(this,void 0,void 0,function(){var h;return o(this,function(m){switch(m.label){case 0:return[4,fetch(d)];case 1:return(h=m.sent()).ok?[4,h.arrayBuffer()]:[3,3];case 2:return[2,new y(m.sent())];case 3:throw new Error("could not load "+d)}})})},Object.defineProperty(y.prototype,"name",{get:function(){return this.header.name},set:function(d){this.header.name=d},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"duration",{get:function(){var d=this.tracks.map(function(h){return h.duration});return Math.max.apply(Math,d)},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"durationTicks",{get:function(){var d=this.tracks.map(function(h){return h.durationTicks});return Math.max.apply(Math,d)},enumerable:!0,configurable:!0}),y.prototype.addTrack=function(){var d=new c.Track(void 0,this.header);return this.tracks.push(d),d},y.prototype.toArray=function(){return i.encode(this)},y.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(d){return d.toJSON()})}},y.prototype.fromJSON=function(d){var h=this;this.header=new a.Header,this.header.fromJSON(d.header),this.tracks=d.tracks.map(function(m){var x=new c.Track(void 0,h.header);return x.fromJSON(m),x})},y.prototype.clone=function(){var d=new y;return d.fromJSON(this.toJSON()),d},y}();t.Midi=l;var p=e(81);t.Track=p.Track;var f=e(66);t.Header=f.Header},,,,,,function(n,t,e){"use strict";e.r(t),e.d(t,"aux_inputs",function(){return r}),e.d(t,"chords",function(){return o}),e.d(t,"constants",function(){return s}),e.d(t,"data",function(){return i}),e.d(t,"logging",function(){return a}),e.d(t,"melodies",function(){return c}),e.d(t,"performance",function(){return l}),e.d(t,"sequences",function(){return p}),e.d(t,"MetronomeCallbackObject",function(){return y}),e.d(t,"Metronome",function(){return d}),e.d(t,"MidiConversionError",function(){return w}),e.d(t,"midiToSequenceProto",function(){return _}),e.d(t,"sequenceProtoToMidi",function(){return I}),e.d(t,"urlToBlob",function(){return T}),e.d(t,"blobToNoteSequence",function(){return D}),e.d(t,"urlToNoteSequence",function(){return O}),e.d(t,"BasePlayerCallback",function(){return G}),e.d(t,"BasePlayer",function(){return Q}),e.d(t,"Player",function(){return pe}),e.d(t,"SoundFontPlayer",function(){return xe}),e.d(t,"PlayerWithClick",function(){return ne}),e.d(t,"MIDIPlayer",function(){return fe}),e.d(t,"BaseRecorderCallback",function(){return te}),e.d(t,"Recorder",function(){return se}),e.d(t,"BaseVisualizer",function(){return we}),e.d(t,"PianoRollCanvasVisualizer",function(){return be}),e.d(t,"Visualizer",function(){return ke}),e.d(t,"BaseSVGVisualizer",function(){return De}),e.d(t,"PianoRollSVGVisualizer",function(){return Re}),e.d(t,"WaterfallSVGVisualizer",function(){return Ce}),e.d(t,"ScrollType",function(){return Je}),e.d(t,"StaffSVGVisualizer",function(){return rt});var r=e(48),o=e(37),s=e(8),i=e(36),a=e(12),c=e(23),l=e(29),p=e(13),f=e(9);class y{}class d{constructor(B,J=1){this.clicksPerQuarter=1,this.muted=!1,this.loClick=new f.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.hiClick=new f.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.loClickNote="c5",this.hiClickNote="g5",this.ticking=!1,this.startedAt=null,this.step=-1,this.reset(),this.callbackObject=B,this.clicksPerQuarter=J}isTicking(){return this.ticking}getStartedAt(){return this.startedAt}getOffsetTime(){return f.immediate()-this.startedAt}start(B=120){this.reset(),this.ticking=!0,this.callbackObject.click||(this.callbackObject.click=()=>{}),this.callbackObject.quarter||(this.callbackObject.quarter=()=>{}),this.callbackObject.bar||(this.callbackObject.bar=()=>{});let J=0,Z=4*this.clicksPerQuarter;f.Transport.scheduleRepeat(le=>{this.startedAt||(this.startedAt=le);let Ge=le-this.startedAt;this.step++;let Qe=this.step%Z,dt=Math.floor(Qe/this.clicksPerQuarter),yt=Qe%this.clicksPerQuarter;this.callbackObject.click(Ge,Qe),yt===0&&this.callbackObject.quarter(Ge,dt),this.muted||(Qe===0?this.hiClick.triggerAttack(this.hiClickNote,le,.1):this.loClick.triggerAttack(this.loClickNote,le,.1)),Qe===0&&(this.callbackObject.bar(Ge,J),J++)},Z+"n"),f.Transport.bpm.value=B,f.Transport.start()}stop(){this.ticking=!1,f.Transport.cancel(),f.Transport.stop()}reset(){this.muted=!1,this.ticking=!1,this.step=-1,this.startedAt=null}}var h=e(67),m=e(15),x=e(10);class w extends Error{constructor(B){super(B),Object.setPrototypeOf(this,new.target.prototype)}}function _(qe){let B=new h.Midi(qe),J=x.a.create();J.ticksPerQuarter=B.header.ppq,J.sourceInfo=x.a.SourceInfo.create({parser:x.a.SourceInfo.Parser.TONEJS_MIDI_CONVERT,encodingType:x.a.SourceInfo.EncodingType.MIDI});for(let le of B.header.timeSignatures)J.timeSignatures.push(x.a.TimeSignature.create({time:B.header.ticksToSeconds(le.ticks),numerator:le.timeSignature[0],denominator:le.timeSignature[1]}));J.timeSignatures.length||J.timeSignatures.push(x.a.TimeSignature.create({time:0,numerator:4,denominator:4}));for(let le of B.header.tempos)J.tempos.push(x.a.Tempo.create({time:le.time,qpm:le.bpm}));let Z=-1;for(let le of B.tracks){le.notes.length>0&&(Z+=1);for(let dt of le.notes){let yt=dt.time,Vt=yt+dt.duration;J.notes.push(x.a.Note.create({instrument:Z,program:le.instrument.number,startTime:yt,endTime:Vt,pitch:dt.midi,velocity:Math.floor(dt.velocity*s.MIDI_VELOCITIES),isDrum:le.instrument.percussion})),Vt>J.totalTime&&(J.totalTime=Vt)}let Ge=Object.values(le.controlChanges),Qe=[].concat.apply([],Ge);for(let dt of Qe)J.controlChanges.push(x.a.ControlChange.create({time:dt.time,controlNumber:dt.number,controlValue:Math.floor(dt.value*(s.MIDI_VELOCITIES-1)),instrument:Z,program:le.instrument.number,isDrum:le.instrument.percussion}))}return J}function I(qe){p.isQuantizedSequence(qe)&&(qe=p.unquantizeSequence(qe));let B=new h.Midi;B.fromJSON({header:{name:"",ppq:qe.ticksPerQuarter||s.DEFAULT_TICKS_PER_QUARTER,tempos:[],timeSignatures:[],keySignatures:[],meta:[]},tracks:[]});let J=Array.from(qe.tempos||[]);J.length===0&&J.push({time:0,qpm:s.DEFAULT_QUARTERS_PER_MINUTE}),J.sort((le,Ge)=>le.time-Ge.time);for(let le of J)B.header.tempos.push({ticks:B.header.secondsToTicks(le.time),bpm:le.qpm}),B.header.update();if(qe.timeSignatures&&qe.timeSignatures.length!==0)for(let le of qe.timeSignatures)B.header.timeSignatures.push({ticks:B.header.secondsToTicks(le.time),timeSignature:[le.numerator,le.denominator]});else B.header.timeSignatures.push({ticks:0,timeSignature:[4,4]});B.header.update();let Z=new Map;for(let le of qe.notes){let Ge=le.instrument?le.instrument:0,Qe=le.program===void 0?s.DEFAULT_PROGRAM:le.program,dt=!!le.isDrum,yt=JSON.stringify([Ge,Qe,dt]);Z.has(yt)||Z.set(yt,{notes:[],controlChanges:[]}),Z.get(yt).notes.push(le)}for(let le of qe.controlChanges){let Ge=le.instrument?le.instrument:0,Qe=le.program===void 0?s.DEFAULT_PROGRAM:le.program,dt=!!le.isDrum,yt=JSON.stringify([Ge,Qe,dt]);Z.has(yt)||Z.set(yt,{notes:[],controlChanges:[]}),Z.get(yt).controlChanges.push(le)}return Z.forEach((le,Ge)=>{let[Qe,dt]=JSON.parse(Ge).slice(1),yt=B.addTrack();yt.channel=dt?s.DRUM_CHANNEL:s.NON_DRUM_CHANNELS[(B.tracks.length-1)%s.NON_DRUM_CHANNELS.length],yt.instrument.number=Qe;for(let Vt of le.notes){let En=Vt.velocity===void 0?s.DEFAULT_VELOCITY:Vt.velocity;yt.addNote({midi:Vt.pitch,time:Vt.startTime,duration:Vt.endTime-Vt.startTime,velocity:(En+1)/s.MIDI_VELOCITIES})}for(let Vt of le.controlChanges)yt.addCC({number:Vt.controlNumber,value:Vt.controlValue,time:Vt.time})}),B.toArray()}function T(qe){return new Promise((B,J)=>{Object(m.a)(qe).then(Z=>Z.blob()).then(Z=>{B(Z)}).catch(Z=>J(Z))})}function D(qe){return new Promise((B,J)=>{let Z=new FileReader;Z.onload=le=>{try{let Ge=_(Z.result);B(Ge)}catch(Ge){J(Ge)}},Z.onerror=le=>J(le),Z.readAsArrayBuffer(qe)})}function O(qe){return T(qe).then(D)}class R{constructor(B){this.FADE_SECONDS=.1,this.baseURL=B,this.buffers=new f.ToneAudioBuffers,this.sourceMap=new Map,this.initialized=!1}initialize(){return Y(this,null,function*(){yield Object(m.a)(this.baseURL+"/instrument.json").then(B=>B.json()).then(B=>{this.name=B.name,this.minPitch=B.minPitch,this.maxPitch=B.maxPitch,this.durationSeconds=B.durationSeconds,this.releaseSeconds=B.releaseSeconds,this.percussive=B.percussive,this.velocities=B.velocities,this.initialized=!0})})}sampleInfoToName(B){return this.velocities?`p${B.pitch}_v${B.velocity}`:"p"+B.pitch}sampleNameToURL(B){return`${this.baseURL}/${B}.mp3`}nearestVelocity(B){if(!this.velocities)return B;B||(B=s.DEFAULT_VELOCITY);let J,Z=s.MIDI_VELOCITIES;return this.velocities.forEach(le=>{let Ge=Math.abs(le-B);Ge<Z&&(J=le,Z=Ge)}),J}loadSamples(B){return Y(this,null,function*(){this.initialized||(yield this.initialize());let J=B.filter(le=>!(le.pitch<this.minPitch||le.pitch>this.maxPitch)||(a.log(`Pitch ${le.pitch} is outside the valid range for ${this.name}, ignoring.`,"SoundFont"),!1)).map(le=>this.sampleInfoToName({pitch:le.pitch,velocity:this.nearestVelocity(le.velocity)})),Z=Array.from(new Set(J)).filter(le=>!this.buffers.has(le)).map(le=>({name:le,url:this.sampleNameToURL(le)}));Z.length>0&&(Z.forEach(le=>this.buffers.add(le.name,le.url)),yield f.loaded(),a.log(`Loaded samples for ${this.name}.`,"SoundFont"))})}playNote(B,J,Z,le,Ge){let Qe=this.getBuffer(B,J);if(!Qe)return;le>this.durationSeconds&&a.log(`Requested note duration longer than sample duration: ${le} > ${this.durationSeconds}`,"SoundFont");let dt=new f.ToneBufferSource({url:Qe,fadeOut:this.FADE_SECONDS}).connect(Ge);if(dt.start(Z,0,void 0,1),!this.percussive&&le<this.durationSeconds){let yt=new f.ToneBufferSource({url:Qe,fadeOut:this.FADE_SECONDS}).connect(Ge);dt.stop(Z+le+this.FADE_SECONDS),yt.start(Z+le,this.durationSeconds,void 0,1)}}playNoteDown(B,J,Z){let le=this.getBuffer(B,J);if(!le)return;let Ge=new f.ToneBufferSource(le).connect(Z);Ge.start(0,0,void 0,1),this.sourceMap.has(B)&&this.sourceMap.get(B).stop(f.now()+this.FADE_SECONDS,this.FADE_SECONDS),this.sourceMap.set(B,Ge)}playNoteUp(B,J,Z){if(!this.sourceMap.has(B))return;let le=this.getBuffer(B,J);le&&(new f.ToneBufferSource({url:le,fadeOut:this.FADE_SECONDS}).connect(Z).start(0,this.durationSeconds,void 0,1),this.sourceMap.get(B).stop(f.now()+this.FADE_SECONDS,this.FADE_SECONDS),this.sourceMap.delete(B))}getBuffer(B,J){if(!this.initialized)throw new Error("Instrument is not initialized.");if(B<this.minPitch||B>this.maxPitch)return void a.log(`Pitch ${B} is outside the valid range for ${this.name} (${this.minPitch}-${this.maxPitch})`,"SoundFont");let Z=this.sampleInfoToName({pitch:B,velocity:this.nearestVelocity(J)});if(!this.buffers.has(Z))throw new Error(`Buffer not found for ${this.name}: ${Z}`);let le=this.buffers.get(Z);if(!le.loaded)throw new Error(`Buffer not loaded for ${this.name}: ${Z}`);return le}}class P{constructor(B){this.baseURL=B,this.instruments=new Map,this.initialized=!1}initialize(){return Y(this,null,function*(){yield Object(m.a)(this.baseURL+"/soundfont.json").then(B=>B.json()).then(B=>{this.name=B.name;for(let J in B.instruments){let Z=`${this.baseURL}/${B.instruments[J]}`;this.instruments.set(J==="drums"?"drums":+J,new R(Z))}this.initialized=!0})})}loadSamples(B){return Y(this,null,function*(){this.initialized||(yield this.initialize());let J=new Map;B.forEach(Z=>{Z.isDrum=Z.isDrum||!1,Z.program=Z.program||0;let le=Z.isDrum?"drums":Z.program,Ge={pitch:Z.pitch,velocity:Z.velocity};J.has(le)?J.get(le).push(Ge):this.instruments.has(le)?J.set(le,[Ge]):a.log(`No instrument in ${this.name} for: program=${Z.program}, isDrum=${Z.isDrum}`,"SoundFont")}),yield Promise.all(Array.from(J.keys()).map(Z=>this.instruments.get(Z).loadSamples(J.get(Z))))})}playNote(B,J,Z,le,Ge=0,Qe=!1,dt){let yt=Qe?"drums":Ge;if(!this.initialized)throw new Error("SoundFont is not initialized.");this.instruments.has(yt)?this.instruments.get(yt).playNote(B,J,Z,le,dt):a.log(`No instrument in ${this.name} for: program=${Ge}, isDrum=${Qe}`,"SoundFont")}playNoteDown(B,J,Z=0,le=!1,Ge){let Qe=le?"drums":Z;if(!this.initialized)throw new Error("SoundFont is not initialized.");this.instruments.has(Qe)?this.instruments.get(Qe).playNoteDown(B,J,Ge):a.log(`No instrument in ${this.name} for: program=${Z}, isDrum=${le}`,"SoundFont")}playNoteUp(B,J,Z=0,le=!1,Ge){let Qe=le?"drums":Z;if(!this.initialized)throw new Error("SoundFont is not initialized.");this.instruments.has(Qe)?this.instruments.get(Qe).playNoteUp(B,J,Ge):a.log(`No instrument in ${this.name} for: program=${Z}, isDrum=${le}`,"SoundFont")}}function j(qe,B){return qe.quantizedStartStep<B.quantizedStartStep?-1:qe.quantizedStartStep>B.quantizedStartStep?1:qe.pitch<B.pitch?-1:1}class G{}class Q{constructor(B=!1,J){this.playClick=B,this.callbackObject=J,this.desiredQPM=void 0}setTempo(B){this.desiredQPM=B,f.Transport.state==="started"&&(f.Transport.bpm.value=B)}makeClickSequence(B){let J=p.clone(B),Z=J.notes.map(Ge=>Ge.quantizedEndStep),le=Math.max(...Z);for(let Ge=0;Ge<le;Ge+=4){let Qe={pitch:Ge%16==0?s.LO_CLICK_PITCH:s.HI_CLICK_PITCH,quantizedStartStep:Ge,isDrum:!0,quantizedEndStep:Ge+1};J.notes.push(Qe)}return J.notes.sort(j),J}resumeContext(){f.context.resume()}start(B,J,Z=0){if(this.getPlayState()==="started")throw new Error("Cannot start playback; player is already playing.");if(this.getPlayState()==="paused")throw new Error("Cannot `start()` a paused player; use `resume()`.");if(f.Transport.state!=="stopped")throw new Error("Cannot start playback while `Tone.Transport` is in use.");this.resumeContext();let le=p.isQuantizedSequence(B);if(this.playClick&&le&&(B=this.makeClickSequence(B)),J?f.Transport.bpm.value=J:B.tempos&&B.tempos.length>0&&B.tempos[0].qpm>0?f.Transport.bpm.value=B.tempos[0].qpm:f.Transport.bpm.value=s.DEFAULT_QUARTERS_PER_MINUTE,le)B=p.unquantizeSequence(B,J);else if(J)throw new Error("Cannot specify a `qpm` for a non-quantized sequence.");let Ge=new f.Part((Qe,dt)=>{this.currentPart===Ge&&(this.playNote(Qe,dt),this.callbackObject&&f.Draw.schedule(()=>{this.callbackObject.run(dt,Qe)},Qe))},B.notes.map(Qe=>[Qe.startTime,Qe]));return this.currentPart=Ge,this.desiredQPM&&(f.Transport.bpm.value=this.desiredQPM),this.currentPart.start(void 0,Z),f.Transport.state!=="started"&&f.Transport.start(),new Promise(Qe=>{this.scheduledStop=f.Transport.schedule(()=>{this.stop(),Qe(),this.callbackObject&&this.callbackObject.stop()},"+"+B.totalTime)})}stop(){this.isPlaying()&&(this.currentPart.stop(),f.Transport.stop(),this.currentPart=null),f.Transport.clear(this.scheduledStop),this.scheduledStop=void 0,this.desiredQPM=void 0}pause(){if(!this.isPlaying())throw new Error("Cannot pause playback while the player is stopped.");f.Transport.pause()}resume(){if(this.getPlayState()!=="paused")throw new Error(`Cannot resume playback while "${this.getPlayState()}".`);f.Transport.start()}seekTo(B){if(!this.isPlaying())throw new Error("Cannot seek while the player is stopped.");f.Transport.seconds=B}isPlaying(){return!!this.currentPart}getPlayState(){return this.isPlaying()?f.Transport.state:"stopped"}}class ie{constructor(){this.DRUM_PITCH_TO_CLASS=new Map,this.kick=new f.MembraneSynth().toDestination(),this.tomLow=new f.MembraneSynth({pitchDecay:.008,envelope:{attack:.01,decay:.5,sustain:0}}).toDestination(),this.tomMid=new f.MembraneSynth({pitchDecay:.008,envelope:{attack:.01,decay:.5,sustain:0}}).toDestination(),this.tomHigh=new f.MembraneSynth({pitchDecay:.008,envelope:{attack:.01,decay:.5,sustain:0}}).toDestination(),this.closedHihat=new f.MetalSynth({frequency:400,envelope:{attack:.001,decay:.1,release:.8},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1}).toDestination(),this.openHihat=new f.MetalSynth({frequency:400,envelope:{attack:.001,decay:.5,release:.8,sustain:1},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1}).toDestination(),this.ride=new f.MetalSynth().toDestination(),this.crash=new f.MetalSynth({frequency:300,envelope:{attack:.001,decay:1,release:3},harmonicity:5.1,modulationIndex:64,resonance:4e3,octaves:1.5}).toDestination(),this.snare=new f.NoiseSynth({noise:{type:"white"},envelope:{attack:.005,decay:.05,sustain:.1,release:.4}}).toDestination(),this.loClick=new f.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.hiClick=new f.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.pitchPlayers=[(B,J=1)=>this.kick.triggerAttackRelease("C2","8n",B,J),(B,J=1)=>this.snare.triggerAttackRelease("16n",B,J),(B,J=1)=>this.closedHihat.triggerAttack(B,.3,J),(B,J=1)=>this.openHihat.triggerAttack(B,.3,J),(B,J=.5)=>this.tomLow.triggerAttack("G3",B,J),(B,J=.5)=>this.tomMid.triggerAttack("C4",B,J),(B,J=.5)=>this.tomHigh.triggerAttack("F4",B,J),(B,J=1)=>this.crash.triggerAttack(B,1,J),(B,J=1)=>this.ride.triggerAttack(B,.5,J),(B,J=.5)=>this.loClick.triggerAttack("G5",B,J),(B,J=.5)=>this.hiClick.triggerAttack("C6",B,J)];for(let B=0;B<s.DEFAULT_DRUM_PITCH_CLASSES.length;++B)s.DEFAULT_DRUM_PITCH_CLASSES[B].forEach(J=>{this.DRUM_PITCH_TO_CLASS.set(J,B)});this.DRUM_PITCH_TO_CLASS.set(s.LO_CLICK_PITCH,s.LO_CLICK_CLASS),this.DRUM_PITCH_TO_CLASS.set(s.HI_CLICK_PITCH,s.HI_CLICK_CLASS)}static getInstance(){return ie.instance||(ie.instance=new ie),ie.instance}playNote(B,J,Z){this.pitchPlayers[this.DRUM_PITCH_TO_CLASS.get(B)](J,Z)}}let pe=(()=>{class qe extends Q{constructor(){super(...arguments),this.drumKit=ie.getInstance(),this.bassSynth=new f.Synth({volume:5,oscillator:{type:"triangle"}}).toDestination(),this.polySynth=new f.PolySynth().toDestination()}playNote(J,Z){let le=Z.hasOwnProperty("velocity")?Z.velocity/s.MAX_MIDI_VELOCITY:void 0;if(Z.isDrum)this.drumKit.playNote(Z.pitch,J,le);else{let Ge=f.Frequency(Z.pitch,"midi").toFrequency(),Qe=Z.endTime-Z.startTime;this.getSynth(Z.instrument,Z.program).triggerAttackRelease(Ge,Qe,J,le)}}getSynth(J,Z){return Z!==void 0&&Z>=32&&Z<=39?this.bassSynth:this.polySynth}}return qe.tone=f,qe})();class xe extends Q{constructor(B,J=f.Master,Z,le,Ge){super(!1,Ge),this.soundFont=new P(B),this.output=J,this.programOutputs=Z,this.drumOutputs=le}loadSamples(B){return Y(this,null,function*(){yield this.soundFont.loadSamples(B.notes.map(J=>({pitch:J.pitch,velocity:J.velocity,program:J.program||0,isDrum:J.isDrum||!1})))})}loadAllSamples(B=0,J=!1){return Y(this,null,function*(){let Z=x.a.create(),le=J?s.MIN_DRUM_PITCH:s.MIN_PIANO_PITCH,Ge=J?s.MAX_DRUM_PITCH:s.MAX_PIANO_PITCH;for(let Qe=le;Qe<=Ge;Qe++)for(let dt=s.MIN_MIDI_VELOCITY;dt<s.MAX_MIDI_VELOCITY;dt++)Z.notes.push({pitch:Qe,velocity:dt,program:B,isDrum:J});return this.loadSamples(Z)})}resumeContext(){f.context.resume()}start(B,J,Z=0){return this.resumeContext(),this.loadSamples(B).then(()=>super.start(B,J,Z))}playNote(B,J){this.soundFont.playNote(J.pitch,J.velocity,B,J.endTime-J.startTime,J.program,J.isDrum,this.getAudioNodeOutput(J))}playNoteDown(B){this.soundFont.playNoteDown(B.pitch,B.velocity,B.program,B.isDrum,this.getAudioNodeOutput(B))}playNoteUp(B){this.soundFont.playNoteUp(B.pitch,B.velocity,B.program,B.isDrum,this.getAudioNodeOutput(B))}getAudioNodeOutput(B){let J=this.output;return this.programOutputs&&!B.isDrum?this.programOutputs.has(B.program)&&(J=this.programOutputs.get(B.program)):this.drumOutputs&&B.isDrum&&this.drumOutputs.has(B.pitch)&&(J=this.drumOutputs.get(B.pitch)),J}}class ne extends pe{constructor(B){super(!0,B)}}class fe extends Q{constructor(B){super(!1,B),this.outputs=[],this.outputChannel=0,this.availableOutputs=[],this.NOTE_ON=144,this.NOTE_OFF=128}requestMIDIAccess(){return Y(this,null,function*(){return navigator.requestMIDIAccess?new Promise((B,J)=>{navigator.requestMIDIAccess().then(Z=>{Z.addEventListener("statechange",le=>this.initOutputs(Z)),B(this.initOutputs(Z))},Z=>console.log("Something went wrong",J(Z)))}):null})}initOutputs(B){let J=B.outputs.values();for(let Z=J.next();Z&&!Z.done;Z=J.next())this.availableOutputs.push(Z.value);return this.availableOutputs}playNote(B,J){let Z=J.velocity||100,le=1e3*(J.endTime-J.startTime),Ge=[this.NOTE_ON+this.outputChannel,J.pitch,Z],Qe=[this.NOTE_OFF+this.outputChannel,J.pitch,Z],dt=this.outputs?this.outputs:this.availableOutputs;for(let yt=0;yt<dt.length;yt++)this.sendMessageToOutput(dt[yt],Ge),this.sendMessageToOutput(dt[yt],Qe,m.d.now()+le)}sendMessageToOutput(B,J,Z){B&&B.send(J,Z)}playNoteDown(B){let J=[this.NOTE_ON,B.pitch,B.velocity],Z=this.outputs?this.outputs:this.availableOutputs;for(let le=0;le<Z.length;le++)this.sendMessageToOutput(Z[le],J)}playNoteUp(B){let J=[this.NOTE_OFF,B.pitch,B.velocity],Z=this.outputs?this.outputs:this.availableOutputs;for(let le=0;le<Z.length;le++)this.sendMessageToOutput(Z[le],J,B.endTime-B.startTime)}}class te{}class se{constructor(B={},J){this.notes=[],this.midiInputs=[],this.loClick=new f.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.hiClick=new f.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.config={playClick:B.playClick,qpm:B.qpm||s.DEFAULT_QUARTERS_PER_MINUTE,playCountIn:B.playCountIn,startRecordingAtFirstNote:B.startRecordingAtFirstNote||!1},this.callbackObject=J,this.recording=!1,this.onNotes=new Map}initialize(){return Y(this,null,function*(){yield navigator.requestMIDIAccess().then(B=>this.midiReady(B),B=>console.log("Something went wrong",B))})}midiReady(B){a.log("Initialized Recorder","Recorder");let J=B.inputs.values();for(let Z=J.next();Z&&!Z.done;Z=J.next())this.midiInputs.push(Z.value)}isRecording(){return this.recording}setTempo(B){this.config.qpm=B,f.Transport.state==="started"&&(f.Transport.bpm.value=B)}enablePlayClick(B){this.config.playClick=B}enablePlayCountIn(B){this.config.playCountIn=B}initClickLoop(){let B=0;this.clickLoop=new f.Loop(J=>{B%4==0?this.loClick.triggerAttack("G5",J):this.hiClick.triggerAttack("C6",J),B++,this.config.playCountIn&&B===4&&(f.Transport.stop(),this.clickLoop.stop())},"4n")}getMIDIInputs(){return this.midiInputs}start(B){let J=B||this.midiInputs;for(let Z of J)Z.onmidimessage=le=>{this.midiMessageReceived(le)};if(this.config.playClick||this.config.playCountIn?(this.initClickLoop(),f.Transport.bpm.value=this.config.qpm,f.Transport.start(),this.clickLoop.start()):this.clickLoop=null,this.recording=!0,this.firstNoteTimestamp=void 0,this.notes=[],this.onNotes=new Map,!this.startRecordingAtFirstNote){let Z=Date.now();this.firstNoteTimestamp=Z}}stop(){this.recording=!1;let B=Date.now();this.onNotes.forEach((J,Z)=>{this.noteOff(Z,B)});for(let J of this.midiInputs)J.onmidimessage=null;return this.clickLoop&&(f.Transport.stop(),this.clickLoop.stop()),this.notes.length===0?null:this.getNoteSequence()}getNoteSequence(){return this.notes.length===0?null:x.a.create({notes:this.notes,totalTime:this.notes[this.notes.length-1].endTime})}reset(){let B=this.stop();return this.firstNoteTimestamp=void 0,this.notes=[],this.onNotes=new Map,B}midiMessageReceived(B){if(!this.recording)return;let J;J=B.timeStamp!==void 0&&B.timeStamp!==0?B.timeStamp:m.d.now();let Z=J+m.d.timing.navigationStart;this.firstNoteTimestamp===void 0&&(this.firstNoteTimestamp=Z);let le=B.data[0]>>4,Ge=B.data[1],Qe=B.data.length>2?B.data[2]:1,dt=B.srcElement;le===8||le===9&&Qe===0?(this.callbackObject&&this.callbackObject.noteOff&&this.callbackObject.noteOff(Ge,Qe,dt),this.noteOff(Ge,Z),this.callbackObject&&this.callbackObject.run&&this.callbackObject.run(this.getNoteSequence())):le===9&&(this.callbackObject&&this.callbackObject.noteOn&&this.callbackObject.noteOn(Ge,Qe,dt),this.noteOn(Ge,Qe,Z))}noteOn(B,J,Z){let le=new x.a.Note;le.pitch=B,le.startTime=(Z-this.firstNoteTimestamp)/1e3,le.velocity=J,this.onNotes.set(B,le)}noteOff(B,J){let Z=this.onNotes.get(B);Z&&(Z.endTime=(J-this.firstNoteTimestamp)/1e3,this.notes.push(Z)),this.onNotes.delete(B)}}var ee=e(83);class we{constructor(B,J={}){let Z=p.isQuantizedSequence(B),le=B.tempos&&B.tempos.length>0?B.tempos[0].qpm:void 0;this.noteSequence=Z?p.unquantizeSequence(B,le):B,this.config={noteHeight:J.noteHeight||6,noteSpacing:J.noteSpacing||1,pixelsPerTimeStep:J.pixelsPerTimeStep||30,noteRGB:J.noteRGB||"8, 41, 64",activeNoteRGB:J.activeNoteRGB||"240, 84, 119",minPitch:J.minPitch,maxPitch:J.maxPitch};let Ge=this.getSize();this.width=Ge.width,this.height=Ge.height}updateMinMaxPitches(B=!1){if(!this.config.minPitch||!this.config.maxPitch){this.config.minPitch===void 0&&(this.config.minPitch=s.MAX_MIDI_PITCH),this.config.maxPitch===void 0&&(this.config.maxPitch=s.MIN_MIDI_PITCH);for(let J of this.noteSequence.notes)this.config.minPitch=Math.min(J.pitch,this.config.minPitch),this.config.maxPitch=Math.max(J.pitch,this.config.maxPitch);B||(this.config.minPitch-=2,this.config.maxPitch+=2)}}getSize(){this.updateMinMaxPitches();let B=(this.config.maxPitch-this.config.minPitch)*this.config.noteHeight,J=this.noteSequence.totalTime;if(!J)throw new Error("The sequence you are using with the visualizer does not have a totalQuantizedSteps or totalTime field set, so the visualizer can't be horizontally sized correctly.");return{width:J*this.config.pixelsPerTimeStep,height:B}}getNotePosition(B,J){let Z=this.getNoteEndTime(B)-this.getNoteStartTime(B),le=this.getNoteStartTime(B)*this.config.pixelsPerTimeStep,Ge=Math.max(this.config.pixelsPerTimeStep*Z-this.config.noteSpacing,1);return{x:le,y:this.height-(B.pitch-this.config.minPitch)*this.config.noteHeight,w:Ge,h:this.config.noteHeight}}scrollIntoViewIfNeeded(B,J){if(B&&this.parentElement){let Z=this.parentElement.getBoundingClientRect().width;J>this.parentElement.scrollLeft+Z&&(this.parentElement.scrollLeft=J-20)}}getNoteStartTime(B){return Math.round(1e8*B.startTime)/1e8}getNoteEndTime(B){return Math.round(1e8*B.endTime)/1e8}isPaintingActiveNote(B,J){let Z=this.getNoteStartTime(B)===this.getNoteStartTime(J),le=this.getNoteStartTime(B)<=this.getNoteStartTime(J)&&this.getNoteEndTime(B)>=this.getNoteEndTime(J);return Z||le}}class be extends we{constructor(B,J,Z={}){super(B,Z),this.ctx=J.getContext("2d"),this.parentElement=J.parentElement;let le=window.devicePixelRatio||1;this.ctx&&(this.ctx.canvas.width=le*this.width,this.ctx.canvas.height=le*this.height,J.style.width=this.width+"px",J.style.height=this.height+"px",this.ctx.scale(le,le)),this.redraw()}redraw(B,J){let Z;this.clear();for(let le=0;le<this.noteSequence.notes.length;le++){let Ge=this.noteSequence.notes[le],Qe=this.getNotePosition(Ge,le),dt=.2,yt=Ge.velocity?Ge.velocity/100+dt:1,Vt=B&&this.isPaintingActiveNote(Ge,B),En=`rgba(${Vt?this.config.activeNoteRGB:this.config.noteRGB},
  ${yt})`;this.redrawNote(Qe.x,Qe.y,Qe.w,Qe.h,En),Vt&&Ge===B&&(Z=Qe.x)}return this.scrollIntoViewIfNeeded(J,Z),Z}clear(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}clearActiveNotes(){this.redraw()}redrawNote(B,J,Z,le,Ge){this.ctx.fillStyle=Ge,this.ctx.fillRect(Math.round(B),Math.round(J),Math.round(Z),Math.round(le))}}class ke extends be{constructor(B,J,Z={}){super(B,J,Z),a.log("mm.Visualizer is deprecated, and will be removed in a future          version. Please use mm.PianoRollCanvasVisualizer instead","mm.Visualizer",5)}}class De extends we{constructor(B,J={}){super(B,J),this.drawn=!1}redraw(B,J){if(this.drawn||this.draw(),!B)return null;let Z;this.unfillActiveRect(this.svg);for(let le=0;le<this.noteSequence.notes.length;le++){let Ge=this.noteSequence.notes[le];if(!(B&&this.isPaintingActiveNote(Ge,B)))continue;let Qe=this.svg.querySelector(`rect[data-index="${le}"]`);this.fillActiveRect(Qe,Ge),Ge===B&&(Z=parseFloat(Qe.getAttribute("x")))}return this.scrollIntoViewIfNeeded(J,Z),Z}fillActiveRect(B,J){B.setAttribute("fill",this.getNoteFillColor(J,!0)),B.classList.add("active")}unfillActiveRect(B){let J=B.querySelectorAll("rect.active");for(let Z=0;Z<J.length;++Z){let le=J[Z],Ge=this.getNoteFillColor(this.noteSequence.notes[parseInt(le.getAttribute("data-index"),10)],!1);le.setAttribute("fill",Ge),le.classList.remove("active")}}draw(){for(let B=0;B<this.noteSequence.notes.length;B++){let J=this.noteSequence.notes[B],Z=this.getNotePosition(J,B),le=this.getNoteFillColor(J,!1),Ge=[["index",B],["instrument",J.instrument],["program",J.program],["isDrum",J.isDrum===!0],["pitch",J.pitch]],Qe=[["--midi-velocity",String(J.velocity!==void 0?J.velocity:127)]];this.drawNote(Z.x,Z.y,Z.w,Z.h,le,Ge,Qe)}this.drawn=!0}getNoteFillColor(B,J){let Z=B.velocity?B.velocity/100+.2:1;return`rgba(${J?this.config.activeNoteRGB:this.config.noteRGB},
  ${Z})`}drawNote(B,J,Z,le,Ge,Qe,dt){if(!this.svg)return;let yt=document.createElementNS("http://www.w3.org/2000/svg","rect");yt.classList.add("note"),yt.setAttribute("fill",Ge),yt.setAttribute("x",""+Math.round(B)),yt.setAttribute("y",""+Math.round(J)),yt.setAttribute("width",""+Math.round(Z)),yt.setAttribute("height",""+Math.round(le)),Qe.forEach(([Vt,En])=>{En!==void 0&&(yt.dataset[Vt]=""+En)}),dt.forEach(([Vt,En])=>{yt.style.setProperty(Vt,En)}),this.svg.appendChild(yt)}clear(){this.svg.innerHTML="",this.drawn=!1}clearActiveNotes(){this.unfillActiveRect(this.svg)}}class Re extends De{constructor(B,J,Z={}){if(super(B,Z),!(J instanceof SVGSVGElement))throw new Error("This visualizer requires an <svg> element to display the visualization");this.svg=J,this.parentElement=J.parentElement;let le=this.getSize();this.width=le.width,this.height=le.height,this.svg.style.width=this.width+"px",this.svg.style.height=this.height+"px",this.clear(),this.draw()}}class Ce extends De{constructor(B,J,Z={}){if(super(B,Z),this.NOTES_PER_OCTAVE=12,this.WHITE_NOTES_PER_OCTAVE=7,this.LOW_C=24,this.firstDrawnOctave=0,this.lastDrawnOctave=6,!(J instanceof HTMLDivElement))throw new Error("This visualizer requires a <div> element to display the visualization");this.config.whiteNoteWidth=Z.whiteNoteWidth||20,this.config.blackNoteWidth=Z.blackNoteWidth||2*this.config.whiteNoteWidth/3,this.config.whiteNoteHeight=Z.whiteNoteHeight||70,this.config.blackNoteHeight=Z.blackNoteHeight||140/3,this.config.showOnlyOctavesUsed=Z.showOnlyOctavesUsed,this.setupDOM(J);let le=this.getSize();this.width=le.width,this.height=le.height,this.svg.style.width=this.width+"px",this.svg.style.height=this.height+"px",this.svgPiano.style.width=this.width+"px",this.svgPiano.style.height=this.config.whiteNoteHeight+"px",this.parentElement.style.width=this.width+this.config.whiteNoteWidth+"px",this.parentElement.scrollTop=this.parentElement.scrollHeight,this.clear(),this.drawPiano(),this.draw()}setupDOM(B){this.parentElement=document.createElement("div"),this.parentElement.classList.add("waterfall-notes-container");let J=Math.max(B.getBoundingClientRect().height,200);this.parentElement.style.paddingTop=J-this.config.whiteNoteHeight+"px",this.parentElement.style.height=J-this.config.whiteNoteHeight+"px",this.parentElement.style.boxSizing="border-box",this.parentElement.style.overflowX="hidden",this.parentElement.style.overflowY="auto",this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgPiano=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.classList.add("waterfall-notes"),this.svgPiano.classList.add("waterfall-piano"),this.parentElement.appendChild(this.svg),B.innerHTML="",B.appendChild(this.parentElement),B.appendChild(this.svgPiano)}redraw(B,J){if(this.drawn||this.draw(),!B)return null;this.clearActiveNotes(),this.parentElement.style.paddingTop=this.parentElement.style.height;for(let Z=0;Z<this.noteSequence.notes.length;Z++){let le=this.noteSequence.notes[Z];if(!(B&&this.isPaintingActiveNote(le,B)))continue;let Ge=this.svg.querySelector(`rect[data-index="${Z}"]`);this.fillActiveRect(Ge,le);let Qe=this.svgPiano.querySelector(`rect[data-pitch="${le.pitch}"]`);if(this.fillActiveRect(Qe,le),le===B){let dt=parseFloat(Ge.getAttribute("y")),yt=parseFloat(Ge.getAttribute("height"));return dt<this.parentElement.scrollTop-yt&&(this.parentElement.scrollTop=dt+yt),dt}}return null}getSize(){this.updateMinMaxPitches(!0);let B=52;if(this.config.showOnlyOctavesUsed){let le=!1,Ge=!1;for(let Qe=1;Qe<7;Qe++){let dt=this.LOW_C+this.NOTES_PER_OCTAVE*Qe;!le&&dt>this.config.minPitch&&(this.firstDrawnOctave=Qe-1,le=!0),!Ge&&dt>this.config.maxPitch&&(this.lastDrawnOctave=Qe-1,Ge=!0)}B=(this.lastDrawnOctave-this.firstDrawnOctave+1)*this.WHITE_NOTES_PER_OCTAVE}let J=B*this.config.whiteNoteWidth,Z=this.noteSequence.totalTime;if(!Z)throw new Error("The sequence you are using with the visualizer does not have a totalQuantizedSteps or totalTime field set, so the visualizer can't be horizontally sized correctly.");return{width:J,height:Math.max(Z*this.config.pixelsPerTimeStep,1)}}getNotePosition(B,J){let Z=this.svgPiano.querySelector(`rect[data-pitch="${B.pitch}"]`);if(!Z)return null;let le=this.getNoteEndTime(B)-this.getNoteStartTime(B),Ge=Number(Z.getAttribute("x")),Qe=Number(Z.getAttribute("width")),dt=Math.max(this.config.pixelsPerTimeStep*le-this.config.noteSpacing,1);return{x:Ge,y:this.height-this.getNoteStartTime(B)*this.config.pixelsPerTimeStep-dt,w:Qe,h:dt}}drawPiano(){this.svgPiano.innerHTML="";let B=this.config.whiteNoteWidth-this.config.blackNoteWidth/2,J=[1,3,6,8,10],Z=0,le=0;this.config.showOnlyOctavesUsed?le=this.firstDrawnOctave*this.NOTES_PER_OCTAVE+this.LOW_C:(le=this.LOW_C-3,this.drawWhiteKey(le,Z),this.drawWhiteKey(le+2,this.config.whiteNoteWidth),le+=3,Z=2*this.config.whiteNoteWidth);for(let Ge=this.firstDrawnOctave;Ge<=this.lastDrawnOctave;Ge++)for(let Qe=0;Qe<this.NOTES_PER_OCTAVE;Qe++)J.indexOf(Qe)===-1&&(this.drawWhiteKey(le,Z),Z+=this.config.whiteNoteWidth),le++;this.config.showOnlyOctavesUsed?(le=this.firstDrawnOctave*this.NOTES_PER_OCTAVE+this.LOW_C,Z=-this.config.whiteNoteWidth):(this.drawWhiteKey(le,Z),le=this.LOW_C-3,this.drawBlackKey(le+1,B),le+=3,Z=this.config.whiteNoteWidth);for(let Ge=this.firstDrawnOctave;Ge<=this.lastDrawnOctave;Ge++)for(let Qe=0;Qe<this.NOTES_PER_OCTAVE;Qe++)J.indexOf(Qe)!==-1?this.drawBlackKey(le,Z+B):Z+=this.config.whiteNoteWidth,le++}drawWhiteKey(B,J){let Z=document.createElementNS("http://www.w3.org/2000/svg","rect");return Z.dataset.pitch=String(B),Z.setAttribute("x",String(J)),Z.setAttribute("y","0"),Z.setAttribute("width",String(this.config.whiteNoteWidth)),Z.setAttribute("height",String(this.config.whiteNoteHeight)),Z.setAttribute("fill","white"),Z.setAttribute("original-fill","white"),Z.setAttribute("stroke","black"),Z.setAttribute("stroke-width","3px"),Z.classList.add("white"),this.svgPiano.appendChild(Z),Z}drawBlackKey(B,J){let Z=document.createElementNS("http://www.w3.org/2000/svg","rect");return Z.dataset.pitch=String(B),Z.setAttribute("x",String(J)),Z.setAttribute("y","0"),Z.setAttribute("width",String(this.config.blackNoteWidth)),Z.setAttribute("height",String(this.config.blackNoteHeight)),Z.setAttribute("fill","black"),Z.setAttribute("original-fill","black"),Z.setAttribute("stroke","black"),Z.setAttribute("stroke-width","3px"),Z.classList.add("black"),this.svgPiano.appendChild(Z),Z}clearActiveNotes(){super.unfillActiveRect(this.svg);let B=this.svgPiano.querySelectorAll("rect.active");for(let J=0;J<B.length;++J){let Z=B[J];Z.setAttribute("fill",Z.getAttribute("original-fill")),Z.classList.remove("active")}}}var Je;(function(qe){qe[qe.PAGE=0]="PAGE",qe[qe.NOTE=1]="NOTE",qe[qe.BAR=2]="BAR"})(Je||(Je={}));class rt extends we{constructor(B,J,Z={}){super(B,Z),(Z.pixelsPerTimeStep===void 0||Z.pixelsPerTimeStep<=0)&&(this.config.pixelsPerTimeStep=0),this.instruments=Z.instruments||[],this.render=new ee.StaffSVGRender(this.getScoreInfo(B),{noteHeight:this.config.noteHeight,noteSpacing:this.config.noteSpacing,pixelsPerTimeStep:this.config.pixelsPerTimeStep,noteRGB:this.config.noteRGB,activeNoteRGB:this.config.activeNoteRGB,defaultKey:Z.defaultKey||0,scrollType:Z.scrollType||Je.PAGE},J),this.drawnNotes=B.notes.length,this.clear(),this.redraw()}clear(){this.render.clear()}redraw(B,J){this.drawnNotes!==this.noteSequence.notes.length&&(this.render.scoreInfo=this.getScoreInfo(this.noteSequence));let Z=B?this.getNoteInfo(B):void 0;return this.render.redraw(Z,J)}isNoteInInstruments(B){return B.instrument===void 0||this.instruments.length===0||this.instruments.indexOf(B.instrument)>=0}timeToQuarters(B){let J=B*this.noteSequence.tempos[0].qpm/60;return Math.round(16*J)/16}getNoteInfo(B){let J=this.timeToQuarters(B.startTime);return{start:J,length:this.timeToQuarters(B.endTime)-J,pitch:B.pitch,intensity:B.velocity}}getScoreInfo(B){let J=[];return B.notes.forEach(Z=>{this.isNoteInInstruments(Z)&&J.push(this.getNoteInfo(Z))}),{notes:J,tempos:B.tempos?B.tempos.map(Z=>({start:this.timeToQuarters(Z.time),qpm:Z.qpm})):[],keySignatures:B.keySignatures?B.keySignatures.map(Z=>({start:this.timeToQuarters(Z.time),key:Z.key})):[],timeSignatures:B.timeSignatures?B.timeSignatures.map(Z=>({start:this.timeToQuarters(Z.time),numerator:Z.numerator,denominator:Z.denominator})):[]}}clearActiveNotes(){this.redraw()}}},,,,,,function(n,t,e){t.parseMidi=e(172),t.writeMidi=e(173)},function(n,t,e){"use strict";function r(o,s,i){i===void 0&&(i="ticks");var a=0,c=o.length,l=c;if(c>0&&o[c-1][i]<=s)return c-1;for(;a<l;){var p=Math.floor(a+(l-a)/2),f=o[p],y=o[p+1];if(f[i]===s){for(var d=p;d<o.length;d++)o[d][i]===s&&(p=d);return p}if(f[i]<s&&y[i]>s)return p;f[i]>s?l=p:f[i]<s&&(a=p+1)}return-1}Object.defineProperty(t,"__esModule",{value:!0}),t.search=r,t.insert=function(o,s,i){if(i===void 0&&(i="ticks"),o.length){var a=r(o,s[i],i);o.splice(a+1,0,s)}else o.push(s)}},function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=e(80),o=e(82),s=e(176),i=e(177),a=e(178),c=e(180),l=new WeakMap,p=function(){function f(y,d){var h=this;if(this.name="",this.notes=[],this.controlChanges=s.createControlChanges(),this.pitchBends=[],l.set(this,d),y){var m=y.find(function(T){return T.type==="trackName"});this.name=m?m.text:""}if(this.instrument=new a.Instrument(y,this),this.channel=0,y){for(var x=y.filter(function(T){return T.type==="noteOn"}),w=y.filter(function(T){return T.type==="noteOff"}),_=function(){var T=x.shift();I.channel=T.channel;var D=w.findIndex(function(R){return R.noteNumber===T.noteNumber&&R.absoluteTime>=T.absoluteTime});if(D!==-1){var O=w.splice(D,1)[0];I.addNote({durationTicks:O.absoluteTime-T.absoluteTime,midi:T.noteNumber,noteOffVelocity:O.velocity/127,ticks:T.absoluteTime,velocity:T.velocity/127})}},I=this;x.length;)_();y.filter(function(T){return T.type==="controller"}).forEach(function(T){h.addCC({number:T.controllerType,ticks:T.absoluteTime,value:T.value/127})}),y.filter(function(T){return T.type==="pitchBend"}).forEach(function(T){h.addPitchBend({ticks:T.absoluteTime,value:T.value/Math.pow(2,13)})})}}return f.prototype.addNote=function(y){var d=l.get(this),h=new c.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},d);return Object.assign(h,y),r.insert(this.notes,h,"ticks"),this},f.prototype.addCC=function(y){var d=l.get(this),h=new o.ControlChange({controllerType:y.number},d);return delete y.number,Object.assign(h,y),Array.isArray(this.controlChanges[h.number])||(this.controlChanges[h.number]=[]),r.insert(this.controlChanges[h.number],h,"ticks"),this},f.prototype.addPitchBend=function(y){var d=l.get(this),h=new i.PitchBend({},d);return Object.assign(h,y),r.insert(this.pitchBends,h,"ticks"),this},Object.defineProperty(f.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var y=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,d=0;d<this.notes.length-1;d++){var h=this.notes[d].time+this.notes[d].duration;y<h&&(y=h)}return y},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var y=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,d=0;d<this.notes.length-1;d++){var h=this.notes[d].ticks+this.notes[d].durationTicks;y<h&&(y=h)}return y},enumerable:!0,configurable:!0}),f.prototype.fromJSON=function(y){var d=this;for(var h in this.name=y.name,this.channel=y.channel,this.instrument=new a.Instrument(void 0,this),this.instrument.fromJSON(y.instrument),y.controlChanges)y.controlChanges[h]&&y.controlChanges[h].forEach(function(m){d.addCC({number:m.number,ticks:m.ticks,value:m.value})});y.notes.forEach(function(m){d.addNote({durationTicks:m.durationTicks,midi:m.midi,ticks:m.ticks,velocity:m.velocity})})},f.prototype.toJSON=function(){for(var y={},d=0;d<127;d++)this.controlChanges.hasOwnProperty(d)&&(y[d]=this.controlChanges[d].map(function(h){return h.toJSON()}));return{channel:this.channel,controlChanges:y,pitchBends:this.pitchBends.map(function(h){return h.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(h){return h.toJSON()})}},f}();t.Track=p},function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},t.controlChangeIds=Object.keys(t.controlChangeNames).reduce(function(i,a){return i[t.controlChangeNames[a]]=a,i},{});var r=new WeakMap,o=new WeakMap,s=function(){function i(a,c){r.set(this,c),o.set(this,a.controllerType),this.ticks=a.absoluteTime,this.value=a.value}return Object.defineProperty(i.prototype,"number",{get:function(){return o.get(this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return t.controlChangeNames[this.number]?t.controlChangeNames[this.number]:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"time",{get:function(){return r.get(this).ticksToSeconds(this.ticks)},set:function(a){var c=r.get(this);this.ticks=c.secondsToTicks(a)},enumerable:!0,configurable:!0}),i.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},i}();t.ControlChange=s},function(n,t,e){n.exports=function(r){var o={};function s(i){if(o[i])return o[i].exports;var a=o[i]={i,l:!1,exports:{}};return r[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}return s.m=r,s.c=o,s.d=function(i,a,c){s.o(i,a)||Object.defineProperty(i,a,{enumerable:!0,get:c})},s.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},s.t=function(i,a){if(1&a&&(i=s(i)),8&a||4&a&&typeof i=="object"&&i&&i.__esModule)return i;var c=Object.create(null);if(s.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:i}),2&a&&typeof i!="string")for(var l in i)s.d(c,l,function(p){return i[p]}.bind(null,l));return c},s.n=function(i){var a=i&&i.__esModule?function(){return i.default}:function(){return i};return s.d(a,"a",a),a},s.o=function(i,a){return Object.prototype.hasOwnProperty.call(i,a)},s.p="",s(s.s=4)}([function(r,o,s){"use strict";s.r(o),s.d(o,"SVGNS",function(){return i}),s.d(o,"drawSVGPath",function(){return a}),s.d(o,"drawSVGText",function(){return c}),s.d(o,"createSVGGroupChild",function(){return l}),s.d(o,"setFade",function(){return p});let i="http://www.w3.org/2000/svg";function a(f,y,d,h,m,x,w=1){let _=document.createElementNS(i,"path");return _.setAttributeNS(null,"d",y),_.setAttributeNS(null,"transform",`translate(${d}, ${h}) scale(${m}, ${x})`),_.setAttributeNS(null,"opacity",""+w),f.appendChild(_),_}function c(f,y,d,h,m,x=!1,w=1,_=1){let I=document.createElementNS(i,"text");I.setAttributeNS(null,"font-family","Times"),I.setAttributeNS(null,"font-size",m),x&&I.setAttributeNS(null,"font-weight","bold"),I.setAttributeNS(null,"transform",`translate(${d}, ${h}) scale(${w}, ${_})`);let T=document.createTextNode(y);return I.appendChild(T),f.appendChild(I),I}function l(f,y){let d=document.createElementNS(i,"g");return d.setAttribute("data-id",y),f.appendChild(d),d}function p(f,y=!1,d=1,h=0){let m=f.querySelector("animate");if(!m){(m=document.createElementNS(i,"animate")).setAttributeNS(null,"attributeName","opacity"),m.setAttributeNS(null,"dur","4s"),m.setAttributeNS(null,"fill","freeze"),m.setAttributeNS(null,"keyTimes","0; 0.25; 0.5; 0.75; 1");let x=(d+3*h)/4;m.setAttributeNS(null,"values",`${d}; ${x}; ${h}; ${x}; ${d}`)}return y?m.setAttributeNS(null,"repeatCount","indefinite"):m.setAttributeNS(null,"repeatCount","1"),f.appendChild(m),f}},function(r,o,s){"use strict";s.r(o),s.d(o,"PATH_SCALE",function(){return i}),s.d(o,"staffLinePath",function(){return c}),s.d(o,"extraLinePath",function(){return l}),s.d(o,"barPath",function(){return p}),s.d(o,"stemPath",function(){return f}),s.d(o,"singleFlagPath",function(){return y}),s.d(o,"multiFlagPath",function(){return d}),s.d(o,"tiePath",function(){return h}),s.d(o,"dotPath",function(){return m}),s.d(o,"NOTE_PATHS",function(){return x}),s.d(o,"REST_PATHS",function(){return w}),s.d(o,"CLEF_PATHS",function(){return _}),s.d(o,"ACCIDENTAL_PATHS",function(){return I});let i=100,a=`M 0,10 C 0,-15 35,-50 80,-50 110,-50 125,-35 125,-10 
125,15 90,50 45,50 15,50 0,35 0,10 Z`,c="m 0,0 h 100",l="m -25,0 h 175",p="m 0,-200 v 400",f="m 0,0 v 100 h 15 v -100 z",y=`M0,0 h 12 c 7,100 175,156 62,314 79,-177 -49,
-193 -61,-200 l -13,-5 z`,d=`m 0,0 h 10 c 6,72 173,64 84,227 44,-120 -44,
-123 -94,-167 z`,h=`M 0,25 C 10,46 30,67 50,67 69,67 90,47 100,25 94,
65 73,89 50,89 26,89 5,63 0,25 Z`,m="M 5 -20 a 20 20 0 1 0 0.00001 0 z",x={4:{path:`m 0,0 c 0,-37 49,-51 79,-51 31,0 83,13 83,51 0,39 
-55,51 -84,51 C 49,51 0,37 0,0 Z m 111,31 c 13,-19 0,-58 -22,-68 -33,-15 
-53,10 -39,49 9,27 48,39 61,19 z`,width:150,stemVSteps:0,stemAnchor:0,flags:0},2:{path:`m 0,10 c 0,-25 35,-60 80,-60 15,0 45,4 45,40 C 125,16 
89,50 45,50 17,50 0,36 0,10 Z m 71,7 c 17,-11 45,-34 38,-45 -7,-10 -39,1 
-57,12 -19,11 -42,31 -36,42 6,10 37,2 55,-9 z`,width:125,stemVSteps:7,stemAnchor:-10,flags:0},1:{path:a,width:125,stemVSteps:7,stemAnchor:-10,flags:0},.5:{path:a,width:125,stemVSteps:7,stemAnchor:-10,flags:1},.25:{path:a,width:125,stemVSteps:9,stemAnchor:-10,flags:2},.125:{path:a,width:125,stemVSteps:11,stemAnchor:-10,flags:3},.0625:{path:a,width:125,stemVSteps:13,stemAnchor:-10,flags:4}},w={4:"m 0,-50 h 125 v -50 H 0 Z",2:"M 0,0 H 125 V -50 H 0 Z",1:`m 0,-25 c 39,-39 37,-75 8,-120 l 6,-5 61,103 C 
40,-13 31,4 73,71 l -5,5 C 14,52 16,125 67,144 l -4,6 C -37,102 -1,22 59,60 Z`,.5:`m 52,-47 c 26,-2 42,-21 48,-42 l 12,4 L 64,83 52,79 
88,-49 c 0,0 -17,22 -57,22 -16,0 -31,-13 -31,-27 0,-18 10,-31 27,-31 17,0 
33,15 25,38 z`,.25:`m 129,-191 c -6,21 -22,40 -48,42 8,-23 -8,-38 
-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 l -20,69 
c -7,18 -22,33 -45,35 8,-23 -8,-38 -25,-38 -17,0 -27,13 -27,31 0,14 15,27 
31,27 40,0 57,-22 57,-22 l -36,128 12,4 77,-270 z`,.125:`m 129,-191 c -6,21 -22,40 -48,42 8,-23 -8,-38 
-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 l -20,69 
c -7,18 -22,33 -45,35 8,-23 -8,-38 -25,-38 -17,0 -27,13 -27,31 0,14 15,27 
31,27 40,0 57,-22 57,-22 L 68,20 C 61,37 46,51 24,52 32,29 16,14 -1,14 c 
-17,0 -27,13 -27,31 0,14 15,27 31,27 38,0 55,-20 57,-22 l -36,128 12,4 
105,-369 z`,.0625:`m 158,-292 c -6,21 -22,40 -48,42 8,-23 -8,-38 
-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 l -17,61 
v 0 c -6,21 -22,40 -48,42 8,-23 -8,-38 -25,-38 -17,0 -27,13 -27,31 0,14 
15,27 31,27 40,0 57,-22 57,-22 l -20,69 c -7,18 -22,33 -45,35 8,-23 -8,-38 
-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 L 68,20 C 
61,37 46,51 24,52 32,29 16,14 -1,14 c -17,0 -27,13 -27,31 0,14 15,27 31,27 
38,0 55,-20 57,-22 l -36,128 12,4 134,-469 z`},_={50:{path:`m 101,-199 c -49,0 -100,28 -100,83 0,39 58,57 82,26 15,-20 
-4,-47 -32,-47 -23,1 -25,0 -25,-8 0,-22 40,-46 71,-41 91,16 67,208 -105,302 
75,-27 198,-94 211,-201 6,-66 -42,-114 -102,-114 z m 143,33 c -13,0 -23,11 
-23,24 0,14 10,24 23,24 13,0 23,-11 23,-24 0,-13 -10,-24 -23,-24 z m 2,83 c 
-13,0 -23,11 -23,24 0,14 10,24 23,24 13,0 23,-11 23,-24 0,-13 -10,-24 -23,-24 
z`,upper:-4,lower:3},71:{path:`M 139,48 C 102,57 76,120 131,151 41,128 64,24 129,2 L 
117,-57 C -32,47 26,217 166,182 Z m 12,-1 27,131 C 242,153 216,46 151,47 
Z m -35,-177 c 34,-23 82,-117 50,-140 -23,-17 -71,33 -50,140 z m -10,10 c 
-23,-77 -20,-200 48,-213 19,-4 89,171 -26,266 l 13,66 c 120,-6 137,155 
39,191 l 12,58 c 30,131 -137,145 -138,47 0,-29 37,-59 63,-37 21,18 25,71 
-25,70 32,42 103,0 91,-65 L 167,193 C 56,232 -112,63 106,-120 Z`,upper:-7,lower:8}},I=[null,`m -49,-121 v 52 l -29,9 v -48 h -8 v 51 l -20,6 v 29 l 
20,-6 v 70 l -20,6 v 30 l 20,-6 v 51 h 8 V 69 l 30,-8 v 50 h 8 V 58 l 20,-6 
V 23 l -20,6 v -71 l 20,-6 v -29 l -20,6 v -50 z m 1,82 v 71 l -29,9 v -71 z`,`M -106,-166 V 67 c 52,-42 85,-56 85,-94 0,-47 -46,-51 
-73,-22 v -117 z m 31,120 c 20,0 42,46 -20,91 V -7 c 0,-28 10,-39 20,-39 z`,`m -81,-58 v -48 H -92 V 73 l 60,-13 v 50 h 11 V -72 Z m 
50,24 v 58 l -50,11 v -58 z`]},function(r,o,s){"use strict";s.r(o),s.d(o,"MIN_RESOLUTION",function(){return i}),s.d(o,"STEM_WIDTH",function(){return a}),s.d(o,"LINE_STROKE",function(){return c}),s.d(o,"COMPACT_SPACING",function(){return l});let i=.0625,a=15,c=1,l=150},function(r,o,s){"use strict";s.r(o),s.d(o,"MAX_QUARTER_DIVISION",function(){return f}),s.d(o,"ScrollType",function(){return y}),s.d(o,"StaffSVGRender",function(){return d});var i=s(2),a=s(0),c=s(1);let l=[{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[0,1,0,1,0,0,1,0,1,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,0,3,0,3,0,0,3,0,3,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,0,1,0,3,0,0,1,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,2,0,0,3,0,2,0,0,3,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,3,0,0,3,0,3,0,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,2,0,2,0,0,2,0,2,0,0,3]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-7],accidental:[3,0,3,0,3,0,0,3,0,3,0,0]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[0,1,0,1,0,3,0,0,1,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,0,3,0,3,0,2,0,0,3,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,0,1,0,3,0,3,0,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,2,0,0,3,0,2,0,2,0,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,3,0,0,3,0,3,0,3,0,0]}],p=[{accidental:1,pitches:[]},{accidental:2,pitches:[70,75,68,73,66]},{accidental:1,pitches:[78,73]},{accidental:2,pitches:[70,75,68]},{accidental:1,pitches:[78,73,80,75]},{accidental:2,pitches:[70]},{accidental:2,pitches:[70,75,68,73,66,71]},{accidental:1,pitches:[78]},{accidental:2,pitches:[70,75,68,73]},{accidental:1,pitches:[78,73,80]},{accidental:2,pitches:[70,75]},{accidental:1,pitches:[78,73,80,75,70]}],f=16;var y;(function(h){h[h.PAGE=0]="PAGE",h[h.NOTE=1]="NOTE",h[h.BAR=2]="BAR"})(y||(y={}));class d{constructor(m,x,w){this.handleScrollEvent=_=>{this.lastKnownScrollLeft=this.parentElement.scrollLeft,this.ticking||window.requestAnimationFrame(()=>{this.changeAndDrawSignaturesIfNeeded(this.lastKnownScrollLeft),this.ticking=!1}),this.ticking=!0},this.scoreInfo=m,this.config={noteHeight:x.noteHeight||6,noteSpacing:x.noteSpacing||1,pixelsPerTimeStep:x.pixelsPerTimeStep||30,noteRGB:x.noteRGB||"8, 41, 64",activeNoteRGB:x.activeNoteRGB||"240, 84, 119"},this.div=w,this.timeSignatureNumerator=4,this.timeSignatureDenominator=4,this.key=x.defaultKey||0,this.scrollType=x.scrollType||y.PAGE,this.scale=this.config.noteHeight/c.PATH_SCALE,(x.pixelsPerTimeStep===void 0||x.pixelsPerTimeStep<=0)&&(this.config.pixelsPerTimeStep=0,this.config.noteSpacing=i.COMPACT_SPACING*this.scale),this.clear(),this.redraw()}clear(){for(;this.div.lastChild;)this.div.removeChild(this.div.lastChild);this.div.style.overflow="visible",this.div.style.position="relative",this.overlaySVG=document.createElementNS(a.SVGNS,"svg"),this.overlaySVG.style.position="absolute",this.div.appendChild(this.overlaySVG),this.overlayG=Object(a.createSVGGroupChild)(this.overlaySVG,"overlay"),this.signaturesBlinking=!1,this.signaturesQuarters=0,this.parentElement=document.createElement("div"),this.parentElement.style.overflow="auto",this.div.appendChild(this.parentElement),this.ticking=!1,this.lastKnownScrollLeft=0,this.parentElement.addEventListener("scroll",this.handleScrollEvent),this.staffSVG=document.createElementNS(a.SVGNS,"svg"),this.parentElement.appendChild(this.staffSVG),this.staffG=Object(a.createSVGGroupChild)(this.staffSVG,"staff"),this.linesG=Object(a.createSVGGroupChild)(this.staffSVG,"lines"),this.setStroke(this.linesG),this.staffG.appendChild(this.linesG),this.musicG=Object(a.createSVGGroupChild)(this.staffSVG,"music"),this.setFill(this.musicG),this.setStroke(this.musicG,0),this.staffG.appendChild(this.musicG),this.signaturesG=Object(a.createSVGGroupChild)(this.staffSVG,"signatures"),this.staffG.appendChild(this.signaturesG);let m=0,x=0;this.scoreInfo.notes.forEach(_=>{m+=_.pitch,++x});let w=m/x;this.clef=w<60?50:71,this.signaturesList=[{x:0,q:0}],this.signatureCurrent=0,this.signatureNext=0,this.changeKeySignatureIfNeeded(0),this.changeTimeSignatureIfNeeded(0),this.vStepSize=this.config.noteHeight/2,this.hStepSize=this.config.pixelsPerTimeStep,this.staffOffset=0,this.height=0,this.width=0,this.musicBlockMap=new Map,this.playingNotes=[],this.lastBar=0,this.barAccidentals={},this.lastQ=-1}isPaintingActiveNote(m,x){let w=m.start===x.start,_=m.start<=x.start&&m.start+m.length>=x.start+x.length;return w||_}redraw(m,x){let w=-1,_=this.config.pixelsPerTimeStep===0;if(m){let I=[];this.playingNotes.forEach(D=>{this.isPaintingActiveNote(D,m)?I.push(D):this.highlightElement(this.getGroup(D),!1)}),this.playingNotes=I;let T=this.getGroup(m);if(T){this.playingNotes.push(m),this.highlightElement(T,!0),w=T.getBoundingClientRect().left-this.staffSVG.getBoundingClientRect().left;let D=m.start,O=T.getAttribute("data-is-bar-beginning");(this.scrollType!==y.BAR||O)&&this.scrollIntoViewIfNeeded(x,w),!_&&this.signaturesBlinking&&D>=this.signaturesQuarters&&(this.signaturesBlinking=!1,Object(a.setFade)(this.overlayG,this.signaturesBlinking))}}else{this.setDetails();let I=this.lastQ===-1,T=0,D=0;I?(D=this.drawSignatures(this.overlayG,T,!0,!0,!0),_&&(this.width=0,D+=this.config.noteSpacing),D+=this.drawRests(this.initialRest,T+D)):T=this.width,this.musicBlockMap.forEach((P,j)=>{_||(T=this.quartersToTime(j)*this.hStepSize),j>this.lastQ?(D+=this.drawMusicBlock(P,T+D),this.lastQ=j):j===this.lastQ&&(D+=this.drawRests(P,T+D))});let O=this.staffSVG.getBoundingClientRect(),R=this.musicG.getBoundingClientRect();if(this.updateVerticalBoundaries(R.top-O.top,R.bottom-O.top),_)this.width+=D;else{let P=this.musicBlockMap.get(this.lastQ),j=this.quartersToTime(this.lastQ+P.notes[0].length);this.width=j*this.config.pixelsPerTimeStep}this.staffSVG.setAttributeNS(null,"width",""+this.width),this.redrawStaff(this.linesG,0,this.width)}return w}drawMusicBlock(m,x){let w=m.notes[0].start,_=this.drawBarIfNeeded(w,x);_+=this.drawSignaturesIfNeeded(w,x+_);let I=0;for(let O=4;O>=i.MIN_RESOLUTION&&!I;O/=2)O<=m.notes[0].length&&(I=O);if(I===0){let O=m.notes[0].length===0?"[infinite]":""+4/m.notes[0].length;console.warn(" StaffRender ","background:orange; color:white",`StaffRender does not handle notes shorther than 1/${4/i.MIN_RESOLUTION}th, and this score tries to draw a 1/${O}th. Shortest possible note will be drawn instead.`),I=i.MIN_RESOLUTION}let T=c.NOTE_PATHS[I],D;if(T.stemAnchor&&(D=Object(a.createSVGGroupChild)(this.musicG,"stem")),m.notes.forEach(O=>{let R=O.vSteps*this.vStepSize,P=2*(O.vSteps>0?Math.floor(O.vSteps/2):Math.ceil(O.vSteps/2)),j=O.vSteps>0?-2:2;for(let G=P;Math.abs(G)>4;G+=j)Object(a.drawSVGPath)(this.linesG,c.extraLinePath,x+_,G*this.vStepSize,this.scale,1);if(O.g=O.tiedFrom?O.tiedFrom.g:Object(a.createSVGGroupChild)(this.musicG,`${O.start}-${O.pitch}`),m.isBarBeginning&&O.g.setAttribute("data-is-bar-beginning","true"),O.tiedFrom){let G=x+_-O.tiedFrom.xHeadRight;Object(a.drawSVGPath)(O.g,c.tiePath,O.tiedFrom.xHeadRight,R,G/c.PATH_SCALE,this.scale*(O.vSteps<0?-1:1),O.opacity)}Object(a.drawSVGPath)(O.g,T.path,x+_,R,this.scale,this.scale,O.opacity),O.xHeadRight=x+_+T.width*this.scale,1.5*I<=O.length&&Object(a.drawSVGPath)(O.g,c.dotPath,x+_+T.width*this.scale+this.vStepSize/2,R-this.vStepSize/2,this.scale,this.scale,O.opacity),O.accidental!==0&&Object(a.drawSVGPath)(O.g,c.ACCIDENTAL_PATHS[O.accidental],x+_,R,this.scale,this.scale,O.opacity)}),T.stemAnchor){let O,R,P=x+_,j=T.stemAnchor*this.scale,G=m.minVStep+m.maxVStep<0,Q=T.flags>2?2*(T.flags-2):0;if(G?(O=m.maxVStep*this.vStepSize-j,R=(m.minVStep+7+Q)*this.vStepSize):(P+=(T.width-i.STEM_WIDTH)*this.scale,O=m.minVStep*this.vStepSize+j,R=(m.maxVStep-7-Q)*this.vStepSize),Object(a.drawSVGPath)(D,c.stemPath,P,O,this.scale,(R-O)/c.PATH_SCALE),T.flags===1)Object(a.drawSVGPath)(D,c.singleFlagPath,P,R,this.scale,this.scale*(G?-1:1),1);else if(T.flags>1)for(let ie=0;ie<T.flags;++ie)Object(a.drawSVGPath)(D,c.multiFlagPath,P,R,this.scale,this.scale*(G?-1:1),1),R+=(G?-2:2)*this.vStepSize}return this.config.pixelsPerTimeStep===0&&(_+=T.width*this.scale,D&&(_+=D.getBoundingClientRect().width),_+=this.config.noteSpacing),_+=this.drawRests(m,x+_)}drawBarIfNeeded(m,x){let w=0,_=this.lastBar+this.getBarLength();return m!==0&&m>=_&&(this.config.pixelsPerTimeStep>0?x-=this.config.noteSpacing:w=this.config.noteSpacing,Object(a.drawSVGPath)(this.linesG,c.barPath,x,0,1,this.scale),this.lastBar=_),w}drawRests(m,x){let w=0,_=m.restToNextLength;if(_){this.config.pixelsPerTimeStep>0&&(x+=this.quartersToTime(m.notes[0].length)*this.hStepSize);let I=m.notes[0].start+m.notes[0].length,T=0,D=this.lastBar+this.getBarLength()-I,O;for(_>D&&(T=_-D,_=D),O=4;O>this.getBarLength()&&O>=i.MIN_RESOLUTION;O/=2);let R=O;for(;(_||T)&&R>=i.MIN_RESOLUTION;){if(R<=_){w+=this.drawBarIfNeeded(I,x+w),w+=this.drawSignaturesIfNeeded(I,x+w);let P=Object(a.drawSVGPath)(this.musicG,c.REST_PATHS[R],x+w,0,this.scale,this.scale);this.config.pixelsPerTimeStep>0?x+=this.quartersToTime(R)*this.hStepSize:(w+=P.getBoundingClientRect().width,w+=this.config.noteSpacing),I+=R,_-=R}if(T&&_<=0){let P=this.getBarLength();for(T>P?(_=P,T-=P):(_=T,T=0),O=4;O>this.getBarLength()&&O>=i.MIN_RESOLUTION;O/=2);R=O}_<R&&(R/=2)}}return w}redrawStaff(m,x,w){let _=m.querySelector('g[data-id="staff-five-lines"]');if(_)_.setAttributeNS(null,"transform",`scale(${w/c.PATH_SCALE}, 1)`);else{_=Object(a.createSVGGroupChild)(m,"staff-five-lines");let I=0;for(let T=-4;T<=4;T+=2)Object(a.drawSVGPath)(_,c.staffLinePath,x,I+T*this.vStepSize,w/c.PATH_SCALE,1)}return _}clearSignatureOverlay(){for(;this.overlayG.lastChild;)this.overlayG.removeChild(this.overlayG.lastChild)}drawSignaturesIfNeeded(m,x){let w=0,_=this.changeKeySignatureIfNeeded(m),I=this.changeTimeSignatureIfNeeded(m);if(_||I){let T=i.COMPACT_SPACING*this.scale*(this.config.pixelsPerTimeStep>0?3:2);this.signaturesList.push({x:x-T,q:m}),this.signatureNext===null&&(this.signatureNext=x);let D=m>0?Object(a.createSVGGroupChild)(this.signaturesG,"signatures"):this.overlayG;w+=this.drawSignatures(D,x+w,!1,_,I)}return this.config.pixelsPerTimeStep===0?w:0}drawSignatures(m,x,w,_,I){let T=i.COMPACT_SPACING*this.scale,D,O=T,R=m===this.overlayG||this.config.pixelsPerTimeStep>0;if(R){(D=document.createElementNS(a.SVGNS,"rect")).setAttributeNS(null,"x",""+x),D.setAttributeNS(null,"y","0"),D.setAttributeNS(null,"width","1"),D.setAttributeNS(null,"height","1"),D.setAttribute("data-id","background"),m.appendChild(D);let Q=document.defaultView.getComputedStyle(this.div.parentElement);D.setAttributeNS(null,"fill",Q.getPropertyValue("background-color"))}if(w){let Q=Object(a.drawSVGPath)(m,c.CLEF_PATHS[this.clef].path,x+O,0,this.scale,this.scale);this.setFill(Q),O+=3*T}if(_){let Q=p[this.key].accidental,ie=this.clef===71?0:14;p[this.key].pitches.forEach(pe=>{let xe=this.getPitchDetails(pe).vSteps,ne=Object(a.drawSVGPath)(m,c.ACCIDENTAL_PATHS[Q],x+O,(ie+xe)*this.vStepSize,this.scale,this.scale);this.setFill(ne),O+=ne.getBoundingClientRect().width})}if(I){let Q=Object(a.createSVGGroupChild)(m,"time-key"),ie=2.85*this.config.noteHeight+"px";Object(a.drawSVGText)(Q,""+this.timeSignatureNumerator,x+O,-.5,ie,!0),Object(a.drawSVGText)(Q,""+this.timeSignatureDenominator,x+O,4*this.vStepSize-.5,ie,!0),this.setFill(Q),O+=Q.getBoundingClientRect().width+T}let P=this.redrawStaff(m,x,O);this.setStroke(P);let j=this.div.getBoundingClientRect(),G=m.getBoundingClientRect();if(this.updateVerticalBoundaries(G.top-j.top,G.bottom-j.top),R&&(D.setAttributeNS(null,"y",""+-this.staffOffset),D.setAttributeNS(null,"height",""+this.height),D.setAttributeNS(null,"width",""+O)),m===this.overlayG){this.overlaySVG.setAttributeNS(null,"width",""+(O+5));for(let Q=0;Q<5;++Q){let ie=Object(a.drawSVGPath)(m,c.stemPath,O+Q,Q*Q-this.staffOffset,1/i.STEM_WIDTH,(this.height-2*Q*Q)/c.PATH_SCALE,(Q-5)*(Q-5)*2/c.PATH_SCALE);this.setFill(ie)}}if(this.config.pixelsPerTimeStep>0){let Q=this.signaturesQuarters===0;return Q&&(this.signaturesQuarters=this.timeToQuarters(O/this.hStepSize)),(Q||x>0)&&(this.signaturesBlinking=!0,Object(a.setFade)(m,this.signaturesBlinking)),0}return O}changeKeySignatureIfNeeded(m){if(this.scoreInfo.keySignatures){let x=this.key;for(let w=0;w<this.scoreInfo.keySignatures.length&&this.scoreInfo.keySignatures[w].start<=m;++w)x=this.scoreInfo.keySignatures[w].key;if(x!==this.key)return this.key=x,!0}return!1}changeTimeSignatureIfNeeded(m){if(this.scoreInfo.timeSignatures){let x=this.timeSignatureNumerator,w=this.timeSignatureDenominator;for(let _=0;_<this.scoreInfo.timeSignatures.length&&this.scoreInfo.timeSignatures[_].start<=m;++_)x=this.scoreInfo.timeSignatures[_].numerator,w=this.scoreInfo.timeSignatures[_].denominator;if(x!==this.timeSignatureNumerator||w!==this.timeSignatureDenominator)return this.timeSignatureNumerator=x,this.timeSignatureDenominator=w,!0}return!1}changeAndDrawSignaturesIfNeeded(m){let x;if(m<this.signatureCurrent||this.signatureNext!==null&&this.signatureNext<=m){x=this.signaturesList[0].q,this.signatureNext=null;for(let w=0;w<this.signaturesList.length;++w){if(m<this.signaturesList[w].x){this.signatureNext=this.signaturesList[w].x;break}this.signatureCurrent=this.signaturesList[w].x,x=this.signaturesList[w].q}}if(x!==void 0){let w=this.key,_=this.timeSignatureNumerator,I=this.timeSignatureDenominator;this.changeKeySignatureIfNeeded(x),this.changeTimeSignatureIfNeeded(x),this.clearSignatureOverlay(),this.drawSignatures(this.overlayG,0,!0,!0,!0),this.key=w,this.timeSignatureNumerator=_,this.timeSignatureDenominator=I}this.config.pixelsPerTimeStep>0&&m===0&&(this.signatureNext=0,this.signaturesBlinking=!0,Object(a.setFade)(this.overlayG,this.signaturesBlinking))}getBarLength(){return 4*this.timeSignatureNumerator/this.timeSignatureDenominator}scrollIntoViewIfNeeded(m,x){if(m)if(this.scrollType===y.PAGE){let w=this.parentElement.getBoundingClientRect().width;x>this.parentElement.scrollLeft+w&&(this.parentElement.scrollLeft=x-20)}else{let w=this.parentElement.getBoundingClientRect().width;this.parentElement.scrollLeft=x-.5*w}}updateVerticalBoundaries(m,x){let w=0;if(m<0){this.staffOffset-=m;let _=`translate(0, ${this.staffOffset})`;this.overlayG.setAttributeNS(null,"transform",_),this.staffG.setAttributeNS(null,"transform",_),w=this.height-m}if((w=Math.max(w,x-m))>this.height){this.height=w,this.overlaySVG.setAttributeNS(null,"height",""+this.height),this.staffSVG.setAttributeNS(null,"height",""+this.height);let _=this.div.querySelectorAll('rect[data-id="background"]');for(let I=0;I<_.length;++I){let T=_[I];T.setAttributeNS(null,"y",""+-this.staffOffset),T.setAttributeNS(null,"height",""+this.height)}}}setFill(m,x=!1){m.setAttributeNS(null,"fill",this.getColor(x))}setStroke(m,x=i.LINE_STROKE,w=!1){m.setAttributeNS(null,"stroke",this.getColor(w)),m.setAttributeNS(null,"stroke-width",""+x)}getColor(m){return`rgb(${m?this.config.activeNoteRGB:this.config.noteRGB})`}getOpacity(m){return m?m/127*.8+.2:1}getGroup(m){let x=m.start,w=m.pitch;return this.staffSVG.querySelector(`g[data-id="${x}-${w}"]`)}highlightElement(m,x){m.setAttribute("fill",this.getColor(x)),m.setAttribute("stroke",this.getColor(x))}getBarBeginnings(){let m=new Set,x=0;this.scoreInfo.notes.forEach(I=>{I.start+I.length>x&&(x=I.start+I.length)});let w=this.scoreInfo.timeSignatures?this.scoreInfo.timeSignatures.slice(0):[{start:0,numerator:4,denominator:4}];w.sort((I,T)=>I.start-T.start);let _=0;for(let I=0;I<w.length;++I){let T=I===w.length-1?x:w[I].start,D=4*w[I].numerator/w[I].denominator;for(;_<T;_+=D)m.add(_)}return m}quartersToTime(m){return m/this.scoreInfo.tempos[0].qpm*60}timeToQuarters(m){return m*this.scoreInfo.tempos[0].qpm/60}setDetails(){let m=new Map,x=this.getBarBeginnings(),w=new Set(x);this.scoreInfo.notes.slice().sort((R,P)=>R.start-P.start).forEach(R=>{let P=this.getQNote(R);w.add(P.start),w.add(P.start+P.length),m.has(P.start)?m.get(P.start).push(P):m.set(P.start,[P])}),Array.from(w).sort((R,P)=>R-P).forEach(R=>{let P=[];m.forEach(j=>{j.forEach(G=>{let Q=this.splitQNote(G,R);Q&&P.push(Q)})}),P.forEach(j=>{m.has(j.start)?m.get(j.start).push(j):m.set(j.start,[j])})}),m=new Map(Array.from(m).sort((R,P)=>R[0]-P[0]));let _=this.key,I=null,T=0,D=x[Symbol.iterator](),O=D.next();m.forEach((R,P)=>{let j={maxVStep:Number.MAX_SAFE_INTEGER,minVStep:Number.MIN_SAFE_INTEGER,restToNextLength:0,isBarBeginning:!1,notes:[]};this.changeKeySignatureIfNeeded(P);let G=O.value+this.getBarLength();!O.done&&P>=G&&(O=D.next(),this.barAccidentals={},j.isBarBeginning=!0),R.forEach(Q=>{this.analyzePitch(Q,P),j.minVStep=Math.max(Q.vSteps,j.minVStep),j.maxVStep=Math.min(Q.vSteps,j.maxVStep),j.notes.push(Q)}),I&&(I.restToNextLength=P-T),this.musicBlockMap.set(P,j),I=j,T=P+j.notes[0].length}),this.initialRest={maxVStep:0,minVStep:0,restToNextLength:this.musicBlockMap.values().next().value.notes[0].start,isBarBeginning:!0,notes:[{start:0,length:0,vSteps:0,accidental:0,opacity:0,pitch:0,xHeadRight:0}]},this.key=_}getQNote(m){return{start:m.start,length:m.length,vSteps:0,accidental:0,opacity:this.getOpacity(m.intensity),pitch:m.pitch,xHeadRight:0}}splitQNote(m,x){let w=m.start+m.length-x;return x>m.start&&w>0?(m.length-=w,{start:x,length:w,vSteps:m.vSteps,accidental:m.accidental,opacity:m.opacity,pitch:m.pitch,xHeadRight:0,tiedFrom:m}):null}analyzePitch(m,x){let w=this.getPitchDetails(m.pitch);w.vSteps in this.barAccidentals?w.accidental===this.barAccidentals[w.vSteps]?w.accidental=0:(this.barAccidentals[w.vSteps]===3?w.accidental=w.keyAccidental:w.accidental===0&&(w.accidental=3),this.barAccidentals[w.vSteps]=w.accidental):(m.tiedFrom&&(w.accidental=0),this.barAccidentals[w.vSteps]=w.accidental),m.vSteps=w.vSteps,m.accidental=w.accidental}getPitchDetails(m){let x=m-60,w=Math.floor(x/12),_=x-12*w,I=l[this.key].steps[_],T=this.clef===71?6:-6,D=p[this.key].accidental===1?69+(_+3)%12:64+(_+8)%12;return{vSteps:T-7*w+I,accidental:l[this.key].accidental[_],keyAccidental:p[this.key].pitches.indexOf(D)>-1?p[this.key].accidental:0}}}},function(r,o,s){"use strict";s.r(o);var i=s(3);s.d(o,"MAX_QUARTER_DIVISION",function(){return i.MAX_QUARTER_DIVISION}),s.d(o,"ScrollType",function(){return i.ScrollType}),s.d(o,"StaffSVGRender",function(){return i.StaffSVGRender})}])},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(n,t){function e(o){for(var s,i=new r(o),a=[];!i.eof();){var c=l();a.push(c)}return a;function l(){var p={};p.deltaTime=i.readVarInt();var f=i.readUInt8();if((240&f)==240){if(f!==255){if(f==240)return p.type="sysEx",d=i.readVarInt(),p.data=i.readBytes(d),p;if(f==247)return p.type="endSysEx",d=i.readVarInt(),p.data=i.readBytes(d),p;throw"Unrecognised MIDI event type byte: "+f}p.meta=!0;var y=i.readUInt8(),d=i.readVarInt();switch(y){case 0:if(p.type="sequenceNumber",d!==2)throw"Expected length for sequenceNumber event is 2, got "+d;return p.number=i.readUInt16(),p;case 1:return p.type="text",p.text=i.readString(d),p;case 2:return p.type="copyrightNotice",p.text=i.readString(d),p;case 3:return p.type="trackName",p.text=i.readString(d),p;case 4:return p.type="instrumentName",p.text=i.readString(d),p;case 5:return p.type="lyrics",p.text=i.readString(d),p;case 6:return p.type="marker",p.text=i.readString(d),p;case 7:return p.type="cuePoint",p.text=i.readString(d),p;case 32:if(p.type="channelPrefix",d!=1)throw"Expected length for channelPrefix event is 1, got "+d;return p.channel=i.readUInt8(),p;case 33:if(p.type="portPrefix",d!=1)throw"Expected length for portPrefix event is 1, got "+d;return p.port=i.readUInt8(),p;case 47:if(p.type="endOfTrack",d!=0)throw"Expected length for endOfTrack event is 0, got "+d;return p;case 81:if(p.type="setTempo",d!=3)throw"Expected length for setTempo event is 3, got "+d;return p.microsecondsPerBeat=i.readUInt24(),p;case 84:if(p.type="smpteOffset",d!=5)throw"Expected length for smpteOffset event is 5, got "+d;var h=i.readUInt8();return p.frameRate={0:24,32:25,64:29,96:30}[96&h],p.hour=31&h,p.min=i.readUInt8(),p.sec=i.readUInt8(),p.frame=i.readUInt8(),p.subFrame=i.readUInt8(),p;case 88:if(p.type="timeSignature",d!=4)throw"Expected length for timeSignature event is 4, got "+d;return p.numerator=i.readUInt8(),p.denominator=1<<i.readUInt8(),p.metronome=i.readUInt8(),p.thirtyseconds=i.readUInt8(),p;case 89:if(p.type="keySignature",d!=2)throw"Expected length for keySignature event is 2, got "+d;return p.key=i.readInt8(),p.scale=i.readUInt8(),p;case 127:return p.type="sequencerSpecific",p.data=i.readBytes(d),p;default:return p.type="unknownMeta",p.data=i.readBytes(d),p.metatypeByte=y,p}}else{var m;if((128&f)==0){if(s===null)throw"Running status byte encountered before status byte";m=f,f=s,p.running=!0}else m=i.readUInt8(),s=f;var x=f>>4;switch(p.channel=15&f,x){case 8:return p.type="noteOff",p.noteNumber=m,p.velocity=i.readUInt8(),p;case 9:var w=i.readUInt8();return p.type=w===0?"noteOff":"noteOn",p.noteNumber=m,p.velocity=w,w===0&&(p.byte9=!0),p;case 10:return p.type="noteAftertouch",p.noteNumber=m,p.amount=i.readUInt8(),p;case 11:return p.type="controller",p.controllerType=m,p.value=i.readUInt8(),p;case 12:return p.type="programChange",p.programNumber=m,p;case 13:return p.type="channelAftertouch",p.amount=m,p;case 14:return p.type="pitchBend",p.value=m+(i.readUInt8()<<7)-8192,p;default:throw"Unrecognised MIDI event type: "+x}}}}function r(o){this.buffer=o,this.bufferLen=this.buffer.length,this.pos=0}r.prototype.eof=function(){return this.pos>=this.bufferLen},r.prototype.readUInt8=function(){var o=this.buffer[this.pos];return this.pos+=1,o},r.prototype.readInt8=function(){var o=this.readUInt8();return 128&o?o-256:o},r.prototype.readUInt16=function(){return(this.readUInt8()<<8)+this.readUInt8()},r.prototype.readInt16=function(){var o=this.readUInt16();return 32768&o?o-65536:o},r.prototype.readUInt24=function(){return(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},r.prototype.readInt24=function(){var o=this.readUInt24();return 8388608&o?o-16777216:o},r.prototype.readUInt32=function(){return(this.readUInt8()<<24)+(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},r.prototype.readBytes=function(o){var s=this.buffer.slice(this.pos,this.pos+o);return this.pos+=o,s},r.prototype.readString=function(o){var s=this.readBytes(o);return String.fromCharCode.apply(null,s)},r.prototype.readVarInt=function(){for(var o=0;!this.eof();){var s=this.readUInt8();if(!(128&s))return o+s;o+=127&s,o<<=7}return o},r.prototype.readChunk=function(){var o=this.readString(4),s=this.readUInt32();return{id:o,length:s,data:this.readBytes(s)}},n.exports=function(o){var s=new r(o),i=s.readChunk();if(i.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+i.id+"'";for(var a=function(y){var d=new r(y),h=d.readUInt16(),m=d.readUInt16(),x={format:h,numTracks:m},w=d.readUInt16();return 32768&w?(x.framesPerSecond=256-(w>>8),x.ticksPerFrame=255&w):x.ticksPerBeat=w,x}(i.data),c=[],l=0;!s.eof()&&l<a.numTracks;l++){var p=s.readChunk();if(p.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+p.id+"'";var f=e(p.data);c.push(f)}return{header:a,tracks:c}}},function(n,t){function e(s,i,a){var c,l=new o,p=i.length,f=null;for(c=0;c<p;c++)a.running!==!1&&(a.running||i[c].running)||(f=null),f=r(l,i[c],f,a.useByte9ForNoteOff);s.writeChunk("MTrk",l.buffer)}function r(s,i,a,c){var l=i.type,p=i.deltaTime,f=i.text||"",y=i.data||[],d=null;switch(s.writeVarInt(p),l){case"sequenceNumber":s.writeUInt8(255),s.writeUInt8(0),s.writeVarInt(2),s.writeUInt16(i.number);break;case"text":s.writeUInt8(255),s.writeUInt8(1),s.writeVarInt(f.length),s.writeString(f);break;case"copyrightNotice":s.writeUInt8(255),s.writeUInt8(2),s.writeVarInt(f.length),s.writeString(f);break;case"trackName":s.writeUInt8(255),s.writeUInt8(3),s.writeVarInt(f.length),s.writeString(f);break;case"instrumentName":s.writeUInt8(255),s.writeUInt8(4),s.writeVarInt(f.length),s.writeString(f);break;case"lyrics":s.writeUInt8(255),s.writeUInt8(5),s.writeVarInt(f.length),s.writeString(f);break;case"marker":s.writeUInt8(255),s.writeUInt8(6),s.writeVarInt(f.length),s.writeString(f);break;case"cuePoint":s.writeUInt8(255),s.writeUInt8(7),s.writeVarInt(f.length),s.writeString(f);break;case"channelPrefix":s.writeUInt8(255),s.writeUInt8(32),s.writeVarInt(1),s.writeUInt8(i.channel);break;case"portPrefix":s.writeUInt8(255),s.writeUInt8(33),s.writeVarInt(1),s.writeUInt8(i.port);break;case"endOfTrack":s.writeUInt8(255),s.writeUInt8(47),s.writeVarInt(0);break;case"setTempo":s.writeUInt8(255),s.writeUInt8(81),s.writeVarInt(3),s.writeUInt24(i.microsecondsPerBeat);break;case"smpteOffset":s.writeUInt8(255),s.writeUInt8(84),s.writeVarInt(5);var h=31&i.hour|{24:0,25:32,29:64,30:96}[i.frameRate];s.writeUInt8(h),s.writeUInt8(i.min),s.writeUInt8(i.sec),s.writeUInt8(i.frame),s.writeUInt8(i.subFrame);break;case"timeSignature":s.writeUInt8(255),s.writeUInt8(88),s.writeVarInt(4),s.writeUInt8(i.numerator);var m=255&Math.floor(Math.log(i.denominator)/Math.LN2);s.writeUInt8(m),s.writeUInt8(i.metronome),s.writeUInt8(i.thirtyseconds||8);break;case"keySignature":s.writeUInt8(255),s.writeUInt8(89),s.writeVarInt(2),s.writeInt8(i.key),s.writeUInt8(i.scale);break;case"sequencerSpecific":s.writeUInt8(255),s.writeUInt8(127),s.writeVarInt(y.length),s.writeBytes(y);break;case"unknownMeta":i.metatypeByte!=null&&(s.writeUInt8(255),s.writeUInt8(i.metatypeByte),s.writeVarInt(y.length),s.writeBytes(y));break;case"sysEx":s.writeUInt8(240),s.writeVarInt(y.length),s.writeBytes(y);break;case"endSysEx":s.writeUInt8(247),s.writeVarInt(y.length),s.writeBytes(y);break;case"noteOff":(d=(c!==!1&&i.byte9||c&&i.velocity==0?144:128)|i.channel)!==a&&s.writeUInt8(d),s.writeUInt8(i.noteNumber),s.writeUInt8(i.velocity);break;case"noteOn":(d=144|i.channel)!==a&&s.writeUInt8(d),s.writeUInt8(i.noteNumber),s.writeUInt8(i.velocity);break;case"noteAftertouch":(d=160|i.channel)!==a&&s.writeUInt8(d),s.writeUInt8(i.noteNumber),s.writeUInt8(i.amount);break;case"controller":(d=176|i.channel)!==a&&s.writeUInt8(d),s.writeUInt8(i.controllerType),s.writeUInt8(i.value);break;case"programChange":(d=192|i.channel)!==a&&s.writeUInt8(d),s.writeUInt8(i.programNumber);break;case"channelAftertouch":(d=208|i.channel)!==a&&s.writeUInt8(d),s.writeUInt8(i.amount);break;case"pitchBend":(d=224|i.channel)!==a&&s.writeUInt8(d);var x=8192+i.value,w=127&x,_=x>>7&127;s.writeUInt8(w),s.writeUInt8(_);break;default:throw"Unrecognized event type: "+l}return d}function o(){this.buffer=[]}o.prototype.writeUInt8=function(s){this.buffer.push(255&s)},o.prototype.writeInt8=o.prototype.writeUInt8,o.prototype.writeUInt16=function(s){var i=s>>8&255,a=255&s;this.writeUInt8(i),this.writeUInt8(a)},o.prototype.writeInt16=o.prototype.writeUInt16,o.prototype.writeUInt24=function(s){var i=s>>16&255,a=s>>8&255,c=255&s;this.writeUInt8(i),this.writeUInt8(a),this.writeUInt8(c)},o.prototype.writeInt24=o.prototype.writeUInt24,o.prototype.writeUInt32=function(s){var i=s>>24&255,a=s>>16&255,c=s>>8&255,l=255&s;this.writeUInt8(i),this.writeUInt8(a),this.writeUInt8(c),this.writeUInt8(l)},o.prototype.writeInt32=o.prototype.writeUInt32,o.prototype.writeBytes=function(s){this.buffer=this.buffer.concat(Array.prototype.slice.call(s,0))},o.prototype.writeString=function(s){var i,a=s.length,c=[];for(i=0;i<a;i++)c.push(s.codePointAt(i));this.writeBytes(c)},o.prototype.writeVarInt=function(s){if(s<0)throw"Cannot write negative variable-length integer";if(s<=127)this.writeUInt8(s);else{var i=s,a=[];for(a.push(127&i),i>>=7;i;){var c=127&i|128;a.push(c),i>>=7}this.writeBytes(a.reverse())}},o.prototype.writeChunk=function(s,i){this.writeString(s),this.writeUInt32(i.length),this.writeBytes(i)},n.exports=function(s,i){if(typeof s!="object")throw"Invalid MIDI data";i=i||{};var a,c=s.header||{},l=s.tracks||[],p=l.length,f=new o;for(function(y,d,h){var m=d.format==null?1:d.format,x=128;d.timeDivision?x=d.timeDivision:d.ticksPerFrame&&d.framesPerSecond?x=-(255&d.framesPerSecond)<<8|255&d.ticksPerFrame:d.ticksPerBeat&&(x=32767&d.ticksPerBeat);var w=new o;w.writeUInt16(m),w.writeUInt16(h),w.writeUInt16(x),y.writeChunk("MThd",w.buffer)}(f,c,p),a=0;a<p;a++)e(f,l[a],i);return f.buffer}},function(n,t,e){"use strict";var r=this&&this.__spreadArrays||function(){for(var f=0,y=0,d=arguments.length;y<d;y++)f+=arguments[y].length;var h=Array(f),m=0;for(y=0;y<d;y++)for(var x=arguments[y],w=0,_=x.length;w<_;w++,m++)h[m]=x[w];return h},o=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(t,"__esModule",{value:!0});var s=e(79),i=e(66),a=o(e(175));function c(f){return a.default(f.notes.map(function(y){return function(d,h){return[{absoluteTime:d.ticks,channel:h,deltaTime:0,noteNumber:d.midi,type:"noteOn",velocity:Math.floor(127*d.velocity)},{absoluteTime:d.ticks+d.durationTicks,channel:h,deltaTime:0,noteNumber:d.midi,type:"noteOff",velocity:Math.floor(127*d.noteOffVelocity)}]}(y,f.channel)}))}function l(f,y){return{absoluteTime:f.ticks,channel:y,controllerType:f.number,deltaTime:0,type:"controller",value:f.value}}function p(f){return{absoluteTime:0,channel:f.channel,deltaTime:0,programNumber:f.instrument.number,type:"programChange"}}t.encode=function(f){var y={header:{format:1,numTracks:f.tracks.length+1,ticksPerBeat:f.header.ppq},tracks:r([r([{absoluteTime:0,deltaTime:0,meta:!0,text:f.header.name,type:"trackName"}],f.header.keySignatures.map(function(d){return function(h){var m=i.keySignatureKeys.indexOf(h.key);return{absoluteTime:h.ticks,deltaTime:0,key:m+7,meta:!0,scale:h.scale==="major"?0:1,type:"keySignature"}}(d)}),f.header.meta.map(function(d){return{absoluteTime:(h=d).ticks,deltaTime:0,meta:!0,text:h.text,type:h.type};var h}),f.header.tempos.map(function(d){return function(h){return{absoluteTime:h.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/h.bpm),type:"setTempo"}}(d)}),f.header.timeSignatures.map(function(d){return function(h){return{absoluteTime:h.ticks,deltaTime:0,denominator:h.timeSignature[1],meta:!0,metronome:24,numerator:h.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}(d)}))],f.tracks.map(function(d){return r([(h=d.name,{absoluteTime:0,deltaTime:0,meta:!0,text:h,type:"trackName"}),p(d)],c(d),function(m){for(var x=[],w=0;w<127;w++)m.controlChanges.hasOwnProperty(w)&&m.controlChanges[w].forEach(function(_){x.push(l(_,m.channel))});return x}(d),function(m){var x=[];return m.pitchBends.forEach(function(w){x.push(function(_,I){return{absoluteTime:_.ticks,channel:I,deltaTime:0,type:"pitchBend",value:_.value}}(w,m.channel))}),x}(d));var h}))};return y.tracks=y.tracks.map(function(d){d=d.sort(function(m,x){return m.absoluteTime-x.absoluteTime});var h=0;return d.forEach(function(m){m.deltaTime=m.absoluteTime-h,h=m.absoluteTime,delete m.absoluteTime}),d.push({deltaTime:0,meta:!0,type:"endOfTrack"}),d}),new Uint8Array(s.writeMidi(y))}},function(n,t,e){"use strict";function r(s){return function i(a,c){for(var l=0;l<a.length;l++){var p=a[l];Array.isArray(p)?i(p,c):c.push(p)}return c}(s,[])}function o(s,i){if(typeof i!="number")throw new TypeError("Expected the depth to be a number");return function a(c,l,p){p--;for(var f=0;f<c.length;f++){var y=c[f];p>-1&&Array.isArray(y)?a(y,l,p):l.push(y)}return l}(s,[],i)}n.exports=function(s){if(!Array.isArray(s))throw new TypeError("Expected value to be an array");return r(s)},n.exports.from=r,n.exports.depth=function(s,i){if(!Array.isArray(s))throw new TypeError("Expected value to be an array");return o(s,i)},n.exports.fromDepth=o},function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=e(82);t.createControlChanges=function(){return new Proxy({},{get:function(o,s){return o[s]?o[s]:r.controlChangeIds.hasOwnProperty(s)?o[r.controlChangeIds[s]]:void 0},set:function(o,s,i){return r.controlChangeIds.hasOwnProperty(s)?o[r.controlChangeIds[s]]=i:o[s]=i,!0}})}},function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new WeakMap,o=function(){function s(i,a){r.set(this,a),this.ticks=i.absoluteTime,this.value=i.value}return Object.defineProperty(s.prototype,"time",{get:function(){return r.get(this).ticksToSeconds(this.ticks)},set:function(i){var a=r.get(this);this.ticks=a.secondsToTicks(i)},enumerable:!0,configurable:!0}),s.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},s}();t.PitchBend=o},function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=e(179),o=new WeakMap,s=function(){function i(a,c){if(this.number=0,o.set(this,c),this.number=0,a){var l=a.find(function(p){return p.type==="programChange"});l&&(this.number=l.programNumber)}}return Object.defineProperty(i.prototype,"name",{get:function(){return this.percussion?r.DrumKitByPatchID[this.number]:r.instrumentByPatchID[this.number]},set:function(a){var c=r.instrumentByPatchID.indexOf(a);c!==-1&&(this.number=c)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"family",{get:function(){return this.percussion?"drums":r.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"percussion",{get:function(){return o.get(this).channel===9},enumerable:!0,configurable:!0}),i.prototype.toJSON=function(){return{family:this.family,name:this.name,number:this.number}},i.prototype.fromJSON=function(a){this.number=a.number},i}();t.Instrument=s},function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],t.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],t.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}},function(n,t,e){"use strict";function r(l){return["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][l%12]}Object.defineProperty(t,"__esModule",{value:!0});var o,s,i=(o=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,s={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},function(l){var p=o.exec(l),f=p[1],y=p[2];return s[f.toLowerCase()]+12*(parseInt(y,10)+1)}),a=new WeakMap,c=function(){function l(p,f,y){a.set(this,y),this.midi=p.midi,this.velocity=p.velocity,this.noteOffVelocity=f.velocity,this.ticks=p.ticks,this.durationTicks=f.ticks-p.ticks}return Object.defineProperty(l.prototype,"name",{get:function(){return p=this.midi,f=Math.floor(p/12)-1,r(p)+f.toString();var p,f},set:function(p){this.midi=i(p)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(p){var f=p-this.octave;this.midi+=12*f},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"pitch",{get:function(){return r(this.midi)},set:function(p){this.midi=12*(this.octave+1)+["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"].indexOf(p)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"duration",{get:function(){var p=a.get(this);return p.ticksToSeconds(this.ticks+this.durationTicks)-p.ticksToSeconds(this.ticks)},set:function(p){var f=a.get(this).secondsToTicks(this.time+p);this.durationTicks=f-this.ticks},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"time",{get:function(){return a.get(this).ticksToSeconds(this.ticks)},set:function(p){var f=a.get(this);this.ticks=f.secondsToTicks(p)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"bars",{get:function(){return a.get(this).ticksToMeasures(this.ticks)},enumerable:!0,configurable:!0}),l.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},l}();t.Note=c}])})});function tq(n,t){return Object.is(n,t)}var Mo=null,c_=!1,AA=1,Ey=Symbol("SIGNAL");function Yn(n){let t=Mo;return Mo=n,t}function OA(){return Mo}var u_={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function MA(n){if(c_)throw new Error("");if(Mo===null)return;Mo.consumerOnSignalRead(n);let t=Mo.nextProducerIndex++;if(p_(Mo),t<Mo.producerNode.length&&Mo.producerNode[t]!==n&&ew(Mo)){let e=Mo.producerNode[t];l_(e,Mo.producerIndexOfThis[t])}Mo.producerNode[t]!==n&&(Mo.producerNode[t]=n,Mo.producerIndexOfThis[t]=ew(Mo)?iq(n,Mo,t):0),Mo.producerLastReadVersion[t]=n.version}function nq(){AA++}function rq(n){if(!(ew(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===AA)){if(!n.producerMustRecompute(n)&&!FA(n)){kA(n);return}n.producerRecomputeValue(n),kA(n)}}function RA(n){if(n.liveConsumerNode===void 0)return;let t=c_;c_=!0;try{for(let e of n.liveConsumerNode)e.dirty||zve(e)}finally{c_=t}}function oq(){return Mo?.consumerAllowSignalWrites!==!1}function zve(n){n.dirty=!0,RA(n),n.consumerMarkedDirty?.(n)}function kA(n){n.dirty=!1,n.lastCleanEpoch=AA}function PA(n){return n&&(n.nextProducerIndex=0),Yn(n)}function sq(n,t){if(Yn(t),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(ew(n))for(let e=n.nextProducerIndex;e<n.producerNode.length;e++)l_(n.producerNode[e],n.producerIndexOfThis[e]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function FA(n){p_(n);for(let t=0;t<n.producerNode.length;t++){let e=n.producerNode[t],r=n.producerLastReadVersion[t];if(r!==e.version||(rq(e),r!==e.version))return!0}return!1}function $A(n){if(p_(n),ew(n))for(let t=0;t<n.producerNode.length;t++)l_(n.producerNode[t],n.producerIndexOfThis[t]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function iq(n,t,e){if(aq(n),n.liveConsumerNode.length===0&&cq(n))for(let r=0;r<n.producerNode.length;r++)n.producerIndexOfThis[r]=iq(n.producerNode[r],n,r);return n.liveConsumerIndexOfThis.push(e),n.liveConsumerNode.push(t)-1}function l_(n,t){if(aq(n),n.liveConsumerNode.length===1&&cq(n))for(let r=0;r<n.producerNode.length;r++)l_(n.producerNode[r],n.producerIndexOfThis[r]);let e=n.liveConsumerNode.length-1;if(n.liveConsumerNode[t]=n.liveConsumerNode[e],n.liveConsumerIndexOfThis[t]=n.liveConsumerIndexOfThis[e],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,t<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[t],o=n.liveConsumerNode[t];p_(o),o.producerIndexOfThis[r]=t}}function ew(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function p_(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function aq(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function cq(n){return n.producerNode!==void 0}function Bve(){throw new Error}var uq=Bve;function Vve(n){uq(n)}function LA(n){uq=n}var qve=null;function zA(n,t){oq()||Vve(n),n.equal(n.value,t)||(n.value=t,Uve(n))}var BA=vt(Fe({},u_),{equal:tq,value:void 0,kind:"signal"});function Uve(n){n.version++,nq(),RA(n),qve?.()}var VA;function tw(){return VA}function jl(n){let t=VA;return VA=n,t}var h_=Symbol("NotFound");function hn(n){return typeof n=="function"}function Ny(n){let e=n(r=>{Error.call(r),r.stack=new Error().stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var f_=Ny(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:
${e.map((r,o)=>`${o+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=e});function nw(n,t){if(n){let e=n.indexOf(t);0<=e&&n.splice(e,1)}}var _o=class n{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;let{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(let s of e)s.remove(this);else e.remove(this);let{initialTeardown:r}=this;if(hn(r))try{r()}catch(s){t=s instanceof f_?s.errors:[s]}let{_finalizers:o}=this;if(o){this._finalizers=null;for(let s of o)try{lq(s)}catch(i){t=t??[],i instanceof f_?t=[...t,...i.errors]:t.push(i)}}if(t)throw new f_(t)}}add(t){var e;if(t&&t!==this)if(this.closed)lq(t);else{if(t instanceof n){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(t)}}_hasParent(t){let{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){let{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){let{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&nw(e,t)}remove(t){let{_finalizers:e}=this;e&&nw(e,t),t instanceof n&&t._removeParent(this)}};_o.EMPTY=(()=>{let n=new _o;return n.closed=!0,n})();var qA=_o.EMPTY;function d_(n){return n instanceof _o||n&&"closed"in n&&hn(n.remove)&&hn(n.add)&&hn(n.unsubscribe)}function lq(n){hn(n)?n():n.unsubscribe()}var ec={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Dy={setTimeout(n,t,...e){let{delegate:r}=Dy;return r?.setTimeout?r.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){let{delegate:t}=Dy;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function m_(n){Dy.setTimeout(()=>{let{onUnhandledError:t}=ec;if(t)t(n);else throw n})}function rw(){}var pq=UA("C",void 0,void 0);function hq(n){return UA("E",void 0,n)}function fq(n){return UA("N",n,void 0)}function UA(n,t,e){return{kind:n,value:t,error:e}}var Dd=null;function ky(n){if(ec.useDeprecatedSynchronousErrorHandling){let t=!Dd;if(t&&(Dd={errorThrown:!1,error:null}),n(),t){let{errorThrown:e,error:r}=Dd;if(Dd=null,e)throw r}}else n()}function dq(n){ec.useDeprecatedSynchronousErrorHandling&&Dd&&(Dd.errorThrown=!0,Dd.error=n)}var kd=class extends _o{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,d_(t)&&t.add(this)):this.destination=Jve}static create(t,e,r){return new Ay(t,e,r)}next(t){this.isStopped?GA(fq(t),this):this._next(t)}error(t){this.isStopped?GA(hq(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?GA(pq,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Yve=Function.prototype.bind;function jA(n,t){return Yve.call(n,t)}var WA=class{constructor(t){this.partialObserver=t}next(t){let{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(r){g_(r)}}error(t){let{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(r){g_(r)}else g_(t)}complete(){let{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){g_(e)}}},Ay=class extends kd{constructor(t,e,r){super();let o;if(hn(t)||!t)o={next:t??void 0,error:e??void 0,complete:r??void 0};else{let s;this&&ec.useDeprecatedNextContext?(s=Object.create(t),s.unsubscribe=()=>this.unsubscribe(),o={next:t.next&&jA(t.next,s),error:t.error&&jA(t.error,s),complete:t.complete&&jA(t.complete,s)}):o=t}this.destination=new WA(o)}};function g_(n){ec.useDeprecatedSynchronousErrorHandling?dq(n):m_(n)}function Zve(n){throw n}function GA(n,t){let{onStoppedNotification:e}=ec;e&&Dy.setTimeout(()=>e(n,t))}var Jve={closed:!0,next:rw,error:Zve,complete:rw};var Oy=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Ri(n){return n}function HA(...n){return KA(n)}function KA(n){return n.length===0?Ri:n.length===1?n[0]:function(e){return n.reduce((r,o)=>o(r),e)}}var fr=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){let r=new n;return r.source=this,r.operator=e,r}subscribe(e,r,o){let s=tbe(e)?e:new Ay(e,r,o);return ky(()=>{let{operator:i,source:a}=this;s.add(i?i.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return r=mq(r),new r((o,s)=>{let i=new Ay({next:a=>{try{e(a)}catch(c){s(c),i.unsubscribe()}},error:s,complete:o});this.subscribe(i)})}_subscribe(e){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(e)}[Oy](){return this}pipe(...e){return KA(e)(this)}toPromise(e){return e=mq(e),new e((r,o)=>{let s;this.subscribe(i=>s=i,i=>o(i),()=>r(s))})}}return n.create=t=>new n(t),n})();function mq(n){var t;return(t=n??ec.Promise)!==null&&t!==void 0?t:Promise}function ebe(n){return n&&hn(n.next)&&hn(n.error)&&hn(n.complete)}function tbe(n){return n&&n instanceof kd||ebe(n)&&d_(n)}function XA(n){return hn(n?.lift)}function Fn(n){return t=>{if(XA(t))return t.lift(function(e){try{return n(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function $n(n,t,e,r,o){return new QA(n,t,e,r,o)}var QA=class extends kd{constructor(t,e,r,o,s,i){super(t),this.onFinalize=s,this.shouldUnsubscribe=i,this._next=e?function(a){try{e(a)}catch(c){t.error(c)}}:super._next,this._error=o?function(a){try{o(a)}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:e}=this;super.unsubscribe(),!e&&((t=this.onFinalize)===null||t===void 0||t.call(this))}}};function My(){return Fn((n,t)=>{let e=null;n._refCount++;let r=$n(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){e=null;return}let o=n._connection,s=e;e=null,o&&(!s||o===s)&&o.unsubscribe(),t.unsubscribe()});n.subscribe(r),r.closed||(e=n.connect())})}var Ry=class extends fr{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,XA(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){let t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new _o;let e=this.getSubject();t.add(this.source.subscribe($n(e,void 0,()=>{this._teardown(),e.complete()},r=>{this._teardown(),e.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=_o.EMPTY)}return t}refCount(){return My()(this)}};var gq=Ny(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var fs=(()=>{class n extends fr{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){let r=new y_(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new gq}next(e){ky(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(e)}})}error(e){ky(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;let{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){ky(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){let{hasError:r,isStopped:o,observers:s}=this;return r||o?qA:(this.currentObservers=null,s.push(e),new _o(()=>{this.currentObservers=null,nw(s,e)}))}_checkFinalizedStatuses(e){let{hasError:r,thrownError:o,isStopped:s}=this;r?e.error(o):s&&e.complete()}asObservable(){let e=new fr;return e.source=this,e}}return n.create=(t,e)=>new y_(t,e),n})(),y_=class extends fs{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,r;(r=(e=this.destination)===null||e===void 0?void 0:e.next)===null||r===void 0||r.call(e,t)}error(t){var e,r;(r=(e=this.destination)===null||e===void 0?void 0:e.error)===null||r===void 0||r.call(e,t)}complete(){var t,e;(e=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||e===void 0||e.call(t)}_subscribe(t){var e,r;return(r=(e=this.source)===null||e===void 0?void 0:e.subscribe(t))!==null&&r!==void 0?r:qA}};var ds=class extends fs{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){let e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){let{hasError:t,thrownError:e,_value:r}=this;if(t)throw e;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}};var di=new fr(n=>n.complete());function yq(n){return n&&hn(n.schedule)}function xq(n){return n[n.length-1]}function vq(n){return hn(xq(n))?n.pop():void 0}function Bh(n){return yq(xq(n))?n.pop():void 0}function wq(n,t,e,r){function o(s){return s instanceof e?s:new e(function(i){i(s)})}return new(e||(e=Promise))(function(s,i){function a(p){try{l(r.next(p))}catch(f){i(f)}}function c(p){try{l(r.throw(p))}catch(f){i(f)}}function l(p){p.done?s(p.value):o(p.value).then(a,c)}l((r=r.apply(n,t||[])).next())})}function bq(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ad(n){return this instanceof Ad?(this.v=n,this):new Ad(n)}function Sq(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=e.apply(n,t||[]),o,s=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",i),o[Symbol.asyncIterator]=function(){return this},o;function i(d){return function(h){return Promise.resolve(h).then(d,f)}}function a(d,h){r[d]&&(o[d]=function(m){return new Promise(function(x,w){s.push([d,m,x,w])>1||c(d,m)})},h&&(o[d]=h(o[d])))}function c(d,h){try{l(r[d](h))}catch(m){y(s[0][3],m)}}function l(d){d.value instanceof Ad?Promise.resolve(d.value.v).then(p,f):y(s[0][2],d)}function p(d){c("next",d)}function f(d){c("throw",d)}function y(d,h){d(h),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Cq(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=n[Symbol.asyncIterator],e;return t?t.call(n):(n=typeof bq=="function"?bq(n):n[Symbol.iterator](),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(s){e[s]=n[s]&&function(i){return new Promise(function(a,c){i=n[s](i),o(a,c,i.done,i.value)})}}function o(s,i,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},i)}}var x_=n=>n&&typeof n.length=="number"&&typeof n!="function";function v_(n){return hn(n?.then)}function b_(n){return hn(n[Oy])}function w_(n){return Symbol.asyncIterator&&hn(n?.[Symbol.asyncIterator])}function S_(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function nbe(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var C_=nbe();function __(n){return hn(n?.[C_])}function T_(n){return Sq(this,arguments,function*(){let e=n.getReader();try{for(;;){let{value:r,done:o}=yield Ad(e.read());if(o)return yield Ad(void 0);yield yield Ad(r)}}finally{e.releaseLock()}})}function I_(n){return hn(n?.getReader)}function Ho(n){if(n instanceof fr)return n;if(n!=null){if(b_(n))return rbe(n);if(x_(n))return obe(n);if(v_(n))return sbe(n);if(w_(n))return _q(n);if(__(n))return ibe(n);if(I_(n))return abe(n)}throw S_(n)}function rbe(n){return new fr(t=>{let e=n[Oy]();if(hn(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function obe(n){return new fr(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}function sbe(n){return new fr(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,m_)})}function ibe(n){return new fr(t=>{for(let e of n)if(t.next(e),t.closed)return;t.complete()})}function _q(n){return new fr(t=>{cbe(n,t).catch(e=>t.error(e))})}function abe(n){return _q(T_(n))}function cbe(n,t){var e,r,o,s;return wq(this,void 0,void 0,function*(){try{for(e=Cq(n);r=yield e.next(),!r.done;){let i=r.value;if(t.next(i),t.closed)return}}catch(i){o={error:i}}finally{try{r&&!r.done&&(s=e.return)&&(yield s.call(e))}finally{if(o)throw o.error}}t.complete()})}function mi(n,t,e,r=0,o=!1){let s=t.schedule(function(){e(),o?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!o)return s}function E_(n,t=0){return Fn((e,r)=>{e.subscribe($n(r,o=>mi(r,n,()=>r.next(o),t),()=>mi(r,n,()=>r.complete(),t),o=>mi(r,n,()=>r.error(o),t)))})}function N_(n,t=0){return Fn((e,r)=>{r.add(n.schedule(()=>e.subscribe(r),t))})}function Tq(n,t){return Ho(n).pipe(N_(t),E_(t))}function Iq(n,t){return Ho(n).pipe(N_(t),E_(t))}function Eq(n,t){return new fr(e=>{let r=0;return t.schedule(function(){r===n.length?e.complete():(e.next(n[r++]),e.closed||this.schedule())})})}function Nq(n,t){return new fr(e=>{let r;return mi(e,t,()=>{r=n[C_](),mi(e,t,()=>{let o,s;try{({value:o,done:s}=r.next())}catch(i){e.error(i);return}s?e.complete():e.next(o)},0,!0)}),()=>hn(r?.return)&&r.return()})}function D_(n,t){if(!n)throw new Error("Iterable cannot be null");return new fr(e=>{mi(e,t,()=>{let r=n[Symbol.asyncIterator]();mi(e,t,()=>{r.next().then(o=>{o.done?e.complete():e.next(o.value)})},0,!0)})})}function Dq(n,t){return D_(T_(n),t)}function kq(n,t){if(n!=null){if(b_(n))return Tq(n,t);if(x_(n))return Eq(n,t);if(v_(n))return Iq(n,t);if(w_(n))return D_(n,t);if(__(n))return Nq(n,t);if(I_(n))return Dq(n,t)}throw S_(n)}function to(n,t){return t?kq(n,t):Ho(n)}function nn(...n){let t=Bh(n);return to(n,t)}function Py(n,t){let e=hn(n)?n:()=>n,r=o=>o.error(e());return new fr(t?o=>t.schedule(r,0,o):r)}function YA(n){return!!n&&(n instanceof fr||hn(n.lift)&&hn(n.subscribe))}var Gl=Ny(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function zn(n,t){return Fn((e,r)=>{let o=0;e.subscribe($n(r,s=>{r.next(n.call(t,s,o++))}))})}var{isArray:ube}=Array;function lbe(n,t){return ube(t)?n(...t):n(t)}function Aq(n){return zn(t=>lbe(n,t))}var{isArray:pbe}=Array,{getPrototypeOf:hbe,prototype:fbe,keys:dbe}=Object;function Oq(n){if(n.length===1){let t=n[0];if(pbe(t))return{args:t,keys:null};if(mbe(t)){let e=dbe(t);return{args:e.map(r=>t[r]),keys:e}}}return{args:n,keys:null}}function mbe(n){return n&&typeof n=="object"&&hbe(n)===fbe}function Mq(n,t){return n.reduce((e,r,o)=>(e[r]=t[o],e),{})}function ow(...n){let t=Bh(n),e=vq(n),{args:r,keys:o}=Oq(n);if(r.length===0)return to([],t);let s=new fr(gbe(r,t,o?i=>Mq(o,i):Ri));return e?s.pipe(Aq(e)):s}function gbe(n,t,e=Ri){return r=>{Rq(t,()=>{let{length:o}=n,s=new Array(o),i=o,a=o;for(let c=0;c<o;c++)Rq(t,()=>{let l=to(n[c],t),p=!1;l.subscribe($n(r,f=>{s[c]=f,p||(p=!0,a--),a||r.next(e(s.slice()))},()=>{--i||r.complete()}))},r)},r)}}function Rq(n,t,e){n?mi(e,n,t):t()}function Pq(n,t,e,r,o,s,i,a){let c=[],l=0,p=0,f=!1,y=()=>{f&&!c.length&&!l&&t.complete()},d=m=>l<r?h(m):c.push(m),h=m=>{s&&t.next(m),l++;let x=!1;Ho(e(m,p++)).subscribe($n(t,w=>{o?.(w),s?d(w):t.next(w)},()=>{x=!0},void 0,()=>{if(x)try{for(l--;c.length&&l<r;){let w=c.shift();i?mi(t,i,()=>h(w)):h(w)}y()}catch(w){t.error(w)}}))};return n.subscribe($n(t,d,()=>{f=!0,y()})),()=>{a?.()}}function go(n,t,e=1/0){return hn(t)?go((r,o)=>zn((s,i)=>t(r,s,o,i))(Ho(n(r,o))),e):(typeof t=="number"&&(e=t),Fn((r,o)=>Pq(r,o,n,e)))}function Fy(n=1/0){return go(Ri,n)}function Fq(){return Fy(1)}function $y(...n){return Fq()(to(n,Bh(n)))}function k_(n){return new fr(t=>{Ho(n()).subscribe(t)})}function Pi(n,t){return Fn((e,r)=>{let o=0;e.subscribe($n(r,s=>n.call(t,s,o++)&&r.next(s)))})}function Wl(n){return Fn((t,e)=>{let r=null,o=!1,s;r=t.subscribe($n(e,void 0,void 0,i=>{s=Ho(n(i,Wl(n)(t))),r?(r.unsubscribe(),r=null,s.subscribe(e)):o=!0})),o&&(r.unsubscribe(),r=null,s.subscribe(e))})}function $q(n,t,e,r,o){return(s,i)=>{let a=e,c=t,l=0;s.subscribe($n(i,p=>{let f=l++;c=a?n(c,p,f):(a=!0,p),r&&i.next(c)},o&&(()=>{a&&i.next(c),i.complete()})))}}function Vh(n,t){return hn(t)?go(n,t,1):go(n,1)}function qh(n){return Fn((t,e)=>{let r=!1;t.subscribe($n(e,o=>{r=!0,e.next(o)},()=>{r||e.next(n),e.complete()}))})}function Hl(n){return n<=0?()=>di:Fn((t,e)=>{let r=0;t.subscribe($n(e,o=>{++r<=n&&(e.next(o),n<=r&&e.complete())}))})}function A_(n=ybe){return Fn((t,e)=>{let r=!1;t.subscribe($n(e,o=>{r=!0,e.next(o)},()=>r?e.complete():e.error(n())))})}function ybe(){return new Gl}function sw(n){return Fn((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}function Kl(n,t){let e=arguments.length>=2;return r=>r.pipe(n?Pi((o,s)=>n(o,s,r)):Ri,Hl(1),e?qh(t):A_(()=>new Gl))}function Ly(n){return n<=0?()=>di:Fn((t,e)=>{let r=[];t.subscribe($n(e,o=>{r.push(o),n<r.length&&r.shift()},()=>{for(let o of r)e.next(o);e.complete()},void 0,()=>{r=null}))})}function ZA(n,t){let e=arguments.length>=2;return r=>r.pipe(n?Pi((o,s)=>n(o,s,r)):Ri,Ly(1),e?qh(t):A_(()=>new Gl))}function JA(n,t){return Fn($q(n,t,arguments.length>=2,!0))}function eO(...n){let t=Bh(n);return Fn((e,r)=>{(t?$y(n,e,t):$y(n,e)).subscribe(r)})}function aa(n,t){return Fn((e,r)=>{let o=null,s=0,i=!1,a=()=>i&&!o&&r.complete();e.subscribe($n(r,c=>{o?.unsubscribe();let l=0,p=s++;Ho(n(c,p)).subscribe(o=$n(r,f=>r.next(t?t(c,f,p,l++):f),()=>{o=null,a()}))},()=>{i=!0,a()}))})}function tO(n){return Fn((t,e)=>{Ho(n).subscribe($n(e,()=>e.complete(),rw)),!e.closed&&t.subscribe(e)})}function ms(n,t,e){let r=hn(n)||t||e?{next:n,error:t,complete:e}:n;return r?Fn((o,s)=>{var i;(i=r.subscribe)===null||i===void 0||i.call(r);let a=!0;o.subscribe($n(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Ri}var Ht=class extends Error{code;constructor(t,e){super(C4(t,e)),this.code=t}};function xbe(n){return`NG0${Math.abs(n)}`}function C4(n,t){return`${xbe(n)}${t?": "+t:""}`}var _4=Symbol("InputSignalNode#UNSET"),vbe=vt(Fe({},BA),{transformFn:void 0,applyValueToInputSignal(n,t){zA(n,t)}});function T4(n,t){let e=Object.create(vbe);e.value=n,e.transformFn=t?.transform;function r(){if(MA(e),e.value===_4){let o=null;throw new Ht(-950,o)}return e.value}return r[Ey]=e,r}function oT(n){return{toString:n}.toString()}function vr(n){for(let t in n)if(n[t]===vr)return t;throw Error("Could not find renamed property on target object.")}function Fi(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Fi).join(", ")}]`;if(n==null)return""+n;let t=n.overriddenName||n.name;if(t)return`${t}`;let e=n.toString();if(e==null)return""+e;let r=e.indexOf(`
`);return r>=0?e.slice(0,r):e}function Lq(n,t){return n?t?`${n} ${t}`:n:t||""}var bbe=vr({__forward_ref__:vr});function I4(n){return n.__forward_ref__=I4,n.toString=function(){return Fi(this())},n}function ua(n){return E4(n)?n():n}function E4(n){return typeof n=="function"&&n.hasOwnProperty(bbe)&&n.__forward_ref__===I4}function Ut(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function gw(n){return{providers:n.providers||[],imports:n.imports||[]}}function sT(n){return zq(n,D4)||zq(n,k4)}function N4(n){return sT(n)!==null}function zq(n,t){return n.hasOwnProperty(t)?n[t]:null}function wbe(n){let t=n&&(n[D4]||n[k4]);return t||null}function Bq(n){return n&&(n.hasOwnProperty(Vq)||n.hasOwnProperty(Sbe))?n[Vq]:null}var D4=vr({\u0275prov:vr}),Vq=vr({\u0275inj:vr}),k4=vr({ngInjectableDef:vr}),Sbe=vr({ngInjectorDef:vr}),Kt=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(t,e){this._desc=t,this.\u0275prov=void 0,typeof e=="number"?this.__NG_ELEMENT_ID__=e:e!==void 0&&(this.\u0275prov=Ut({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function A4(n){return n&&!!n.\u0275providers}var Cbe=vr({\u0275cmp:vr}),_be=vr({\u0275dir:vr}),Tbe=vr({\u0275pipe:vr}),Ibe=vr({\u0275mod:vr}),$_=vr({\u0275fac:vr}),uw=vr({__NG_ELEMENT_ID__:vr}),qq=vr({__NG_ENV_ID__:vr});function O4(n){return typeof n=="string"?n:n==null?"":String(n)}function Ebe(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():O4(n)}function M4(n,t){throw new Ht(-200,n)}function qO(n,t){throw new Ht(-201,!1)}var vn=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(vn||{}),uO;function R4(){return uO}function ca(n){let t=uO;return uO=n,t}function P4(n,t,e){let r=sT(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(e&vn.Optional)return null;if(t!==void 0)return t;qO(n,"Injector")}var Nbe={},Od=Nbe,Dbe="__NG_DI_FLAG__",L_=class{injector;constructor(t){this.injector=t}retrieve(t,e){let r=e;return this.injector.get(t,r.optional?h_:Od,r)}},z_="ngTempTokenPath",kbe="ngTokenPath",Abe=/\n/gm,Obe="\u0275",Uq="__source";function Mbe(n,t=vn.Default){if(tw()===void 0)throw new Ht(-203,!1);if(tw()===null)return P4(n,void 0,t);{let e=tw(),r;return e instanceof L_?r=e.injector:r=e,r.get(n,t&vn.Optional?null:void 0,t)}}function on(n,t=vn.Default){return(R4()||Mbe)(ua(n),t)}function mt(n,t=vn.Default){return on(n,iT(t))}function iT(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function lO(n){let t=[];for(let e=0;e<n.length;e++){let r=ua(n[e]);if(Array.isArray(r)){if(r.length===0)throw new Ht(900,!1);let o,s=vn.Default;for(let i=0;i<r.length;i++){let a=r[i],c=Rbe(a);typeof c=="number"?c===-1?o=a.token:s|=c:o=a}t.push(on(o,s))}else t.push(on(r))}return t}function Rbe(n){return n[Dbe]}function Pbe(n,t,e,r){let o=n[z_];throw t[Uq]&&o.unshift(t[Uq]),n.message=Fbe(`
`+n.message,o,e,r),n[kbe]=o,n[z_]=null,n}function Fbe(n,t,e,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==Obe?n.slice(2):n;let o=Fi(t);if(Array.isArray(t))o=t.map(Fi).join(" -> ");else if(typeof t=="object"){let s=[];for(let i in t)if(t.hasOwnProperty(i)){let a=t[i];s.push(i+":"+(typeof a=="string"?JSON.stringify(a):Fi(a)))}o=`{${s.join(", ")}}`}return`${e}${r?"("+r+")":""}[${o}]: ${n.replace(Abe,`
  `)}`}function Gy(n,t){let e=n.hasOwnProperty($_);return e?n[$_]:null}function UO(n,t){n.forEach(e=>Array.isArray(e)?UO(e,t):t(e))}function F4(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function B_(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}var Wy={},jc=[],lw=new Kt(""),$4=new Kt("",-1),L4=new Kt(""),V_=class{get(t,e=Od){if(e===Od){let r=new Error(`NullInjectorError: No provider for ${Fi(t)}!`);throw r.name="NullInjectorError",r}return e}};function z4(n,t){let e=n[Ibe]||null;if(!e&&t===!0)throw new Error(`Type ${Fi(n)} does not have '\u0275mod' property.`);return e}function Pd(n){return n[Cbe]||null}function $be(n){return n[_be]||null}function Lbe(n){return n[Tbe]||null}function aT(n){return{\u0275providers:n}}function zbe(...n){return{\u0275providers:B4(!0,n),\u0275fromNgModule:!0}}function B4(n,...t){let e=[],r=new Set,o,s=i=>{e.push(i)};return UO(t,i=>{let a=i;pO(a,s,[],r)&&(o||=[],o.push(a))}),o!==void 0&&V4(o,s),e}function V4(n,t){for(let e=0;e<n.length;e++){let{ngModule:r,providers:o}=n[e];jO(o,s=>{t(s,r)})}}function pO(n,t,e,r){if(n=ua(n),!n)return!1;let o=null,s=Bq(n),i=!s&&Pd(n);if(!s&&!i){let c=n.ngModule;if(s=Bq(c),s)o=c;else return!1}else{if(i&&!i.standalone)return!1;o=n}let a=r.has(o);if(i){if(a)return!1;if(r.add(o),i.dependencies){let c=typeof i.dependencies=="function"?i.dependencies():i.dependencies;for(let l of c)pO(l,t,e,r)}}else if(s){if(s.imports!=null&&!a){r.add(o);let l;try{UO(s.imports,p=>{pO(p,t,e,r)&&(l||=[],l.push(p))})}finally{}l!==void 0&&V4(l,t)}if(!a){let l=Gy(o)||(()=>new o);t({provide:o,useFactory:l,deps:jc},o),t({provide:L4,useValue:o,multi:!0},o),t({provide:lw,useValue:()=>on(o),multi:!0},o)}let c=s.providers;if(c!=null&&!a){let l=n;jO(c,p=>{t(p,l)})}}else return!1;return o!==n&&n.providers!==void 0}function jO(n,t){for(let e of n)A4(e)&&(e=e.\u0275providers),Array.isArray(e)?jO(e,t):t(e)}var Bbe=vr({provide:String,useValue:vr});function q4(n){return n!==null&&typeof n=="object"&&Bbe in n}function Vbe(n){return!!(n&&n.useExisting)}function qbe(n){return!!(n&&n.useFactory)}function hO(n){return typeof n=="function"}var cT=new Kt(""),O_={},jq={},nO;function GO(){return nO===void 0&&(nO=new V_),nO}var yi=class{},pw=class extends yi{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(t,e,r,o){super(),this.parent=e,this.source=r,this.scopes=o,dO(t,i=>this.processProvider(i)),this.records.set($4,zy(void 0,this)),o.has("environment")&&this.records.set(yi,zy(void 0,this));let s=this.records.get(cT);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(L4,jc,vn.Self))}retrieve(t,e){let r=e;return this.get(t,r.optional?h_:Od,r)}destroy(){aw(this),this._destroyed=!0;let t=Yn(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of e)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Yn(t)}}onDestroy(t){return aw(this),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){aw(this);let e=jl(this),r=ca(void 0),o;try{return t()}finally{jl(e),ca(r)}}get(t,e=Od,r=vn.Default){if(aw(this),t.hasOwnProperty(qq))return t[qq](this);r=iT(r);let o,s=jl(this),i=ca(void 0);try{if(!(r&vn.SkipSelf)){let c=this.records.get(t);if(c===void 0){let l=Kbe(t)&&sT(t);l&&this.injectableDefInScope(l)?c=zy(fO(t),O_):c=null,this.records.set(t,c)}if(c!=null)return this.hydrate(t,c,r)}let a=r&vn.Self?GO():this.parent;return e=r&vn.Optional&&e===Od?null:e,a.get(t,e)}catch(a){if(a.name==="NullInjectorError"){if((a[z_]=a[z_]||[]).unshift(Fi(t)),s)throw a;return Pbe(a,t,"R3InjectorError",this.source)}else throw a}finally{ca(i),jl(s)}}resolveInjectorInitializers(){let t=Yn(null),e=jl(this),r=ca(void 0),o;try{let s=this.get(lw,jc,vn.Self);for(let i of s)i()}finally{jl(e),ca(r),Yn(t)}}toString(){let t=[],e=this.records;for(let r of e.keys())t.push(Fi(r));return`R3Injector[${t.join(", ")}]`}processProvider(t){t=ua(t);let e=hO(t)?t:ua(t&&t.provide),r=jbe(t);if(!hO(t)&&t.multi===!0){let o=this.records.get(e);o||(o=zy(void 0,O_,!0),o.factory=()=>lO(o.multi),this.records.set(e,o)),e=t,o.multi.push(t)}this.records.set(e,r)}hydrate(t,e,r){let o=Yn(null);try{return e.value===jq?M4(Fi(t)):e.value===O_&&(e.value=jq,e.value=e.factory(void 0,r)),typeof e.value=="object"&&e.value&&Hbe(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{Yn(o)}}injectableDefInScope(t){if(!t.providedIn)return!1;let e=ua(t.providedIn);return typeof e=="string"?e==="any"||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(t){let e=this._onDestroyHooks.indexOf(t);e!==-1&&this._onDestroyHooks.splice(e,1)}};function fO(n){let t=sT(n),e=t!==null?t.factory:Gy(n);if(e!==null)return e;if(n instanceof Kt)throw new Ht(204,!1);if(n instanceof Function)return Ube(n);throw new Ht(204,!1)}function Ube(n){if(n.length>0)throw new Ht(204,!1);let e=wbe(n);return e!==null?()=>e.factory(n):()=>new n}function jbe(n){if(q4(n))return zy(void 0,n.useValue);{let t=Gbe(n);return zy(t,O_)}}function Gbe(n,t,e){let r;if(hO(n)){let o=ua(n);return Gy(o)||fO(o)}else if(q4(n))r=()=>ua(n.useValue);else if(qbe(n))r=()=>n.useFactory(...lO(n.deps||[]));else if(Vbe(n))r=(o,s)=>on(ua(n.useExisting),s!==void 0&&s&vn.Optional?vn.Optional:void 0);else{let o=ua(n&&(n.useClass||n.provide));if(Wbe(n))r=()=>new o(...lO(n.deps));else return Gy(o)||fO(o)}return r}function aw(n){if(n.destroyed)throw new Ht(205,!1)}function zy(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function Wbe(n){return!!n.deps}function Hbe(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function Kbe(n){return typeof n=="function"||typeof n=="object"&&n instanceof Kt}function dO(n,t){for(let e of n)Array.isArray(e)?dO(e,t):e&&A4(e)?dO(e.\u0275providers,t):t(e)}function da(n,t){let e;n instanceof pw?(aw(n),e=n):e=new L_(n);let r,o=jl(e),s=ca(void 0);try{return t()}finally{jl(o),ca(s)}}function U4(){return R4()!==void 0||tw()!=null}function Xbe(n){if(!U4())throw new Ht(-203,!1)}function Qbe(n){return typeof n=="function"}var Xl=0,Bn=1,wn=2,Ks=3,nc=4,oc=5,q_=6,U_=7,ha=8,Hy=9,jh=10,fa=11,hw=12,Gq=13,yw=14,Wc=15,fw=16,By=17,uT=18,lT=19,j4=20,Uh=21,rO=22,j_=23,la=24,Uy=25,Gh=26,G4=1;var Fd=7,G_=8,W_=9,pa=10;function Md(n){return Array.isArray(n)&&typeof n[G4]=="object"}function Ql(n){return Array.isArray(n)&&n[G4]===!0}function W4(n){return(n.flags&4)!==0}function xw(n){return n.componentOffset>-1}function H4(n){return(n.flags&1)===1}function Bd(n){return!!n.template}function H_(n){return(n[wn]&512)!==0}function Yy(n){return(n[wn]&256)===256}var mO=class{previousValue;currentValue;firstChange;constructor(t,e,r){this.previousValue=t,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}};function K4(n,t,e,r){t!==null?t.applyValueToInputSignal(t,r):n[e]=r}var pT=(()=>{let n=()=>X4;return n.ngInherit=!0,n})();function X4(n){return n.type.prototype.ngOnChanges&&(n.setInput=Zbe),Ybe}function Ybe(){let n=Y4(this),t=n?.current;if(t){let e=n.previous;if(e===Wy)n.previous=t;else for(let r in t)e[r]=t[r];n.current=null,this.ngOnChanges(t)}}function Zbe(n,t,e,r,o){let s=this.declaredInputs[r],i=Y4(n)||Jbe(n,{previous:Wy,current:null}),a=i.current||(i.current={}),c=i.previous,l=c[s];a[s]=new mO(l&&l.currentValue,e,c===Wy),K4(n,t,o,e)}var Q4="__ngSimpleChanges__";function Y4(n){return n[Q4]||null}function Jbe(n,t){return n[Q4]=t}var Wq=null;var dr=function(n,t=null,e){Wq?.(n,t,e)},ewe="svg",twe="math";function Hc(n){for(;Array.isArray(n);)n=n[Xl];return n}function nwe(n,t){return Hc(t[n])}function Hh(n,t){return Hc(t[n.index])}function rwe(n,t){return n.data[t]}function Wh(n,t){let e=t[n];return Md(e)?e:e[Xl]}function WO(n){return(n[wn]&128)===128}function owe(n){return Ql(n[Ks])}function Hq(n,t){return t==null?null:n[t]}function Z4(n){n[By]=0}function J4(n){n[wn]&1024||(n[wn]|=1024,WO(n)&&vw(n))}function hT(n){return!!(n[wn]&9216||n[la]?.dirty)}function gO(n){n[jh].changeDetectionScheduler?.notify(8),n[wn]&64&&(n[wn]|=1024),hT(n)&&vw(n)}function vw(n){n[jh].changeDetectionScheduler?.notify(0);let t=$d(n);for(;t!==null&&!(t[wn]&8192||(t[wn]|=8192,!WO(t)));)t=$d(t)}function eU(n,t){if(Yy(n))throw new Ht(911,!1);n[Uh]===null&&(n[Uh]=[]),n[Uh].push(t)}function swe(n,t){if(n[Uh]===null)return;let e=n[Uh].indexOf(t);e!==-1&&n[Uh].splice(e,1)}function $d(n){let t=n[Ks];return Ql(t)?t[Ks]:t}function tU(n){return n[U_]??=[]}function nU(n){return n.cleanup??=[]}var cr={lFrame:uU(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var yO=!1;function iwe(){return cr.lFrame.elementDepthCount}function awe(){cr.lFrame.elementDepthCount++}function cwe(){cr.lFrame.elementDepthCount--}function uwe(){return cr.bindingsEnabled}function lwe(){return cr.skipHydrationRootTNode!==null}function pwe(n){return cr.skipHydrationRootTNode===n}function hwe(){cr.skipHydrationRootTNode=null}function xi(){return cr.lFrame.lView}function bw(){return cr.lFrame.tView}function Yl(){let n=rU();for(;n!==null&&n.type===64;)n=n.parent;return n}function rU(){return cr.lFrame.currentTNode}function fwe(){let n=cr.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}function fT(n,t){let e=cr.lFrame;e.currentTNode=n,e.isParent=t}function oU(){return cr.lFrame.isParent}function dwe(){cr.lFrame.isParent=!1}function sU(){return yO}function Kq(n){let t=yO;return yO=n,t}function mwe(n){return cr.lFrame.bindingIndex=n}function gwe(){return cr.lFrame.bindingIndex++}function ywe(){return cr.lFrame.inI18n}function xwe(n,t){let e=cr.lFrame;e.bindingIndex=e.bindingRootIndex=n,xO(t)}function vwe(){return cr.lFrame.currentDirectiveIndex}function xO(n){cr.lFrame.currentDirectiveIndex=n}function iU(n){cr.lFrame.currentQueryIndex=n}function bwe(n){let t=n[Bn];return t.type===2?t.declTNode:t.type===1?n[oc]:null}function aU(n,t,e){if(e&vn.SkipSelf){let o=t,s=n;for(;o=o.parent,o===null&&!(e&vn.Host);)if(o=bwe(s),o===null||(s=s[yw],o.type&10))break;if(o===null)return!1;t=o,n=s}let r=cr.lFrame=cU();return r.currentTNode=t,r.lView=n,!0}function HO(n){let t=cU(),e=n[Bn];cr.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function cU(){let n=cr.lFrame,t=n===null?null:n.child;return t===null?uU(n):t}function uU(n){let t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=t),t}function lU(){let n=cr.lFrame;return cr.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var pU=lU;function KO(){let n=lU();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function XO(){return cr.lFrame.selectedIndex}function Ld(n){cr.lFrame.selectedIndex=n}function wwe(){return cr.lFrame.currentNamespace}var hU=!0;function fU(){return hU}function dU(n){hU=n}function Swe(n,t,e){let{ngOnChanges:r,ngOnInit:o,ngDoCheck:s}=t.type.prototype;if(r){let i=X4(t);(e.preOrderHooks??=[]).push(n,i),(e.preOrderCheckHooks??=[]).push(n,i)}o&&(e.preOrderHooks??=[]).push(0-n,o),s&&((e.preOrderHooks??=[]).push(n,s),(e.preOrderCheckHooks??=[]).push(n,s))}function Cwe(n,t){for(let e=t.directiveStart,r=t.directiveEnd;e<r;e++){let s=n.data[e].type.prototype,{ngAfterContentInit:i,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:p}=s;i&&(n.contentHooks??=[]).push(-e,i),a&&((n.contentHooks??=[]).push(e,a),(n.contentCheckHooks??=[]).push(e,a)),c&&(n.viewHooks??=[]).push(-e,c),l&&((n.viewHooks??=[]).push(e,l),(n.viewCheckHooks??=[]).push(e,l)),p!=null&&(n.destroyHooks??=[]).push(e,p)}}function M_(n,t,e){mU(n,t,3,e)}function R_(n,t,e,r){(n[wn]&3)===e&&mU(n,t,e,r)}function oO(n,t){let e=n[wn];(e&3)===t&&(e&=16383,e+=1,n[wn]=e)}function mU(n,t,e,r){let o=r!==void 0?n[By]&65535:0,s=r??-1,i=t.length-1,a=0;for(let c=o;c<i;c++)if(typeof t[c+1]=="number"){if(a=t[c],r!=null&&a>=r)break}else t[c]<0&&(n[By]+=65536),(a<s||s==-1)&&(_we(n,e,t,c),n[By]=(n[By]&4294901760)+c+2),c++}function Xq(n,t){dr(4,n,t);let e=Yn(null);try{t.call(n)}finally{Yn(e),dr(5,n,t)}}function _we(n,t,e,r){let o=e[r]<0,s=e[r+1],i=o?-e[r]:e[r],a=n[i];o?n[wn]>>14<n[By]>>16&&(n[wn]&3)===t&&(n[wn]+=16384,Xq(a,s)):Xq(a,s)}var jy=-1,dw=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(t,e,r){this.factory=t,this.canSeeViewProviders=e,this.injectImpl=r}};function Twe(n){return(n.flags&8)!==0}function Iwe(n){return(n.flags&16)!==0}function Ewe(n,t,e){let r=0;for(;r<e.length;){let o=e[r];if(typeof o=="number"){if(o!==0)break;r++;let s=e[r++],i=e[r++],a=e[r++];n.setAttribute(t,i,a,s)}else{let s=o,i=e[++r];Dwe(s)?n.setProperty(t,s,i):n.setAttribute(t,s,i),r++}}return r}function Nwe(n){return n===3||n===4||n===6}function Dwe(n){return n.charCodeAt(0)===64}function gU(n,t){if(!(t===null||t.length===0))if(n===null||n.length===0)n=t.slice();else{let e=-1;for(let r=0;r<t.length;r++){let o=t[r];typeof o=="number"?e=o:e===0||(e===-1||e===2?Qq(n,e,o,null,t[++r]):Qq(n,e,o,null,null))}}return n}function Qq(n,t,e,r,o){let s=0,i=n.length;if(t===-1)i=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===t){i=-1;break}else if(a>t){i=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===e){o!==null&&(n[s+1]=o);return}s++,o!==null&&s++}i!==-1&&(n.splice(i,0,t),s=i+1),n.splice(s++,0,e),o!==null&&n.splice(s++,0,o)}function yU(n){return n!==jy}function K_(n){return n&32767}function kwe(n){return n>>16}function X_(n,t){let e=kwe(n),r=t;for(;e>0;)r=r[yw],e--;return r}var vO=!0;function Yq(n){let t=vO;return vO=n,t}var Awe=256,xU=Awe-1,vU=5,Owe=0,Gc={};function Mwe(n,t,e){let r;typeof e=="string"?r=e.charCodeAt(0)||0:e.hasOwnProperty(uw)&&(r=e[uw]),r==null&&(r=e[uw]=Owe++);let o=r&xU,s=1<<o;t.data[n+(o>>vU)]|=s}function bU(n,t){let e=wU(n,t);if(e!==-1)return e;let r=t[Bn];r.firstCreatePass&&(n.injectorIndex=t.length,sO(r.data,n),sO(t,null),sO(r.blueprint,null));let o=QO(n,t),s=n.injectorIndex;if(yU(o)){let i=K_(o),a=X_(o,t),c=a[Bn].data;for(let l=0;l<8;l++)t[s+l]=a[i+l]|c[i+l]}return t[s+8]=o,s}function sO(n,t){n.push(0,0,0,0,0,0,0,0,t)}function wU(n,t){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||t[n.injectorIndex+8]===null?-1:n.injectorIndex}function QO(n,t){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let e=0,r=null,o=t;for(;o!==null;){if(r=IU(o),r===null)return jy;if(e++,o=o[yw],r.injectorIndex!==-1)return r.injectorIndex|e<<16}return jy}function Rwe(n,t,e){Mwe(n,t,e)}function SU(n,t,e){if(e&vn.Optional||n!==void 0)return n;qO(t,"NodeInjector")}function CU(n,t,e,r){if(e&vn.Optional&&r===void 0&&(r=null),(e&(vn.Self|vn.Host))===0){let o=n[Hy],s=ca(void 0);try{return o?o.get(t,r,e&vn.Optional):P4(t,r,e&vn.Optional)}finally{ca(s)}}return SU(r,t,e)}function _U(n,t,e,r=vn.Default,o){if(n!==null){if(t[wn]&2048&&!(r&vn.Self)){let i=zwe(n,t,e,r,Gc);if(i!==Gc)return i}let s=TU(n,t,e,r,Gc);if(s!==Gc)return s}return CU(t,e,r,o)}function TU(n,t,e,r,o){let s=$we(e);if(typeof s=="function"){if(!aU(t,n,r))return r&vn.Host?SU(o,e,r):CU(t,e,r,o);try{let i;if(i=s(r),i==null&&!(r&vn.Optional))qO(e);else return i}finally{pU()}}else if(typeof s=="number"){let i=null,a=wU(n,t),c=jy,l=r&vn.Host?t[Wc][oc]:null;for((a===-1||r&vn.SkipSelf)&&(c=a===-1?QO(n,t):t[a+8],c===jy||!Jq(r,!1)?a=-1:(i=t[Bn],a=K_(c),t=X_(c,t)));a!==-1;){let p=t[Bn];if(Zq(s,a,p.data)){let f=Pwe(a,t,e,i,r,l);if(f!==Gc)return f}c=t[a+8],c!==jy&&Jq(r,t[Bn].data[a+8]===l)&&Zq(s,a,t)?(i=p,a=K_(c),t=X_(c,t)):a=-1}}return o}function Pwe(n,t,e,r,o,s){let i=t[Bn],a=i.data[n+8],c=r==null?xw(a)&&vO:r!=i&&(a.type&3)!==0,l=o&vn.Host&&s===a,p=Fwe(a,i,e,c,l);return p!==null?bO(t,i,p,a,o):Gc}function Fwe(n,t,e,r,o){let s=n.providerIndexes,i=t.data,a=s&1048575,c=n.directiveStart,l=n.directiveEnd,p=s>>20,f=r?a:a+p,y=o?a+p:l;for(let d=f;d<y;d++){let h=i[d];if(d<c&&e===h||d>=c&&h.type===e)return d}if(o){let d=i[c];if(d&&Bd(d)&&d.type===e)return c}return null}function bO(n,t,e,r,o){let s=n[e],i=t.data;if(s instanceof dw){let a=s;a.resolving&&M4(Ebe(i[e]));let c=Yq(a.canSeeViewProviders);a.resolving=!0;let l,p=a.injectImpl?ca(a.injectImpl):null,f=aU(n,r,vn.Default);try{s=n[e]=a.factory(void 0,o,i,n,r),t.firstCreatePass&&e>=r.directiveStart&&Swe(e,i[e],t)}finally{p!==null&&ca(p),Yq(c),a.resolving=!1,pU()}}return s}function $we(n){if(typeof n=="string")return n.charCodeAt(0)||0;let t=n.hasOwnProperty(uw)?n[uw]:void 0;return typeof t=="number"?t>=0?t&xU:Lwe:t}function Zq(n,t,e){let r=1<<n;return!!(e[t+(n>>vU)]&r)}function Jq(n,t){return!(n&vn.Self)&&!(n&vn.Host&&t)}var Rd=class{_tNode;_lView;constructor(t,e){this._tNode=t,this._lView=e}get(t,e,r){return _U(this._tNode,this._lView,t,iT(r),e)}};function Lwe(){return new Rd(Yl(),xi())}function YO(n){return oT(()=>{let t=n.prototype.constructor,e=t[$_]||wO(t),r=Object.prototype,o=Object.getPrototypeOf(n.prototype).constructor;for(;o&&o!==r;){let s=o[$_]||wO(o);if(s&&s!==e)return s;o=Object.getPrototypeOf(o)}return s=>new s})}function wO(n){return E4(n)?()=>{let t=wO(ua(n));return t&&t()}:Gy(n)}function zwe(n,t,e,r,o){let s=n,i=t;for(;s!==null&&i!==null&&i[wn]&2048&&!H_(i);){let a=TU(s,i,e,r|vn.Self,Gc);if(a!==Gc)return a;let c=s.parent;if(!c){let l=i[j4];if(l){let p=l.get(e,Gc,r);if(p!==Gc)return p}c=IU(i),i=i[yw]}s=c}return o}function IU(n){let t=n[Bn],e=t.type;return e===2?t.declTNode:e===1?n[oc]:null}function e4(n,t=null,e=null,r){let o=EU(n,t,e,r);return o.resolveInjectorInitializers(),o}function EU(n,t=null,e=null,r,o=new Set){let s=[e||jc,zbe(n)];return r=r||(typeof n=="object"?void 0:Fi(n)),new pw(s,t||GO(),r||null,o)}var rc=class n{static THROW_IF_NOT_FOUND=Od;static NULL=new V_;static create(t,e){if(Array.isArray(t))return e4({name:""},e,t,"");{let r=t.name??"";return e4({name:r},t.parent,t.providers,r)}}static \u0275prov=Ut({token:n,providedIn:"any",factory:()=>on($4)});static __NG_ELEMENT_ID__=-1};var Bwe=new Kt("");Bwe.__NG_ELEMENT_ID__=n=>{let t=Yl();if(t===null)throw new Ht(204,!1);if(t.type&2)return t.value;if(n&vn.Optional)return null;throw new Ht(204,!1)};var NU=!1,ww=(()=>{class n{static __NG_ELEMENT_ID__=Vwe;static __NG_ENV_ID__=e=>e}return n})(),SO=class extends ww{_lView;constructor(t){super(),this._lView=t}onDestroy(t){let e=this._lView;return Yy(e)?(t(),()=>{}):(eU(e,t),()=>swe(e,t))}};function Vwe(){return new SO(xi())}var Ky=class{},ZO=new Kt("",{providedIn:"root",factory:()=>!1});var DU=new Kt(""),kU=new Kt(""),Zy=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new ds(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let e=this.taskId++;return this.pendingTasks.add(e),e}has(e){return this.pendingTasks.has(e)}remove(e){this.pendingTasks.delete(e),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=Ut({token:n,providedIn:"root",factory:()=>new n})}return n})();var CO=class extends fs{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(t=!1){super(),this.__isAsync=t,U4()&&(this.destroyRef=mt(ww,{optional:!0})??void 0,this.pendingTasks=mt(Zy,{optional:!0})??void 0)}emit(t){let e=Yn(null);try{super.next(t)}finally{Yn(e)}}subscribe(t,e,r){let o=t,s=e||(()=>null),i=r;if(t&&typeof t=="object"){let c=t;o=c.next?.bind(c),s=c.error?.bind(c),i=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),o&&(o=this.wrapInTimeout(o)),i&&(i=this.wrapInTimeout(i)));let a=super.subscribe({next:o,error:s,complete:i});return t instanceof _o&&t.add(a),a}wrapInTimeout(t){return e=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{t(e)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},gi=CO;function Q_(...n){}function AU(n){let t,e;function r(){n=Q_;try{e!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(e),t!==void 0&&clearTimeout(t)}catch{}}return t=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(e=requestAnimationFrame(()=>{n(),r()})),()=>r()}function t4(n){return queueMicrotask(()=>n()),()=>{n=Q_}}var JO="isAngularZone",Y_=JO+"_ID",qwe=0,yo=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new gi(!1);onMicrotaskEmpty=new gi(!1);onStable=new gi(!1);onError=new gi(!1);constructor(t){let{enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:o=!1,scheduleInRootZone:s=NU}=t;if(typeof Zone>"u")throw new Ht(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!o&&r,i.shouldCoalesceRunChangeDetection=o,i.callbackScheduled=!1,i.scheduleInRootZone=s,Gwe(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(JO)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new Ht(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new Ht(909,!1)}run(t,e,r){return this._inner.run(t,e,r)}runTask(t,e,r,o){let s=this._inner,i=s.scheduleEventTask("NgZoneEvent: "+o,t,Uwe,Q_,Q_);try{return s.runTask(i,e,r)}finally{s.cancelTask(i)}}runGuarded(t,e,r){return this._inner.runGuarded(t,e,r)}runOutsideAngular(t){return this._outer.run(t)}},Uwe={};function eM(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function jwe(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function t(){AU(()=>{n.callbackScheduled=!1,_O(n),n.isCheckStableRunning=!0,eM(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{t()}):n._outer.run(()=>{t()}),_O(n)}function Gwe(n){let t=()=>{jwe(n)},e=qwe++;n._inner=n._inner.fork({name:"angular",properties:{[JO]:!0,[Y_]:e,[Y_+e]:!0},onInvokeTask:(r,o,s,i,a,c)=>{if(Wwe(c))return r.invokeTask(s,i,a,c);try{return n4(n),r.invokeTask(s,i,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&i.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&t(),r4(n)}},onInvoke:(r,o,s,i,a,c,l)=>{try{return n4(n),r.invoke(s,i,a,c,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!Hwe(c)&&t(),r4(n)}},onHasTask:(r,o,s,i)=>{r.hasTask(s,i),o===s&&(i.change=="microTask"?(n._hasPendingMicrotasks=i.microTask,_O(n),eM(n)):i.change=="macroTask"&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:(r,o,s,i)=>(r.handleError(s,i),n.runOutsideAngular(()=>n.onError.emit(i)),!1)})}function _O(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function n4(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function r4(n){n._nesting--,eM(n)}var TO=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new gi;onMicrotaskEmpty=new gi;onStable=new gi;onError=new gi;run(t,e,r){return t.apply(e,r)}runGuarded(t,e,r){return t.apply(e,r)}runOutsideAngular(t){return t()}runTask(t,e,r,o){return t.apply(e,r)}};function Wwe(n){return OU(n,"__ignore_ng_zone__")}function Hwe(n){return OU(n,"__scheduler_tick__")}function OU(n,t){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[t]===!0}var Kc=class{_console=console;handleError(t){this._console.error("ERROR",t)}},Kwe=new Kt("",{providedIn:"root",factory:()=>{let n=mt(yo),t=mt(Kc);return e=>n.runOutsideAngular(()=>t.handleError(e))}});function o4(n,t){return T4(n,t)}function Xwe(n){return T4(_4,n)}var MU=(o4.required=Xwe,o4);function Qwe(){return tM(Yl(),xi())}function tM(n,t){return new dT(Hh(n,t))}var dT=(()=>{class n{nativeElement;constructor(e){this.nativeElement=e}static __NG_ELEMENT_ID__=Qwe}return n})();function RU(n){return(n.flags&128)===128}var PU=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(PU||{}),FU=new Map,Ywe=0;function Zwe(){return Ywe++}function Jwe(n){FU.set(n[lT],n)}function IO(n){FU.delete(n[lT])}var s4="__ngContext__";function mT(n,t){Md(t)?(n[s4]=t[lT],Jwe(t)):n[s4]=t}function $U(n){return zU(n[hw])}function LU(n){return zU(n[nc])}function zU(n){for(;n!==null&&!Ql(n);)n=n[nc];return n}var EO;function BU(n){EO=n}function e0e(){if(EO!==void 0)return EO;if(typeof document<"u")return document;throw new Ht(210,!1)}var nM=new Kt("",{providedIn:"root",factory:()=>t0e}),t0e="ng",rM=new Kt(""),Jy=new Kt("",{providedIn:"platform",factory:()=>"unknown"});var oM=new Kt("",{providedIn:"root",factory:()=>e0e().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var n0e="h",r0e="b";var VU=!1,o0e=new Kt("",{providedIn:"root",factory:()=>VU});var sM=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(sM||{}),ex=new Kt(""),i4=new Set;function tx(n){i4.has(n)||(i4.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var qU=(()=>{class n{view;node;constructor(e,r){this.view=e,this.node=r}static __NG_ELEMENT_ID__=s0e}return n})();function s0e(){return new qU(xi(),Yl())}var Vy=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(Vy||{}),UU=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=Ut({token:n,providedIn:"root",factory:()=>new n})}return n})(),i0e=[Vy.EarlyRead,Vy.Write,Vy.MixedReadWrite,Vy.Read],a0e=(()=>{class n{ngZone=mt(yo);scheduler=mt(Ky);errorHandler=mt(Kc,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){mt(ex,{optional:!0})}execute(){let e=this.sequences.size>0;e&&dr(16),this.executing=!0;for(let r of i0e)for(let o of this.sequences)if(!(o.erroredOrDestroyed||!o.hooks[r]))try{o.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let s=o.hooks[r];return s(o.pipelinedValue)},o.snapshot))}catch(s){o.erroredOrDestroyed=!0,this.errorHandler?.handleError(s)}this.executing=!1;for(let r of this.sequences)r.afterRun(),r.once&&(this.sequences.delete(r),r.destroy());for(let r of this.deferredRegistrations)this.sequences.add(r);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),e&&dr(17)}register(e){let{view:r}=e;r!==void 0?((r[Uy]??=[]).push(e),vw(r),r[wn]|=8192):this.executing?this.deferredRegistrations.add(e):this.addSequence(e)}addSequence(e){this.sequences.add(e),this.scheduler.notify(7)}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}maybeTrace(e,r){return r?r.run(sM.AFTER_NEXT_RENDER,e):e()}static \u0275prov=Ut({token:n,providedIn:"root",factory:()=>new n})}return n})(),NO=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(t,e,r,o,s,i=null){this.impl=t,this.hooks=e,this.view=r,this.once=o,this.snapshot=i,this.unregisterOnDestroy=s?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let t=this.view?.[Uy];t&&(this.view[Uy]=t.filter(e=>e!==this))}};function iM(n,t){!t?.injector&&Xbe(iM);let e=t?.injector??mt(rc);return tx("NgAfterNextRender"),u0e(n,e,t,!0)}function c0e(n,t){if(n instanceof Function){let e=[void 0,void 0,void 0,void 0];return e[t]=n,e}else return[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function u0e(n,t,e,r){let o=t.get(UU);o.impl??=t.get(a0e);let s=t.get(ex,null,{optional:!0}),i=e?.phase??Vy.MixedReadWrite,a=e?.manualCleanup!==!0?t.get(ww):null,c=t.get(qU,null,{optional:!0}),l=new NO(o.impl,c0e(n,i),c?.view,r,a,s?.snapshot(null));return o.impl.register(l),l}var l0e=(n,t,e,r)=>{};function p0e(n,t,e,r){l0e(n,t,e,r)}var h0e=()=>null;function jU(n,t,e=!1){return h0e(n,t,e)}function GU(n,t){let e=n.contentQueries;if(e!==null){let r=Yn(null);try{for(let o=0;o<e.length;o+=2){let s=e[o],i=e[o+1];if(i!==-1){let a=n.data[i];iU(s),a.contentQueries(2,t[i],i)}}}finally{Yn(r)}}}function DO(n,t,e){iU(0);let r=Yn(null);try{t(n,e)}finally{Yn(r)}}function WU(n,t,e){if(W4(t)){let r=Yn(null);try{let o=t.directiveStart,s=t.directiveEnd;for(let i=o;i<s;i++){let a=n.data[i];if(a.contentQueries){let c=e[i];a.contentQueries(1,c,i)}}}finally{Yn(r)}}}var Xc=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Xc||{});function HU(n){return n instanceof Function?n():n}function f0e(n,t,e){let r=n.length;for(;;){let o=n.indexOf(t,e);if(o===-1)return o;if(o===0||n.charCodeAt(o-1)<=32){let s=t.length;if(o+s===r||n.charCodeAt(o+s)<=32)return o}e=o+1}}var KU="ng-template";function d0e(n,t,e,r){let o=0;if(r){for(;o<t.length&&typeof t[o]=="string";o+=2)if(t[o]==="class"&&f0e(t[o+1].toLowerCase(),e,0)!==-1)return!0}else if(aM(n))return!1;if(o=t.indexOf(1,o),o>-1){let s;for(;++o<t.length&&typeof(s=t[o])=="string";)if(s.toLowerCase()===e)return!0}return!1}function aM(n){return n.type===4&&n.value!==KU}function m0e(n,t,e){let r=n.type===4&&!e?KU:n.value;return t===r}function g0e(n,t,e){let r=4,o=n.attrs,s=o!==null?v0e(o):0,i=!1;for(let a=0;a<t.length;a++){let c=t[a];if(typeof c=="number"){if(!i&&!tc(r)&&!tc(c))return!1;if(i&&tc(c))continue;i=!1,r=c|r&1;continue}if(!i)if(r&4){if(r=2|r&1,c!==""&&!m0e(n,c,e)||c===""&&t.length===1){if(tc(r))return!1;i=!0}}else if(r&8){if(o===null||!d0e(n,o,c,e)){if(tc(r))return!1;i=!0}}else{let l=t[++a],p=y0e(c,o,aM(n),e);if(p===-1){if(tc(r))return!1;i=!0;continue}if(l!==""){let f;if(p>s?f="":f=o[p+1].toLowerCase(),r&2&&l!==f){if(tc(r))return!1;i=!0}}}}return tc(r)||i}function tc(n){return(n&1)===0}function y0e(n,t,e,r){if(t===null)return-1;let o=0;if(r||!e){let s=!1;for(;o<t.length;){let i=t[o];if(i===n)return o;if(i===3||i===6)s=!0;else if(i===1||i===2){let a=t[++o];for(;typeof a=="string";)a=t[++o];continue}else{if(i===4)break;if(i===0){o+=4;continue}}o+=s?1:2}return-1}else return b0e(t,n)}function x0e(n,t,e=!1){for(let r=0;r<t.length;r++)if(g0e(n,t[r],e))return!0;return!1}function v0e(n){for(let t=0;t<n.length;t++){let e=n[t];if(Nwe(e))return t}return n.length}function b0e(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){let r=n[e];if(typeof r=="number")return-1;if(r===t)return e;e++}return-1}function a4(n,t){return n?":not("+t.trim()+")":t}function w0e(n){let t=n[0],e=1,r=2,o="",s=!1;for(;e<n.length;){let i=n[e];if(typeof i=="string")if(r&2){let a=n[++e];o+="["+i+(a.length>0?'="'+a+'"':"")+"]"}else r&8?o+="."+i:r&4&&(o+=" "+i);else o!==""&&!tc(i)&&(t+=a4(s,o),o=""),r=i,s=s||!tc(r);e++}return o!==""&&(t+=a4(s,o)),t}function S0e(n){return n.map(w0e).join(",")}function C0e(n){let t=[],e=[],r=1,o=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")o===2?s!==""&&t.push(s,n[++r]):o===8&&e.push(s);else{if(!tc(o))break;o=s}r++}return e.length&&t.push(1,...e),t}var gT={};function _0e(n,t){return n.createText(t)}function T0e(n,t,e){n.setValue(t,e)}function XU(n,t,e){return n.createElement(t,e)}function Z_(n,t,e,r,o){n.insertBefore(t,e,r,o)}function QU(n,t,e){n.appendChild(t,e)}function c4(n,t,e,r,o){r!==null?Z_(n,t,e,r,o):QU(n,t,e)}function I0e(n,t,e){n.removeChild(null,t,e)}function E0e(n,t,e){n.setAttribute(t,"style",e)}function N0e(n,t,e){e===""?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function YU(n,t,e){let{mergedAttrs:r,classes:o,styles:s}=e;r!==null&&Ewe(n,t,r),o!==null&&N0e(n,t,o),s!==null&&E0e(n,t,s)}function ZU(n,t,e,r,o,s,i,a,c,l,p){let f=Gh+r,y=f+o,d=D0e(f,y),h=typeof l=="function"?l():l;return d[Bn]={type:n,blueprint:d,template:e,queries:null,viewQuery:a,declTNode:t,data:d.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:y,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof i=="function"?i():i,firstChild:null,schemas:c,consts:h,incompleteFirstPass:!1,ssrId:p}}function D0e(n,t){let e=[];for(let r=0;r<t;r++)e.push(r<n?null:gT);return e}function k0e(n){let t=n.tView;return t===null||t.incompleteFirstPass?n.tView=ZU(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):t}function JU(n,t,e,r,o,s,i,a,c,l,p){let f=t.blueprint.slice();return f[Xl]=o,f[wn]=r|4|128|8|64|1024,(l!==null||n&&n[wn]&2048)&&(f[wn]|=2048),Z4(f),f[Ks]=f[yw]=n,f[ha]=e,f[jh]=i||n&&n[jh],f[fa]=a||n&&n[fa],f[Hy]=c||n&&n[Hy]||null,f[oc]=s,f[lT]=Zwe(),f[q_]=p,f[j4]=l,f[Wc]=t.type==2?n[Wc]:f,f}function A0e(n,t,e){let r=Hh(t,n),o=k0e(e),s=n[jh].rendererFactory,i=nj(n,JU(n,o,null,ej(e),r,t,null,s.createRenderer(r,e),null,null,null));return n[t.index]=i}function ej(n){let t=16;return n.signals?t=4096:n.onPush&&(t=64),t}function tj(n,t,e,r){if(e===0)return-1;let o=t.length;for(let s=0;s<e;s++)t.push(r),n.blueprint.push(r),n.data.push(null);return o}function nj(n,t){return n[hw]?n[Gq][nc]=t:n[hw]=t,n[Gq]=t,t}function rj(n=1){oj(bw(),xi(),XO()+n,!1)}function oj(n,t,e,r){if(!r)if((t[wn]&3)===3){let s=n.preOrderCheckHooks;s!==null&&M_(t,s,e)}else{let s=n.preOrderHooks;s!==null&&R_(t,s,0,e)}Ld(e)}var yT=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(yT||{});function kO(n,t,e,r){let o=Yn(null);try{let[s,i,a]=n.inputs[e],c=null;(i&yT.SignalBased)!==0&&(c=t[s][Ey]),c!==null&&c.transformFn!==void 0?r=c.transformFn(r):a!==null&&(r=a.call(t,r)),n.setInput!==null?n.setInput(t,c,r,e,s):K4(t,c,s,r)}finally{Yn(o)}}function sj(n,t,e,r,o){let s=XO(),i=r&2;try{Ld(-1),i&&t.length>Gh&&oj(n,t,Gh,!1),dr(i?2:0,o),e(r,o)}finally{Ld(s),dr(i?3:1,o)}}function ij(n,t,e){F0e(n,t,e),(e.flags&64)===64&&$0e(n,t,e)}function O0e(n,t,e=Hh){let r=t.localNames;if(r!==null){let o=t.index+1;for(let s=0;s<r.length;s+=2){let i=r[s+1],a=i===-1?e(t,n):n[i];n[o++]=a}}}function M0e(n,t,e,r){let s=r.get(o0e,VU)||e===Xc.ShadowDom,i=n.selectRootElement(t,s);return R0e(i),i}function R0e(n){P0e(n)}var P0e=()=>null;function F0e(n,t,e){let r=e.directiveStart,o=e.directiveEnd;xw(e)&&A0e(t,e,n.data[r+e.componentOffset]),n.firstCreatePass||bU(e,t);let s=e.initialInputs;for(let i=r;i<o;i++){let a=n.data[i],c=bO(t,n,i,e);if(mT(c,t),s!==null&&B0e(t,i-r,c,a,e,s),Bd(a)){let l=Wh(e.index,t);l[ha]=bO(t,n,i,e)}}}function $0e(n,t,e){let r=e.directiveStart,o=e.directiveEnd,s=e.index,i=vwe();try{Ld(s);for(let a=r;a<o;a++){let c=n.data[a],l=t[a];xO(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&L0e(c,l)}}finally{Ld(-1),xO(i)}}function L0e(n,t){n.hostBindings!==null&&n.hostBindings(1,t)}function z0e(n,t){let e=n.directiveRegistry,r=null;if(e)for(let o=0;o<e.length;o++){let s=e[o];x0e(t,s.selectors,!1)&&(r??=[],Bd(s)?r.unshift(s):r.push(s))}return r}function B0e(n,t,e,r,o,s){let i=s[t];if(i!==null)for(let a=0;a<i.length;a+=2){let c=i[a],l=i[a+1];kO(r,e,c,l)}}function V0e(n,t){let e=n[Hy],r=e?e.get(Kc,null):null;r&&r.handleError(t)}function aj(n,t,e,r,o){let s=n.inputs?.[r],i=n.hostDirectiveInputs?.[r],a=!1;if(i)for(let c=0;c<i.length;c+=2){let l=i[c],p=i[c+1],f=t.data[l];kO(f,e[l],p,o),a=!0}if(s)for(let c of s){let l=e[c],p=t.data[c];kO(p,l,r,o),a=!0}return a}function q0e(n,t){let e=Wh(t,n),r=e[Bn];U0e(r,e);let o=e[Xl];o!==null&&e[q_]===null&&(e[q_]=jU(o,e[Hy])),dr(18),cj(r,e,e[ha]),dr(19,e[ha])}function U0e(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])}function cj(n,t,e){HO(t);try{let r=n.viewQuery;r!==null&&DO(1,r,e);let o=n.template;o!==null&&sj(n,t,o,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),t[uT]?.finishViewCreation(n),n.staticContentQueries&&GU(n,t),n.staticViewQueries&&DO(2,n.viewQuery,e);let s=n.components;s!==null&&j0e(t,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{t[wn]&=-5,KO()}}function j0e(n,t){for(let e=0;e<t.length;e++)q0e(n,t[e])}function u4(n,t){return!t||t.firstChild===null||RU(n)}var G0e;function cM(n,t){return G0e(n,t)}var nx=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(nx||{});function uj(n){return(n.flags&32)===32}function qy(n,t,e,r,o){if(r!=null){let s,i=!1;Ql(r)?s=r:Md(r)&&(i=!0,r=r[Xl]);let a=Hc(r);n===0&&e!==null?o==null?QU(t,e,a):Z_(t,e,a,o||null,!0):n===1&&e!==null?Z_(t,e,a,o||null,!0):n===2?I0e(t,a,i):n===3&&t.destroyNode(a),s!=null&&rSe(t,n,s,e,o)}}function W0e(n,t){lj(n,t),t[Xl]=null,t[oc]=null}function H0e(n,t,e,r,o,s){r[Xl]=o,r[oc]=t,xT(n,r,e,1,o,s)}function lj(n,t){t[jh].changeDetectionScheduler?.notify(9),xT(n,t,t[fa],2,null,null)}function K0e(n){let t=n[hw];if(!t)return iO(n[Bn],n);for(;t;){let e=null;if(Md(t))e=t[hw];else{let r=t[pa];r&&(e=r)}if(!e){for(;t&&!t[nc]&&t!==n;)Md(t)&&iO(t[Bn],t),t=t[Ks];t===null&&(t=n),Md(t)&&iO(t[Bn],t),e=t&&t[nc]}t=e}}function uM(n,t){let e=n[W_],r=e.indexOf(t);e.splice(r,1)}function pj(n,t){if(Yy(t))return;let e=t[fa];e.destroyNode&&xT(n,t,e,3,null,null),K0e(t)}function iO(n,t){if(Yy(t))return;let e=Yn(null);try{t[wn]&=-129,t[wn]|=256,t[la]&&$A(t[la]),Q0e(n,t),X0e(n,t),t[Bn].type===1&&t[fa].destroy();let r=t[fw];if(r!==null&&Ql(t[Ks])){r!==t[Ks]&&uM(r,t);let o=t[uT];o!==null&&o.detachView(n)}IO(t)}finally{Yn(e)}}function X0e(n,t){let e=n.cleanup,r=t[U_];if(e!==null)for(let i=0;i<e.length-1;i+=2)if(typeof e[i]=="string"){let a=e[i+3];a>=0?r[a]():r[-a].unsubscribe(),i+=2}else{let a=r[e[i+1]];e[i].call(a)}r!==null&&(t[U_]=null);let o=t[Uh];if(o!==null){t[Uh]=null;for(let i=0;i<o.length;i++){let a=o[i];a()}}let s=t[j_];if(s!==null){t[j_]=null;for(let i of s)i.destroy()}}function Q0e(n,t){let e;if(n!=null&&(e=n.destroyHooks)!=null)for(let r=0;r<e.length;r+=2){let o=t[e[r]];if(!(o instanceof dw)){let s=e[r+1];if(Array.isArray(s))for(let i=0;i<s.length;i+=2){let a=o[s[i]],c=s[i+1];dr(4,a,c);try{c.call(a)}finally{dr(5,a,c)}}else{dr(4,o,s);try{s.call(o)}finally{dr(5,o,s)}}}}}function Y0e(n,t,e){return Z0e(n,t.parent,e)}function Z0e(n,t,e){let r=t;for(;r!==null&&r.type&168;)t=r,r=t.parent;if(r===null)return e[Xl];if(xw(r)){let{encapsulation:o}=n.data[r.directiveStart+r.componentOffset];if(o===Xc.None||o===Xc.Emulated)return null}return Hh(r,e)}function J0e(n,t,e){return tSe(n,t,e)}function eSe(n,t,e){return n.type&40?Hh(n,e):null}var tSe=eSe,l4;function hj(n,t,e,r){let o=Y0e(n,r,t),s=t[fa],i=r.parent||t[oc],a=J0e(i,r,t);if(o!=null)if(Array.isArray(e))for(let c=0;c<e.length;c++)c4(s,o,e[c],a,!1);else c4(s,o,e,a,!1);l4!==void 0&&l4(s,r,t,e,o)}function cw(n,t){if(t!==null){let e=t.type;if(e&3)return Hh(t,n);if(e&4)return AO(-1,n[t.index]);if(e&8){let r=t.child;if(r!==null)return cw(n,r);{let o=n[t.index];return Ql(o)?AO(-1,o):Hc(o)}}else{if(e&128)return cw(n,t.next);if(e&32)return cM(t,n)()||Hc(n[t.index]);{let r=fj(n,t);if(r!==null){if(Array.isArray(r))return r[0];let o=$d(n[Wc]);return cw(o,r)}else return cw(n,t.next)}}}return null}function fj(n,t){if(t!==null){let r=n[Wc][oc],o=t.projection;return r.projection[o]}return null}function AO(n,t){let e=pa+n+1;if(e<t.length){let r=t[e],o=r[Bn].firstChild;if(o!==null)return cw(r,o)}return t[Fd]}function lM(n,t,e,r,o,s,i){for(;e!=null;){if(e.type===128){e=e.next;continue}let a=r[e.index],c=e.type;if(i&&t===0&&(a&&mT(Hc(a),r),e.flags|=2),!uj(e))if(c&8)lM(n,t,e.child,r,o,s,!1),qy(t,n,o,a,s);else if(c&32){let l=cM(e,r),p;for(;p=l();)qy(t,n,o,p,s);qy(t,n,o,a,s)}else c&16?nSe(n,t,r,e,o,s):qy(t,n,o,a,s);e=i?e.projectionNext:e.next}}function xT(n,t,e,r,o,s){lM(e,r,n.firstChild,t,o,s,!1)}function nSe(n,t,e,r,o,s){let i=e[Wc],c=i[oc].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let p=c[l];qy(t,n,o,p,s)}else{let l=c,p=i[Ks];RU(r)&&(l.flags|=128),lM(n,t,l,p,o,s,!0)}}function rSe(n,t,e,r,o){let s=e[Fd],i=Hc(e);s!==i&&qy(t,n,r,s,o);for(let a=pa;a<e.length;a++){let c=e[a];xT(c[Bn],c,n,t,r,s)}}function J_(n,t,e,r,o=!1){for(;e!==null;){if(e.type===128){e=o?e.projectionNext:e.next;continue}let s=t[e.index];s!==null&&r.push(Hc(s)),Ql(s)&&oSe(s,r);let i=e.type;if(i&8)J_(n,t,e.child,r);else if(i&32){let a=cM(e,t),c;for(;c=a();)r.push(c)}else if(i&16){let a=fj(t,e);if(Array.isArray(a))r.push(...a);else{let c=$d(t[Wc]);J_(c[Bn],c,a,r,!0)}}e=o?e.projectionNext:e.next}return r}function oSe(n,t){for(let e=pa;e<n.length;e++){let r=n[e],o=r[Bn].firstChild;o!==null&&J_(r[Bn],r,o,t)}n[Fd]!==n[Xl]&&t.push(n[Fd])}function dj(n){if(n[Uy]!==null){for(let t of n[Uy])t.impl.addSequence(t);n[Uy].length=0}}var mj=[];function sSe(n){return n[la]??iSe(n)}function iSe(n){let t=mj.pop()??Object.create(cSe);return t.lView=n,t}function aSe(n){n.lView[la]!==n&&(n.lView=null,mj.push(n))}var cSe=vt(Fe({},u_),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{vw(n.lView)},consumerOnSignalRead(){this.lView[la]=this}});function uSe(n){let t=n[la]??Object.create(lSe);return t.lView=n,t}var lSe=vt(Fe({},u_),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let t=$d(n.lView);for(;t&&!gj(t[Bn]);)t=$d(t);t&&J4(t)},consumerOnSignalRead(){this.lView[la]=this}});function gj(n){return n.type!==2}function yj(n){if(n[j_]===null)return;let t=!0;for(;t;){let e=!1;for(let r of n[j_])r.dirty&&(e=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));t=e&&!!(n[wn]&8192)}}var pSe=100;function xj(n,t=!0,e=0){let o=n[jh].rendererFactory,s=!1;s||o.begin?.();try{hSe(n,e)}catch(i){throw t&&V0e(n,i),i}finally{s||o.end?.()}}function hSe(n,t){let e=sU();try{Kq(!0),OO(n,t);let r=0;for(;hT(n);){if(r===pSe)throw new Ht(103,!1);r++,OO(n,1)}}finally{Kq(e)}}function fSe(n,t,e,r){if(Yy(t))return;let o=t[wn],s=!1,i=!1;HO(t);let a=!0,c=null,l=null;s||(gj(n)?(l=sSe(t),c=PA(l)):OA()===null?(a=!1,l=uSe(t),c=PA(l)):t[la]&&($A(t[la]),t[la]=null));try{Z4(t),mwe(n.bindingStartIndex),e!==null&&sj(n,t,e,2,r);let p=(o&3)===3;if(!s)if(p){let d=n.preOrderCheckHooks;d!==null&&M_(t,d,null)}else{let d=n.preOrderHooks;d!==null&&R_(t,d,0,null),oO(t,0)}if(i||dSe(t),yj(t),vj(t,0),n.contentQueries!==null&&GU(n,t),!s)if(p){let d=n.contentCheckHooks;d!==null&&M_(t,d)}else{let d=n.contentHooks;d!==null&&R_(t,d,1),oO(t,1)}gSe(n,t);let f=n.components;f!==null&&wj(t,f,0);let y=n.viewQuery;if(y!==null&&DO(2,y,r),!s)if(p){let d=n.viewCheckHooks;d!==null&&M_(t,d)}else{let d=n.viewHooks;d!==null&&R_(t,d,2),oO(t,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),t[rO]){for(let d of t[rO])d();t[rO]=null}s||(dj(t),t[wn]&=-73)}catch(p){throw s||vw(t),p}finally{l!==null&&(sq(l,c),a&&aSe(l)),KO()}}function vj(n,t){for(let e=$U(n);e!==null;e=LU(e))for(let r=pa;r<e.length;r++){let o=e[r];bj(o,t)}}function dSe(n){for(let t=$U(n);t!==null;t=LU(t)){if(!(t[wn]&2))continue;let e=t[W_];for(let r=0;r<e.length;r++){let o=e[r];J4(o)}}}function mSe(n,t,e){dr(18);let r=Wh(t,n);bj(r,e),dr(19,r[ha])}function bj(n,t){WO(n)&&OO(n,t)}function OO(n,t){let r=n[Bn],o=n[wn],s=n[la],i=!!(t===0&&o&16);if(i||=!!(o&64&&t===0),i||=!!(o&1024),i||=!!(s?.dirty&&FA(s)),i||=!1,s&&(s.dirty=!1),n[wn]&=-9217,i)fSe(r,n,r.template,n[ha]);else if(o&8192){yj(n),vj(n,1);let a=r.components;a!==null&&wj(n,a,1),dj(n)}}function wj(n,t,e){for(let r=0;r<t.length;r++)mSe(n,t[r],e)}function gSe(n,t){let e=n.hostBindingOpCodes;if(e!==null)try{for(let r=0;r<e.length;r++){let o=e[r];if(o<0)Ld(~o);else{let s=o,i=e[++r],a=e[++r];xwe(i,s);let c=t[s];dr(24,c),a(2,c),dr(25,c)}}}finally{Ld(-1)}}function pM(n,t){let e=sU()?64:1088;for(n[jh].changeDetectionScheduler?.notify(t);n;){n[wn]|=e;let r=$d(n);if(H_(n)&&!r)return n;n=r}return null}function ySe(n,t,e,r){return[n,!0,0,t,null,r,null,e,null,null]}function xSe(n,t,e,r=!0){let o=t[Bn];if(vSe(o,t,n,e),r){let i=AO(e,n),a=t[fa],c=a.parentNode(n[Fd]);c!==null&&H0e(o,n[oc],a,t,c,i)}let s=t[q_];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function MO(n,t){if(n.length<=pa)return;let e=pa+t,r=n[e];if(r){let o=r[fw];o!==null&&o!==n&&uM(o,r),t>0&&(n[e-1][nc]=r[nc]);let s=B_(n,pa+t);W0e(r[Bn],r);let i=s[uT];i!==null&&i.detachView(s[Bn]),r[Ks]=null,r[nc]=null,r[wn]&=-129}return r}function vSe(n,t,e,r){let o=pa+r,s=e.length;r>0&&(e[o-1][nc]=t),r<s-pa?(t[nc]=e[o],F4(e,pa+r,t)):(e.push(t),t[nc]=null),t[Ks]=e;let i=t[fw];i!==null&&e!==i&&Sj(i,t);let a=t[uT];a!==null&&a.insertView(n),gO(t),t[wn]|=128}function Sj(n,t){let e=n[W_],r=t[Ks];if(Md(r))n[wn]|=2;else{let o=r[Ks][Wc];t[Wc]!==o&&(n[wn]|=2)}e===null?n[W_]=[t]:e.push(t)}var eT=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let t=this._lView,e=t[Bn];return J_(e,t,e.firstChild,[])}constructor(t,e,r=!0){this._lView=t,this._cdRefInjectingView=e,this.notifyErrorHandler=r}get context(){return this._lView[ha]}set context(t){this._lView[ha]=t}get destroyed(){return Yy(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let t=this._lView[Ks];if(Ql(t)){let e=t[G_],r=e?e.indexOf(this):-1;r>-1&&(MO(t,r),B_(e,r))}this._attachedToViewContainer=!1}pj(this._lView[Bn],this._lView)}onDestroy(t){eU(this._lView,t)}markForCheck(){pM(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[wn]&=-129}reattach(){gO(this._lView),this._lView[wn]|=128}detectChanges(){this._lView[wn]|=1024,xj(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ht(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let t=H_(this._lView),e=this._lView[fw];e!==null&&!t&&uM(e,this._lView),lj(this._lView[Bn],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Ht(902,!1);this._appRef=t;let e=H_(this._lView),r=this._lView[fw];r!==null&&!e&&Sj(r,this._lView),gO(this._lView)}};function Cj(n,t,e,r,o){let s=n.data[t];if(s===null)s=bSe(n,t,e,r,o),ywe()&&(s.flags|=32);else if(s.type&64){s.type=e,s.value=r,s.attrs=o;let i=fwe();s.injectorIndex=i===null?-1:i.injectorIndex}return fT(s,!0),s}function bSe(n,t,e,r,o){let s=rU(),i=oU(),a=i?s:s&&s.parent,c=n.data[t]=SSe(n,a,e,t,r,o);return wSe(n,c,s,i),c}function wSe(n,t,e,r){n.firstChild===null&&(n.firstChild=t),e!==null&&(r?e.child==null&&t.parent!==null&&(e.child=t):e.next===null&&(e.next=t,t.prev=e))}function SSe(n,t,e,r,o,s){let i=t?t.injectorIndex:-1,a=0;return lwe()&&(a|=128),{type:e,index:r,insertBeforeIndex:null,injectorIndex:i,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:o,attrs:s,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var PHe=new RegExp(`^(\\d+)*(${r0e}|${n0e})*(.*)`);var CSe=()=>null;function p4(n,t){return CSe(n,t)}var _Se=class{},_j=class{},RO=class{resolveComponentFactory(t){throw Error(`No component factory found for ${Fi(t)}.`)}},vT=class{static NULL=new RO},Xy=class{};var TSe=(()=>{class n{static \u0275prov=Ut({token:n,providedIn:"root",factory:()=>null})}return n})();var aO={},PO=class{injector;parentInjector;constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,r){r=iT(r);let o=this.injector.get(t,aO,r);return o!==aO||e===aO?o:this.parentInjector.get(t,e,r)}};function h4(n,t,e){let r=e?n.styles:null,o=e?n.classes:null,s=0;if(t!==null)for(let i=0;i<t.length;i++){let a=t[i];if(typeof a=="number")s=a;else if(s==1)o=Lq(o,a);else if(s==2){let c=a,l=t[++i];r=Lq(r,c+": "+l+";")}}e?n.styles=r:n.stylesWithoutHost=r,e?n.classes=o:n.classesWithoutHost=o}function hM(n,t=vn.Default){let e=xi();if(e===null)return on(n,t);let r=Yl();return _U(r,e,ua(n),t)}function Tj(){let n="invalid";throw new Error(n)}function ISe(n,t,e,r,o){let s=r===null?null:{"":-1},i=o(n,e);if(i!==null){let a,c=null,l=null,p=NSe(i);p===null?a=i:[a,c,l]=p,ASe(n,t,e,a,s,c,l)}s!==null&&r!==null&&ESe(e,r,s)}function ESe(n,t,e){let r=n.localNames=[];for(let o=0;o<t.length;o+=2){let s=e[t[o+1]];if(s==null)throw new Ht(-301,!1);r.push(t[o],s)}}function NSe(n){let t=null,e=!1;for(let i=0;i<n.length;i++){let a=n[i];if(i===0&&Bd(a)&&(t=a),a.findHostDirectiveDefs!==null){e=!0;break}}if(!e)return null;let r=null,o=null,s=null;for(let i of n)i.findHostDirectiveDefs!==null&&(r??=[],o??=new Map,s??=new Map,DSe(i,r,s,o)),i===t&&(r??=[],r.push(i));return r!==null?(r.push(...t===null?n:n.slice(1)),[r,o,s]):null}function DSe(n,t,e,r){let o=t.length;n.findHostDirectiveDefs(n,t,r),e.set(n,[o,t.length-1])}function kSe(n,t,e){t.componentOffset=e,(n.components??=[]).push(t.index)}function ASe(n,t,e,r,o,s,i){let a=r.length,c=!1;for(let y=0;y<a;y++){let d=r[y];!c&&Bd(d)&&(c=!0,kSe(n,e,y)),Rwe(bU(e,t),n,d.type)}$Se(e,n.data.length,a);for(let y=0;y<a;y++){let d=r[y];d.providersResolver&&d.providersResolver(d)}let l=!1,p=!1,f=tj(n,t,a,null);a>0&&(e.directiveToIndex=new Map);for(let y=0;y<a;y++){let d=r[y];if(e.mergedAttrs=gU(e.mergedAttrs,d.hostAttrs),MSe(n,e,t,f,d),FSe(f,d,o),i!==null&&i.has(d)){let[m,x]=i.get(d);e.directiveToIndex.set(d.type,[f,m+e.directiveStart,x+e.directiveStart])}else(s===null||!s.has(d))&&e.directiveToIndex.set(d.type,f);d.contentQueries!==null&&(e.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(e.flags|=64);let h=d.type.prototype;!l&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(e.index),l=!0),!p&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(e.index),p=!0),f++}OSe(n,e,s)}function OSe(n,t,e){for(let r=t.directiveStart;r<t.directiveEnd;r++){let o=n.data[r];if(e===null||!e.has(o))f4(0,t,o,r),f4(1,t,o,r),m4(t,r,!1);else{let s=e.get(o);d4(0,t,s,r),d4(1,t,s,r),m4(t,r,!0)}}}function f4(n,t,e,r){let o=n===0?e.inputs:e.outputs;for(let s in o)if(o.hasOwnProperty(s)){let i;n===0?i=t.inputs??={}:i=t.outputs??={},i[s]??=[],i[s].push(r),Ij(t,s)}}function d4(n,t,e,r){let o=n===0?e.inputs:e.outputs;for(let s in o)if(o.hasOwnProperty(s)){let i=o[s],a;n===0?a=t.hostDirectiveInputs??={}:a=t.hostDirectiveOutputs??={},a[i]??=[],a[i].push(r,s),Ij(t,i)}}function Ij(n,t){t==="class"?n.flags|=8:t==="style"&&(n.flags|=16)}function m4(n,t,e){let{attrs:r,inputs:o,hostDirectiveInputs:s}=n;if(r===null||!e&&o===null||e&&s===null||aM(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let i=null,a=0;for(;a<r.length;){let c=r[a];if(c===0){a+=4;continue}else if(c===5){a+=2;continue}else if(typeof c=="number")break;if(!e&&o.hasOwnProperty(c)){let l=o[c];for(let p of l)if(p===t){i??=[],i.push(c,r[a+1]);break}}else if(e&&s.hasOwnProperty(c)){let l=s[c];for(let p=0;p<l.length;p+=2)if(l[p]===t){i??=[],i.push(l[p+1],r[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(i)}function MSe(n,t,e,r,o){n.data[r]=o;let s=o.factory||(o.factory=Gy(o.type,!0)),i=new dw(s,Bd(o),hM);n.blueprint[r]=i,e[r]=i,RSe(n,t,r,tj(n,e,o.hostVars,gT),o)}function RSe(n,t,e,r,o){let s=o.hostBindings;if(s){let i=n.hostBindingOpCodes;i===null&&(i=n.hostBindingOpCodes=[]);let a=~t.index;PSe(i)!=a&&i.push(a),i.push(e,r,s)}}function PSe(n){let t=n.length;for(;t>0;){let e=n[--t];if(typeof e=="number"&&e<0)return e}return 0}function FSe(n,t,e){if(e){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)e[t.exportAs[r]]=n;Bd(t)&&(e[""]=n)}}function $Se(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function Ej(n,t,e,r,o,s,i,a){let c=t.consts,l=Hq(c,i),p=Cj(t,n,2,r,l);return s&&ISe(t,e,p,Hq(c,a),o),p.mergedAttrs=gU(p.mergedAttrs,p.attrs),p.attrs!==null&&h4(p,p.attrs,!1),p.mergedAttrs!==null&&h4(p,p.mergedAttrs,!0),t.queries!==null&&t.queries.elementStart(t,p),p}function Nj(n,t){Cwe(n,t),W4(t)&&n.queries.elementEnd(t)}var tT=class extends vT{ngModule;constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){let e=Pd(t);return new Qy(e,this.ngModule)}};function LSe(n){return Object.keys(n).map(t=>{let[e,r,o]=n[t],s={propName:e,templateName:t,isSignal:(r&yT.SignalBased)!==0};return o&&(s.transform=o),s})}function zSe(n){return Object.keys(n).map(t=>({propName:n[t],templateName:t}))}function BSe(n,t,e){let r=t instanceof yi?t:t?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new PO(e,r):e}function VSe(n){let t=n.get(Xy,null);if(t===null)throw new Ht(407,!1);let e=n.get(TSe,null),r=n.get(Ky,null);return{rendererFactory:t,sanitizer:e,changeDetectionScheduler:r}}function qSe(n,t){let e=(n.selectors[0][0]||"div").toLowerCase();return XU(t,e,e==="svg"?ewe:e==="math"?twe:null)}var Qy=class extends _j{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=LSe(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=zSe(this.componentDef.outputs),this.cachedOutputs}constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=S0e(t.selectors),this.ngContentSelectors=t.ngContentSelectors??[],this.isBoundToModule=!!e}create(t,e,r,o){dr(22);let s=Yn(null);try{let i=this.componentDef,a=r?["ng-version","19.2.14"]:C0e(this.componentDef.selectors[0]),c=ZU(0,null,null,1,0,null,null,null,null,[a],null),l=BSe(i,o||this.ngModule,t),p=VSe(l),f=p.rendererFactory.createRenderer(null,i),y=r?M0e(f,r,i.encapsulation,l):qSe(i,f),d=JU(null,c,null,512|ej(i),null,null,p,f,l,null,jU(y,l,!0));d[Gh]=y,HO(d);let h=null;try{let m=Ej(Gh,c,d,"#host",()=>[this.componentDef],!0,0);y&&(YU(f,y,m),mT(y,d)),ij(c,d,m),WU(c,m,d),Nj(c,m),e!==void 0&&USe(m,this.ngContentSelectors,e),h=Wh(m.index,d),d[ha]=h[ha],cj(c,d,null)}catch(m){throw h!==null&&IO(h),IO(d),m}finally{dr(23),KO()}return new FO(this.componentType,d)}finally{Yn(s)}}},FO=class extends _Se{_rootLView;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(t,e){super(),this._rootLView=e,this._tNode=rwe(e[Bn],Gh),this.location=tM(this._tNode,e),this.instance=Wh(this._tNode.index,e)[ha],this.hostView=this.changeDetectorRef=new eT(e,void 0,!1),this.componentType=t}setInput(t,e){let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),e))return;let o=this._rootLView,s=aj(r,o[Bn],o,t,e);this.previousInputValues.set(t,e);let i=Wh(r.index,o);pM(i,1)}get injector(){return new Rd(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}};function USe(n,t,e){let r=n.projection=[];for(let o=0;o<t.length;o++){let s=e[o];r.push(s!=null&&s.length?Array.from(s):null)}}var bT=(()=>{class n{static __NG_ELEMENT_ID__=jSe}return n})();function jSe(){let n=Yl();return WSe(n,xi())}var GSe=bT,Dj=class extends GSe{_lContainer;_hostTNode;_hostLView;constructor(t,e,r){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=r}get element(){return tM(this._hostTNode,this._hostLView)}get injector(){return new Rd(this._hostTNode,this._hostLView)}get parentInjector(){let t=QO(this._hostTNode,this._hostLView);if(yU(t)){let e=X_(t,this._hostLView),r=K_(t),o=e[Bn].data[r+8];return new Rd(o,e)}else return new Rd(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){let e=g4(this._lContainer);return e!==null&&e[t]||null}get length(){return this._lContainer.length-pa}createEmbeddedView(t,e,r){let o,s;typeof r=="number"?o=r:r!=null&&(o=r.index,s=r.injector);let i=p4(this._lContainer,t.ssrId),a=t.createEmbeddedViewImpl(e||{},s,i);return this.insertImpl(a,o,u4(this._hostTNode,i)),a}createComponent(t,e,r,o,s){let i=t&&!Qbe(t),a;if(i)a=e;else{let h=e||{};a=h.index,r=h.injector,o=h.projectableNodes,s=h.environmentInjector||h.ngModuleRef}let c=i?t:new Qy(Pd(t)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let m=(i?l:this.parentInjector).get(yi,null);m&&(s=m)}let p=Pd(c.componentType??{}),f=p4(this._lContainer,p?.id??null),y=f?.firstChild??null,d=c.create(l,o,y,s);return this.insertImpl(d.hostView,a,u4(this._hostTNode,f)),d}insert(t,e){return this.insertImpl(t,e,!0)}insertImpl(t,e,r){let o=t._lView;if(owe(o)){let a=this.indexOf(t);if(a!==-1)this.detach(a);else{let c=o[Ks],l=new Dj(c,c[oc],c[Ks]);l.detach(l.indexOf(t))}}let s=this._adjustIndex(e),i=this._lContainer;return xSe(i,o,s,r),t.attachToViewContainerRef(),F4(cO(i),s,t),t}move(t,e){return this.insert(t,e)}indexOf(t){let e=g4(this._lContainer);return e!==null?e.indexOf(t):-1}remove(t){let e=this._adjustIndex(t,-1),r=MO(this._lContainer,e);r&&(B_(cO(this._lContainer),e),pj(r[Bn],r))}detach(t){let e=this._adjustIndex(t,-1),r=MO(this._lContainer,e);return r&&B_(cO(this._lContainer),e)!=null?new eT(r):null}_adjustIndex(t,e=0){return t??this.length+e}};function g4(n){return n[G_]}function cO(n){return n[G_]||(n[G_]=[])}function WSe(n,t){let e,r=t[n.index];return Ql(r)?e=r:(e=ySe(r,t,null,n),t[n.index]=e,nj(t,e)),KSe(e,t,n,r),new Dj(e,n,t)}function HSe(n,t){let e=n[fa],r=e.createComment(""),o=Hh(t,n),s=e.parentNode(o);return Z_(e,s,r,e.nextSibling(o),!1),r}var KSe=XSe;function XSe(n,t,e,r){if(n[Fd])return;let o;e.type&8?o=Hc(r):o=HSe(t,e),n[Fd]=o}var mw=class{},fM=class{};var $O=class extends mw{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new tT(this);constructor(t,e,r,o=!0){super(),this.ngModuleType=t,this._parent=e;let s=z4(t);this._bootstrapComponents=HU(s.bootstrap),this._r3Injector=EU(t,e,[{provide:mw,useValue:this},{provide:vT,useValue:this.componentFactoryResolver},...r],Fi(t),new Set(["environment"])),o&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}},LO=class extends fM{moduleType;constructor(t){super(),this.moduleType=t}create(t){return new $O(this.moduleType,t,[])}};var nT=class extends mw{injector;componentFactoryResolver=new tT(this);instance=null;constructor(t){super();let e=new pw([...t.providers,{provide:mw,useValue:this},{provide:vT,useValue:this.componentFactoryResolver}],t.parent||GO(),t.debugName,new Set(["environment"]));this.injector=e,t.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}};function Sw(n,t,e=null){return new nT({providers:n,parent:t,debugName:e,runEnvironmentInitializers:!0}).injector}var QSe=(()=>{class n{_injector;cachedInjectors=new Map;constructor(e){this._injector=e}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){let r=B4(!1,e.type),o=r.length>0?Sw([r],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,o)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(let e of this.cachedInjectors.values())e!==null&&e.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Ut({token:n,providedIn:"environment",factory:()=>new n(on(yi))})}return n})();function wT(n){return oT(()=>{let t=kj(n),e=vt(Fe({},t),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===PU.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&n.dependencies||null,getStandaloneInjector:t.standalone?o=>o.get(QSe).getOrCreateStandaloneInjector(e):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Xc.Emulated,styles:n.styles||jc,_:null,schemas:n.schemas||null,tView:null,id:""});t.standalone&&tx("NgStandalone"),Aj(e);let r=n.dependencies;return e.directiveDefs=y4(r,!1),e.pipeDefs=y4(r,!0),e.id=tCe(e),e})}function YSe(n){return Pd(n)||$be(n)}function ZSe(n){return n!==null}function Cw(n){return oT(()=>({type:n.type,bootstrap:n.bootstrap||jc,declarations:n.declarations||jc,imports:n.imports||jc,exports:n.exports||jc,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function JSe(n,t){if(n==null)return Wy;let e={};for(let r in n)if(n.hasOwnProperty(r)){let o=n[r],s,i,a,c;Array.isArray(o)?(a=o[0],s=o[1],i=o[2]??s,c=o[3]||null):(s=o,i=o,a=yT.None,c=null),e[s]=[r,a,c],t[s]=i}return e}function eCe(n){if(n==null)return Wy;let t={};for(let e in n)n.hasOwnProperty(e)&&(t[n[e]]=e);return t}function ST(n){return oT(()=>{let t=kj(n);return Aj(t),t})}function kj(n){let t={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputConfig:n.inputs||Wy,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||jc,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:JSe(n.inputs,t),outputs:eCe(n.outputs),debugInfo:null}}function Aj(n){n.features?.forEach(t=>t(n))}function y4(n,t){if(!n)return null;let e=t?Lbe:YSe;return()=>(typeof n=="function"?n():n).map(r=>e(r)).filter(ZSe)}function tCe(n){let t=0,e=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,e,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let s of r.join("|"))t=Math.imul(31,t)+s.charCodeAt(0)<<0;return t+=2147483648,"c"+t}function nCe(n,t,e){let r=n[t];return Object.is(r,e)?!1:(n[t]=e,!0)}var Oj=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var Mj=new Kt("");var rCe=(()=>{class n{static \u0275prov=Ut({token:n,providedIn:"root",factory:()=>new zO})}return n})(),zO=class{queuedEffectCount=0;queues=new Map;schedule(t){this.enqueue(t)}remove(t){let e=t.zone,r=this.queues.get(e);r.has(t)&&(r.delete(t),this.queuedEffectCount--)}enqueue(t){let e=t.zone;this.queues.has(e)||this.queues.set(e,new Set);let r=this.queues.get(e);r.has(t)||(this.queuedEffectCount++,r.add(t))}flush(){for(;this.queuedEffectCount>0;)for(let[t,e]of this.queues)t===null?this.flushQueue(e):t.run(()=>this.flushQueue(e))}flushQueue(t){for(let e of t)t.delete(e),this.queuedEffectCount--,e.run()}};function CT(n){return!!n&&typeof n.then=="function"}function oCe(n){return!!n&&typeof n.subscribe=="function"}var Rj=new Kt("");function dM(n){return aT([{provide:Rj,multi:!0,useValue:n}])}var Pj=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((e,r)=>{this.resolve=e,this.reject=r});appInits=mt(Rj,{optional:!0})??[];injector=mt(rc);constructor(){}runInitializers(){if(this.initialized)return;let e=[];for(let o of this.appInits){let s=da(this.injector,o);if(CT(s))e.push(s);else if(oCe(s)){let i=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});e.push(i)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{r()}).catch(o=>{this.reject(o)}),e.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),_T=new Kt("");function sCe(){LA(()=>{throw new Ht(600,!1)})}function iCe(n){return n.isBoundToModule}var aCe=10;var zd=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=mt(Kwe);afterRenderManager=mt(UU);zonelessEnabled=mt(ZO);rootEffectScheduler=mt(rCe);dirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new fs;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=mt(Zy).hasPendingTasks.pipe(zn(e=>!e));constructor(){mt(ex,{optional:!0})}whenStable(){let e;return new Promise(r=>{e=this.isStable.subscribe({next:o=>{o&&r()}})}).finally(()=>{e.unsubscribe()})}_injector=mt(yi);_rendererFactory=null;get injector(){return this._injector}bootstrap(e,r){return this.bootstrapImpl(e,r)}bootstrapImpl(e,r,o=rc.NULL){dr(10);let s=e instanceof _j;if(!this._injector.get(Pj).done){let d="";throw new Ht(405,d)}let a;s?a=e:a=this._injector.get(vT).resolveComponentFactory(e),this.componentTypes.push(a.componentType);let c=iCe(a)?void 0:this._injector.get(mw),l=r||a.selector,p=a.create(o,[],l,c),f=p.location.nativeElement,y=p.injector.get(Mj,null);return y?.registerApplication(f),p.onDestroy(()=>{this.detachView(p.hostView),P_(this.components,p),y?.unregisterApplication(f)}),this._loadComponent(p),dr(11,p),p}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){dr(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(sM.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new Ht(101,!1);let e=Yn(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Yn(e),this.afterTick.next(),dr(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Xy,null,{optional:!0}));let e=0;for(;this.dirtyFlags!==0&&e++<aCe;)dr(14),this.synchronizeOnce(),dr(15)}synchronizeOnce(){if(this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let e=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r,notifyErrorHandler:o}of this.allViews)cCe(r,o,e,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:e})=>hT(e))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(e){let r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){let r=e;P_(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(_T,[]).forEach(o=>o(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>P_(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Ht(406,!1);let e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function P_(n,t){let e=n.indexOf(t);e>-1&&n.splice(e,1)}function cCe(n,t,e,r){if(!e&&!hT(n))return;xj(n,t,e&&!r?0:1)}function uCe(n,t,e,r){return nCe(n,gwe(),e)?t+O4(e)+r:gT}function x4(n,t,e,r,o){aj(t,n,e,o?"class":"style",r)}function TT(n,t,e,r){let o=xi(),s=bw(),i=Gh+n,a=o[fa],c=s.firstCreatePass?Ej(i,s,o,t,z0e,uwe(),e,r):s.data[i],l=lCe(s,o,c,a,t,n);o[i]=l;let p=H4(c);return fT(c,!0),YU(a,l,c),!uj(c)&&fU()&&hj(s,o,l,c),(iwe()===0||p)&&mT(l,o),awe(),p&&(ij(s,o,c),WU(s,c,o)),r!==null&&O0e(o,c),TT}function IT(){let n=Yl();oU()?dwe():(n=n.parent,fT(n,!1));let t=n;pwe(t)&&hwe(),cwe();let e=bw();return e.firstCreatePass&&Nj(e,t),t.classesWithoutHost!=null&&Twe(t)&&x4(e,t,xi(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&Iwe(t)&&x4(e,t,xi(),t.stylesWithoutHost,!1),IT}function _w(n,t,e,r){return TT(n,t,e,r),IT(),_w}var lCe=(n,t,e,r,o,s)=>(dU(!0),XU(r,o,wwe()));var rT="en-US";var pCe=rT;function hCe(n){typeof n=="string"&&(pCe=n.toLowerCase().replace(/_/g,"-"))}function v4(n,t,e){return function r(o){if(o===Function)return e;let s=xw(n)?Wh(n.index,t):t;pM(s,5);let i=t[ha],a=b4(t,i,e,o),c=r.__ngNextListenerFn__;for(;c;)a=b4(t,i,c,o)&&a,c=c.__ngNextListenerFn__;return a}}function b4(n,t,e,r){let o=Yn(null);try{return dr(6,t,e),e(r)!==!1}catch(s){return fCe(n,s),!1}finally{dr(7,t,e),Yn(o)}}function fCe(n,t){let e=n[Hy],r=e?e.get(Kc,null):null;r&&r.handleError(t)}function w4(n,t,e,r,o,s){let i=t[e],a=t[Bn],l=a.data[e].outputs[r],p=i[l],f=a.firstCreatePass?nU(a):null,y=tU(t),d=p.subscribe(s),h=y.length;y.push(s,d),f&&f.push(o,n.index,h,-(h+1))}function ET(n,t,e,r){let o=xi(),s=bw(),i=Yl();return mCe(s,o,o[fa],i,n,t,r),ET}function dCe(n,t,e,r){let o=n.cleanup;if(o!=null)for(let s=0;s<o.length-1;s+=2){let i=o[s];if(i===e&&o[s+1]===r){let a=t[U_],c=o[s+2];return a.length>c?a[c]:null}typeof i=="string"&&(s+=2)}return null}function mCe(n,t,e,r,o,s,i){let a=H4(r),l=n.firstCreatePass?nU(n):null,p=tU(t),f=!0;if(r.type&3||i){let y=Hh(r,t),d=i?i(y):y,h=p.length,m=i?w=>i(Hc(w[r.index])):r.index,x=null;if(!i&&a&&(x=dCe(n,t,o,r.index)),x!==null){let w=x.__ngLastListenerFn__||x;w.__ngNextListenerFn__=s,x.__ngLastListenerFn__=s,f=!1}else{s=v4(r,t,s),p0e(t,d,o,s);let w=e.listen(d,o,s);p.push(s,w),l&&l.push(o,m,h,h+1)}}else s=v4(r,t,s);if(f){let y=r.outputs?.[o],d=r.hostDirectiveOutputs?.[o];if(d&&d.length)for(let h=0;h<d.length;h+=2){let m=d[h],x=d[h+1];w4(r,t,m,x,o,s)}if(y&&y.length)for(let h of y)w4(r,t,h,o,o,s)}}function Fj(n,t=""){let e=xi(),r=bw(),o=n+Gh,s=r.firstCreatePass?Cj(r,o,1,t,null):r.data[o],i=gCe(r,e,s,t,n);e[o]=i,fU()&&hj(r,e,i,s),fT(s,!1)}var gCe=(n,t,e,r,o)=>(dU(!0),_0e(t[fa],r));function mM(n){return $j("",n,""),mM}function $j(n,t,e){let r=xi(),o=uCe(r,n,t,e);return o!==gT&&yCe(r,XO(),o),$j}function yCe(n,t,e){let r=nwe(t,n);T0e(n[fa],r,e)}var BO=class{ngModuleFactory;componentFactories;constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}},Lj=(()=>{class n{compileModuleSync(e){return new LO(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){let r=this.compileModuleSync(e),o=z4(e),s=HU(o.declarations).reduce((i,a)=>{let c=Pd(a);return c&&i.push(new Qy(c)),i},[]);return new BO(r,s)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var xCe=(()=>{class n{zone=mt(yo);changeDetectionScheduler=mt(Ky);applicationRef=mt(zd);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),vCe=new Kt("",{factory:()=>!1});function zj({ngZoneFactory:n,ignoreChangesOutsideZone:t,scheduleInRootZone:e}){return n??=()=>new yo(vt(Fe({},Vj()),{scheduleInRootZone:e})),[{provide:yo,useFactory:n},{provide:lw,multi:!0,useFactory:()=>{let r=mt(xCe,{optional:!0});return()=>r.initialize()}},{provide:lw,multi:!0,useFactory:()=>{let r=mt(bCe);return()=>{r.initialize()}}},t===!0?{provide:DU,useValue:!0}:[],{provide:kU,useValue:e??NU}]}function Bj(n){let t=n?.ignoreChangesOutsideZone,e=n?.scheduleInRootZone,r=zj({ngZoneFactory:()=>{let o=Vj(n);return o.scheduleInRootZone=e,o.shouldCoalesceEventChangeDetection&&tx("NgZone_CoalesceEvent"),new yo(o)},ignoreChangesOutsideZone:t,scheduleInRootZone:e});return aT([{provide:vCe,useValue:!0},{provide:ZO,useValue:!1},r])}function Vj(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var bCe=(()=>{class n{subscription=new _o;initialized=!1;zone=mt(yo);pendingTasks=mt(Zy);initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{yo.assertNotInAngularZone(),queueMicrotask(()=>{e!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{yo.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var wCe=(()=>{class n{appRef=mt(zd);taskService=mt(Zy);ngZone=mt(yo);zonelessEnabled=mt(ZO);tracing=mt(ex,{optional:!0});disableScheduling=mt(DU,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new _o;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Y_):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(mt(kU,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof TO||!this.zoneIsDefined)}notify(e){if(!this.zonelessEnabled&&e===5)return;let r=!1;switch(e){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{this.appRef.dirtyFlags|=16,r=!0;break}case 13:{this.appRef.dirtyFlags|=2,r=!0;break}case 11:{r=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let o=this.useMicrotaskScheduler?t4:AU;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>o(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>o(()=>this.tick()))}shouldScheduleTick(e){return!(this.disableScheduling&&!e||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Y_+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let e=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(e),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,t4(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(e)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let e=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(e)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function SCe(){return typeof $localize<"u"&&$localize.locale||rT}var qj=new Kt("",{providedIn:"root",factory:()=>mt(qj,vn.Optional|vn.SkipSelf)||SCe()});var VO=new Kt(""),CCe=new Kt("");function iw(n){return!n.moduleRef}function _Ce(n){let t=iw(n)?n.r3Injector:n.moduleRef.injector,e=t.get(yo);return e.run(()=>{iw(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=t.get(Kc,null),o;if(e.runOutsideAngular(()=>{o=e.onError.subscribe({next:s=>{r.handleError(s)}})}),iw(n)){let s=()=>t.destroy(),i=n.platformInjector.get(VO);i.add(s),t.onDestroy(()=>{o.unsubscribe(),i.delete(s)})}else{let s=()=>n.moduleRef.destroy(),i=n.platformInjector.get(VO);i.add(s),n.moduleRef.onDestroy(()=>{P_(n.allPlatformModules,n.moduleRef),o.unsubscribe(),i.delete(s)})}return ICe(r,e,()=>{let s=t.get(Pj);return s.runInitializers(),s.donePromise.then(()=>{let i=t.get(qj,rT);if(hCe(i||rT),!t.get(CCe,!0))return iw(n)?t.get(zd):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(iw(n)){let c=t.get(zd);return n.rootComponent!==void 0&&c.bootstrap(n.rootComponent),c}else return TCe(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function TCe(n,t){let e=n.injector.get(zd);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>e.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(e);else throw new Ht(-403,!1);t.push(n)}function ICe(n,t,e){try{let r=e();return CT(r)?r.catch(o=>{throw t.runOutsideAngular(()=>n.handleError(o)),o}):r}catch(r){throw t.runOutsideAngular(()=>n.handleError(r)),r}}var F_=null;function ECe(n=[],t){return rc.create({name:t,providers:[{provide:cT,useValue:"platform"},{provide:VO,useValue:new Set([()=>F_=null])},...n]})}function NCe(n=[]){if(F_)return F_;let t=ECe(n);return F_=t,sCe(),DCe(t),t}function DCe(n){let t=n.get(rM,null);da(n,()=>{t?.forEach(e=>e())})}var Tw=(()=>{class n{static __NG_ELEMENT_ID__=kCe}return n})();function kCe(n){return ACe(Yl(),xi(),(n&16)===16)}function ACe(n,t,e){if(xw(n)&&!e){let r=Wh(n.index,t);return new eT(r,r)}else if(n.type&175){let r=t[Wc];return new eT(r,t)}return null}function Uj(n){dr(8);try{let{rootComponent:t,appProviders:e,platformProviders:r}=n,o=NCe(r),s=[zj({}),{provide:Ky,useExisting:wCe},...e||[]],i=new nT({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return _Ce({r3Injector:i.injector,platformInjector:o,rootComponent:t})}catch(t){return Promise.reject(t)}finally{dr(9)}}var S4=class{[Ey];constructor(t){this[Ey]=t}destroy(){this[Ey].destroy()}};function jj(n){let t=Pd(n);if(!t)return null;let e=new Qy(t);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return t.standalone},get isSignal(){return t.signals}}}var Ko=new Kt("");var Hj=null;function Zl(){return Hj}function gM(n){Hj??=n}var Iw=class{},Ew=(()=>{class n{historyGo(e){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:()=>mt(Kj),providedIn:"platform"})}return n})(),yM=new Kt(""),Kj=(()=>{class n extends Ew{_location;_history;_doc=mt(Ko);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Zl().getBaseHref(this._doc)}onPopState(e){let r=Zl().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){let r=Zl().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,r,o){this._history.pushState(e,r,o)}replaceState(e,r,o){this._history.replaceState(e,r,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function NT(n,t){return n?t?n.endsWith("/")?t.startsWith("/")?n+t.slice(1):n+t:t.startsWith("/")?n+t:`${n}/${t}`:n:t}function Gj(n){let t=n.search(/#|\?|$/);return n[t-1]==="/"?n.slice(0,t-1)+n.slice(t):n}function sc(n){return n&&n[0]!=="?"?`?${n}`:n}var Jl=(()=>{class n{historyGo(e){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:()=>mt(kT),providedIn:"root"})}return n})(),DT=new Kt(""),kT=(()=>{class n extends Jl{_platformLocation;_baseHref;_removeListenerFns=[];constructor(e,r){super(),this._platformLocation=e,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??mt(Ko).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return NT(this._baseHref,e)}path(e=!1){let r=this._platformLocation.pathname+sc(this._platformLocation.search),o=this._platformLocation.hash;return o&&e?`${r}${o}`:r}pushState(e,r,o,s){let i=this.prepareExternalUrl(o+sc(s));this._platformLocation.pushState(e,r,i)}replaceState(e,r,o,s){let i=this.prepareExternalUrl(o+sc(s));this._platformLocation.replaceState(e,r,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(r){return new(r||n)(on(Ew),on(DT,8))};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Xh=(()=>{class n{_subject=new fs;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(e){this._locationStrategy=e;let r=this._locationStrategy.getBaseHref();this._basePath=RCe(Gj(Wj(r))),this._locationStrategy.onPopState(o=>{this._subject.next({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+sc(r))}normalize(e){return n.stripTrailingSlash(MCe(this._basePath,Wj(e)))}prepareExternalUrl(e){return e&&e[0]!=="/"&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",o=null){this._locationStrategy.pushState(o,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+sc(r)),o)}replaceState(e,r="",o=null){this._locationStrategy.replaceState(o,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+sc(r)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(o=>o(e,r))}subscribe(e,r,o){return this._subject.subscribe({next:e,error:r??void 0,complete:o??void 0})}static normalizeQueryParams=sc;static joinWithSlash=NT;static stripTrailingSlash=Gj;static \u0275fac=function(r){return new(r||n)(on(Jl))};static \u0275prov=Ut({token:n,factory:()=>OCe(),providedIn:"root"})}return n})();function OCe(){return new Xh(on(Jl))}function MCe(n,t){if(!n||!t.startsWith(n))return t;let e=t.substring(n.length);return e===""||["/",";","?","#"].includes(e[0])?e:t}function Wj(n){return n.replace(/\/index.html$/,"")}function RCe(n){if(new RegExp("^(https?:)?//").test(n)){let[,e]=n.split(/\/\/[^\/]+/);return e}return n}var xM=(()=>{class n extends Jl{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(e,r){super(),this._platformLocation=e,r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(e){let r=NT(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,o,s){let i=this.prepareExternalUrl(o+sc(s))||this._platformLocation.pathname;this._platformLocation.pushState(e,r,i)}replaceState(e,r,o,s){let i=this.prepareExternalUrl(o+sc(s))||this._platformLocation.pathname;this._platformLocation.replaceState(e,r,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(r){return new(r||n)(on(Ew),on(DT,8))};static \u0275prov=Ut({token:n,factory:n.\u0275fac})}return n})();function vM(n,t){t=encodeURIComponent(t);for(let e of n.split(";")){let r=e.indexOf("="),[o,s]=r==-1?[e,""]:[e.slice(0,r),e.slice(r+1)];if(o.trim()===t)return decodeURIComponent(s)}return null}var bM="browser",Qj="server";function AT(n){return n===Qj}var Nw=class{};var Yj=(()=>{class n{static \u0275prov=Ut({token:n,providedIn:"root",factory:()=>new wM(mt(Ko),window)})}return n})(),wM=class{document;window;offset=()=>[0,0];constructor(t,e){this.document=t,this.window=e}setOffset(t){Array.isArray(t)?this.offset=()=>t:this.offset=t}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(t){this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){let e=zCe(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){this.window.history.scrollRestoration=t}scrollToElement(t){let e=t.getBoundingClientRect(),r=e.left+this.window.pageXOffset,o=e.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],o-s[1])}};function zCe(n,t){let e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),o=r.currentNode;for(;o;){let s=o.shadowRoot;if(s){let i=s.getElementById(t)||s.querySelector(`[name="${t}"]`);if(i)return i}o=r.nextNode()}}return null}var RT=new Kt(""),TM=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(e,r){this._zone=r,e.forEach(o=>{o.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,r,o,s){return this._findPluginFor(r).addEventListener(e,r,o,s)}getZone(){return this._zone}_findPluginFor(e){let r=this._eventNameToPlugin.get(e);if(r)return r;if(r=this._plugins.find(s=>s.supports(e)),!r)throw new Ht(5101,!1);return this._eventNameToPlugin.set(e,r),r}static \u0275fac=function(r){return new(r||n)(on(RT),on(yo))};static \u0275prov=Ut({token:n,factory:n.\u0275fac})}return n})(),Dw=class{_doc;constructor(t){this._doc=t}manager},OT="ng-app-id";function Zj(n){for(let t of n)t.remove()}function Jj(n,t){let e=t.createElement("style");return e.textContent=n,e}function BCe(n,t,e,r){let o=n.head?.querySelectorAll(`style[${OT}="${t}"],link[${OT}="${t}"]`);if(o)for(let s of o)s.removeAttribute(OT),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&e.set(s.textContent,{usage:0,elements:[s]})}function CM(n,t){let e=t.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",n),e}var IM=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(e,r,o,s={}){this.doc=e,this.appId=r,this.nonce=o,this.isServer=AT(s),BCe(e,r,this.inline,this.external),this.hosts.add(e.head)}addStyles(e,r){for(let o of e)this.addUsage(o,this.inline,Jj);r?.forEach(o=>this.addUsage(o,this.external,CM))}removeStyles(e,r){for(let o of e)this.removeUsage(o,this.inline);r?.forEach(o=>this.removeUsage(o,this.external))}addUsage(e,r,o){let s=r.get(e);s?s.usage++:r.set(e,{usage:1,elements:[...this.hosts].map(i=>this.addElement(i,o(e,this.doc)))})}removeUsage(e,r){let o=r.get(e);o&&(o.usage--,o.usage<=0&&(Zj(o.elements),r.delete(e)))}ngOnDestroy(){for(let[,{elements:e}]of[...this.inline,...this.external])Zj(e);this.hosts.clear()}addHost(e){this.hosts.add(e);for(let[r,{elements:o}]of this.inline)o.push(this.addElement(e,Jj(r,this.doc)));for(let[r,{elements:o}]of this.external)o.push(this.addElement(e,CM(r,this.doc)))}removeHost(e){this.hosts.delete(e)}addElement(e,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(OT,this.appId),e.appendChild(r)}static \u0275fac=function(r){return new(r||n)(on(Ko),on(nM),on(oM,8),on(Jy))};static \u0275prov=Ut({token:n,factory:n.\u0275fac})}return n})(),SM={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},EM=/%COMP%/g;var tG="%COMP%",VCe=`_nghost-${tG}`,qCe=`_ngcontent-${tG}`,UCe=!0,jCe=new Kt("",{providedIn:"root",factory:()=>UCe});function GCe(n){return qCe.replace(EM,n)}function WCe(n){return VCe.replace(EM,n)}function nG(n,t){return t.map(e=>e.replace(EM,n))}var NM=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(e,r,o,s,i,a,c,l=null,p=null){this.eventManager=e,this.sharedStylesHost=r,this.appId=o,this.removeStylesOnCompDestroy=s,this.doc=i,this.platformId=a,this.ngZone=c,this.nonce=l,this.tracingService=p,this.platformIsServer=AT(a),this.defaultRenderer=new kw(e,i,c,this.platformIsServer,this.tracingService)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Xc.ShadowDom&&(r=vt(Fe({},r),{encapsulation:Xc.Emulated}));let o=this.getOrCreateRenderer(e,r);return o instanceof MT?o.applyToHost(e):o instanceof Aw&&o.applyStyles(),o}getOrCreateRenderer(e,r){let o=this.rendererByCompId,s=o.get(r.id);if(!s){let i=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,p=this.removeStylesOnCompDestroy,f=this.platformIsServer,y=this.tracingService;switch(r.encapsulation){case Xc.Emulated:s=new MT(c,l,r,this.appId,p,i,a,f,y);break;case Xc.ShadowDom:return new _M(c,l,e,r,i,a,this.nonce,f,y);default:s=new Aw(c,l,r,p,i,a,f,y);break}o.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(e){this.rendererByCompId.delete(e)}static \u0275fac=function(r){return new(r||n)(on(TM),on(IM),on(nM),on(jCe),on(Ko),on(Jy),on(yo),on(oM),on(ex,8))};static \u0275prov=Ut({token:n,factory:n.\u0275fac})}return n})(),kw=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(t,e,r,o,s){this.eventManager=t,this.doc=e,this.ngZone=r,this.platformIsServer=o,this.tracingService=s}destroy(){}destroyNode=null;createElement(t,e){return e?this.doc.createElementNS(SM[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){(eG(t)?t.content:t).appendChild(e)}insertBefore(t,e,r){t&&(eG(t)?t.content:t).insertBefore(e,r)}removeChild(t,e){e.remove()}selectRootElement(t,e){let r=typeof t=="string"?this.doc.querySelector(t):t;if(!r)throw new Ht(-5104,!1);return e||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,r,o){if(o){e=o+":"+e;let s=SM[o];s?t.setAttributeNS(s,e,r):t.setAttribute(e,r)}else t.setAttribute(e,r)}removeAttribute(t,e,r){if(r){let o=SM[r];o?t.removeAttributeNS(o,e):t.removeAttribute(`${r}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,r,o){o&(nx.DashCase|nx.Important)?t.style.setProperty(e,r,o&nx.Important?"important":""):t.style[e]=r}removeStyle(t,e,r){r&nx.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,r){t!=null&&(t[e]=r)}setValue(t,e){t.nodeValue=e}listen(t,e,r,o){if(typeof t=="string"&&(t=Zl().getGlobalEventTarget(this.doc,t),!t))throw new Ht(5102,!1);let s=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(t,e,s)),this.eventManager.addEventListener(t,e,s,o)}decoratePreventDefault(t){return e=>{if(e==="__ngUnwrap__")return t;(this.platformIsServer?this.ngZone.runGuarded(()=>t(e)):t(e))===!1&&e.preventDefault()}}};function eG(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var _M=class extends kw{sharedStylesHost;hostEl;shadowRoot;constructor(t,e,r,o,s,i,a,c,l){super(t,s,i,c,l),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let p=o.styles;p=nG(o.id,p);for(let y of p){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=y,this.shadowRoot.appendChild(d)}let f=o.getExternalStyles?.();if(f)for(let y of f){let d=CM(y,s);a&&d.setAttribute("nonce",a),this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,r){return super.insertBefore(this.nodeOrShadowRoot(t),e,r)}removeChild(t,e){return super.removeChild(null,e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Aw=class extends kw{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(t,e,r,o,s,i,a,c,l){super(t,s,i,a,c),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=o;let p=r.styles;this.styles=l?nG(l,p):p,this.styleUrls=r.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},MT=class extends Aw{contentAttr;hostAttr;constructor(t,e,r,o,s,i,a,c,l){let p=o+"-"+r.id;super(t,e,r,s,i,a,c,l,p),this.contentAttr=GCe(p),this.hostAttr=WCe(p)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){let r=super.createElement(t,e);return super.setAttribute(r,this.contentAttr,""),r}};var PT=class n extends Iw{supportsDOMEvents=!0;static makeCurrent(){gM(new n)}onAndCancel(t,e,r,o){return t.addEventListener(e,r,o),()=>{t.removeEventListener(e,r,o)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.remove()}createElement(t,e){return e=e||this.getDefaultDocument(),e.createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return e==="window"?window:e==="document"?t:e==="body"?t.body:null}getBaseHref(t){let e=HCe();return e==null?null:KCe(e)}resetBaseElement(){Ow=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return vM(document.cookie,t)}},Ow=null;function HCe(){return Ow=Ow||document.head.querySelector("base"),Ow?Ow.getAttribute("href"):null}function KCe(n){return new URL(n,document.baseURI).pathname}var XCe=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac})}return n})(),oG=(()=>{class n extends Dw{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,o,s){return e.addEventListener(r,o,s),()=>this.removeEventListener(e,r,o,s)}removeEventListener(e,r,o,s){return e.removeEventListener(r,o,s)}static \u0275fac=function(r){return new(r||n)(on(Ko))};static \u0275prov=Ut({token:n,factory:n.\u0275fac})}return n})(),rG=["alt","control","meta","shift"],QCe={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},YCe={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},sG=(()=>{class n extends Dw{constructor(e){super(e)}supports(e){return n.parseEventName(e)!=null}addEventListener(e,r,o,s){let i=n.parseEventName(r),a=n.eventCallback(i.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Zl().onAndCancel(e,i.domEventName,a,s))}static parseEventName(e){let r=e.toLowerCase().split("."),o=r.shift();if(r.length===0||!(o==="keydown"||o==="keyup"))return null;let s=n._normalizeKey(r.pop()),i="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),i="code."),rG.forEach(l=>{let p=r.indexOf(l);p>-1&&(r.splice(p,1),i+=l+".")}),i+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=o,c.fullKey=i,c}static matchEventFullKeyCode(e,r){let o=QCe[e.key]||e.key,s="";return r.indexOf("code.")>-1&&(o=e.code,s="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),rG.forEach(i=>{if(i!==o){let a=YCe[i];a(e)&&(s+=i+".")}}),s+=o,s===r)}static eventCallback(e,r,o){return s=>{n.matchEventFullKeyCode(s,e)&&o.runGuarded(()=>r(s))}}static _normalizeKey(e){return e==="esc"?"escape":e}static \u0275fac=function(r){return new(r||n)(on(Ko))};static \u0275prov=Ut({token:n,factory:n.\u0275fac})}return n})();function DM(n,t){return Uj(Fe({rootComponent:n},ZCe(t)))}function ZCe(n){return{appProviders:[...r_e,...n?.providers??[]],platformProviders:n_e}}function JCe(){PT.makeCurrent()}function e_e(){return new Kc}function t_e(){return BU(document),document}var n_e=[{provide:Jy,useValue:bM},{provide:rM,useValue:JCe,multi:!0},{provide:Ko,useFactory:t_e}];var r_e=[{provide:cT,useValue:"root"},{provide:Kc,useFactory:e_e},{provide:RT,useClass:oG,multi:!0,deps:[Ko]},{provide:RT,useClass:sG,multi:!0,deps:[Ko]},NM,IM,TM,{provide:Xy,useExisting:NM},{provide:Nw,useClass:XCe},[]];var iG=(()=>{class n{_doc;constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static \u0275fac=function(r){return new(r||n)(on(Ko))};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var mn="primary",Gw=Symbol("RouteTitle"),RM=class{params;constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){let e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){let e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}};function Ud(n){return new RM(n)}function dG(n,t,e){let r=e.path.split("/");if(r.length>n.length||e.pathMatch==="full"&&(t.hasChildren()||r.length<n.length))return null;let o={};for(let s=0;s<r.length;s++){let i=r[s],a=n[s];if(i[0]===":")o[i.substring(1)]=a;else if(i!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:o}}function s_e(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!Qc(n[e],t[e]))return!1;return!0}function Qc(n,t){let e=n?PM(n):void 0,r=t?PM(t):void 0;if(!e||!r||e.length!=r.length)return!1;let o;for(let s=0;s<e.length;s++)if(o=e[s],!mG(n[o],t[o]))return!1;return!0}function PM(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function mG(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;let e=[...n].sort(),r=[...t].sort();return e.every((o,s)=>r[s]===o)}else return n===t}function gG(n){return n.length>0?n[n.length-1]:null}function Jh(n){return YA(n)?n:CT(n)?to(Promise.resolve(n)):nn(n)}var i_e={exact:xG,subset:vG},yG={exact:a_e,subset:c_e,ignored:()=>!0};function aG(n,t,e){return i_e[e.paths](n.root,t.root,e.matrixParams)&&yG[e.queryParams](n.queryParams,t.queryParams)&&!(e.fragment==="exact"&&n.fragment!==t.fragment)}function a_e(n,t){return Qc(n,t)}function xG(n,t,e){if(!Vd(n.segments,t.segments)||!LT(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(let r in t.children)if(!n.children[r]||!xG(n.children[r],t.children[r],e))return!1;return!0}function c_e(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>mG(n[e],t[e]))}function vG(n,t,e){return bG(n,t,t.segments,e)}function bG(n,t,e,r){if(n.segments.length>e.length){let o=n.segments.slice(0,e.length);return!(!Vd(o,e)||t.hasChildren()||!LT(o,e,r))}else if(n.segments.length===e.length){if(!Vd(n.segments,e)||!LT(n.segments,e,r))return!1;for(let o in t.children)if(!n.children[o]||!vG(n.children[o],t.children[o],r))return!1;return!0}else{let o=e.slice(0,n.segments.length),s=e.slice(n.segments.length);return!Vd(n.segments,o)||!LT(n.segments,o,r)||!n.children[mn]?!1:bG(n.children[mn],t,s,r)}}function LT(n,t,e){return t.every((r,o)=>yG[e](n[o].parameters,r.parameters))}var Zc=class{root;queryParams;fragment;_queryParamMap;constructor(t=new Zn([],{}),e={},r=null){this.root=t,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Ud(this.queryParams),this._queryParamMap}toString(){return p_e.serialize(this)}},Zn=class{segments;children;parent=null;constructor(t,e){this.segments=t,this.children=e,Object.values(e).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return zT(this)}},Qh=class{path;parameters;_parameterMap;constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap??=Ud(this.parameters),this._parameterMap}toString(){return SG(this)}};function u_e(n,t){return Vd(n,t)&&n.every((e,r)=>Qc(e.parameters,t[r].parameters))}function Vd(n,t){return n.length!==t.length?!1:n.every((e,r)=>e.path===t[r].path)}function l_e(n,t){let e=[];return Object.entries(n.children).forEach(([r,o])=>{r===mn&&(e=e.concat(t(o,r)))}),Object.entries(n.children).forEach(([r,o])=>{r!==mn&&(e=e.concat(t(o,r)))}),e}var jd=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:()=>new Yh,providedIn:"root"})}return n})(),Yh=class{parse(t){let e=new $M(t);return new Zc(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){let e=`/${Mw(t.root,!0)}`,r=d_e(t.queryParams),o=typeof t.fragment=="string"?`#${h_e(t.fragment)}`:"";return`${e}${r}${o}`}},p_e=new Yh;function zT(n){return n.segments.map(t=>SG(t)).join("/")}function Mw(n,t){if(!n.hasChildren())return zT(n);if(t){let e=n.children[mn]?Mw(n.children[mn],!1):"",r=[];return Object.entries(n.children).forEach(([o,s])=>{o!==mn&&r.push(`${o}:${Mw(s,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}else{let e=l_e(n,(r,o)=>o===mn?[Mw(n.children[mn],!1)]:[`${o}:${Mw(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[mn]!=null?`${zT(n)}/${e[0]}`:`${zT(n)}/(${e.join("//")})`}}function wG(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function FT(n){return wG(n).replace(/%3B/gi,";")}function h_e(n){return encodeURI(n)}function FM(n){return wG(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function BT(n){return decodeURIComponent(n)}function cG(n){return BT(n.replace(/\+/g,"%20"))}function SG(n){return`${FM(n.path)}${f_e(n.parameters)}`}function f_e(n){return Object.entries(n).map(([t,e])=>`;${FM(t)}=${FM(e)}`).join("")}function d_e(n){let t=Object.entries(n).map(([e,r])=>Array.isArray(r)?r.map(o=>`${FT(e)}=${FT(o)}`).join("&"):`${FT(e)}=${FT(r)}`).filter(e=>e);return t.length?`?${t.join("&")}`:""}var m_e=/^[^\/()?;#]+/;function kM(n){let t=n.match(m_e);return t?t[0]:""}var g_e=/^[^\/()?;=#]+/;function y_e(n){let t=n.match(g_e);return t?t[0]:""}var x_e=/^[^=?&#]+/;function v_e(n){let t=n.match(x_e);return t?t[0]:""}var b_e=/^[^&#]+/;function w_e(n){let t=n.match(b_e);return t?t[0]:""}var $M=class{url;remaining;constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Zn([],{}):new Zn([],this.parseChildren())}parseQueryParams(){let t={};if(this.consumeOptional("?"))do this.parseQueryParam(t);while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(r[mn]=new Zn(t,e)),r}parseSegment(){let t=kM(this.remaining);if(t===""&&this.peekStartsWith(";"))throw new Ht(4009,!1);return this.capture(t),new Qh(BT(t),this.parseMatrixParams())}parseMatrixParams(){let t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){let e=y_e(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){let o=kM(this.remaining);o&&(r=o,this.capture(r))}t[BT(e)]=BT(r)}parseQueryParam(t){let e=v_e(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){let i=w_e(this.remaining);i&&(r=i,this.capture(r))}let o=cG(e),s=cG(r);if(t.hasOwnProperty(o)){let i=t[o];Array.isArray(i)||(i=[i],t[o]=i),i.push(s)}else t[o]=s}parseParens(t){let e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=kM(this.remaining),o=this.remaining[r.length];if(o!=="/"&&o!==")"&&o!==";")throw new Ht(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):t&&(s=mn);let i=this.parseChildren();e[s]=Object.keys(i).length===1?i[mn]:new Zn([],i),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return this.peekStartsWith(t)?(this.remaining=this.remaining.substring(t.length),!0):!1}capture(t){if(!this.consumeOptional(t))throw new Ht(4011,!1)}};function CG(n){return n.segments.length>0?new Zn([],{[mn]:n}):n}function _G(n){let t={};for(let[r,o]of Object.entries(n.children)){let s=_G(o);if(r===mn&&s.segments.length===0&&s.hasChildren())for(let[i,a]of Object.entries(s.children))t[i]=a;else(s.segments.length>0||s.hasChildren())&&(t[r]=s)}let e=new Zn(n.segments,t);return S_e(e)}function S_e(n){if(n.numberOfChildren===1&&n.children[mn]){let t=n.children[mn];return new Zn(n.segments.concat(t.segments),t.children)}return n}function ax(n){return n instanceof Zc}function TG(n,t,e=null,r=null){let o=IG(n);return EG(o,t,e,r)}function IG(n){let t;function e(s){let i={};for(let c of s.children){let l=e(c);i[c.outlet]=l}let a=new Zn(s.url,i);return s===n&&(t=a),a}let r=e(n.root),o=CG(r);return t??o}function EG(n,t,e,r){let o=n;for(;o.parent;)o=o.parent;if(t.length===0)return AM(o,o,o,e,r);let s=C_e(t);if(s.toRoot())return AM(o,o,new Zn([],{}),e,r);let i=__e(s,o,n),a=i.processChildren?Pw(i.segmentGroup,i.index,s.commands):DG(i.segmentGroup,i.index,s.commands);return AM(o,i.segmentGroup,a,e,r)}function qT(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function $w(n){return typeof n=="object"&&n!=null&&n.outlets}function AM(n,t,e,r,o){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(p=>`${p}`):`${l}`});let i;n===t?i=e:i=NG(n,t,e);let a=CG(_G(i));return new Zc(a,s,o)}function NG(n,t,e){let r={};return Object.entries(n.children).forEach(([o,s])=>{s===t?r[o]=e:r[o]=NG(s,t,e)}),new Zn(n.segments,r)}var UT=class{isAbsolute;numberOfDoubleDots;commands;constructor(t,e,r){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=r,t&&r.length>0&&qT(r[0]))throw new Ht(4003,!1);let o=r.find($w);if(o&&o!==gG(r))throw new Ht(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function C_e(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new UT(!0,0,n);let t=0,e=!1,r=n.reduce((o,s,i)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...o,{outlets:a}]}if(s.segmentPath)return[...o,s.segmentPath]}return typeof s!="string"?[...o,s]:i===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?e=!0:a===".."?t++:a!=""&&o.push(a))}),o):[...o,s]},[]);return new UT(e,t,r)}var sx=class{segmentGroup;processChildren;index;constructor(t,e,r){this.segmentGroup=t,this.processChildren=e,this.index=r}};function __e(n,t,e){if(n.isAbsolute)return new sx(t,!0,0);if(!e)return new sx(t,!1,NaN);if(e.parent===null)return new sx(e,!0,0);let r=qT(n.commands[0])?0:1,o=e.segments.length-1+r;return T_e(e,o,n.numberOfDoubleDots)}function T_e(n,t,e){let r=n,o=t,s=e;for(;s>o;){if(s-=o,r=r.parent,!r)throw new Ht(4005,!1);o=r.segments.length}return new sx(r,!1,o-s)}function I_e(n){return $w(n[0])?n[0].outlets:{[mn]:n}}function DG(n,t,e){if(n??=new Zn([],{}),n.segments.length===0&&n.hasChildren())return Pw(n,t,e);let r=E_e(n,t,e),o=e.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new Zn(n.segments.slice(0,r.pathIndex),{});return s.children[mn]=new Zn(n.segments.slice(r.pathIndex),n.children),Pw(s,0,o)}else return r.match&&o.length===0?new Zn(n.segments,{}):r.match&&!n.hasChildren()?LM(n,t,e):r.match?Pw(n,0,o):LM(n,t,e)}function Pw(n,t,e){if(e.length===0)return new Zn(n.segments,{});{let r=I_e(e),o={};if(Object.keys(r).some(s=>s!==mn)&&n.children[mn]&&n.numberOfChildren===1&&n.children[mn].segments.length===0){let s=Pw(n.children[mn],t,e);return new Zn(n.segments,s.children)}return Object.entries(r).forEach(([s,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(o[s]=DG(n.children[s],t,i))}),Object.entries(n.children).forEach(([s,i])=>{r[s]===void 0&&(o[s]=i)}),new Zn(n.segments,o)}}function E_e(n,t,e){let r=0,o=t,s={match:!1,pathIndex:0,commandIndex:0};for(;o<n.segments.length;){if(r>=e.length)return s;let i=n.segments[o],a=e[r];if($w(a))break;let c=`${a}`,l=r<e.length-1?e[r+1]:null;if(o>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!lG(c,l,i))return s;r+=2}else{if(!lG(c,{},i))return s;r++}o++}return{match:!0,pathIndex:o,commandIndex:r}}function LM(n,t,e){let r=n.segments.slice(0,t),o=0;for(;o<e.length;){let s=e[o];if($w(s)){let c=N_e(s.outlets);return new Zn(r,c)}if(o===0&&qT(e[0])){let c=n.segments[t];r.push(new Qh(c.path,uG(e[0]))),o++;continue}let i=$w(s)?s.outlets[mn]:`${s}`,a=o<e.length-1?e[o+1]:null;i&&a&&qT(a)?(r.push(new Qh(i,uG(a))),o+=2):(r.push(new Qh(i,{})),o++)}return new Zn(r,{})}function N_e(n){let t={};return Object.entries(n).forEach(([e,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(t[e]=LM(new Zn([],{}),0,r))}),t}function uG(n){let t={};return Object.entries(n).forEach(([e,r])=>t[e]=`${r}`),t}function lG(n,t,e){return n==e.path&&Qc(t,e.parameters)}var VT="imperative",Ro=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Ro||{}),Li=class{id;url;constructor(t,e){this.id=t,this.url=e}},Zh=class extends Li{type=Ro.NavigationStart;navigationTrigger;restoredState;constructor(t,e,r="imperative",o=null){super(t,e),this.navigationTrigger=r,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ac=class extends Li{urlAfterRedirects;type=Ro.NavigationEnd;constructor(t,e,r){super(t,e),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},vi=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(vi||{}),cx=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(cx||{}),Yc=class extends Li{reason;code;type=Ro.NavigationCancel;constructor(t,e,r,o){super(t,e),this.reason=r,this.code=o}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Jc=class extends Li{reason;code;type=Ro.NavigationSkipped;constructor(t,e,r,o){super(t,e),this.reason=r,this.code=o}},ux=class extends Li{error;target;type=Ro.NavigationError;constructor(t,e,r,o){super(t,e),this.error=r,this.target=o}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Lw=class extends Li{urlAfterRedirects;state;type=Ro.RoutesRecognized;constructor(t,e,r,o){super(t,e),this.urlAfterRedirects=r,this.state=o}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},jT=class extends Li{urlAfterRedirects;state;type=Ro.GuardsCheckStart;constructor(t,e,r,o){super(t,e),this.urlAfterRedirects=r,this.state=o}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},GT=class extends Li{urlAfterRedirects;state;shouldActivate;type=Ro.GuardsCheckEnd;constructor(t,e,r,o,s){super(t,e),this.urlAfterRedirects=r,this.state=o,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},WT=class extends Li{urlAfterRedirects;state;type=Ro.ResolveStart;constructor(t,e,r,o){super(t,e),this.urlAfterRedirects=r,this.state=o}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},HT=class extends Li{urlAfterRedirects;state;type=Ro.ResolveEnd;constructor(t,e,r,o){super(t,e),this.urlAfterRedirects=r,this.state=o}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},KT=class{route;type=Ro.RouteConfigLoadStart;constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},XT=class{route;type=Ro.RouteConfigLoadEnd;constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},QT=class{snapshot;type=Ro.ChildActivationStart;constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},YT=class{snapshot;type=Ro.ChildActivationEnd;constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ZT=class{snapshot;type=Ro.ActivationStart;constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},JT=class{snapshot;type=Ro.ActivationEnd;constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},lx=class{routerEvent;position;anchor;type=Ro.Scroll;constructor(t,e,r){this.routerEvent=t,this.position=e,this.anchor=r}toString(){let t=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${t}')`}},zw=class{},px=class{url;navigationBehaviorOptions;constructor(t,e){this.url=t,this.navigationBehaviorOptions=e}};function D_e(n,t){return n.providers&&!n._injector&&(n._injector=Sw(n.providers,t,`Route: ${n.path}`)),n._injector??t}function ic(n){return n.outlet||mn}function k_e(n,t){let e=n.filter(r=>ic(r)===t);return e.push(...n.filter(r=>ic(r)!==t)),e}function Ww(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){let e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}var eI=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Ww(this.route?.snapshot)??this.rootInjector}constructor(t){this.rootInjector=t,this.children=new Gd(this.rootInjector)}},Gd=(()=>{class n{rootInjector;contexts=new Map;constructor(e){this.rootInjector=e}onChildOutletCreated(e,r){let o=this.getOrCreateContext(e);o.outlet=r,this.contexts.set(e,o)}onChildOutletDestroyed(e){let r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new eI(this.rootInjector),this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}static \u0275fac=function(r){return new(r||n)(on(yi))};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),tI=class{_root;constructor(t){this._root=t}get root(){return this._root.value}parent(t){let e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){let e=zM(t,this._root);return e?e.children.map(r=>r.value):[]}firstChild(t){let e=zM(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){let e=BM(t,this._root);return e.length<2?[]:e[e.length-2].children.map(o=>o.value).filter(o=>o!==t)}pathFromRoot(t){return BM(t,this._root).map(e=>e.value)}};function zM(n,t){if(n===t.value)return t;for(let e of t.children){let r=zM(n,e);if(r)return r}return null}function BM(n,t){if(n===t.value)return[t];for(let e of t.children){let r=BM(n,e);if(r.length)return r.unshift(t),r}return[]}var $i=class{value;children;constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}};function ox(n){let t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}var Bw=class extends tI{snapshot;constructor(t,e){super(t),this.snapshot=e,KM(this,t)}toString(){return this.snapshot.toString()}};function kG(n){let t=A_e(n),e=new ds([new Qh("",{})]),r=new ds({}),o=new ds({}),s=new ds({}),i=new ds(""),a=new ep(e,r,s,i,o,mn,n,t.root);return a.snapshot=t.root,new Bw(new $i(a,[]),t)}function A_e(n){let t={},e={},r={},o="",s=new qd([],t,r,o,e,mn,n,null,{});return new Vw("",new $i(s,[]))}var ep=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(t,e,r,o,s,i,a,c){this.urlSubject=t,this.paramsSubject=e,this.queryParamsSubject=r,this.fragmentSubject=o,this.dataSubject=s,this.outlet=i,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(zn(l=>l[Gw]))??nn(void 0),this.url=t,this.params=e,this.queryParams=r,this.fragment=o,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(zn(t=>Ud(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(zn(t=>Ud(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function nI(n,t,e="emptyOnly"){let r,{routeConfig:o}=n;return t!==null&&(e==="always"||o?.path===""||!t.component&&!t.routeConfig?.loadComponent)?r={params:Fe(Fe({},t.params),n.params),data:Fe(Fe({},t.data),n.data),resolve:Fe(Fe(Fe(Fe({},n.data),t.data),o?.data),n._resolvedData)}:r={params:Fe({},n.params),data:Fe({},n.data),resolve:Fe(Fe({},n.data),n._resolvedData??{})},o&&OG(o)&&(r.resolve[Gw]=o.title),r}var qd=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Gw]}constructor(t,e,r,o,s,i,a,c,l){this.url=t,this.params=e,this.queryParams=r,this.fragment=o,this.data=s,this.outlet=i,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Ud(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Ud(this.queryParams),this._queryParamMap}toString(){let t=this.url.map(r=>r.toString()).join("/"),e=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${t}', path:'${e}')`}},Vw=class extends tI{url;constructor(t,e){super(e),this.url=t,KM(this,e)}toString(){return AG(this._root)}};function KM(n,t){t.value._routerState=n,t.children.forEach(e=>KM(n,e))}function AG(n){let t=n.children.length>0?` { ${n.children.map(AG).join(", ")} } `:"";return`${n.value}${t}`}function OM(n){if(n.snapshot){let t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,Qc(t.queryParams,e.queryParams)||n.queryParamsSubject.next(e.queryParams),t.fragment!==e.fragment&&n.fragmentSubject.next(e.fragment),Qc(t.params,e.params)||n.paramsSubject.next(e.params),s_e(t.url,e.url)||n.urlSubject.next(e.url),Qc(t.data,e.data)||n.dataSubject.next(e.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function VM(n,t){let e=Qc(n.params,t.params)&&u_e(n.url,t.url),r=!n.parent!=!t.parent;return e&&!r&&(!n.parent||VM(n.parent,t.parent))}function OG(n){return typeof n.title=="string"||n.title===null}var MG=new Kt(""),Hw=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=mn;activateEvents=new gi;deactivateEvents=new gi;attachEvents=new gi;detachEvents=new gi;routerOutletData=MU(void 0);parentContexts=mt(Gd);location=mt(bT);changeDetector=mt(Tw);inputBinder=mt(Kw,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(e){if(e.name){let{firstChange:r,previousValue:o}=e.name;if(r)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ht(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ht(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ht(4012,!1);this.location.detach();let e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){let e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new Ht(4013,!1);this._activatedRoute=e;let o=this.location,i=e.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new qM(e,a,o.injector,this.routerOutletData);this.activated=o.createComponent(i,{index:o.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=ST({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[pT]})}return n})(),qM=class{route;childContexts;parent;outletData;constructor(t,e,r,o){this.route=t,this.childContexts=e,this.parent=r,this.outletData=o}get(t,e){return t===ep?this.route:t===Gd?this.childContexts:t===MG?this.outletData:this.parent.get(t,e)}},Kw=new Kt(""),XM=(()=>{class n{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){let{activatedRoute:r}=e,o=ow([r.queryParams,r.params,r.data]).pipe(aa(([s,i,a],c)=>(a=Fe(Fe(Fe({},s),i),a),c===0?nn(a):Promise.resolve(a)))).subscribe(s=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(e);return}let i=jj(r.component);if(!i){this.unsubscribeFromRouteData(e);return}for(let{templateName:a}of i.inputs)e.activatedComponentRef.setInput(a,s[a])});this.outletDataSubscriptions.set(e,o)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac})}return n})(),QM=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=wT({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,o){r&1&&_w(0,"router-outlet")},dependencies:[Hw],encapsulation:2})}return n})();function YM(n){let t=n.children&&n.children.map(YM),e=t?vt(Fe({},n),{children:t}):Fe({},n);return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==mn&&(e.component=QM),e}function O_e(n,t,e){let r=qw(n,t._root,e?e._root:void 0);return new Bw(r,t)}function qw(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){let r=e.value;r._futureSnapshot=t.value;let o=M_e(n,t,e);return new $i(r,o)}else{if(n.shouldAttach(t.value)){let s=n.retrieve(t.value);if(s!==null){let i=s.route;return i.value._futureSnapshot=t.value,i.children=t.children.map(a=>qw(n,a)),i}}let r=R_e(t.value),o=t.children.map(s=>qw(n,s));return new $i(r,o)}}function M_e(n,t,e){return t.children.map(r=>{for(let o of e.children)if(n.shouldReuseRoute(r.value,o.value.snapshot))return qw(n,r,o);return qw(n,r)})}function R_e(n){return new ep(new ds(n.url),new ds(n.params),new ds(n.queryParams),new ds(n.fragment),new ds(n.data),n.outlet,n.component,n)}var hx=class{redirectTo;navigationBehaviorOptions;constructor(t,e){this.redirectTo=t,this.navigationBehaviorOptions=e}},RG="ngNavigationCancelingError";function rI(n,t){let{redirectTo:e,navigationBehaviorOptions:r}=ax(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,o=PG(!1,vi.Redirect);return o.url=e,o.navigationBehaviorOptions=r,o}function PG(n,t){let e=new Error(`NavigationCancelingError: ${n||""}`);return e[RG]=!0,e.cancellationCode=t,e}function P_e(n){return FG(n)&&ax(n.url)}function FG(n){return!!n&&n[RG]}var F_e=(n,t,e,r)=>zn(o=>(new UM(t,o.targetRouterState,o.currentRouterState,e,r).activate(n),o)),UM=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(t,e,r,o,s){this.routeReuseStrategy=t,this.futureState=e,this.currState=r,this.forwardEvent=o,this.inputBindingEnabled=s}activate(t){let e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,t),OM(this.futureState.root),this.activateChildRoutes(e,r,t)}deactivateChildRoutes(t,e,r){let o=ox(e);t.children.forEach(s=>{let i=s.value.outlet;this.deactivateRoutes(s,o[i],r),delete o[i]}),Object.values(o).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(t,e,r){let o=t.value,s=e?e.value:null;if(o===s)if(o.component){let i=r.getContext(o.outlet);i&&this.deactivateChildRoutes(t,e,i.children)}else this.deactivateChildRoutes(t,e,r);else s&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){let r=e.getContext(t.value.outlet),o=r&&t.value.component?r.children:e,s=ox(t);for(let i of Object.values(s))this.deactivateRouteAndItsChildren(i,o);if(r&&r.outlet){let i=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:i,route:t,contexts:a})}}deactivateRouteAndOutlet(t,e){let r=e.getContext(t.value.outlet),o=r&&t.value.component?r.children:e,s=ox(t);for(let i of Object.values(s))this.deactivateRouteAndItsChildren(i,o);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(t,e,r){let o=ox(e);t.children.forEach(s=>{this.activateRoutes(s,o[s.value.outlet],r),this.forwardEvent(new JT(s.value.snapshot))}),t.children.length&&this.forwardEvent(new YT(t.value.snapshot))}activateRoutes(t,e,r){let o=t.value,s=e?e.value:null;if(OM(o),o===s)if(o.component){let i=r.getOrCreateContext(o.outlet);this.activateChildRoutes(t,e,i.children)}else this.activateChildRoutes(t,e,r);else if(o.component){let i=r.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){let a=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),i.children.onOutletReAttached(a.contexts),i.attachRef=a.componentRef,i.route=a.route.value,i.outlet&&i.outlet.attach(a.componentRef,a.route.value),OM(a.route.value),this.activateChildRoutes(t,null,i.children)}else i.attachRef=null,i.route=o,i.outlet&&i.outlet.activateWith(o,i.injector),this.activateChildRoutes(t,null,i.children)}else this.activateChildRoutes(t,null,r)}},oI=class{path;route;constructor(t){this.path=t,this.route=this.path[this.path.length-1]}},ix=class{component;route;constructor(t,e){this.component=t,this.route=e}};function $_e(n,t,e){let r=n._root,o=t?t._root:null;return Rw(r,o,e,[r.value])}function L_e(n){let t=n.routeConfig?n.routeConfig.canActivateChild:null;return!t||t.length===0?null:{node:n,guards:t}}function dx(n,t){let e=Symbol(),r=t.get(n,e);return r===e?typeof n=="function"&&!N4(n)?n:t.get(n):r}function Rw(n,t,e,r,o={canDeactivateChecks:[],canActivateChecks:[]}){let s=ox(t);return n.children.forEach(i=>{z_e(i,s[i.value.outlet],e,r.concat([i.value]),o),delete s[i.value.outlet]}),Object.entries(s).forEach(([i,a])=>Fw(a,e.getContext(i),o)),o}function z_e(n,t,e,r,o={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,i=t?t.value:null,a=e?e.getContext(n.value.outlet):null;if(i&&s.routeConfig===i.routeConfig){let c=B_e(i,s,s.routeConfig.runGuardsAndResolvers);c?o.canActivateChecks.push(new oI(r)):(s.data=i.data,s._resolvedData=i._resolvedData),s.component?Rw(n,t,a?a.children:null,r,o):Rw(n,t,e,r,o),c&&a&&a.outlet&&a.outlet.isActivated&&o.canDeactivateChecks.push(new ix(a.outlet.component,i))}else i&&Fw(t,a,o),o.canActivateChecks.push(new oI(r)),s.component?Rw(n,null,a?a.children:null,r,o):Rw(n,null,e,r,o);return o}function B_e(n,t,e){if(typeof e=="function")return e(n,t);switch(e){case"pathParamsChange":return!Vd(n.url,t.url);case"pathParamsOrQueryParamsChange":return!Vd(n.url,t.url)||!Qc(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!VM(n,t)||!Qc(n.queryParams,t.queryParams);case"paramsChange":default:return!VM(n,t)}}function Fw(n,t,e){let r=ox(n),o=n.value;Object.entries(r).forEach(([s,i])=>{o.component?t?Fw(i,t.children.getContext(s),e):Fw(i,null,e):Fw(i,t,e)}),o.component?t&&t.outlet&&t.outlet.isActivated?e.canDeactivateChecks.push(new ix(t.outlet.component,o)):e.canDeactivateChecks.push(new ix(null,o)):e.canDeactivateChecks.push(new ix(null,o))}function Xw(n){return typeof n=="function"}function V_e(n){return typeof n=="boolean"}function q_e(n){return n&&Xw(n.canLoad)}function U_e(n){return n&&Xw(n.canActivate)}function j_e(n){return n&&Xw(n.canActivateChild)}function G_e(n){return n&&Xw(n.canDeactivate)}function W_e(n){return n&&Xw(n.canMatch)}function $G(n){return n instanceof Gl||n?.name==="EmptyError"}var $T=Symbol("INITIAL_VALUE");function fx(){return aa(n=>ow(n.map(t=>t.pipe(Hl(1),eO($T)))).pipe(zn(t=>{for(let e of t)if(e!==!0){if(e===$T)return $T;if(e===!1||H_e(e))return e}return!0}),Pi(t=>t!==$T),Hl(1)))}function H_e(n){return ax(n)||n instanceof hx}function K_e(n,t){return go(e=>{let{targetSnapshot:r,currentSnapshot:o,guards:{canActivateChecks:s,canDeactivateChecks:i}}=e;return i.length===0&&s.length===0?nn(vt(Fe({},e),{guardsResult:!0})):X_e(i,r,o,n).pipe(go(a=>a&&V_e(a)?Q_e(r,s,n,t):nn(a)),zn(a=>vt(Fe({},e),{guardsResult:a})))})}function X_e(n,t,e,r){return to(n).pipe(go(o=>tTe(o.component,o.route,e,t,r)),Kl(o=>o!==!0,!0))}function Q_e(n,t,e,r){return to(t).pipe(Vh(o=>$y(Z_e(o.route.parent,r),Y_e(o.route,r),eTe(n,o.path,e),J_e(n,o.route,e))),Kl(o=>o!==!0,!0))}function Y_e(n,t){return n!==null&&t&&t(new ZT(n)),nn(!0)}function Z_e(n,t){return n!==null&&t&&t(new QT(n)),nn(!0)}function J_e(n,t,e){let r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||r.length===0)return nn(!0);let o=r.map(s=>k_(()=>{let i=Ww(t)??e,a=dx(s,i),c=U_e(a)?a.canActivate(t,n):da(i,()=>a(t,n));return Jh(c).pipe(Kl())}));return nn(o).pipe(fx())}function eTe(n,t,e){let r=t[t.length-1],s=t.slice(0,t.length-1).reverse().map(i=>L_e(i)).filter(i=>i!==null).map(i=>k_(()=>{let a=i.guards.map(c=>{let l=Ww(i.node)??e,p=dx(c,l),f=j_e(p)?p.canActivateChild(r,n):da(l,()=>p(r,n));return Jh(f).pipe(Kl())});return nn(a).pipe(fx())}));return nn(s).pipe(fx())}function tTe(n,t,e,r,o){let s=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!s||s.length===0)return nn(!0);let i=s.map(a=>{let c=Ww(t)??o,l=dx(a,c),p=G_e(l)?l.canDeactivate(n,t,e,r):da(c,()=>l(n,t,e,r));return Jh(p).pipe(Kl())});return nn(i).pipe(fx())}function nTe(n,t,e,r){let o=t.canLoad;if(o===void 0||o.length===0)return nn(!0);let s=o.map(i=>{let a=dx(i,n),c=q_e(a)?a.canLoad(t,e):da(n,()=>a(t,e));return Jh(c)});return nn(s).pipe(fx(),LG(r))}function LG(n){return HA(ms(t=>{if(typeof t!="boolean")throw rI(n,t)}),zn(t=>t===!0))}function rTe(n,t,e,r){let o=t.canMatch;if(!o||o.length===0)return nn(!0);let s=o.map(i=>{let a=dx(i,n),c=W_e(a)?a.canMatch(t,e):da(n,()=>a(t,e));return Jh(c)});return nn(s).pipe(fx(),LG(r))}var Uw=class{segmentGroup;constructor(t){this.segmentGroup=t||null}},jw=class extends Error{urlTree;constructor(t){super(),this.urlTree=t}};function rx(n){return Py(new Uw(n))}function oTe(n){return Py(new Ht(4e3,!1))}function sTe(n){return Py(PG(!1,vi.GuardRejected))}var jM=class{urlSerializer;urlTree;constructor(t,e){this.urlSerializer=t,this.urlTree=e}lineralizeSegments(t,e){let r=[],o=e.root;for(;;){if(r=r.concat(o.segments),o.numberOfChildren===0)return nn(r);if(o.numberOfChildren>1||!o.children[mn])return oTe(`${t.redirectTo}`);o=o.children[mn]}}applyRedirectCommands(t,e,r,o,s){if(typeof e!="string"){let a=e,{queryParams:c,fragment:l,routeConfig:p,url:f,outlet:y,params:d,data:h,title:m}=o,x=da(s,()=>a({params:d,data:h,queryParams:c,fragment:l,routeConfig:p,url:f,outlet:y,title:m}));if(x instanceof Zc)throw new jw(x);e=x}let i=this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,r);if(e[0]==="/")throw new jw(i);return i}applyRedirectCreateUrlTree(t,e,r,o){let s=this.createSegmentGroup(t,e.root,r,o);return new Zc(s,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){let r={};return Object.entries(t).forEach(([o,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);r[o]=e[a]}else r[o]=s}),r}createSegmentGroup(t,e,r,o){let s=this.createSegments(t,e.segments,r,o),i={};return Object.entries(e.children).forEach(([a,c])=>{i[a]=this.createSegmentGroup(t,c,r,o)}),new Zn(s,i)}createSegments(t,e,r,o){return e.map(s=>s.path[0]===":"?this.findPosParam(t,s,o):this.findOrReturn(s,r))}findPosParam(t,e,r){let o=r[e.path.substring(1)];if(!o)throw new Ht(4001,!1);return o}findOrReturn(t,e){let r=0;for(let o of e){if(o.path===t.path)return e.splice(r),o;r++}return t}},GM={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function iTe(n,t,e,r,o){let s=zG(n,t,e);return s.matched?(r=D_e(t,r),rTe(r,t,e,o).pipe(zn(i=>i===!0?s:Fe({},GM)))):nn(s)}function zG(n,t,e){if(t.path==="**")return aTe(e);if(t.path==="")return t.pathMatch==="full"&&(n.hasChildren()||e.length>0)?Fe({},GM):{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};let o=(t.matcher||dG)(e,n,t);if(!o)return Fe({},GM);let s={};Object.entries(o.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let i=o.consumed.length>0?Fe(Fe({},s),o.consumed[o.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:o.consumed,remainingSegments:e.slice(o.consumed.length),parameters:i,positionalParamSegments:o.posParams??{}}}function aTe(n){return{matched:!0,parameters:n.length>0?gG(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function pG(n,t,e,r){return e.length>0&&lTe(n,e,r)?{segmentGroup:new Zn(t,uTe(r,new Zn(e,n.children))),slicedSegments:[]}:e.length===0&&pTe(n,e,r)?{segmentGroup:new Zn(n.segments,cTe(n,e,r,n.children)),slicedSegments:e}:{segmentGroup:new Zn(n.segments,n.children),slicedSegments:e}}function cTe(n,t,e,r){let o={};for(let s of e)if(iI(n,t,s)&&!r[ic(s)]){let i=new Zn([],{});o[ic(s)]=i}return Fe(Fe({},r),o)}function uTe(n,t){let e={};e[mn]=t;for(let r of n)if(r.path===""&&ic(r)!==mn){let o=new Zn([],{});e[ic(r)]=o}return e}function lTe(n,t,e){return e.some(r=>iI(n,t,r)&&ic(r)!==mn)}function pTe(n,t,e){return e.some(r=>iI(n,t,r))}function iI(n,t,e){return(n.hasChildren()||t.length>0)&&e.pathMatch==="full"?!1:e.path===""}function hTe(n,t,e){return t.length===0&&!n.children[e]}var WM=class{};function fTe(n,t,e,r,o,s,i="emptyOnly"){return new HM(n,t,e,r,o,i,s).recognize()}var dTe=31,HM=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(t,e,r,o,s,i,a){this.injector=t,this.configLoader=e,this.rootComponentType=r,this.config=o,this.urlTree=s,this.paramsInheritanceStrategy=i,this.urlSerializer=a,this.applyRedirects=new jM(this.urlSerializer,this.urlTree)}noMatchError(t){return new Ht(4002,`'${t.segmentGroup}'`)}recognize(){let t=pG(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(t).pipe(zn(({children:e,rootSnapshot:r})=>{let o=new $i(r,e),s=new Vw("",o),i=TG(r,[],this.urlTree.queryParams,this.urlTree.fragment);return i.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(i),{state:s,tree:i}}))}match(t){let e=new qd([],Object.freeze({}),Object.freeze(Fe({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),mn,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,t,mn,e).pipe(zn(r=>({children:r,rootSnapshot:e})),Wl(r=>{if(r instanceof jw)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Uw?this.noMatchError(r):r}))}processSegmentGroup(t,e,r,o,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(t,e,r,s):this.processSegment(t,e,r,r.segments,o,!0,s).pipe(zn(i=>i instanceof $i?[i]:[]))}processChildren(t,e,r,o){let s=[];for(let i of Object.keys(r.children))i==="primary"?s.unshift(i):s.push(i);return to(s).pipe(Vh(i=>{let a=r.children[i],c=k_e(e,i);return this.processSegmentGroup(t,c,a,i,o)}),JA((i,a)=>(i.push(...a),i)),qh(null),ZA(),go(i=>{if(i===null)return rx(r);let a=BG(i);return mTe(a),nn(a)}))}processSegment(t,e,r,o,s,i,a){return to(e).pipe(Vh(c=>this.processSegmentAgainstRoute(c._injector??t,e,c,r,o,s,i,a).pipe(Wl(l=>{if(l instanceof Uw)return nn(null);throw l}))),Kl(c=>!!c),Wl(c=>{if($G(c))return hTe(r,o,s)?nn(new WM):rx(r);throw c}))}processSegmentAgainstRoute(t,e,r,o,s,i,a,c){return ic(r)!==i&&(i===mn||!iI(o,s,r))?rx(o):r.redirectTo===void 0?this.matchSegmentAgainstRoute(t,o,r,s,i,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(t,o,e,r,s,i,c):rx(o)}expandSegmentAgainstRouteUsingRedirect(t,e,r,o,s,i,a){let{matched:c,parameters:l,consumedSegments:p,positionalParamSegments:f,remainingSegments:y}=zG(e,o,s);if(!c)return rx(e);typeof o.redirectTo=="string"&&o.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>dTe&&(this.allowRedirects=!1));let d=new qd(s,l,Object.freeze(Fe({},this.urlTree.queryParams)),this.urlTree.fragment,hG(o),ic(o),o.component??o._loadedComponent??null,o,fG(o)),h=nI(d,a,this.paramsInheritanceStrategy);d.params=Object.freeze(h.params),d.data=Object.freeze(h.data);let m=this.applyRedirects.applyRedirectCommands(p,o.redirectTo,f,d,t);return this.applyRedirects.lineralizeSegments(o,m).pipe(go(x=>this.processSegment(t,r,e,x.concat(y),i,!1,a)))}matchSegmentAgainstRoute(t,e,r,o,s,i){let a=iTe(e,r,o,t,this.urlSerializer);return r.path==="**"&&(e.children={}),a.pipe(aa(c=>c.matched?(t=r._injector??t,this.getChildConfig(t,r,o).pipe(aa(({routes:l})=>{let p=r._loadedInjector??t,{parameters:f,consumedSegments:y,remainingSegments:d}=c,h=new qd(y,f,Object.freeze(Fe({},this.urlTree.queryParams)),this.urlTree.fragment,hG(r),ic(r),r.component??r._loadedComponent??null,r,fG(r)),m=nI(h,i,this.paramsInheritanceStrategy);h.params=Object.freeze(m.params),h.data=Object.freeze(m.data);let{segmentGroup:x,slicedSegments:w}=pG(e,y,d,l);if(w.length===0&&x.hasChildren())return this.processChildren(p,l,x,h).pipe(zn(I=>new $i(h,I)));if(l.length===0&&w.length===0)return nn(new $i(h,[]));let _=ic(r)===s;return this.processSegment(p,l,x,w,_?mn:s,!0,h).pipe(zn(I=>new $i(h,I instanceof $i?[I]:[])))}))):rx(e)))}getChildConfig(t,e,r){return e.children?nn({routes:e.children,injector:t}):e.loadChildren?e._loadedRoutes!==void 0?nn({routes:e._loadedRoutes,injector:e._loadedInjector}):nTe(t,e,r,this.urlSerializer).pipe(go(o=>o?this.configLoader.loadChildren(t,e).pipe(ms(s=>{e._loadedRoutes=s.routes,e._loadedInjector=s.injector})):sTe(e))):nn({routes:[],injector:t})}};function mTe(n){n.sort((t,e)=>t.value.outlet===mn?-1:e.value.outlet===mn?1:t.value.outlet.localeCompare(e.value.outlet))}function gTe(n){let t=n.value.routeConfig;return t&&t.path===""}function BG(n){let t=[],e=new Set;for(let r of n){if(!gTe(r)){t.push(r);continue}let o=t.find(s=>r.value.routeConfig===s.value.routeConfig);o!==void 0?(o.children.push(...r.children),e.add(o)):t.push(r)}for(let r of e){let o=BG(r.children);t.push(new $i(r.value,o))}return t.filter(r=>!e.has(r))}function hG(n){return n.data||{}}function fG(n){return n.resolve||{}}function yTe(n,t,e,r,o,s){return go(i=>fTe(n,t,e,r,i.extractedUrl,o,s).pipe(zn(({state:a,tree:c})=>vt(Fe({},i),{targetSnapshot:a,urlAfterRedirects:c}))))}function xTe(n,t){return go(e=>{let{targetSnapshot:r,guards:{canActivateChecks:o}}=e;if(!o.length)return nn(e);let s=new Set(o.map(c=>c.route)),i=new Set;for(let c of s)if(!i.has(c))for(let l of VG(c))i.add(l);let a=0;return to(i).pipe(Vh(c=>s.has(c)?vTe(c,r,n,t):(c.data=nI(c,c.parent,n).resolve,nn(void 0))),ms(()=>a++),Ly(1),go(c=>a===i.size?nn(e):di))})}function VG(n){let t=n.children.map(e=>VG(e)).flat();return[n,...t]}function vTe(n,t,e,r){let o=n.routeConfig,s=n._resolve;return o?.title!==void 0&&!OG(o)&&(s[Gw]=o.title),bTe(s,n,t,r).pipe(zn(i=>(n._resolvedData=i,n.data=nI(n,n.parent,e).resolve,null)))}function bTe(n,t,e,r){let o=PM(n);if(o.length===0)return nn({});let s={};return to(o).pipe(go(i=>wTe(n[i],t,e,r).pipe(Kl(),ms(a=>{if(a instanceof hx)throw rI(new Yh,a);s[i]=a}))),Ly(1),zn(()=>s),Wl(i=>$G(i)?di:Py(i)))}function wTe(n,t,e,r){let o=Ww(t)??r,s=dx(n,o),i=s.resolve?s.resolve(t,e):da(o,()=>s(t,e));return Jh(i)}function MM(n){return aa(t=>{let e=n(t);return e?to(e).pipe(zn(()=>t)):nn(t)})}var ZM=(()=>{class n{buildTitle(e){let r,o=e.root;for(;o!==void 0;)r=this.getResolvedTitleForRoute(o)??r,o=o.children.find(s=>s.outlet===mn);return r}getResolvedTitleForRoute(e){return e.data[Gw]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:()=>mt(qG),providedIn:"root"})}return n})(),qG=(()=>{class n extends ZM{title;constructor(e){super(),this.title=e}updateTitle(e){let r=this.buildTitle(e);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(on(iG))};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Wd=new Kt("",{providedIn:"root",factory:()=>({})}),Hd=new Kt(""),aI=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=mt(Lj);loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return nn(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);let r=Jh(e.loadComponent()).pipe(zn(jG),ms(s=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=s}),sw(()=>{this.componentLoaders.delete(e)})),o=new Ry(r,()=>new fs).pipe(My());return this.componentLoaders.set(e,o),o}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return nn({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=UG(r,this.compiler,e,this.onLoadEndListener).pipe(sw(()=>{this.childrenLoaders.delete(r)})),i=new Ry(s,()=>new fs).pipe(My());return this.childrenLoaders.set(r,i),i}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function UG(n,t,e,r){return Jh(n.loadChildren()).pipe(zn(jG),go(o=>o instanceof fM||Array.isArray(o)?nn(o):to(t.compileModuleAsync(o))),zn(o=>{r&&r(n);let s,i,a=!1;return Array.isArray(o)?(i=o,a=!0):(s=o.create(e).injector,i=s.get(Hd,[],{optional:!0,self:!0}).flat()),{routes:i.map(YM),injector:s}}))}function STe(n){return n&&typeof n=="object"&&"default"in n}function jG(n){return STe(n)?n.default:n}var cI=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:()=>mt(CTe),providedIn:"root"})}return n})(),CTe=(()=>{class n{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,r){return e}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),JM=new Kt(""),eR=new Kt("");function GG(n,t,e){let r=n.get(eR),o=n.get(Ko);return n.get(yo).runOutsideAngular(()=>{if(!o.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,i=new Promise(l=>{s=l}),a=o.startViewTransition(()=>(s(),_Te(n))),{onViewTransitionCreated:c}=r;return c&&da(n,()=>c({transition:a,from:t,to:e})),i})}function _Te(n){return new Promise(t=>{iM({read:()=>setTimeout(t)},{injector:n})})}var tR=new Kt(""),uI=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new fs;transitionAbortSubject=new fs;configLoader=mt(aI);environmentInjector=mt(yi);destroyRef=mt(ww);urlSerializer=mt(jd);rootContexts=mt(Gd);location=mt(Xh);inputBindingEnabled=mt(Kw,{optional:!0})!==null;titleStrategy=mt(ZM);options=mt(Wd,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=mt(cI);createViewTransition=mt(JM,{optional:!0});navigationErrorHandler=mt(tR,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>nn(void 0);rootComponentType=null;destroyed=!1;constructor(){let e=o=>this.events.next(new KT(o)),r=o=>this.events.next(new XT(o));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=e,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(e){let r=++this.navigationId;this.transitions?.next(vt(Fe({},e),{extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))}setupNavigations(e){return this.transitions=new ds(null),this.transitions.pipe(Pi(r=>r!==null),aa(r=>{let o=!1,s=!1;return nn(r).pipe(aa(i=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",vi.SupersededByNewNavigation),di;this.currentTransition=r,this.currentNavigation={id:i.id,initialUrl:i.rawUrl,extractedUrl:i.extractedUrl,targetBrowserUrl:typeof i.extras.browserUrl=="string"?this.urlSerializer.parse(i.extras.browserUrl):i.extras.browserUrl,trigger:i.source,extras:i.extras,previousNavigation:this.lastSuccessfulNavigation?vt(Fe({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let a=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),c=i.extras.onSameUrlNavigation??e.onSameUrlNavigation;if(!a&&c!=="reload"){let l="";return this.events.next(new Jc(i.id,this.urlSerializer.serialize(i.rawUrl),l,cx.IgnoredSameUrlNavigation)),i.resolve(!1),di}if(this.urlHandlingStrategy.shouldProcessUrl(i.rawUrl))return nn(i).pipe(aa(l=>(this.events.next(new Zh(l.id,this.urlSerializer.serialize(l.extractedUrl),l.source,l.restoredState)),l.id!==this.navigationId?di:Promise.resolve(l))),yTe(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy),ms(l=>{r.targetSnapshot=l.targetSnapshot,r.urlAfterRedirects=l.urlAfterRedirects,this.currentNavigation=vt(Fe({},this.currentNavigation),{finalUrl:l.urlAfterRedirects});let p=new Lw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(p)}));if(a&&this.urlHandlingStrategy.shouldProcessUrl(i.currentRawUrl)){let{id:l,extractedUrl:p,source:f,restoredState:y,extras:d}=i,h=new Zh(l,this.urlSerializer.serialize(p),f,y);this.events.next(h);let m=kG(this.rootComponentType).snapshot;return this.currentTransition=r=vt(Fe({},i),{targetSnapshot:m,urlAfterRedirects:p,extras:vt(Fe({},d),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=p,nn(r)}else{let l="";return this.events.next(new Jc(i.id,this.urlSerializer.serialize(i.extractedUrl),l,cx.IgnoredByUrlHandlingStrategy)),i.resolve(!1),di}}),ms(i=>{let a=new jT(i.id,this.urlSerializer.serialize(i.extractedUrl),this.urlSerializer.serialize(i.urlAfterRedirects),i.targetSnapshot);this.events.next(a)}),zn(i=>(this.currentTransition=r=vt(Fe({},i),{guards:$_e(i.targetSnapshot,i.currentSnapshot,this.rootContexts)}),r)),K_e(this.environmentInjector,i=>this.events.next(i)),ms(i=>{if(r.guardsResult=i.guardsResult,i.guardsResult&&typeof i.guardsResult!="boolean")throw rI(this.urlSerializer,i.guardsResult);let a=new GT(i.id,this.urlSerializer.serialize(i.extractedUrl),this.urlSerializer.serialize(i.urlAfterRedirects),i.targetSnapshot,!!i.guardsResult);this.events.next(a)}),Pi(i=>i.guardsResult?!0:(this.cancelNavigationTransition(i,"",vi.GuardRejected),!1)),MM(i=>{if(i.guards.canActivateChecks.length!==0)return nn(i).pipe(ms(a=>{let c=new WT(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),aa(a=>{let c=!1;return nn(a).pipe(xTe(this.paramsInheritanceStrategy,this.environmentInjector),ms({next:()=>c=!0,complete:()=>{c||this.cancelNavigationTransition(a,"",vi.NoDataFromResolver)}}))}),ms(a=>{let c=new HT(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}))}),MM(i=>{let a=c=>{let l=[];c.routeConfig?.loadComponent&&!c.routeConfig._loadedComponent&&l.push(this.configLoader.loadComponent(c.routeConfig).pipe(ms(p=>{c.component=p}),zn(()=>{})));for(let p of c.children)l.push(...a(p));return l};return ow(a(i.targetSnapshot.root)).pipe(qh(null),Hl(1))}),MM(()=>this.afterPreactivation()),aa(()=>{let{currentSnapshot:i,targetSnapshot:a}=r,c=this.createViewTransition?.(this.environmentInjector,i.root,a.root);return c?to(c).pipe(zn(()=>r)):nn(r)}),zn(i=>{let a=O_e(e.routeReuseStrategy,i.targetSnapshot,i.currentRouterState);return this.currentTransition=r=vt(Fe({},i),{targetRouterState:a}),this.currentNavigation.targetRouterState=a,r}),ms(()=>{this.events.next(new zw)}),F_e(this.rootContexts,e.routeReuseStrategy,i=>this.events.next(i),this.inputBindingEnabled),Hl(1),ms({next:i=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ac(i.id,this.urlSerializer.serialize(i.extractedUrl),this.urlSerializer.serialize(i.urlAfterRedirects))),this.titleStrategy?.updateTitle(i.targetRouterState.snapshot),i.resolve(!0)},complete:()=>{o=!0}}),tO(this.transitionAbortSubject.pipe(ms(i=>{throw i}))),sw(()=>{!o&&!s&&this.cancelNavigationTransition(r,"",vi.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation=null,this.currentTransition=null)}),Wl(i=>{if(this.destroyed)return r.resolve(!1),di;if(s=!0,FG(i))this.events.next(new Yc(r.id,this.urlSerializer.serialize(r.extractedUrl),i.message,i.cancellationCode)),P_e(i)?this.events.next(new px(i.url,i.navigationBehaviorOptions)):r.resolve(!1);else{let a=new ux(r.id,this.urlSerializer.serialize(r.extractedUrl),i,r.targetSnapshot??void 0);try{let c=da(this.environmentInjector,()=>this.navigationErrorHandler?.(a));if(c instanceof hx){let{message:l,cancellationCode:p}=rI(this.urlSerializer,c);this.events.next(new Yc(r.id,this.urlSerializer.serialize(r.extractedUrl),l,p)),this.events.next(new px(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(a),i}catch(c){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(c)}}return di}))}))}cancelNavigationTransition(e,r,o){let s=new Yc(e.id,this.urlSerializer.serialize(e.extractedUrl),r,o);this.events.next(s),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let e=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return e.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function TTe(n){return n!==VT}var WG=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:()=>mt(ITe),providedIn:"root"})}return n})(),sI=class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}},ITe=(()=>{class n extends sI{static \u0275fac=(()=>{let e;return function(o){return(e||(e=YO(n)))(o||n)}})();static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),HG=(()=>{class n{urlSerializer=mt(jd);options=mt(Wd,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=mt(Xh);urlHandlingStrategy=mt(cI);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Zc;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:e,initialUrl:r,targetBrowserUrl:o}){let s=e!==void 0?this.urlHandlingStrategy.merge(e,r):r,i=o??s;return i instanceof Zc?this.urlSerializer.serialize(i):i}commitTransition({targetRouterState:e,finalUrl:r,initialUrl:o}){r&&e?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,o),this.routerState=e):this.rawUrlTree=o}routerState=kG(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:e}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:()=>mt(ETe),providedIn:"root"})}return n})(),ETe=(()=>{class n extends HG{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{e(r.url,r.state,"popstate")})})}handleRouterEvent(e,r){e instanceof Zh?this.updateStateMemento():e instanceof Jc?this.commitTransition(r):e instanceof Lw?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):e instanceof zw?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):e instanceof Yc&&(e.code===vi.GuardRejected||e.code===vi.NoDataFromResolver)?this.restoreHistory(r):e instanceof ux?this.restoreHistory(r,!0):e instanceof ac&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,{extras:r,id:o}){let{replaceUrl:s,state:i}=r;if(this.location.isCurrentPathEqualTo(e)||s){let a=this.browserPageId,c=Fe(Fe({},i),this.generateNgRouterState(o,a));this.location.replaceState(e,"",c)}else{let a=Fe(Fe({},i),this.generateNgRouterState(o,this.browserPageId+1));this.location.go(e,"",a)}}restoreHistory(e,r=!1){if(this.canceledNavigationResolution==="computed"){let o=this.browserPageId,s=this.currentPageId-o;s!==0?this.location.historyGo(s):this.getCurrentUrlTree()===e.finalUrl&&s===0&&(this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,r){return this.canceledNavigationResolution==="computed"?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}static \u0275fac=(()=>{let e;return function(o){return(e||(e=YO(n)))(o||n)}})();static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function lI(n,t){n.events.pipe(Pi(e=>e instanceof ac||e instanceof Yc||e instanceof ux||e instanceof Jc),zn(e=>e instanceof ac||e instanceof Jc?0:(e instanceof Yc?e.code===vi.Redirect||e.code===vi.SupersededByNewNavigation:!1)?2:1),Pi(e=>e!==2),Hl(1)).subscribe(()=>{t()})}var NTe={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},DTe={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},tp=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=mt(Oj);stateManager=mt(HG);options=mt(Wd,{optional:!0})||{};pendingTasks=mt(Zy);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=mt(uI);urlSerializer=mt(jd);location=mt(Xh);urlHandlingStrategy=mt(cI);_events=new fs;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=mt(WG);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=mt(Hd,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!mt(Kw,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:e=>{this.console.warn(e)}}),this.subscribeToNavigationEvents()}eventsSubscription=new _o;subscribeToNavigationEvents(){let e=this.navigationTransitions.events.subscribe(r=>{try{let o=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(o!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof Yc&&r.code!==vi.Redirect&&r.code!==vi.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof ac)this.navigated=!0;else if(r instanceof px){let i=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,o.currentRawUrl),c=Fe({browserUrl:o.extras.browserUrl,info:o.extras.info,skipLocationChange:o.extras.skipLocationChange,replaceUrl:o.extras.replaceUrl||this.urlUpdateStrategy==="eager"||TTe(o.source)},i);this.scheduleNavigation(a,VT,null,c,{resolve:o.resolve,reject:o.reject,promise:o.promise})}}ATe(r)&&this._events.next(r)}catch(o){this.navigationTransitions.transitionAbortSubject.next(o)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),VT,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,r,o)=>{this.navigateToSyncWithBrowser(e,o,r)})}navigateToSyncWithBrowser(e,r,o){let s={replaceUrl:!0},i=o?.navigationId?o:null;if(o){let c=Fe({},o);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let a=this.parseUrl(e);this.scheduleNavigation(a,r,i,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(YM),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,r={}){let{relativeTo:o,queryParams:s,fragment:i,queryParamsHandling:a,preserveFragment:c}=r,l=c?this.currentUrlTree.fragment:i,p=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":p=Fe(Fe({},this.currentUrlTree.queryParams),s);break;case"preserve":p=this.currentUrlTree.queryParams;break;default:p=s||null}p!==null&&(p=this.removeEmptyProps(p));let f;try{let y=o?o.snapshot:this.routerState.snapshot.root;f=IG(y)}catch{(typeof e[0]!="string"||e[0][0]!=="/")&&(e=[]),f=this.currentUrlTree.root}return EG(f,e,p,l??null)}navigateByUrl(e,r={skipLocationChange:!1}){let o=ax(e)?e:this.parseUrl(e),s=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(s,VT,null,r)}navigate(e,r={skipLocationChange:!1}){return kTe(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.urlSerializer.parse("/")}}isActive(e,r){let o;if(r===!0?o=Fe({},NTe):r===!1?o=Fe({},DTe):o=r,ax(e))return aG(this.currentUrlTree,e,o);let s=this.parseUrl(e);return aG(this.currentUrlTree,s,o)}removeEmptyProps(e){return Object.entries(e).reduce((r,[o,s])=>(s!=null&&(r[o]=s),r),{})}scheduleNavigation(e,r,o,s,i){if(this.disposed)return Promise.resolve(!1);let a,c,l;i?(a=i.resolve,c=i.reject,l=i.promise):l=new Promise((f,y)=>{a=f,c=y});let p=this.pendingTasks.add();return lI(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(p))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:s,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(f=>Promise.reject(f))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function kTe(n){for(let t=0;t<n.length;t++)if(n[t]==null)throw new Ht(4008,!1)}function ATe(n){return!(n instanceof zw)&&!(n instanceof px)}var Qw=class{};var KG=(()=>{class n{router;injector;preloadingStrategy;loader;subscription;constructor(e,r,o,s){this.router=e,this.injector=r,this.preloadingStrategy=o,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(Pi(e=>e instanceof ac),Vh(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){let o=[];for(let s of r){s.providers&&!s._injector&&(s._injector=Sw(s.providers,e,`Route: ${s.path}`));let i=s._injector??e,a=s._loadedInjector??i;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&o.push(this.preloadConfig(i,s)),(s.children||s._loadedRoutes)&&o.push(this.processRoutes(a,s.children??s._loadedRoutes))}return to(o).pipe(Fy())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let o;r.loadChildren&&r.canLoad===void 0?o=this.loader.loadChildren(e,r):o=nn(null);let s=o.pipe(go(i=>i===null?nn(void 0):(r._loadedRoutes=i.routes,r._loadedInjector=i.injector,this.processRoutes(i.injector??e,i.routes))));if(r.loadComponent&&!r._loadedComponent){let i=this.loader.loadComponent(r);return to([s,i]).pipe(Fy())}else return s})}static \u0275fac=function(r){return new(r||n)(on(tp),on(yi),on(Qw),on(aI))};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),XG=new Kt(""),OTe=(()=>{class n{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(e,r,o,s,i={}){this.urlSerializer=e,this.transitions=r,this.viewportScroller=o,this.zone=s,this.options=i,i.scrollPositionRestoration||="disabled",i.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof Zh?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof ac?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof Jc&&e.code===cx.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof lx&&(e.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(e.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new lx(e,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(r){Tj()};static \u0275prov=Ut({token:n,factory:n.\u0275fac})}return n})();function rR(n,...t){return aT([{provide:Hd,multi:!0,useValue:n},[],{provide:ep,useFactory:QG,deps:[tp]},{provide:_T,multi:!0,useFactory:YG},t.map(e=>e.\u0275providers)])}function QG(n){return n.routerState.root}function Yw(n,t){return{\u0275kind:n,\u0275providers:t}}function YG(){let n=mt(rc);return t=>{let e=n.get(zd);if(t!==e.components[0])return;let r=n.get(tp),o=n.get(ZG);n.get(oR)===1&&r.initialNavigation(),n.get(tW,null,vn.Optional)?.setUpPreloading(),n.get(XG,null,vn.Optional)?.init(),r.resetRootComponentType(e.componentTypes[0]),o.closed||(o.next(),o.complete(),o.unsubscribe())}}var ZG=new Kt("",{factory:()=>new fs}),oR=new Kt("",{providedIn:"root",factory:()=>1});function JG(){let n=[{provide:oR,useValue:0},dM(()=>{let t=mt(rc);return t.get(yM,Promise.resolve()).then(()=>new Promise(r=>{let o=t.get(tp),s=t.get(ZG);lI(o,()=>{r(!0)}),t.get(uI).afterPreactivation=()=>(r(!0),s.closed?nn(void 0):s),o.initialNavigation()}))})];return Yw(2,n)}function eW(){let n=[dM(()=>{mt(tp).setUpLocationChangeListener()}),{provide:oR,useValue:2}];return Yw(3,n)}var tW=new Kt("");function nW(n){return Yw(0,[{provide:tW,useExisting:KG},{provide:Qw,useExisting:n}])}function rW(){return Yw(8,[XM,{provide:Kw,useExisting:XM}])}function oW(n){tx("NgRouterViewTransitions");let t=[{provide:JM,useValue:GG},{provide:eR,useValue:Fe({skipNextTransition:!!n?.skipInitialTransition},n)}];return Yw(9,t)}var sW=[Xh,{provide:jd,useClass:Yh},tp,Gd,{provide:ep,useFactory:QG,deps:[tp]},aI,[]],sR=(()=>{class n{constructor(){}static forRoot(e,r){return{ngModule:n,providers:[sW,[],{provide:Hd,multi:!0,useValue:e},[],r?.errorHandler?{provide:tR,useValue:r.errorHandler}:[],{provide:Wd,useValue:r||{}},r?.useHash?RTe():PTe(),MTe(),r?.preloadingStrategy?nW(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?FTe(r):[],r?.bindToComponentInputs?rW().\u0275providers:[],r?.enableViewTransitions?oW().\u0275providers:[],$Te()]}}static forChild(e){return{ngModule:n,providers:[{provide:Hd,multi:!0,useValue:e}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Cw({type:n});static \u0275inj=gw({})}return n})();function MTe(){return{provide:XG,useFactory:()=>{let n=mt(Yj),t=mt(yo),e=mt(Wd),r=mt(uI),o=mt(jd);return e.scrollOffset&&n.setOffset(e.scrollOffset),new OTe(o,r,n,t,e)}}}function RTe(){return{provide:Jl,useClass:xM}}function PTe(){return{provide:Jl,useClass:kT}}function FTe(n){return[n.initialNavigation==="disabled"?eW().\u0275providers:[],n.initialNavigation==="enabledBlocking"?JG().\u0275providers:[]]}var nR=new Kt("");function $Te(){return[{provide:nR,useFactory:YG},{provide:_T,multi:!0,useExisting:nR}]}var iW=[];var aW={providers:[Bj({eventCoalescing:!0}),rR(iW)]};var hye=Jb(pye());var jk=class n{title="magenta-music";playing=!1;player=new hye.Player;onClick(t){return Y(this,null,function*(){})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=wT({type:n,selectors:[["app-root"]],decls:4,vars:1,consts:[[1,"main"],["matButton","",3,"click"]],template:function(e,r){e&1&&(TT(0,"main",0)(1,"button",1),ET("click",function(s){return r.onClick(s)}),Fj(2),IT()(),_w(3,"router-outlet")),e&2&&(rj(2),mM(r.playing?"Stop":"Play"))},dependencies:[sR,Hw],encapsulation:2})};DM(jk,aW).catch(n=>console.error(n));
